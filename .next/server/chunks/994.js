exports.id=994,exports.ids=[994],exports.modules={13538:(e,t,r)=>{var s={"./darwin/arm64/onnxruntime_binding.node":67987,"./darwin/x64/onnxruntime_binding.node":29467,"./linux/arm64/onnxruntime_binding.node":57824,"./linux/x64/onnxruntime_binding.node":51603,"./win32/arm64/onnxruntime_binding.node":61200,"./win32/x64/onnxruntime_binding.node":51343};function o(e){return r(a(e))}function a(e){if(!r.o(s,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=a,e.exports=o,o.id=13538},43350:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;let s=r(66319),o=r(6698),a=r(51433),n=r(69771),i=["/properties"],l="http://json-schema.org/draft-07/schema";class c extends s.default{_addVocabularies(){super._addVocabularies(),o.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(a.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(n,i):n;this.addMetaSchema(e,l,!1),this.refs["http://json-schema.org/schema"]=l}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(l)?l:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var d=r(65863);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return d.KeywordCxt}});var u=r(70257);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var m=r(69638);Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return m.default}});var p=r(99925);Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return p.default}})},71393:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class r{}t._CodeOrName=r,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class s extends r{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=s;class o extends r{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof s&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function a(e,...t){let r=[e[0]],s=0;for(;s<t.length;)l(r,t[s]),r.push(e[++s]);return new o(r)}t._Code=o,t.nil=new o(""),t._=a;let n=new o("+");function i(e,...t){let r=[c(e[0])],a=0;for(;a<t.length;)r.push(n),l(r,t[a]),r.push(n,c(e[++a]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===n){var r,o;let a=(r=e[t-1],'""'===(o=e[t+1])?r:'""'===r?o:"string"==typeof r?o instanceof s||'"'!==r[r.length-1]?void 0:"string"!=typeof o?`${r.slice(0,-1)}${o}"`:'"'===o[0]?r.slice(0,-1)+o.slice(1):void 0:"string"!=typeof o||'"'!==o[0]||r instanceof s?void 0:`"${r}${o.slice(1)}`);if(void 0!==a){e.splice(t-1,3,a);continue}e[t++]="+"}t++}}(r),new o(r)}function l(e,t){t instanceof o?e.push(...t._items):t instanceof s?e.push(t):e.push("number"==typeof t||"boolean"==typeof t||null===t?t:c(Array.isArray(t)?t.join(","):t))}function c(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=i,t.addCodeArg=l,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:i`${e}${t}`},t.stringify=function(e){return new o(c(e))},t.safeStringify=c,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new o(`.${e}`):a`[${e}]`},t.getEsmExportName=function(e){if("string"==typeof e&&t.IDENTIFIER.test(e))return new o(`${e}`);throw Error(`CodeGen: invalid export name: ${e}, use explicit $id name mapping`)},t.regexpCode=function(e){return new o(e.toString())}},70257:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;let s=r(71393),o=r(54775);var a=r(71393);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return a._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return a.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return a.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return a.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return a.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return a.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return a.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return a.Name}});var n=r(54775);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return n.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return n.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return n.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return n.varKinds}}),t.operators={GT:new s._Code(">"),GTE:new s._Code(">="),LT:new s._Code("<"),LTE:new s._Code("<="),EQ:new s._Code("==="),NEQ:new s._Code("!=="),NOT:new s._Code("!"),OR:new s._Code("||"),AND:new s._Code("&&"),ADD:new s._Code("+")};class i{optimizeNodes(){return this}optimizeNames(e,t){return this}}class l extends i{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){let r=e?o.varKinds.var:this.varKind,s=void 0===this.rhs?"":` = ${this.rhs}`;return`${r} ${this.name}${s};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=I(this.rhs,e,t)),this}get names(){return this.rhs instanceof s._CodeOrName?this.rhs.names:{}}}class c extends i{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof s.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=I(this.rhs,e,t),this}get names(){return A(this.lhs instanceof s.Name?{}:{...this.lhs.names},this.rhs)}}class d extends c{constructor(e,t,r,s){super(e,r,s),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class u extends i{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class m extends i{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){let t=this.label?` ${this.label}`:"";return`break${t};`+e}}class p extends i{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class h extends i{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=I(this.code,e,t),this}get names(){return this.code instanceof s._CodeOrName?this.code.names:{}}}class f extends i{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){let{nodes:e}=this,t=e.length;for(;t--;){let r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){let{nodes:r}=this,s=r.length;for(;s--;){let o=r[s];o.optimizeNames(e,t)||(function(e,t){for(let r in t)e[r]=(e[r]||0)-(t[r]||0)}(e,o.names),r.splice(s,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>E(e,t.names),{})}}class _ extends f{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class g extends f{}class M extends _{}M.kind="else";class y extends _{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){let e=t.optimizeNodes();t=this.else=Array.isArray(e)?new M(e):e}return t?!1===e?t instanceof y?t:t.nodes:this.nodes.length?this:new y($(e),t instanceof y?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=I(this.condition,e,t),this}get names(){let e=super.names;return A(e,this.condition),this.else&&E(e,this.else.names),e}}y.kind="if";class w extends _{}w.kind="for";class b extends w{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=I(this.iteration,e,t),this}get names(){return E(super.names,this.iteration.names)}}class v extends w{constructor(e,t,r,s){super(),this.varKind=e,this.name=t,this.from=r,this.to=s}render(e){let t=e.es5?o.varKinds.var:this.varKind,{name:r,from:s,to:a}=this;return`for(${t} ${r}=${s}; ${r}<${a}; ${r}++)`+super.render(e)}get names(){let e=A(super.names,this.from);return A(e,this.to)}}class x extends w{constructor(e,t,r,s){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=s}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=I(this.iterable,e,t),this}get names(){return E(super.names,this.iterable.names)}}class P extends _{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){let t=this.async?"async ":"";return`${t}function ${this.name}(${this.args})`+super.render(e)}}P.kind="func";class T extends f{render(e){return"return "+super.render(e)}}T.kind="return";class k extends _{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,s;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(s=this.finally)||void 0===s||s.optimizeNames(e,t),this}get names(){let e=super.names;return this.catch&&E(e,this.catch.names),this.finally&&E(e,this.finally.names),e}}class F extends _{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}F.kind="catch";class S extends _{render(e){return"finally"+super.render(e)}}S.kind="finally";class C{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new o.Scope({parent:e}),this._nodes=[new g]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){let r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,s){let o=this._scope.toName(t);return void 0!==r&&s&&(this._constants[o.str]=r),this._leafNode(new l(e,o,r)),o}const(e,t,r){return this._def(o.varKinds.const,e,t,r)}let(e,t,r){return this._def(o.varKinds.let,e,t,r)}var(e,t,r){return this._def(o.varKinds.var,e,t,r)}assign(e,t,r){return this._leafNode(new c(e,t,r))}add(e,r){return this._leafNode(new d(e,t.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==s.nil&&this._leafNode(new h(e)),this}object(...e){let t=["{"];for(let[r,o]of e)t.length>1&&t.push(","),t.push(r),(r!==o||this.opts.es5)&&(t.push(":"),(0,s.addCodeArg)(t,o));return t.push("}"),new s._Code(t)}if(e,t,r){if(this._blockNode(new y(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new M)}endIf(){return this._endBlockNode(y,M)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new b(e),t)}forRange(e,t,r,s,a=this.opts.es5?o.varKinds.var:o.varKinds.let){let n=this._scope.toName(e);return this._for(new v(a,n,t,r),()=>s(n))}forOf(e,t,r,a=o.varKinds.const){let n=this._scope.toName(e);if(this.opts.es5){let e=t instanceof s.Name?t:this.var("_arr",t);return this.forRange("_i",0,(0,s._)`${e}.length`,t=>{this.var(n,(0,s._)`${e}[${t}]`),r(n)})}return this._for(new x("of",a,n,t),()=>r(n))}forIn(e,t,r,a=this.opts.es5?o.varKinds.var:o.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,s._)`Object.keys(${t})`,r);let n=this._scope.toName(e);return this._for(new x("in",a,n,t),()=>r(n))}endFor(){return this._endBlockNode(w)}label(e){return this._leafNode(new u(e))}break(e){return this._leafNode(new m(e))}return(e){let t=new T;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw Error('CodeGen: "return" should have one node');return this._endBlockNode(T)}try(e,t,r){if(!t&&!r)throw Error('CodeGen: "try" without "catch" and "finally"');let s=new k;if(this._blockNode(s),this.code(e),t){let e=this.name("e");this._currNode=s.catch=new F(e),t(e)}return r&&(this._currNode=s.finally=new S,this.code(r)),this._endBlockNode(F,S)}throw(e){return this._leafNode(new p(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){let t=this._blockStarts.pop();if(void 0===t)throw Error("CodeGen: not in self-balancing block");let r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=s.nil,r,o){return this._blockNode(new P(e,t,r)),o&&this.code(o).endFunc(),this}endFunc(){return this._endBlockNode(P)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){let r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){let t=this._currNode;if(!(t instanceof y))throw Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let t=this._nodes;t[t.length-1]=e}}function E(e,t){for(let r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function A(e,t){return t instanceof s._CodeOrName?E(e,t.names):e}function I(e,t,r){if(e instanceof s.Name)return o(e);if(!(e instanceof s._Code&&e._items.some(e=>e instanceof s.Name&&1===t[e.str]&&void 0!==r[e.str])))return e;return new s._Code(e._items.reduce((e,t)=>(t instanceof s.Name&&(t=o(t)),t instanceof s._Code?e.push(...t._items):e.push(t),e),[]));function o(e){let s=r[e.str];return void 0===s||1!==t[e.str]?e:(delete t[e.str],s)}}function $(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:(0,s._)`!${N(e)}`}t.CodeGen=C,t.not=$;let L=O(t.operators.AND);t.and=function(...e){return e.reduce(L)};let j=O(t.operators.OR);function O(e){return(t,r)=>t===s.nil?r:r===s.nil?t:(0,s._)`${N(t)} ${e} ${N(r)}`}function N(e){return e instanceof s.Name?e:(0,s._)`(${e})`}t.or=function(...e){return e.reduce(j)}},54775:(e,t,r)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;let o=r(71393);class a extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}(function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"})(s||(t.UsedValueState=s={})),t.varKinds={const:new o.Name("const"),let:new o.Name("let"),var:new o.Name("var")};class n{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof o.Name?e:this.name(e)}name(e){return new o.Name(this._newName(e))}_newName(e){let t=this._names[e]||this._nameGroup(e);return`${e}${t.index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}t.Scope=n;class i extends o.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:r}){this.value=e,this.scopePath=(0,o._)`.${new o.Name(t)}[${r}]`}}t.ValueScopeName=i;let l=(0,o._)`\n`;class c extends n{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?l:o.nil}}get(){return this._scope}name(e){return new i(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw Error("CodeGen: ref must be passed in value");let s=this.toName(e),{prefix:o}=s,a=null!==(r=t.key)&&void 0!==r?r:t.ref,n=this._values[o];if(n){let e=n.get(a);if(e)return e}else n=this._values[o]=new Map;n.set(a,s);let i=this._scope[o]||(this._scope[o]=[]),l=i.length;return i[l]=t.ref,s.setValue(t,{property:o,itemIndex:l}),s}getValue(e,t){let r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw Error(`CodeGen: name "${t}" has no value`);return(0,o._)`${e}${t.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(e,r,n={},i){let l=o.nil;for(let c in e){let d=e[c];if(!d)continue;let u=n[c]=n[c]||new Map;d.forEach(e=>{if(u.has(e))return;u.set(e,s.Started);let n=r(e);if(n){let r=this.opts.es5?t.varKinds.var:t.varKinds.const;l=(0,o._)`${l}${r} ${e} = ${n};${this.opts._n}`}else if(n=null==i?void 0:i(e))l=(0,o._)`${l}${n}${this.opts._n}`;else throw new a(e);u.set(e,s.Completed)})}return l}}t.ValueScope=c},49479:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;let s=r(70257),o=r(3050),a=r(82281);function n(e,t){let r=e.const("err",t);e.if((0,s._)`${a.default.vErrors} === null`,()=>e.assign(a.default.vErrors,(0,s._)`[${r}]`),(0,s._)`${a.default.vErrors}.push(${r})`),e.code((0,s._)`${a.default.errors}++`)}function i(e,t){let{gen:r,validateName:o,schemaEnv:a}=e;a.$async?r.throw((0,s._)`new ${e.ValidationError}(${t})`):(r.assign((0,s._)`${o}.errors`,t),r.return(!1))}t.keywordError={message:({keyword:e})=>(0,s.str)`must pass "${e}" keyword validation`},t.keyword$DataError={message:({keyword:e,schemaType:t})=>t?(0,s.str)`"${e}" keyword must be ${t} ($data)`:(0,s.str)`"${e}" keyword is invalid ($data)`},t.reportError=function(e,r=t.keywordError,o,a){let{it:l}=e,{gen:d,compositeRule:u,allErrors:m}=l,p=c(e,r,o);(null!=a?a:u||m)?n(d,p):i(l,(0,s._)`[${p}]`)},t.reportExtraError=function(e,r=t.keywordError,s){let{it:o}=e,{gen:l,compositeRule:d,allErrors:u}=o;n(l,c(e,r,s)),d||u||i(o,a.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(a.default.errors,t),e.if((0,s._)`${a.default.vErrors} !== null`,()=>e.if(t,()=>e.assign((0,s._)`${a.default.vErrors}.length`,t),()=>e.assign(a.default.vErrors,null)))},t.extendErrors=function({gen:e,keyword:t,schemaValue:r,data:o,errsCount:n,it:i}){if(void 0===n)throw Error("ajv implementation error");let l=e.name("err");e.forRange("i",n,a.default.errors,n=>{e.const(l,(0,s._)`${a.default.vErrors}[${n}]`),e.if((0,s._)`${l}.instancePath === undefined`,()=>e.assign((0,s._)`${l}.instancePath`,(0,s.strConcat)(a.default.instancePath,i.errorPath))),e.assign((0,s._)`${l}.schemaPath`,(0,s.str)`${i.errSchemaPath}/${t}`),i.opts.verbose&&(e.assign((0,s._)`${l}.schema`,r),e.assign((0,s._)`${l}.data`,o))})};let l={keyword:new s.Name("keyword"),schemaPath:new s.Name("schemaPath"),params:new s.Name("params"),propertyName:new s.Name("propertyName"),message:new s.Name("message"),schema:new s.Name("schema"),parentSchema:new s.Name("parentSchema")};function c(e,t,r){let{createErrors:n}=e.it;return!1===n?(0,s._)`{}`:function(e,t,r={}){let{gen:n,it:i}=e,c=[function({errorPath:e},{instancePath:t}){let r=t?(0,s.str)`${e}${(0,o.getErrorPath)(t,o.Type.Str)}`:e;return[a.default.instancePath,(0,s.strConcat)(a.default.instancePath,r)]}(i,r),function({keyword:e,it:{errSchemaPath:t}},{schemaPath:r,parentSchema:a}){let n=a?t:(0,s.str)`${t}/${e}`;return r&&(n=(0,s.str)`${n}${(0,o.getErrorPath)(r,o.Type.Str)}`),[l.schemaPath,n]}(e,r)];return function(e,{params:t,message:r},o){let{keyword:n,data:i,schemaValue:c,it:d}=e,{opts:u,propertyName:m,topSchemaRef:p,schemaPath:h}=d;o.push([l.keyword,n],[l.params,"function"==typeof t?t(e):t||(0,s._)`{}`]),u.messages&&o.push([l.message,"function"==typeof r?r(e):r]),u.verbose&&o.push([l.schema,c],[l.parentSchema,(0,s._)`${p}${h}`],[a.default.data,i]),m&&o.push([l.propertyName,m])}(e,t,c),n.object(...c)}(e,t,r)}},20665:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;let s=r(70257),o=r(69638),a=r(82281),n=r(89967),i=r(3050),l=r(65863);class c{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,n.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function d(e){let t,r;let i=m.call(this,e);if(i)return i;let c=(0,n.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:d,lines:u}=this.opts.code,{ownProperties:p}=this.opts,h=new s.CodeGen(this.scope,{es5:d,lines:u,ownProperties:p});e.$async&&(t=h.scopeValue("Error",{ref:o.default,code:(0,s._)`require("ajv/dist/runtime/validation_error").default`}));let f=h.scopeName("validate");e.validateName=f;let _={gen:h,allErrors:this.opts.allErrors,data:a.default.data,parentData:a.default.parentData,parentDataProperty:a.default.parentDataProperty,dataNames:[a.default.data],dataPathArr:[s.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:h.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,s.stringify)(e.schema)}:{ref:e.schema}),validateName:f,ValidationError:t,schema:e.schema,schemaEnv:e,rootId:c,baseId:e.baseId||c,schemaPath:s.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,s._)`""`,opts:this.opts,self:this};try{this._compilations.add(e),(0,l.validateFunctionCode)(_),h.optimize(this.opts.code.optimize);let t=h.toString();r=`${h.scopeRefs(a.default.scope)}return ${t}`,this.opts.code.process&&(r=this.opts.code.process(r,e));let o=Function(`${a.default.self}`,`${a.default.scope}`,r)(this,this.scope.get());if(this.scope.value(f,{ref:o}),o.errors=null,o.schema=e.schema,o.schemaEnv=e,e.$async&&(o.$async=!0),!0===this.opts.code.source&&(o.source={validateName:f,validateCode:t,scopeValues:h._values}),this.opts.unevaluated){let{props:e,items:t}=_;o.evaluated={props:e instanceof s.Name?void 0:e,items:t instanceof s.Name?void 0:t,dynamicProps:e instanceof s.Name,dynamicItems:t instanceof s.Name},o.source&&(o.source.evaluated=(0,s.stringify)(o.evaluated))}return e.validate=o,e}catch(t){throw delete e.validate,delete e.validateName,r&&this.logger.error("Error compiling schema, function code:",r),t}finally{this._compilations.delete(e)}}function u(e){return(0,n.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:d.call(this,e)}function m(e){for(let t of this._compilations){if(t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId)return t}}function p(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||h.call(this,e,t)}function h(e,t){let r=this.opts.uriResolver.parse(t),s=(0,n._getFullPath)(this.opts.uriResolver,r),o=(0,n.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&s===o)return _.call(this,r,e);let a=(0,n.normalizeId)(s),i=this.refs[a]||this.schemas[a];if("string"==typeof i){let t=h.call(this,e,i);if("object"!=typeof(null==t?void 0:t.schema))return;return _.call(this,r,t)}if("object"==typeof(null==i?void 0:i.schema)){if(i.validate||d.call(this,i),a===(0,n.normalizeId)(t)){let{schema:t}=i,{schemaId:r}=this.opts,s=t[r];return s&&(o=(0,n.resolveUrl)(this.opts.uriResolver,o,s)),new c({schema:t,schemaId:r,root:e,baseId:o})}return _.call(this,r,i)}}t.SchemaEnv=c,t.compileSchema=d,t.resolveRef=function(e,t,r){var s;r=(0,n.resolveUrl)(this.opts.uriResolver,t,r);let o=e.refs[r];if(o)return o;let a=p.call(this,e,r);if(void 0===a){let o=null===(s=e.localRefs)||void 0===s?void 0:s[r],{schemaId:n}=this.opts;o&&(a=new c({schema:o,schemaId:n,root:e,baseId:t}))}if(void 0!==a)return e.refs[r]=u.call(this,a)},t.getCompilingSchema=m,t.resolveSchema=h;let f=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function _(e,{baseId:t,schema:r,root:s}){var o;let a;if((null===(o=e.fragment)||void 0===o?void 0:o[0])!=="/")return;for(let s of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;let e=r[(0,i.unescapeFragment)(s)];if(void 0===e)return;let o="object"==typeof(r=e)&&r[this.opts.schemaId];!f.has(s)&&o&&(t=(0,n.resolveUrl)(this.opts.uriResolver,t,o))}if("boolean"!=typeof r&&r.$ref&&!(0,i.schemaHasRulesButRef)(r,this.RULES)){let e=(0,n.resolveUrl)(this.opts.uriResolver,t,r.$ref);a=h.call(this,s,e)}let{schemaId:l}=this.opts;if((a=a||new c({schema:r,schemaId:l,root:s,baseId:t})).schema!==a.root.schema)return a}},82281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o={data:new s.Name("data"),valCxt:new s.Name("valCxt"),instancePath:new s.Name("instancePath"),parentData:new s.Name("parentData"),parentDataProperty:new s.Name("parentDataProperty"),rootData:new s.Name("rootData"),dynamicAnchors:new s.Name("dynamicAnchors"),vErrors:new s.Name("vErrors"),errors:new s.Name("errors"),this:new s.Name("this"),self:new s.Name("self"),scope:new s.Name("scope"),json:new s.Name("json"),jsonPos:new s.Name("jsonPos"),jsonLen:new s.Name("jsonLen"),jsonPart:new s.Name("jsonPart")};t.default=o},99925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(89967);class o extends Error{constructor(e,t,r,o){super(o||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,s.resolveUrl)(e,t,r),this.missingSchema=(0,s.normalizeId)((0,s.getFullPath)(e,this.missingRef))}}t.default=o},89967:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;let s=r(3050),o=r(65953),a=r(75886),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!function e(t){for(let r in t){if(i.has(r))return!0;let s=t[r];if(Array.isArray(s)&&s.some(e)||"object"==typeof s&&e(s))return!0}return!1}(e):!!t&&function e(t){let r=0;for(let o in t)if("$ref"===o||(r++,!n.has(o)&&("object"==typeof t[o]&&(0,s.eachItem)(t[o],t=>r+=e(t)),r===1/0)))return 1/0;return r}(e)<=t)};let i=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(e,t="",r){!1!==r&&(t=u(t));let s=e.parse(t);return c(e,s)}function c(e,t){return e.serialize(t).split("#")[0]+"#"}t.getFullPath=l,t._getFullPath=c;let d=/#\/?$/;function u(e){return e?e.replace(d,""):""}t.normalizeId=u,t.resolveUrl=function(e,t,r){return r=u(r),e.resolve(t,r)};let m=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};let{schemaId:r,uriResolver:s}=this.opts,n=u(e[r]||t),i={"":n},c=l(s,n,!1),d={},p=new Set;return a(e,{allKeys:!0},(e,t,s,o)=>{if(void 0===o)return;let a=c+t,n=i[o];function l(t){let r=this.opts.uriResolver.resolve;if(t=u(n?r(n,t):t),p.has(t))throw f(t);p.add(t);let s=this.refs[t];return"string"==typeof s&&(s=this.refs[s]),"object"==typeof s?h(e,s.schema,t):t!==u(a)&&("#"===t[0]?(h(e,d[t],t),d[t]=e):this.refs[t]=a),t}function _(e){if("string"==typeof e){if(!m.test(e))throw Error(`invalid anchor "${e}"`);l.call(this,`#${e}`)}}"string"==typeof e[r]&&(n=l.call(this,e[r])),_.call(this,e.$anchor),_.call(this,e.$dynamicAnchor),i[t]=n}),d;function h(e,t,r){if(void 0!==t&&!o(e,t))throw f(r)}function f(e){return Error(`reference "${e}" resolves to more than one schema`)}}},85695:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;let r=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&r.has(e)},t.getRules=function(){let e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}},3050:(e,t,r)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;let o=r(70257),a=r(71393);function n(e,t=e.schema){let{opts:r,self:s}=e;if(!r.strictSchema||"boolean"==typeof t)return;let o=s.RULES.keywords;for(let r in t)o[r]||h(e,`unknown keyword: "${r}"`)}function i(e,t){if("boolean"==typeof e)return!e;for(let r in e)if(t[r])return!0;return!1}function l(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function c(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function d({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:s}){return(a,n,i,l)=>{let c=void 0===i?n:i instanceof o.Name?(n instanceof o.Name?e(a,n,i):t(a,n,i),i):n instanceof o.Name?(t(a,i,n),n):r(n,i);return l!==o.Name||c instanceof o.Name?c:s(a,c)}}function u(e,t){if(!0===t)return e.var("props",!0);let r=e.var("props",(0,o._)`{}`);return void 0!==t&&m(e,r,t),r}function m(e,t,r){Object.keys(r).forEach(r=>e.assign((0,o._)`${t}${(0,o.getProperty)(r)}`,!0))}t.toHash=function(e){let t={};for(let r of e)t[r]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!i(t,e.self.RULES.all))},t.checkUnknownRules=n,t.schemaHasRules=i,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(let r in e)if("$ref"!==r&&t.all[r])return!0;return!1},t.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,s,a){if(!a){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return(0,o._)`${r}`}return(0,o._)`${e}${t}${(0,o.getProperty)(s)}`},t.unescapeFragment=function(e){return c(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(l(e))},t.escapeJsonPointer=l,t.unescapeJsonPointer=c,t.eachItem=function(e,t){if(Array.isArray(e))for(let r of e)t(r);else t(e)},t.mergeEvaluated={props:d({mergeNames:(e,t,r)=>e.if((0,o._)`${r} !== true && ${t} !== undefined`,()=>{e.if((0,o._)`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,(0,o._)`${r} || {}`).code((0,o._)`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if((0,o._)`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,(0,o._)`${r} || {}`),m(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:u}),items:d({mergeNames:(e,t,r)=>e.if((0,o._)`${r} !== true && ${t} !== undefined`,()=>e.assign(r,(0,o._)`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if((0,o._)`${r} !== true`,()=>e.assign(r,!0===t||(0,o._)`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=u,t.setEvaluated=m;let p={};function h(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw Error(t);e.self.logger.warn(t)}}t.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:p[t.code]||(p[t.code]=new a._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(s||(t.Type=s={})),t.getErrorPath=function(e,t,r){if(e instanceof o.Name){let a=t===s.Num;return r?a?(0,o._)`"[" + ${e} + "]"`:(0,o._)`"['" + ${e} + "']"`:a?(0,o._)`"/" + ${e}`:(0,o._)`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,o.getProperty)(e).toString():"/"+l(e)},t.checkStrictMode=h},71241:(e,t)=>{"use strict";function r(e,t){return t.rules.some(t=>s(e,t))}function s(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function({schema:e,self:t},s){let o=t.RULES.types[s];return o&&!0!==o&&r(e,o)},t.shouldUseGroup=r,t.shouldUseRule=s},70310:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;let s=r(49479),o=r(70257),a=r(82281),n={message:"boolean schema is false"};function i(e,t){let{gen:r,data:o}=e;(0,s.reportError)({gen:r,keyword:"false schema",data:o,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e},n,void 0,t)}t.topBoolOrEmptySchema=function(e){let{gen:t,schema:r,validateName:s}=e;!1===r?i(e,!1):"object"==typeof r&&!0===r.$async?t.return(a.default.data):(t.assign((0,o._)`${s}.errors`,null),t.return(!0))},t.boolOrEmptySchema=function(e,t){let{gen:r,schema:s}=e;!1===s?(r.var(t,!1),i(e)):r.var(t,!0)}},77434:(e,t,r)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;let o=r(85695),a=r(71241),n=r(49479),i=r(70257),l=r(3050);function c(e){let t=Array.isArray(e)?e:e?[e]:[];if(t.every(o.isJSONType))return t;throw Error("type must be JSONType or JSONType[]: "+t.join(","))}(function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"})(s||(t.DataType=s={})),t.getSchemaTypes=function(e){let t=c(e.type);if(t.includes("null")){if(!1===e.nullable)throw Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=c,t.coerceAndCheckDataType=function(e,t){var r;let{gen:o,data:n,opts:l}=e,c=(r=l.coerceTypes)?t.filter(e=>d.has(e)||"array"===r&&"array"===e):[],u=t.length>0&&!(0===c.length&&1===t.length&&(0,a.schemaHasRulesForType)(e,t[0]));if(u){let r=m(t,n,l.strictNumbers,s.Wrong);o.if(r,()=>{c.length?function(e,t,r){let{gen:s,data:o,opts:a}=e,n=s.let("dataType",(0,i._)`typeof ${o}`),l=s.let("coerced",(0,i._)`undefined`);for(let e of("array"===a.coerceTypes&&s.if((0,i._)`${n} == 'object' && Array.isArray(${o}) && ${o}.length == 1`,()=>s.assign(o,(0,i._)`${o}[0]`).assign(n,(0,i._)`typeof ${o}`).if(m(t,o,a.strictNumbers),()=>s.assign(l,o))),s.if((0,i._)`${l} !== undefined`),r))(d.has(e)||"array"===e&&"array"===a.coerceTypes)&&function(e){switch(e){case"string":s.elseIf((0,i._)`${n} == "number" || ${n} == "boolean"`).assign(l,(0,i._)`"" + ${o}`).elseIf((0,i._)`${o} === null`).assign(l,(0,i._)`""`);return;case"number":s.elseIf((0,i._)`${n} == "boolean" || ${o} === null
              || (${n} == "string" && ${o} && ${o} == +${o})`).assign(l,(0,i._)`+${o}`);return;case"integer":s.elseIf((0,i._)`${n} === "boolean" || ${o} === null
              || (${n} === "string" && ${o} && ${o} == +${o} && !(${o} % 1))`).assign(l,(0,i._)`+${o}`);return;case"boolean":s.elseIf((0,i._)`${o} === "false" || ${o} === 0 || ${o} === null`).assign(l,!1).elseIf((0,i._)`${o} === "true" || ${o} === 1`).assign(l,!0);return;case"null":s.elseIf((0,i._)`${o} === "" || ${o} === 0 || ${o} === false`),s.assign(l,null);return;case"array":s.elseIf((0,i._)`${n} === "string" || ${n} === "number"
              || ${n} === "boolean" || ${o} === null`).assign(l,(0,i._)`[${o}]`)}}(e);s.else(),h(e),s.endIf(),s.if((0,i._)`${l} !== undefined`,()=>{s.assign(o,l),function({gen:e,parentData:t,parentDataProperty:r},s){e.if((0,i._)`${t} !== undefined`,()=>e.assign((0,i._)`${t}[${r}]`,s))}(e,l)})}(e,t,c):h(e)})}return u};let d=new Set(["string","number","integer","boolean","null"]);function u(e,t,r,o=s.Correct){let a;let n=o===s.Correct?i.operators.EQ:i.operators.NEQ;switch(e){case"null":return(0,i._)`${t} ${n} null`;case"array":a=(0,i._)`Array.isArray(${t})`;break;case"object":a=(0,i._)`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":a=l((0,i._)`!(${t} % 1) && !isNaN(${t})`);break;case"number":a=l();break;default:return(0,i._)`typeof ${t} ${n} ${e}`}return o===s.Correct?a:(0,i.not)(a);function l(e=i.nil){return(0,i.and)((0,i._)`typeof ${t} == "number"`,e,r?(0,i._)`isFinite(${t})`:i.nil)}}function m(e,t,r,s){let o;if(1===e.length)return u(e[0],t,r,s);let a=(0,l.toHash)(e);if(a.array&&a.object){let e=(0,i._)`typeof ${t} != "object"`;o=a.null?e:(0,i._)`!${t} || ${e}`,delete a.null,delete a.array,delete a.object}else o=i.nil;for(let e in a.number&&delete a.integer,a)o=(0,i.and)(o,u(e,t,r,s));return o}t.checkDataType=u,t.checkDataTypes=m;let p={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?(0,i._)`{type: ${e}}`:(0,i._)`{type: ${t}}`};function h(e){let t=function(e){let{gen:t,data:r,schema:s}=e,o=(0,l.schemaRefOrVal)(e,s,"type");return{gen:t,keyword:"type",data:r,schema:s.type,schemaCode:o,schemaValue:o,parentSchema:s,params:{},it:e}}(e);(0,n.reportError)(t,p)}t.reportTypeError=h},99370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;let s=r(70257),o=r(3050);function a(e,t,r){let{gen:a,compositeRule:n,data:i,opts:l}=e;if(void 0===r)return;let c=(0,s._)`${i}${(0,s.getProperty)(t)}`;if(n){(0,o.checkStrictMode)(e,`default is ignored for: ${c}`);return}let d=(0,s._)`${c} === undefined`;"empty"===l.useDefaults&&(d=(0,s._)`${d} || ${c} === null || ${c} === ""`),a.if(d,(0,s._)`${c} = ${(0,s.stringify)(r)}`)}t.assignDefaults=function(e,t){let{properties:r,items:s}=e.schema;if("object"===t&&r)for(let t in r)a(e,t,r[t].default);else"array"===t&&Array.isArray(s)&&s.forEach((t,r)=>a(e,r,t.default))}},65863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;let s=r(70310),o=r(77434),a=r(71241),n=r(77434),i=r(99370),l=r(43189),c=r(43111),d=r(70257),u=r(82281),m=r(89967),p=r(3050),h=r(49479);function f({gen:e,validateName:t,schema:r,schemaEnv:s,opts:o},a){o.code.es5?e.func(t,(0,d._)`${u.default.data}, ${u.default.valCxt}`,s.$async,()=>{e.code((0,d._)`"use strict"; ${_(r,o)}`),function(e,t){e.if(u.default.valCxt,()=>{e.var(u.default.instancePath,(0,d._)`${u.default.valCxt}.${u.default.instancePath}`),e.var(u.default.parentData,(0,d._)`${u.default.valCxt}.${u.default.parentData}`),e.var(u.default.parentDataProperty,(0,d._)`${u.default.valCxt}.${u.default.parentDataProperty}`),e.var(u.default.rootData,(0,d._)`${u.default.valCxt}.${u.default.rootData}`),t.dynamicRef&&e.var(u.default.dynamicAnchors,(0,d._)`${u.default.valCxt}.${u.default.dynamicAnchors}`)},()=>{e.var(u.default.instancePath,(0,d._)`""`),e.var(u.default.parentData,(0,d._)`undefined`),e.var(u.default.parentDataProperty,(0,d._)`undefined`),e.var(u.default.rootData,u.default.data),t.dynamicRef&&e.var(u.default.dynamicAnchors,(0,d._)`{}`)})}(e,o),e.code(a)}):e.func(t,(0,d._)`${u.default.data}, ${(0,d._)`{${u.default.instancePath}="", ${u.default.parentData}, ${u.default.parentDataProperty}, ${u.default.rootData}=${u.default.data}${o.dynamicRef?(0,d._)`, ${u.default.dynamicAnchors}={}`:d.nil}}={}`}`,s.$async,()=>e.code(_(r,o)).code(a))}function _(e,t){let r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,d._)`/*# sourceURL=${r} */`:d.nil}function g({schema:e,self:t}){if("boolean"==typeof e)return!e;for(let r in e)if(t.RULES.all[r])return!0;return!1}function M(e){return"boolean"!=typeof e.schema}function y(e){(0,p.checkUnknownRules)(e),function(e){let{schema:t,errSchemaPath:r,opts:s,self:o}=e;t.$ref&&s.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(t,o.RULES)&&o.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function w(e,t){if(e.opts.jtd)return v(e,[],!1,t);let r=(0,o.getSchemaTypes)(e.schema),s=(0,o.coerceAndCheckDataType)(e,r);v(e,r,!s,t)}function b({gen:e,schemaEnv:t,schema:r,errSchemaPath:s,opts:o}){let a=r.$comment;if(!0===o.$comment)e.code((0,d._)`${u.default.self}.logger.log(${a})`);else if("function"==typeof o.$comment){let r=(0,d.str)`${s}/$comment`,o=e.scopeValue("root",{ref:t.root});e.code((0,d._)`${u.default.self}.opts.$comment(${a}, ${r}, ${o}.schema)`)}}function v(e,t,r,s){let{gen:o,schema:i,data:l,allErrors:c,opts:m,self:h}=e,{RULES:f}=h;if(i.$ref&&(m.ignoreKeywordsWithRef||!(0,p.schemaHasRulesButRef)(i,f))){o.block(()=>F(e,"$ref",f.all.$ref.definition));return}function _(p){(0,a.shouldUseGroup)(i,p)&&(p.type?(o.if((0,n.checkDataType)(p.type,l,m.strictNumbers)),x(e,p),1===t.length&&t[0]===p.type&&r&&(o.else(),(0,n.reportTypeError)(e)),o.endIf()):x(e,p),c||o.if((0,d._)`${u.default.errors} === ${s||0}`))}m.jtd||!e.schemaEnv.meta&&e.opts.strictTypes&&(function(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(t=>{P(e.dataTypes,t)||T(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),function(e,t){let r=[];for(let s of e.dataTypes)P(t,s)?r.push(s):t.includes("integer")&&"number"===s&&r.push("integer");e.dataTypes=r}(e,t)}}(e,t),e.opts.allowUnionTypes||t.length>1&&!(2===t.length&&t.includes("null"))&&T(e,"use allowUnionTypes to allow union type keyword"),function(e,t){let r=e.self.RULES.all;for(let s in r){let o=r[s];if("object"==typeof o&&(0,a.shouldUseRule)(e.schema,o)){let{type:r}=o.definition;r.length&&!r.some(e=>t.includes(e)||"number"===e&&t.includes("integer"))&&T(e,`missing type "${r.join(",")}" for keyword "${s}"`)}}}(e,e.dataTypes)),o.block(()=>{for(let e of f.rules)_(e);_(f.post)})}function x(e,t){let{gen:r,schema:s,opts:{useDefaults:o}}=e;o&&(0,i.assignDefaults)(e,t.type),r.block(()=>{for(let r of t.rules)(0,a.shouldUseRule)(s,r)&&F(e,r.keyword,r.definition,t.type)})}function P(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function T(e,t){let r=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${r}" (strictTypes)`,(0,p.checkStrictMode)(e,t,e.opts.strictTypes)}t.validateFunctionCode=function(e){if(M(e)&&(y(e),g(e))){(function(e){let{schema:t,opts:r,gen:s}=e;f(e,()=>{r.$comment&&t.$comment&&b(e),function(e){let{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,p.checkStrictMode)(e,"default is ignored in the schema root")}(e),s.let(u.default.vErrors,null),s.let(u.default.errors,0),r.unevaluated&&function(e){let{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,d._)`${r}.evaluated`),t.if((0,d._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,d._)`${e.evaluated}.props`,(0,d._)`undefined`)),t.if((0,d._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,d._)`${e.evaluated}.items`,(0,d._)`undefined`))}(e),w(e),function(e){let{gen:t,schemaEnv:r,validateName:s,ValidationError:o,opts:a}=e;r.$async?t.if((0,d._)`${u.default.errors} === 0`,()=>t.return(u.default.data),()=>t.throw((0,d._)`new ${o}(${u.default.vErrors})`)):(t.assign((0,d._)`${s}.errors`,u.default.vErrors),a.unevaluated&&function({gen:e,evaluated:t,props:r,items:s}){r instanceof d.Name&&e.assign((0,d._)`${t}.props`,r),s instanceof d.Name&&e.assign((0,d._)`${t}.items`,s)}(e),t.return((0,d._)`${u.default.errors} === 0`))}(e)})})(e);return}f(e,()=>(0,s.topBoolOrEmptySchema)(e))};class k{constructor(e,t,r){if((0,l.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,p.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",E(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,l.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",u.default.errors))}result(e,t,r){this.failResult((0,d.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,d.not)(e),void 0,t)}fail(e){if(void 0===e){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:t}=this;this.fail((0,d._)`${t} !== undefined && (${(0,d.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t){this.setParams(t),this._error(e,r),this.setParams({});return}this._error(e,r)}_error(e,t){(e?h.reportExtraError:h.reportError)(this,this.def.error,t)}$dataError(){(0,h.reportError)(this,this.def.$dataError||h.keyword$DataError)}reset(){if(void 0===this.errsCount)throw Error('add "trackErrors" to keyword definition');(0,h.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=d.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=d.nil,t=d.nil){if(!this.$data)return;let{gen:r,schemaCode:s,schemaType:o,def:a}=this;r.if((0,d.or)((0,d._)`${s} === undefined`,t)),e!==d.nil&&r.assign(e,!0),(o.length||a.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==d.nil&&r.assign(e,!1)),r.else()}invalid$data(){let{gen:e,schemaCode:t,schemaType:r,def:s,it:o}=this;return(0,d.or)(function(){if(r.length){if(!(t instanceof d.Name))throw Error("ajv implementation error");let e=Array.isArray(r)?r:[r];return(0,d._)`${(0,n.checkDataTypes)(e,t,o.opts.strictNumbers,n.DataType.Wrong)}`}return d.nil}(),function(){if(s.validateSchema){let r=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,d._)`!${r}(${t})`}return d.nil}())}subschema(e,t){let r=(0,c.getSubschema)(this.it,e);(0,c.extendSubschemaData)(r,this.it,e),(0,c.extendSubschemaMode)(r,e);let o={...this.it,...r,items:void 0,props:void 0};return function(e,t){if(M(e)&&(y(e),g(e))){(function(e,t){let{schema:r,gen:s,opts:o}=e;o.$comment&&r.$comment&&b(e),function(e){let t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,m.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw Error("async schema in sync schema")}(e);let a=s.const("_errs",u.default.errors);w(e,a),s.var(t,(0,d._)`${a} === ${u.default.errors}`)})(e,t);return}(0,s.boolOrEmptySchema)(e,t)}(o,t),o}mergeEvaluated(e,t){let{it:r,gen:s}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=p.mergeEvaluated.props(s,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=p.mergeEvaluated.items(s,e.items,r.items,t)))}mergeValidEvaluated(e,t){let{it:r,gen:s}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return s.if(t,()=>this.mergeEvaluated(e,d.Name)),!0}}function F(e,t,r,s){let o=new k(e,r,t);"code"in r?r.code(o,s):o.$data&&r.validate?(0,l.funcKeywordCode)(o,r):"macro"in r?(0,l.macroKeywordCode)(o,r):(r.compile||r.validate)&&(0,l.funcKeywordCode)(o,r)}t.KeywordCxt=k;let S=/^\/(?:[^~]|~0|~1)*$/,C=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function E(e,{dataLevel:t,dataNames:r,dataPathArr:s}){let o,a;if(""===e)return u.default.rootData;if("/"===e[0]){if(!S.test(e))throw Error(`Invalid JSON-pointer: ${e}`);o=e,a=u.default.rootData}else{let n=C.exec(e);if(!n)throw Error(`Invalid JSON-pointer: ${e}`);let l=+n[1];if("#"===(o=n[2])){if(l>=t)throw Error(i("property/index",l));return s[t-l]}if(l>t)throw Error(i("data",l));if(a=r[t-l],!o)return a}let n=a;for(let e of o.split("/"))e&&(a=(0,d._)`${a}${(0,d.getProperty)((0,p.unescapeJsonPointer)(e))}`,n=(0,d._)`${n} && ${a}`);return n;function i(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}t.getData=E},43189:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;let s=r(70257),o=r(82281),a=r(37450),n=r(49479);function i(e){let{gen:t,data:r,it:o}=e;t.if(o.parentData,()=>t.assign(r,(0,s._)`${o.parentData}[${o.parentDataProperty}]`))}function l(e,t,r){if(void 0===r)throw Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,s.stringify)(r)})}t.macroKeywordCode=function(e,t){let{gen:r,keyword:o,schema:a,parentSchema:n,it:i}=e,c=t.macro.call(i.self,a,n,i),d=l(r,o,c);!1!==i.opts.validateSchema&&i.self.validateSchema(c,!0);let u=r.name("valid");e.subschema({schema:c,schemaPath:s.nil,errSchemaPath:`${i.errSchemaPath}/${o}`,topSchemaRef:d,compositeRule:!0},u),e.pass(u,()=>e.error(!0))},t.funcKeywordCode=function(e,t){var r;let{gen:c,keyword:d,schema:u,parentSchema:m,$data:p,it:h}=e;(function({schemaEnv:e},t){if(t.async&&!e.$async)throw Error("async keyword in sync schema")})(h,t);let f=l(c,d,!p&&t.compile?t.compile.call(h.self,u,m,h):t.validate),_=c.let("valid");function g(r=t.async?(0,s._)`await `:s.nil){let n=h.opts.passContext?o.default.this:o.default.self,i=!("compile"in t&&!p||!1===t.schema);c.assign(_,(0,s._)`${r}${(0,a.callValidateCode)(e,f,n,i)}`,t.modifying)}function M(e){var r;c.if((0,s.not)(null!==(r=t.valid)&&void 0!==r?r:_),e)}e.block$data(_,function(){if(!1===t.errors)g(),t.modifying&&i(e),M(()=>e.error());else{let r=t.async?function(){let e=c.let("ruleErrs",null);return c.try(()=>g((0,s._)`await `),t=>c.assign(_,!1).if((0,s._)`${t} instanceof ${h.ValidationError}`,()=>c.assign(e,(0,s._)`${t}.errors`),()=>c.throw(t))),e}():function(){let e=(0,s._)`${f}.errors`;return c.assign(e,null),g(s.nil),e}();t.modifying&&i(e),M(()=>(function(e,t){let{gen:r}=e;r.if((0,s._)`Array.isArray(${t})`,()=>{r.assign(o.default.vErrors,(0,s._)`${o.default.vErrors} === null ? ${t} : ${o.default.vErrors}.concat(${t})`).assign(o.default.errors,(0,s._)`${o.default.vErrors}.length`),(0,n.extendErrors)(e)},()=>e.error())})(e,r))}}),e.ok(null!==(r=t.valid)&&void 0!==r?r:_)},t.validSchemaType=function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)},t.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:s},o,a){if(Array.isArray(o.keyword)?!o.keyword.includes(a):o.keyword!==a)throw Error("ajv implementation error");let n=o.dependencies;if(null==n?void 0:n.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw Error(`parent schema must have dependencies of ${a}: ${n.join(",")}`);if(o.validateSchema&&!o.validateSchema(e[a])){let e=`keyword "${a}" value is invalid at path "${s}": `+r.errorsText(o.validateSchema.errors);if("log"===t.validateSchema)r.logger.error(e);else throw Error(e)}}},43111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;let s=r(70257),o=r(3050);t.getSubschema=function(e,{keyword:t,schemaProp:r,schema:a,schemaPath:n,errSchemaPath:i,topSchemaRef:l}){if(void 0!==t&&void 0!==a)throw Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){let a=e.schema[t];return void 0===r?{schema:a,schemaPath:(0,s._)`${e.schemaPath}${(0,s.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:a[r],schemaPath:(0,s._)`${e.schemaPath}${(0,s.getProperty)(t)}${(0,s.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,o.escapeFragment)(r)}`}}if(void 0!==a){if(void 0===n||void 0===i||void 0===l)throw Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:a,schemaPath:n,topSchemaRef:l,errSchemaPath:i}}throw Error('either "keyword" or "schema" must be passed')},t.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:a,data:n,dataTypes:i,propertyName:l}){if(void 0!==n&&void 0!==r)throw Error('both "data" and "dataProp" passed, only one allowed');let{gen:c}=t;if(void 0!==r){let{errorPath:n,dataPathArr:i,opts:l}=t;d(c.let("data",(0,s._)`${t.data}${(0,s.getProperty)(r)}`,!0)),e.errorPath=(0,s.str)`${n}${(0,o.getErrorPath)(r,a,l.jsPropertySyntax)}`,e.parentDataProperty=(0,s._)`${r}`,e.dataPathArr=[...i,e.parentDataProperty]}function d(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}void 0!==n&&(d(n instanceof s.Name?n:c.let("data",n,!0)),void 0!==l&&(e.propertyName=l)),i&&(e.dataTypes=i)},t.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:s,createErrors:o,allErrors:a}){void 0!==s&&(e.compositeRule=s),void 0!==o&&(e.createErrors=o),void 0!==a&&(e.allErrors=a),e.jtdDiscriminator=t,e.jtdMetadata=r}},66319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var s=r(65863);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return s.KeywordCxt}});var o=r(70257);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return o._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return o.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return o.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return o.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return o.CodeGen}});let a=r(69638),n=r(99925),i=r(85695),l=r(20665),c=r(70257),d=r(89967),u=r(77434),m=r(3050),p=r(1235),h=r(95738),f=(e,t)=>new RegExp(e,t);f.code="new RegExp";let _=["removeAdditional","useDefaults","coerceTypes"],g=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),M={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};class w{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...function(e){var t,r,s,o,a,n,i,l,c,d,u,m,p,_,g,M,y,w,b,v,x,P,T,k,F;let S=e.strict,C=null===(t=e.code)||void 0===t?void 0:t.optimize,E=!0===C||void 0===C?1:C||0,A=null!==(s=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==s?s:f,I=null!==(o=e.uriResolver)&&void 0!==o?o:h.default;return{strictSchema:null===(n=null!==(a=e.strictSchema)&&void 0!==a?a:S)||void 0===n||n,strictNumbers:null===(l=null!==(i=e.strictNumbers)&&void 0!==i?i:S)||void 0===l||l,strictTypes:null!==(d=null!==(c=e.strictTypes)&&void 0!==c?c:S)&&void 0!==d?d:"log",strictTuples:null!==(m=null!==(u=e.strictTuples)&&void 0!==u?u:S)&&void 0!==m?m:"log",strictRequired:null!==(_=null!==(p=e.strictRequired)&&void 0!==p?p:S)&&void 0!==_&&_,code:e.code?{...e.code,optimize:E,regExp:A}:{optimize:E,regExp:A},loopRequired:null!==(g=e.loopRequired)&&void 0!==g?g:200,loopEnum:null!==(M=e.loopEnum)&&void 0!==M?M:200,meta:null===(y=e.meta)||void 0===y||y,messages:null===(w=e.messages)||void 0===w||w,inlineRefs:null===(b=e.inlineRefs)||void 0===b||b,schemaId:null!==(v=e.schemaId)&&void 0!==v?v:"$id",addUsedSchema:null===(x=e.addUsedSchema)||void 0===x||x,validateSchema:null===(P=e.validateSchema)||void 0===P||P,validateFormats:null===(T=e.validateFormats)||void 0===T||T,unicodeRegExp:null===(k=e.unicodeRegExp)||void 0===k||k,int32range:null===(F=e.int32range)||void 0===F||F,uriResolver:I}}(e)};let{es5:t,lines:r}=this.opts.code;this.scope=new c.ValueScope({scope:{},prefixes:g,es5:t,lines:r}),this.logger=function(e){if(!1===e)return F;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw Error("logger must implement log, warn and error methods")}(e.logger);let s=e.validateFormats;e.validateFormats=!1,this.RULES=(0,i.getRules)(),b.call(this,M,e,"NOT SUPPORTED"),b.call(this,y,e,"DEPRECATED","warn"),this._metaOpts=k.call(this),e.formats&&P.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&T.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),x.call(this),e.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:t,schemaId:r}=this.opts,s=p;"id"===r&&((s={...p}).id=s.$id,delete s.$id),t&&e&&this.addMetaSchema(s,s[r],!1)}defaultMeta(){let{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);let s=r(t);return"$async"in r||(this.errors=r.errors),s}compile(e,t){let r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw Error("options.loadSchema should be a function");let{loadSchema:r}=this.opts;return s.call(this,e,t);async function s(e,t){await o.call(this,e.$schema);let r=this._addSchema(e,t);return r.validate||a.call(this,r)}async function o(e){e&&!this.getSchema(e)&&await s.call(this,{$ref:e},!0)}async function a(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof n.default))throw t;return i.call(this,t),await l.call(this,t.missingSchema),a.call(this,e)}}function i({missingSchema:e,missingRef:t}){if(this.refs[e])throw Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){let r=await c.call(this,e);this.refs[e]||await o.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function c(e){let t=this._loading[e];if(t)return t;try{return await (this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,s=this.opts.validateSchema){let o;if(Array.isArray(e)){for(let t of e)this.addSchema(t,void 0,r,s);return this}if("object"==typeof e){let{schemaId:t}=this.opts;if(void 0!==(o=e[t])&&"string"!=typeof o)throw Error(`schema ${t} must be string`)}return t=(0,d.normalizeId)(t||o),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,s,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){let r;if("boolean"==typeof e)return!0;if(void 0!==(r=e.$schema)&&"string"!=typeof r)throw Error("$schema must be a string");if(!(r=r||this.opts.defaultMeta||this.defaultMeta()))return this.logger.warn("meta-schema not available"),this.errors=null,!0;let s=this.validate(r,e);if(!s&&t){let e="schema is invalid: "+this.errorsText();if("log"===this.opts.validateSchema)this.logger.error(e);else throw Error(e)}return s}getSchema(e){let t;for(;"string"==typeof(t=v.call(this,e));)e=t;if(void 0===t){let{schemaId:r}=this.opts,s=new l.SchemaEnv({schema:{},schemaId:r});if(!(t=l.resolveSchema.call(this,s,e)))return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let t=v.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{this._cache.delete(e);let t=e[this.opts.schemaId];return t&&(t=(0,d.normalizeId)(t),delete this.schemas[t],delete this.refs[t]),this}default:throw Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else if("object"==typeof e&&void 0===t){if(Array.isArray(r=(t=e).keyword)&&!r.length)throw Error("addKeywords: keyword must be string or non-empty array")}else throw Error("invalid addKeywords parameters");if(C.call(this,r,t),!t)return(0,m.eachItem)(r,e=>E.call(this,e)),this;I.call(this,t);let s={...t,type:(0,u.getJSONTypes)(t.type),schemaType:(0,u.getJSONTypes)(t.schemaType)};return(0,m.eachItem)(r,0===s.type.length?e=>E.call(this,e,s):e=>s.type.forEach(t=>E.call(this,e,s,t))),this}getKeyword(e){let t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){let{RULES:t}=this;for(let r of(delete t.keywords[e],delete t.all[e],t.rules)){let t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.instancePath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){let r=this.RULES.all;for(let s of(e=JSON.parse(JSON.stringify(e)),t)){let t=s.split("/").slice(1),o=e;for(let e of t)o=o[e];for(let e in r){let t=r[e];if("object"!=typeof t)continue;let{$data:s}=t.definition,a=o[e];s&&a&&(o[e]=L(a))}}return e}_removeAllSchemas(e,t){for(let r in e){let s=e[r];(!t||t.test(r))&&("string"==typeof s?delete e[r]:s&&!s.meta&&(this._cache.delete(s.schema),delete e[r]))}}_addSchema(e,t,r,s=this.opts.validateSchema,o=this.opts.addUsedSchema){let a;let{schemaId:n}=this.opts;if("object"==typeof e)a=e[n];else{if(this.opts.jtd)throw Error("schema must be object");if("boolean"!=typeof e)throw Error("schema must be object or boolean")}let i=this._cache.get(e);if(void 0!==i)return i;r=(0,d.normalizeId)(a||r);let c=d.getSchemaRefs.call(this,e,r);return i=new l.SchemaEnv({schema:e,schemaId:n,meta:t,baseId:r,localRefs:c}),this._cache.set(i.schema,i),o&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=i),s&&this.validateSchema(e,!0),i}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):l.compileSchema.call(this,e),!e.validate)throw Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let t=this.opts;this.opts=this._metaOpts;try{l.compileSchema.call(this,e)}finally{this.opts=t}}}function b(e,t,r,s="error"){for(let o in e)o in t&&this.logger[s](`${r}: option ${o}. ${e[o]}`)}function v(e){return e=(0,d.normalizeId)(e),this.schemas[e]||this.refs[e]}function x(){let e=this.opts.schemas;if(e){if(Array.isArray(e))this.addSchema(e);else for(let t in e)this.addSchema(e[t],t)}}function P(){for(let e in this.opts.formats){let t=this.opts.formats[e];t&&this.addFormat(e,t)}}function T(e){if(Array.isArray(e)){this.addVocabulary(e);return}for(let t in this.logger.warn("keywords option as map is deprecated, pass array"),e){let r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}function k(){let e={...this.opts};for(let t of _)delete e[t];return e}w.ValidationError=a.default,w.MissingRefError=n.default,t.default=w;let F={log(){},warn(){},error(){}},S=/^[a-z_$][a-z0-9_$:-]*$/i;function C(e,t){let{RULES:r}=this;if((0,m.eachItem)(e,e=>{if(r.keywords[e])throw Error(`Keyword ${e} is already defined`);if(!S.test(e))throw Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t||"validate"in t))throw Error('$data keyword must have "code" or "validate" function')}function E(e,t,r){var s;let o=null==t?void 0:t.post;if(r&&o)throw Error('keyword with "post" flag cannot have "type"');let{RULES:a}=this,n=o?a.post:a.rules.find(({type:e})=>e===r);if(n||(n={type:r,rules:[]},a.rules.push(n)),a.keywords[e]=!0,!t)return;let i={keyword:e,definition:{...t,type:(0,u.getJSONTypes)(t.type),schemaType:(0,u.getJSONTypes)(t.schemaType)}};t.before?A.call(this,n,i,t.before):n.rules.push(i),a.all[e]=i,null===(s=t.implements)||void 0===s||s.forEach(e=>this.addKeyword(e))}function A(e,t,r){let s=e.rules.findIndex(e=>e.keyword===r);s>=0?e.rules.splice(s,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function I(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=L(t)),e.validateSchema=this.compile(t,!0))}let $={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function L(e){return{anyOf:[e,$]}}},17246:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(65953);s.code='require("ajv/dist/runtime/equal").default',t.default=s},40720:(e,t)=>{"use strict";function r(e){let t;let r=e.length,s=0,o=0;for(;o<r;)s++,(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r&&(64512&(t=e.charCodeAt(o)))==56320&&o++;return s}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,r.code='require("ajv/dist/runtime/ucs2length").default'},95738:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(66751);s.code='require("ajv/dist/runtime/uri").default',t.default=s},69638:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.default=r},48505:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;let s=r(70257),o=r(3050);function a(e,t){let{gen:r,schema:a,data:n,keyword:i,it:l}=e;l.items=!0;let c=r.const("len",(0,s._)`${n}.length`);if(!1===a)e.setParams({len:t.length}),e.pass((0,s._)`${c} <= ${t.length}`);else if("object"==typeof a&&!(0,o.alwaysValidSchema)(l,a)){let a=r.var("valid",(0,s._)`${c} <= ${t.length}`);r.if((0,s.not)(a),()=>{r.forRange("i",t.length,c,t=>{e.subschema({keyword:i,dataProp:t,dataPropType:o.Type.Num},a),l.allErrors||r.if((0,s.not)(a),()=>r.break())})}),e.ok(a)}}t.validateAdditionalItems=a,t.default={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>(0,s.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,s._)`{limit: ${e}}`},code(e){let{parentSchema:t,it:r}=e,{items:s}=t;if(!Array.isArray(s)){(0,o.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}a(e,s)}}},44844:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(37450),o=r(70257),a=r(82281),n=r(3050);t.default={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:e})=>(0,o._)`{additionalProperty: ${e.additionalProperty}}`},code(e){let{gen:t,schema:r,parentSchema:i,data:l,errsCount:c,it:d}=e;if(!c)throw Error("ajv implementation error");let{allErrors:u,opts:m}=d;if(d.props=!0,"all"!==m.removeAdditional&&(0,n.alwaysValidSchema)(d,r))return;let p=(0,s.allSchemaProperties)(i.properties),h=(0,s.allSchemaProperties)(i.patternProperties);function f(e){t.code((0,o._)`delete ${l}[${e}]`)}function _(s){if("all"===m.removeAdditional||m.removeAdditional&&!1===r){f(s);return}if(!1===r){e.setParams({additionalProperty:s}),e.error(),u||t.break();return}if("object"==typeof r&&!(0,n.alwaysValidSchema)(d,r)){let r=t.name("valid");"failing"===m.removeAdditional?(g(s,r,!1),t.if((0,o.not)(r),()=>{e.reset(),f(s)})):(g(s,r),u||t.if((0,o.not)(r),()=>t.break()))}}function g(t,r,s){let o={keyword:"additionalProperties",dataProp:t,dataPropType:n.Type.Str};!1===s&&Object.assign(o,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(o,r)}t.forIn("key",l,r=>{p.length||h.length?t.if(function(r){let a;if(p.length>8){let e=(0,n.schemaRefOrVal)(d,i.properties,"properties");a=(0,s.isOwnProperty)(t,e,r)}else a=p.length?(0,o.or)(...p.map(e=>(0,o._)`${r} === ${e}`)):o.nil;return h.length&&(a=(0,o.or)(a,...h.map(t=>(0,o._)`${(0,s.usePattern)(e,t)}.test(${r})`))),(0,o.not)(a)}(r),()=>_(r)):_(r)}),e.ok((0,o._)`${c} === ${a.default.errors}`)}}},11984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(3050);t.default={keyword:"allOf",schemaType:"array",code(e){let{gen:t,schema:r,it:o}=e;if(!Array.isArray(r))throw Error("ajv implementation error");let a=t.name("valid");r.forEach((t,r)=>{if((0,s.alwaysValidSchema)(o,t))return;let n=e.subschema({keyword:"allOf",schemaProp:r},a);e.ok(a),e.mergeEvaluated(n)})}}},93659:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:r(37450).validateUnion,error:{message:"must match a schema in anyOf"}};t.default=s},93230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050);t.default={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?(0,s.str)`must contain at least ${e} valid item(s)`:(0,s.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?(0,s._)`{minContains: ${e}}`:(0,s._)`{minContains: ${e}, maxContains: ${t}}`},code(e){let t,r;let{gen:a,schema:n,parentSchema:i,data:l,it:c}=e,{minContains:d,maxContains:u}=i;c.opts.next?(t=void 0===d?1:d,r=u):t=1;let m=a.const("len",(0,s._)`${l}.length`);if(e.setParams({min:t,max:r}),void 0===r&&0===t){(0,o.checkStrictMode)(c,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(void 0!==r&&t>r){(0,o.checkStrictMode)(c,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,o.alwaysValidSchema)(c,n)){let o=(0,s._)`${m} >= ${t}`;void 0!==r&&(o=(0,s._)`${o} && ${m} <= ${r}`),e.pass(o);return}c.items=!0;let p=a.name("valid");function h(){let e=a.name("_valid"),o=a.let("count",0);f(e,()=>a.if(e,()=>{a.code((0,s._)`${o}++`),void 0===r?a.if((0,s._)`${o} >= ${t}`,()=>a.assign(p,!0).break()):(a.if((0,s._)`${o} > ${r}`,()=>a.assign(p,!1).break()),1===t?a.assign(p,!0):a.if((0,s._)`${o} >= ${t}`,()=>a.assign(p,!0)))}))}function f(t,r){a.forRange("i",0,m,s=>{e.subschema({keyword:"contains",dataProp:s,dataPropType:o.Type.Num,compositeRule:!0},t),r()})}void 0===r&&1===t?f(p,()=>a.if(p,()=>a.break())):0===t?(a.let(p,!0),void 0!==r&&a.if((0,s._)`${l}.length > 0`,h)):(a.let(p,!1),h()),e.result(p,()=>e.reset())}}},24416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;let s=r(70257),o=r(3050),a=r(37450);t.error={message:({params:{property:e,depsCount:t,deps:r}})=>(0,s.str)`must have ${1===t?"property":"properties"} ${r} when property ${e} is present`,params:({params:{property:e,depsCount:t,deps:r,missingProperty:o}})=>(0,s._)`{property: ${e},
    missingProperty: ${o},
    depsCount: ${t},
    deps: ${r}}`};let n={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){let[t,r]=function({schema:e}){let t={},r={};for(let s in e)"__proto__"!==s&&((Array.isArray(e[s])?t:r)[s]=e[s]);return[t,r]}(e);i(e,t),l(e,r)}};function i(e,t=e.schema){let{gen:r,data:o,it:n}=e;if(0===Object.keys(t).length)return;let i=r.let("missing");for(let l in t){let c=t[l];if(0===c.length)continue;let d=(0,a.propertyInData)(r,o,l,n.opts.ownProperties);e.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),n.allErrors?r.if(d,()=>{for(let t of c)(0,a.checkReportMissingProp)(e,t)}):(r.if((0,s._)`${d} && (${(0,a.checkMissingProp)(e,c,i)})`),(0,a.reportMissingProp)(e,i),r.else())}}function l(e,t=e.schema){let{gen:r,data:s,keyword:n,it:i}=e,l=r.name("valid");for(let c in t)(0,o.alwaysValidSchema)(i,t[c])||(r.if((0,a.propertyInData)(r,s,c,i.opts.ownProperties),()=>{let t=e.subschema({keyword:n,schemaProp:c},l);e.mergeValidEvaluated(t,l)},()=>r.var(l,!0)),e.ok(l))}t.validatePropertyDeps=i,t.validateSchemaDeps=l,t.default=n},33449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050);function a(e,t){let r=e.schema[t];return void 0!==r&&!(0,o.alwaysValidSchema)(e,r)}t.default={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>(0,s.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,s._)`{failingKeyword: ${e.ifClause}}`},code(e){let{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&(0,o.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let i=a(n,"then"),l=a(n,"else");if(!i&&!l)return;let c=t.let("valid",!0),d=t.name("_valid");if(function(){let t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},d);e.mergeEvaluated(t)}(),e.reset(),i&&l){let r=t.let("ifClause");e.setParams({ifClause:r}),t.if(d,u("then",r),u("else",r))}else i?t.if(d,u("then")):t.if((0,s.not)(d),u("else"));function u(r,o){return()=>{let a=e.subschema({keyword:r},d);t.assign(c,d),e.mergeValidEvaluated(a,c),o?t.assign(o,(0,s._)`${r}`):e.setParams({ifClause:r})}}e.pass(c,()=>e.error(!0))}}},75737:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(48505),o=r(18543),a=r(14177),n=r(5127),i=r(93230),l=r(24416),c=r(24680),d=r(44844),u=r(7872),m=r(95127),p=r(45301),h=r(93659),f=r(97619),_=r(11984),g=r(33449),M=r(54094);t.default=function(e=!1){let t=[p.default,h.default,f.default,_.default,g.default,M.default,c.default,d.default,l.default,u.default,m.default];return e?t.push(o.default,n.default):t.push(s.default,a.default),t.push(i.default),t}},14177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;let s=r(70257),o=r(3050),a=r(37450);function n(e,t,r=e.schema){let{gen:a,parentSchema:n,data:i,keyword:l,it:c}=e;(function(e){let{opts:s,errSchemaPath:a}=c,n=r.length,i=n===e.minItems&&(n===e.maxItems||!1===e[t]);if(s.strictTuples&&!i){let e=`"${l}" is ${n}-tuple, but minItems or maxItems/${t} are not specified or different at path "${a}"`;(0,o.checkStrictMode)(c,e,s.strictTuples)}})(n),c.opts.unevaluated&&r.length&&!0!==c.items&&(c.items=o.mergeEvaluated.items(a,r.length,c.items));let d=a.name("valid"),u=a.const("len",(0,s._)`${i}.length`);r.forEach((t,r)=>{(0,o.alwaysValidSchema)(c,t)||(a.if((0,s._)`${u} > ${r}`,()=>e.subschema({keyword:l,schemaProp:r,dataProp:r},d)),e.ok(d))})}t.validateTuple=n,t.default={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){let{schema:t,it:r}=e;if(Array.isArray(t))return n(e,"additionalItems",t);r.items=!0,(0,o.alwaysValidSchema)(r,t)||e.ok((0,a.validateArray)(e))}}},5127:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050),a=r(37450),n=r(48505);t.default={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:e}})=>(0,s.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,s._)`{limit: ${e}}`},code(e){let{schema:t,parentSchema:r,it:s}=e,{prefixItems:i}=r;s.items=!0,(0,o.alwaysValidSchema)(s,t)||(i?(0,n.validateAdditionalItems)(e,i):e.ok((0,a.validateArray)(e)))}}},45301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(3050);t.default={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){let{gen:t,schema:r,it:o}=e;if((0,s.alwaysValidSchema)(o,r)){e.fail();return}let a=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),e.failResult(a,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}}},97619:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050);t.default={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:e})=>(0,s._)`{passingSchemas: ${e.passing}}`},code(e){let{gen:t,schema:r,parentSchema:a,it:n}=e;if(!Array.isArray(r))throw Error("ajv implementation error");if(n.opts.discriminator&&a.discriminator)return;let i=t.let("valid",!1),l=t.let("passing",null),c=t.name("_valid");e.setParams({passing:l}),t.block(function(){r.forEach((r,a)=>{let d;(0,o.alwaysValidSchema)(n,r)?t.var(c,!0):d=e.subschema({keyword:"oneOf",schemaProp:a,compositeRule:!0},c),a>0&&t.if((0,s._)`${c} && ${i}`).assign(i,!1).assign(l,(0,s._)`[${l}, ${a}]`).else(),t.if(c,()=>{t.assign(i,!0),t.assign(l,a),d&&e.mergeEvaluated(d,s.Name)})})}),e.result(i,()=>e.reset(),()=>e.error(!0))}}},95127:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(37450),o=r(70257),a=r(3050),n=r(3050);t.default={keyword:"patternProperties",type:"object",schemaType:"object",code(e){let{gen:t,schema:r,data:i,parentSchema:l,it:c}=e,{opts:d}=c,u=(0,s.allSchemaProperties)(r),m=u.filter(e=>(0,a.alwaysValidSchema)(c,r[e]));if(0===u.length||m.length===u.length&&(!c.opts.unevaluated||!0===c.props))return;let p=d.strictSchema&&!d.allowMatchingProperties&&l.properties,h=t.name("valid");!0===c.props||c.props instanceof o.Name||(c.props=(0,n.evaluatedPropsToName)(t,c.props));let{props:f}=c;function _(r){t.forIn("key",i,a=>{t.if((0,o._)`${(0,s.usePattern)(e,r)}.test(${a})`,()=>{let s=m.includes(r);s||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:a,dataPropType:n.Type.Str},h),c.opts.unevaluated&&!0!==f?t.assign((0,o._)`${f}[${a}]`,!0):s||c.allErrors||t.if((0,o.not)(h),()=>t.break())})})}(function(){for(let e of u)p&&function(e){for(let t in p)new RegExp(e).test(t)&&(0,a.checkStrictMode)(c,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}(e),c.allErrors?_(e):(t.var(h,!0),_(e),t.if(h))})()}}},18543:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(14177);t.default={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,s.validateTuple)(e,"items")}},7872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(65863),o=r(37450),a=r(3050),n=r(44844);t.default={keyword:"properties",type:"object",schemaType:"object",code(e){let{gen:t,schema:r,parentSchema:i,data:l,it:c}=e;"all"===c.opts.removeAdditional&&void 0===i.additionalProperties&&n.default.code(new s.KeywordCxt(c,n.default,"additionalProperties"));let d=(0,o.allSchemaProperties)(r);for(let e of d)c.definedProperties.add(e);c.opts.unevaluated&&d.length&&!0!==c.props&&(c.props=a.mergeEvaluated.props(t,(0,a.toHash)(d),c.props));let u=d.filter(e=>!(0,a.alwaysValidSchema)(c,r[e]));if(0===u.length)return;let m=t.name("valid");for(let s of u)c.opts.useDefaults&&!c.compositeRule&&void 0!==r[s].default?p(s):(t.if((0,o.propertyInData)(t,l,s,c.opts.ownProperties)),p(s),c.allErrors||t.else().var(m,!0),t.endIf()),e.it.definedProperties.add(s),e.ok(m);function p(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},m)}}}},24680:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050);t.default={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:e})=>(0,s._)`{propertyName: ${e.propertyName}}`},code(e){let{gen:t,schema:r,data:a,it:n}=e;if((0,o.alwaysValidSchema)(n,r))return;let i=t.name("valid");t.forIn("key",a,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},i),t.if((0,s.not)(i),()=>{e.error(!0),n.allErrors||t.break()})}),e.ok(i)}}},54094:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(3050);t.default={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,s.checkStrictMode)(r,`"${e}" without "if" is ignored`)}}},37450:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;let s=r(70257),o=r(3050),a=r(82281),n=r(3050);function i(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,s._)`Object.prototype.hasOwnProperty`})}function l(e,t,r){return(0,s._)`${i(e)}.call(${t}, ${r})`}function c(e,t,r,o){let a=(0,s._)`${t}${(0,s.getProperty)(r)} === undefined`;return o?(0,s.or)(a,(0,s.not)(l(e,t,r))):a}function d(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){let{gen:r,data:o,it:a}=e;r.if(c(r,o,t,a.opts.ownProperties),()=>{e.setParams({missingProperty:(0,s._)`${t}`},!0),e.error()})},t.checkMissingProp=function({gen:e,data:t,it:{opts:r}},o,a){return(0,s.or)(...o.map(o=>(0,s.and)(c(e,t,o,r.ownProperties),(0,s._)`${a} = ${o}`)))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=i,t.isOwnProperty=l,t.propertyInData=function(e,t,r,o){let a=(0,s._)`${t}${(0,s.getProperty)(r)} !== undefined`;return o?(0,s._)`${a} && ${l(e,t,r)}`:a},t.noPropertyInData=c,t.allSchemaProperties=d,t.schemaProperties=function(e,t){return d(t).filter(r=>!(0,o.alwaysValidSchema)(e,t[r]))},t.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:o,schemaPath:n,errorPath:i},it:l},c,d,u){let m=u?(0,s._)`${e}, ${t}, ${o}${n}`:t,p=[[a.default.instancePath,(0,s.strConcat)(a.default.instancePath,i)],[a.default.parentData,l.parentData],[a.default.parentDataProperty,l.parentDataProperty],[a.default.rootData,a.default.rootData]];l.opts.dynamicRef&&p.push([a.default.dynamicAnchors,a.default.dynamicAnchors]);let h=(0,s._)`${m}, ${r.object(...p)}`;return d!==s.nil?(0,s._)`${c}.call(${d}, ${h})`:(0,s._)`${c}(${h})`};let u=(0,s._)`new RegExp`;t.usePattern=function({gen:e,it:{opts:t}},r){let o=t.unicodeRegExp?"u":"",{regExp:a}=t.code,i=a(r,o);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,s._)`${"new RegExp"===a.code?u:(0,n.useFunc)(e,a)}(${r}, ${o})`})},t.validateArray=function(e){let{gen:t,data:r,keyword:a,it:n}=e,i=t.name("valid");if(n.allErrors){let e=t.let("valid",!0);return l(()=>t.assign(e,!1)),e}return t.var(i,!0),l(()=>t.break()),i;function l(n){let l=t.const("len",(0,s._)`${r}.length`);t.forRange("i",0,l,r=>{e.subschema({keyword:a,dataProp:r,dataPropType:o.Type.Num},i),t.if((0,s.not)(i),n)})}},t.validateUnion=function(e){let{gen:t,schema:r,keyword:a,it:n}=e;if(!Array.isArray(r))throw Error("ajv implementation error");if(r.some(e=>(0,o.alwaysValidSchema)(n,e))&&!n.opts.unevaluated)return;let i=t.let("valid",!1),l=t.name("_valid");t.block(()=>r.forEach((r,o)=>{let n=e.subschema({keyword:a,schemaProp:o,compositeRule:!0},l);t.assign(i,(0,s._)`${i} || ${l}`),e.mergeValidEvaluated(n,l)||t.if((0,s.not)(i))})),e.result(i,()=>e.reset(),()=>e.error(!0))}},26015:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={keyword:"id",code(){throw Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}}},86827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(26015),o=r(19811),a=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",s.default,o.default];t.default=a},19811:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;let s=r(99925),o=r(37450),a=r(70257),n=r(82281),i=r(20665),l=r(3050);function c(e,t){let{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,a._)`${r.scopeValue("wrapper",{ref:t})}.validate`}function d(e,t,r,s){let{gen:i,it:c}=e,{allErrors:d,schemaEnv:u,opts:m}=c,p=m.passContext?n.default.this:a.nil;function h(e){let t=(0,a._)`${e}.errors`;i.assign(n.default.vErrors,(0,a._)`${n.default.vErrors} === null ? ${t} : ${n.default.vErrors}.concat(${t})`),i.assign(n.default.errors,(0,a._)`${n.default.vErrors}.length`)}function f(e){var t;if(!c.opts.unevaluated)return;let s=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==c.props){if(s&&!s.dynamicProps)void 0!==s.props&&(c.props=l.mergeEvaluated.props(i,s.props,c.props));else{let t=i.var("props",(0,a._)`${e}.evaluated.props`);c.props=l.mergeEvaluated.props(i,t,c.props,a.Name)}}if(!0!==c.items){if(s&&!s.dynamicItems)void 0!==s.items&&(c.items=l.mergeEvaluated.items(i,s.items,c.items));else{let t=i.var("items",(0,a._)`${e}.evaluated.items`);c.items=l.mergeEvaluated.items(i,t,c.items,a.Name)}}}s?function(){if(!u.$async)throw Error("async schema referenced by sync schema");let r=i.let("valid");i.try(()=>{i.code((0,a._)`await ${(0,o.callValidateCode)(e,t,p)}`),f(t),d||i.assign(r,!0)},e=>{i.if((0,a._)`!(${e} instanceof ${c.ValidationError})`,()=>i.throw(e)),h(e),d||i.assign(r,!1)}),e.ok(r)}():e.result((0,o.callValidateCode)(e,t,p),()=>f(t),()=>h(t))}t.getValidate=c,t.callRef=d,t.default={keyword:"$ref",schemaType:"string",code(e){let{gen:t,schema:r,it:o}=e,{baseId:n,schemaEnv:l,validateName:u,opts:m,self:p}=o,{root:h}=l;if(("#"===r||"#/"===r)&&n===h.baseId)return function(){if(l===h)return d(e,u,l,l.$async);let r=t.scopeValue("root",{ref:h});return d(e,(0,a._)`${r}.validate`,h,h.$async)}();let f=i.resolveRef.call(p,h,n,r);if(void 0===f)throw new s.default(o.opts.uriResolver,n,r);return f instanceof i.SchemaEnv?function(t){let r=c(e,t);d(e,r,t,t.$async)}(f):function(s){let o=t.scopeValue("schema",!0===m.code.source?{ref:s,code:(0,a.stringify)(s)}:{ref:s}),n=t.name("valid"),i=e.subschema({schema:s,dataTypes:[],schemaPath:a.nil,topSchemaRef:o,errSchemaPath:r},n);e.mergeEvaluated(i),e.ok(n)}(f)}}},51433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(38709),a=r(20665),n=r(99925),i=r(3050);t.default={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:e,tagName:t}})=>e===o.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,s._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},code(e){let{gen:t,data:r,schema:l,parentSchema:c,it:d}=e,{oneOf:u}=c;if(!d.opts.discriminator)throw Error("discriminator: requires discriminator option");let m=l.propertyName;if("string"!=typeof m)throw Error("discriminator: requires propertyName");if(l.mapping)throw Error("discriminator: mapping is not supported");if(!u)throw Error("discriminator: requires oneOf keyword");let p=t.let("valid",!1),h=t.const("tag",(0,s._)`${r}${(0,s.getProperty)(m)}`);t.if((0,s._)`typeof ${h} == "string"`,()=>(function(){let r=function(){var e;let t={},r=o(c),s=!0;for(let t=0;t<u.length;t++){let c=u[t];if((null==c?void 0:c.$ref)&&!(0,i.schemaHasRulesButRef)(c,d.self.RULES)){let e=c.$ref;if((c=a.resolveRef.call(d.self,d.schemaEnv.root,d.baseId,e))instanceof a.SchemaEnv&&(c=c.schema),void 0===c)throw new n.default(d.opts.uriResolver,d.baseId,e)}let p=null===(e=null==c?void 0:c.properties)||void 0===e?void 0:e[m];if("object"!=typeof p)throw Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${m}"`);s=s&&(r||o(c)),function(e,t){if(e.const)l(e.const,t);else if(e.enum)for(let r of e.enum)l(r,t);else throw Error(`discriminator: "properties/${m}" must have "const" or "enum"`)}(p,t)}if(!s)throw Error(`discriminator: "${m}" must be required`);return t;function o({required:e}){return Array.isArray(e)&&e.includes(m)}function l(e,r){if("string"!=typeof e||e in t)throw Error(`discriminator: "${m}" values must be unique strings`);t[e]=r}}();for(let o in t.if(!1),r)t.elseIf((0,s._)`${h} === ${o}`),t.assign(p,function(r){let o=t.name("valid"),a=e.subschema({keyword:"oneOf",schemaProp:r},o);return e.mergeEvaluated(a,s.Name),o}(r[o]));t.else(),e.error(!1,{discrError:o.DiscrError.Mapping,tag:h,tagName:m}),t.endIf()})(),()=>e.error(!1,{discrError:o.DiscrError.Tag,tag:h,tagName:m})),e.ok(p)}}},38709:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(r||(t.DiscrError=r={}))},6698:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(86827),o=r(13081),a=r(75737),n=r(94121),i=r(41560),l=[s.default,o.default,(0,a.default)(),n.default,i.metadataVocabulary,i.contentVocabulary];t.default=l},12875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257);t.default={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>(0,s.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,s._)`{format: ${e}}`},code(e,t){let{gen:r,data:o,$data:a,schema:n,schemaCode:i,it:l}=e,{opts:c,errSchemaPath:d,schemaEnv:u,self:m}=l;c.validateFormats&&(a?function(){let a=r.scopeValue("formats",{ref:m.formats,code:c.code.formats}),n=r.const("fDef",(0,s._)`${a}[${i}]`),l=r.let("fType"),d=r.let("format");r.if((0,s._)`typeof ${n} == "object" && !(${n} instanceof RegExp)`,()=>r.assign(l,(0,s._)`${n}.type || "string"`).assign(d,(0,s._)`${n}.validate`),()=>r.assign(l,(0,s._)`"string"`).assign(d,n)),e.fail$data((0,s.or)(!1===c.strictSchema?s.nil:(0,s._)`${i} && !${d}`,function(){let e=u.$async?(0,s._)`(${n}.async ? await ${d}(${o}) : ${d}(${o}))`:(0,s._)`${d}(${o})`,r=(0,s._)`(typeof ${d} == "function" ? ${e} : ${d}.test(${o}))`;return(0,s._)`${d} && ${d} !== true && ${l} === ${t} && !${r}`}()))}():function(){let a=m.formats[n];if(!a){(function(){if(!1===c.strictSchema){m.logger.warn(e());return}throw Error(e());function e(){return`unknown format "${n}" ignored in schema at path "${d}"`}})();return}if(!0===a)return;let[i,l,p]=function(e){let t=e instanceof RegExp?(0,s.regexpCode)(e):c.code.formats?(0,s._)`${c.code.formats}${(0,s.getProperty)(n)}`:void 0,o=r.scopeValue("formats",{key:n,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,o]:[e.type||"string",e.validate,(0,s._)`${o}.validate`]}(a);i===t&&e.pass(function(){if("object"==typeof a&&!(a instanceof RegExp)&&a.async){if(!u.$async)throw Error("async format in sync schema");return(0,s._)`await ${p}(${o})`}return"function"==typeof l?(0,s._)`${p}(${o})`:(0,s._)`${p}.test(${o})`}())}())}}},94121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=[r(12875).default];t.default=s},41560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},82161:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050),a=r(17246);t.default={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:e})=>(0,s._)`{allowedValue: ${e}}`},code(e){let{gen:t,data:r,$data:n,schemaCode:i,schema:l}=e;n||l&&"object"==typeof l?e.fail$data((0,s._)`!${(0,o.useFunc)(t,a.default)}(${r}, ${i})`):e.fail((0,s._)`${l} !== ${r}`)}}},13726:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050),a=r(17246);t.default={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,s._)`{allowedValues: ${e}}`},code(e){let t,r;let{gen:n,data:i,$data:l,schema:c,schemaCode:d,it:u}=e;if(!l&&0===c.length)throw Error("enum must have non-empty array");let m=c.length>=u.opts.loopEnum,p=()=>null!=t?t:t=(0,o.useFunc)(n,a.default);if(m||l)r=n.let("valid"),e.block$data(r,function(){n.assign(r,!1),n.forOf("v",d,e=>n.if((0,s._)`${p()}(${i}, ${e})`,()=>n.assign(r,!0).break()))});else{if(!Array.isArray(c))throw Error("ajv implementation error");let e=n.const("vSchema",d);r=(0,s.or)(...c.map((t,r)=>(function(e,t){let r=c[t];return"object"==typeof r&&null!==r?(0,s._)`${p()}(${i}, ${e}[${t}])`:(0,s._)`${i} === ${r}`})(e,r)))}e.pass(r)}}},13081:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(30155),o=r(75546),a=r(88754),n=r(71356),i=r(52014),l=r(8701),c=r(38749),d=r(91185),u=r(82161),m=r(13726),p=[s.default,o.default,a.default,n.default,i.default,l.default,c.default,d.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},u.default,m.default];t.default=p},38749:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257);t.default={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>(0,s.str)`must NOT have ${"maxItems"===e?"more":"fewer"} than ${t} items`,params:({schemaCode:e})=>(0,s._)`{limit: ${e}}`},code(e){let{keyword:t,data:r,schemaCode:o}=e,a="maxItems"===t?s.operators.GT:s.operators.LT;e.fail$data((0,s._)`${r}.length ${a} ${o}`)}}},88754:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=r(3050),a=r(40720);t.default={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>(0,s.str)`must NOT have ${"maxLength"===e?"more":"fewer"} than ${t} characters`,params:({schemaCode:e})=>(0,s._)`{limit: ${e}}`},code(e){let{keyword:t,data:r,schemaCode:n,it:i}=e,l="maxLength"===t?s.operators.GT:s.operators.LT,c=!1===i.opts.unicode?(0,s._)`${r}.length`:(0,s._)`${(0,o.useFunc)(e.gen,a.default)}(${r})`;e.fail$data((0,s._)`${c} ${l} ${n}`)}}},30155:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257),o=s.operators,a={maximum:{okStr:"<=",ok:o.LTE,fail:o.GT},minimum:{okStr:">=",ok:o.GTE,fail:o.LT},exclusiveMaximum:{okStr:"<",ok:o.LT,fail:o.GTE},exclusiveMinimum:{okStr:">",ok:o.GT,fail:o.LTE}},n={keyword:Object.keys(a),type:"number",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>(0,s.str)`must be ${a[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,s._)`{comparison: ${a[e].okStr}, limit: ${t}}`},code(e){let{keyword:t,data:r,schemaCode:o}=e;e.fail$data((0,s._)`${r} ${a[t].fail} ${o} || isNaN(${r})`)}};t.default=n},52014:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257);t.default={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:({keyword:e,schemaCode:t})=>(0,s.str)`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${t} properties`,params:({schemaCode:e})=>(0,s._)`{limit: ${e}}`},code(e){let{keyword:t,data:r,schemaCode:o}=e,a="maxProperties"===t?s.operators.GT:s.operators.LT;e.fail$data((0,s._)`Object.keys(${r}).length ${a} ${o}`)}}},75546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(70257);t.default={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>(0,s.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,s._)`{multipleOf: ${e}}`},code(e){let{gen:t,data:r,schemaCode:o,it:a}=e,n=a.opts.multipleOfPrecision,i=t.let("res"),l=n?(0,s._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${n}`:(0,s._)`${i} !== parseInt(${i})`;e.fail$data((0,s._)`(${o} === 0 || (${i} = ${r}/${o}, ${l}))`)}}},71356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(37450),o=r(70257);t.default={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>(0,o.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,o._)`{pattern: ${e}}`},code(e){let{data:t,$data:r,schema:a,schemaCode:n,it:i}=e,l=i.opts.unicodeRegExp?"u":"",c=r?(0,o._)`(new RegExp(${n}, ${l}))`:(0,s.usePattern)(e,a);e.fail$data((0,o._)`!${c}.test(${t})`)}}},8701:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(37450),o=r(70257),a=r(3050);t.default={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>(0,o.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,o._)`{missingProperty: ${e}}`},code(e){let{gen:t,schema:r,schemaCode:n,data:i,$data:l,it:c}=e,{opts:d}=c;if(!l&&0===r.length)return;let u=r.length>=d.loopRequired;if(c.allErrors?function(){if(u||l)e.block$data(o.nil,m);else for(let t of r)(0,s.checkReportMissingProp)(e,t)}():function(){let a=t.let("missing");if(u||l){let r=t.let("valid",!0);e.block$data(r,()=>{e.setParams({missingProperty:a}),t.forOf(a,n,()=>{t.assign(r,(0,s.propertyInData)(t,i,a,d.ownProperties)),t.if((0,o.not)(r),()=>{e.error(),t.break()})},o.nil)}),e.ok(r)}else t.if((0,s.checkMissingProp)(e,r,a)),(0,s.reportMissingProp)(e,a),t.else()}(),d.strictRequired){let t=e.parentSchema.properties,{definedProperties:s}=e.it;for(let e of r)if((null==t?void 0:t[e])===void 0&&!s.has(e)){let t=c.schemaEnv.baseId+c.errSchemaPath,r=`required property "${e}" is not defined at "${t}" (strictRequired)`;(0,a.checkStrictMode)(c,r,c.opts.strictRequired)}}function m(){t.forOf("prop",n,r=>{e.setParams({missingProperty:r}),t.if((0,s.noPropertyInData)(t,i,r,d.ownProperties),()=>e.error())})}}}},91185:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let s=r(77434),o=r(70257),a=r(3050),n=r(17246);t.default={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>(0,o.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,o._)`{i: ${e}, j: ${t}}`},code(e){let{gen:t,data:r,$data:i,schema:l,parentSchema:c,schemaCode:d,it:u}=e;if(!i&&!l)return;let m=t.let("valid"),p=c.items?(0,s.getSchemaTypes)(c.items):[];e.block$data(m,function(){let i=t.let("i",(0,o._)`${r}.length`),l=t.let("j");e.setParams({i,j:l}),t.assign(m,!0),t.if((0,o._)`${i} > 1`,()=>(p.length>0&&!p.some(e=>"object"===e||"array"===e)?function(a,n){let i=t.name("item"),l=(0,s.checkDataTypes)(p,i,u.opts.strictNumbers,s.DataType.Wrong),c=t.const("indices",(0,o._)`{}`);t.for((0,o._)`;${a}--;`,()=>{t.let(i,(0,o._)`${r}[${a}]`),t.if(l,(0,o._)`continue`),p.length>1&&t.if((0,o._)`typeof ${i} == "string"`,(0,o._)`${i} += "_"`),t.if((0,o._)`typeof ${c}[${i}] == "number"`,()=>{t.assign(n,(0,o._)`${c}[${i}]`),e.error(),t.assign(m,!1).break()}).code((0,o._)`${c}[${i}] = ${a}`)})}:function(s,i){let l=(0,a.useFunc)(t,n.default),c=t.name("outer");t.label(c).for((0,o._)`;${s}--;`,()=>t.for((0,o._)`${i} = ${s}; ${i}--;`,()=>t.if((0,o._)`${l}(${r}[${s}], ${r}[${i}])`,()=>{e.error(),t.assign(m,!1).break(c)})))})(i,l))},(0,o._)`${d} === false`),e.ok(m)}}},75886:e=>{"use strict";var t=e.exports=function(e,r,s){"function"==typeof r&&(s=r,r={});var o="function"==typeof(s=r.cb||s)?s:s.pre||function(){};(function e(r,s,o,a,n,i,l,c,d,u){if(a&&"object"==typeof a&&!Array.isArray(a)){for(var m in s(a,n,i,l,c,d,u),a){var p=a[m];if(Array.isArray(p)){if(m in t.arrayKeywords)for(var h=0;h<p.length;h++)e(r,s,o,p[h],n+"/"+m+"/"+h,i,n,m,a,h)}else if(m in t.propsKeywords){if(p&&"object"==typeof p)for(var f in p)e(r,s,o,p[f],n+"/"+m+"/"+f.replace(/~/g,"~0").replace(/\//g,"~1"),i,n,m,a,f)}else(m in t.keywords||r.allKeys&&!(m in t.skipKeywords))&&e(r,s,o,p,n+"/"+m,i,n,m,a)}o(a,n,i,l,c,d,u)}})(r,o,s.post||function(){},e,"",e)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},65953:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(Array.isArray(t)){if((s=t.length)!=r.length)return!1;for(o=s;0!=o--;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((s=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(o=s;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,a[o]))return!1;for(o=s;0!=o--;){var s,o,a,n=a[o];if(!e(t[n],r[n]))return!1}return!0}return t!=t&&r!=r}},91039:function(e,t,r){"use strict";var s,o=this&&this.__classPrivateFieldSet||function(e,t,r,s,o){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!o)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?o.call(e,r):o?o.value=r:t.set(e,r),r},a=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.listSupportedBackends=t.onnxruntimeBackend=void 0;let n=r(53990);class i{constructor(e,t){s.set(this,void 0),(0,n.initOrt)(),o(this,s,new n.binding.InferenceSession,"f"),"string"==typeof e?a(this,s,"f").loadModel(e,t):a(this,s,"f").loadModel(e.buffer,e.byteOffset,e.byteLength,t),this.inputNames=a(this,s,"f").inputNames,this.outputNames=a(this,s,"f").outputNames}async dispose(){a(this,s,"f").dispose()}startProfiling(){}endProfiling(){a(this,s,"f").endProfiling()}async run(e,t,r){return new Promise((o,n)=>{setImmediate(()=>{try{o(a(this,s,"f").run(e,t,r))}catch(e){n(e)}})})}}s=new WeakMap;class l{async init(){return Promise.resolve()}async createInferenceSessionHandler(e,t){return new Promise((r,s)=>{setImmediate(()=>{try{r(new i(e,t||{}))}catch(e){s(e)}})})}}t.onnxruntimeBackend=new l,t.listSupportedBackends=n.binding.listSupportedBackends},53990:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initOrt=t.binding=void 0;let s=r(81723);t.binding=r(13538)(`./${process.platform}/${process.arch}/onnxruntime_binding.node`);let o=!1;t.initOrt=()=>{if(!o){o=!0;let e=2;if(s.env.logLevel)switch(s.env.logLevel){case"verbose":e=0;break;case"info":e=1;break;case"warning":e=2;break;case"error":e=3;break;case"fatal":e=4;break;default:throw Error(`Unsupported log level: ${s.env.logLevel}`)}t.binding.initOrtOnce(e,s.Tensor)}}},56536:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,o)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.listSupportedBackends=void 0,o(r(81723),t);var a=r(91039);Object.defineProperty(t,"listSupportedBackends",{enumerable:!0,get:function(){return a.listSupportedBackends}});let n=r(81723),i=r(13100),l=r(91039);for(let e of(0,l.listSupportedBackends)())(0,n.registerBackend)(e.name,l.onnxruntimeBackend,100);Object.defineProperty(n.env.versions,"node",{value:i.version,enumerable:!0})},13100:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="1.21.0"},67987:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\darwin\\arm64\\onnxruntime_binding.node")},29467:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\darwin\\x64\\onnxruntime_binding.node")},57824:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\linux\\arm64\\onnxruntime_binding.node")},51603:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\linux\\x64\\onnxruntime_binding.node")},61200:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\win32\\arm64\\onnxruntime_binding.node")},51343:e=>{e.exports=require("./node_modules\\onnxruntime-node\\bin\\napi-v3\\win32\\x64\\onnxruntime_binding.node")},66751:(e,t,r)=>{"use strict";let{normalizeIPv6:s,removeDotSegments:o,recomposeAuthority:a,normalizeComponentEncoding:n,isIPv4:i,nonSimpleDomain:l}=r(95244),{SCHEMES:c,getSchemeHandler:d}=r(62982);function u(e,t,r,s){let a={};return s||(e=h(m(e,r),r),t=h(m(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(a.scheme=t.scheme,a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=o(t.path||""),a.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=o(t.path||""),a.query=t.query):(t.path?("/"===t.path[0]?a.path=o(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?a.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:a.path=t.path:a.path="/"+t.path,a.path=o(a.path)),a.query=t.query):(a.path=e.path,void 0!==t.query?a.query=t.query:a.query=e.query),a.userinfo=e.userinfo,a.host=e.host,a.port=e.port),a.scheme=e.scheme),a.fragment=t.fragment,a}function m(e,t){let r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},s=Object.assign({},t),n=[],i=d(s.scheme||r.scheme);i&&i.serialize&&i.serialize(r,s),void 0!==r.path&&(s.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),void 0!==r.scheme&&(r.path=r.path.split("%3A").join(":")))),"suffix"!==s.reference&&r.scheme&&n.push(r.scheme,":");let l=a(r);if(void 0!==l&&("suffix"!==s.reference&&n.push("//"),n.push(l),r.path&&"/"!==r.path[0]&&n.push("/")),void 0!==r.path){let e=r.path;s.absolutePath||i&&i.absolutePath||(e=o(e)),void 0===l&&"/"===e[0]&&"/"===e[1]&&(e="/%2F"+e.slice(2)),n.push(e)}return void 0!==r.query&&n.push("?",r.query),void 0!==r.fragment&&n.push("#",r.fragment),n.join("")}let p=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function h(e,t){let r=Object.assign({},t),o={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},a=!1;"suffix"===r.reference&&(e=r.scheme?r.scheme+":"+e:"//"+e);let n=e.match(p);if(n){if(o.scheme=n[1],o.userinfo=n[3],o.host=n[4],o.port=parseInt(n[5],10),o.path=n[6]||"",o.query=n[7],o.fragment=n[8],isNaN(o.port)&&(o.port=n[5]),o.host){if(!1===i(o.host)){let e=s(o.host);o.host=e.host.toLowerCase(),a=e.isIPV6}else a=!0}void 0!==o.scheme||void 0!==o.userinfo||void 0!==o.host||void 0!==o.port||void 0!==o.query||o.path?void 0===o.scheme?o.reference="relative":void 0===o.fragment?o.reference="absolute":o.reference="uri":o.reference="same-document",r.reference&&"suffix"!==r.reference&&r.reference!==o.reference&&(o.error=o.error||"URI is not a "+r.reference+" reference.");let t=d(r.scheme||o.scheme);if(!r.unicodeSupport&&(!t||!t.unicodeSupport)&&o.host&&(r.domainHost||t&&t.domainHost)&&!1===a&&l(o.host))try{o.host=URL.domainToASCII(o.host.toLowerCase())}catch(e){o.error=o.error||"Host's domain name can not be converted to ASCII: "+e}(!t||t&&!t.skipNormalize)&&(-1!==e.indexOf("%")&&(void 0!==o.scheme&&(o.scheme=unescape(o.scheme)),void 0!==o.host&&(o.host=unescape(o.host))),o.path&&(o.path=escape(unescape(o.path))),o.fragment&&(o.fragment=encodeURI(decodeURIComponent(o.fragment)))),t&&t.parse&&t.parse(o,r)}else o.error=o.error||"URI can not be parsed.";return o}let f={SCHEMES:c,normalize:function(e,t){return"string"==typeof e?e=m(h(e,t),t):"object"==typeof e&&(e=h(m(e,t),t)),e},resolve:function(e,t,r){let s=r?Object.assign({scheme:"null"},r):{scheme:"null"},o=u(h(e,s),h(t,s),s,!0);return s.skipEscape=!0,m(o,s)},resolveComponent:u,equal:function(e,t,r){return"string"==typeof e?e=m(n(h(e=unescape(e),r),!0),{...r,skipEscape:!0}):"object"==typeof e&&(e=m(n(e,!0),{...r,skipEscape:!0})),"string"==typeof t?t=m(n(h(t=unescape(t),r),!0),{...r,skipEscape:!0}):"object"==typeof t&&(t=m(n(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()},serialize:m,parse:h};e.exports=f,e.exports.default=f,e.exports.fastUri=f},62982:(e,t,r)=>{"use strict";let{isUUID:s}=r(95244),o=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,a=["http","https","ws","wss","urn","urn:uuid"];function n(e){return!0===e.secure||!1!==e.secure&&!!e.scheme&&3===e.scheme.length&&("w"===e.scheme[0]||"W"===e.scheme[0])&&("s"===e.scheme[1]||"S"===e.scheme[1])&&("s"===e.scheme[2]||"S"===e.scheme[2])}function i(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function l(e){let t="https"===String(e.scheme).toLowerCase();return(e.port===(t?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}let c={scheme:"http",domainHost:!0,parse:i,serialize:l},d={scheme:"https",domainHost:c.domainHost,parse:i,serialize:l},u={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=n(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if((e.port===(n(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){let[t,r]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}},m={scheme:"wss",domainHost:u.domainHost,parse:u.parse,serialize:u.serialize},p={http:c,https:d,ws:u,wss:m,urn:{scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;let r=e.path.match(o);if(r){let s=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];let o=h(`${s}:${t.nid||e.nid}`);e.path=void 0,o&&(e=o.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){if(void 0===e.nid)throw Error("URN without nid cannot be serialized");let r=t.scheme||e.scheme||"urn",s=e.nid.toLowerCase(),o=h(`${r}:${t.nid||s}`);o&&(e=o.serialize(e,t));let a=e,n=e.nss;return a.path=`${s||t.nid}:${n}`,t.skipEscape=!0,a},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(e,t){return e.uuid=e.nss,e.nss=void 0,t.tolerant||e.uuid&&s(e.uuid)||(e.error=e.error||"UUID is not valid."),e},serialize:function(e){return e.nss=(e.uuid||"").toLowerCase(),e},skipNormalize:!0}};function h(e){return e&&(p[e]||p[e.toLowerCase()])||void 0}Object.setPrototypeOf(p,null),e.exports={wsIsSecure:n,SCHEMES:p,isValidSchemeName:function(e){return -1!==a.indexOf(e)},getSchemeHandler:h}},95244:e=>{"use strict";let t=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),r=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function s(e){let t="",r=0,s=0;for(s=0;s<e.length;s++)if(48!==(r=e[s].charCodeAt(0))){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[s];break}for(s+=1;s<e.length;s++){if(!((r=e[s].charCodeAt(0))>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[s]}return t}let o=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function a(e){return e.length=0,!0}function n(e,t,r){if(e.length){let o=s(e);if(""===o)return r.error=!0,!1;t.push(o),e.length=0}return!0}function i(e){if(2>function(e,t){let r=0;for(let t=0;t<e.length;t++)":"===e[t]&&r++;return r}(e,0))return{host:e,isIPV6:!1};let t=function(e){let t=0,r={error:!1,address:"",zone:""},o=[],i=[],l=!1,c=!1,d=n;for(let s=0;s<e.length;s++){let n=e[s];if("["!==n&&"]"!==n){if(":"===n){if(!0===l&&(c=!0),!d(i,o,r))break;if(++t>7){r.error=!0;break}s>0&&":"===e[s-1]&&(l=!0),o.push(":");continue}if("%"===n){if(!d(i,o,r))break;d=a}else{i.push(n);continue}}}return i.length&&(d===a?r.zone=i.join(""):c?o.push(i.join("")):o.push(s(i))),r.address=o.join(""),r}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,r=t.address;return t.zone&&(e+="%"+t.zone,r+="%25"+t.zone),{host:e,isIPV6:!0,escapedHost:r}}}e.exports={nonSimpleDomain:o,recomposeAuthority:function(e){let t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let s=unescape(e.host);if(!r(s)){let t=i(s);s=!0===t.isIPV6?`[${t.escapedHost}]`:e.host}t.push(s)}return("number"==typeof e.port||"string"==typeof e.port)&&(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){let r=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=r(e.scheme)),void 0!==e.userinfo&&(e.userinfo=r(e.userinfo)),void 0!==e.host&&(e.host=r(e.host)),void 0!==e.path&&(e.path=r(e.path)),void 0!==e.query&&(e.query=r(e.query)),void 0!==e.fragment&&(e.fragment=r(e.fragment)),e},removeDotSegments:function(e){let t=e,r=[],s=-1,o=0;for(;o=t.length;){if(1===o){if("."===t)break;if("/"===t){r.push("/");break}r.push(t);break}if(2===o){if("."===t[0]){if("."===t[1])break;if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&("."===t[1]||"/"===t[1])){r.push("/");break}}else if(3===o&&"/.."===t){0!==r.length&&r.pop(),r.push("/");break}if("."===t[0]){if("."===t[1]){if("/"===t[2]){t=t.slice(3);continue}}else if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&"."===t[1]){if("/"===t[2]){t=t.slice(2);continue}if("."===t[2]&&"/"===t[3]){t=t.slice(3),0!==r.length&&r.pop();continue}}if(-1===(s=t.indexOf("/",1))){r.push(t);break}r.push(t.slice(0,s)),t=t.slice(s)}return r.join("")},isIPv4:r,isUUID:t,normalizeIPv6:i,stringArrayToHexStripped:s}},67570:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBackendAndExecutionProviders=t.registerBackend=void 0;let r=new Map,s=[];t.registerBackend=(e,t,o)=>{if(t&&"function"==typeof t.init&&"function"==typeof t.createInferenceSessionHandler){let a=r.get(e);if(void 0===a)r.set(e,{backend:t,priority:o});else if(a.priority>o)return;else if(a.priority===o&&a.backend!==t)throw Error(`cannot register backend "${e}" using priority ${o}`);if(o>=0){let t=s.indexOf(e);-1!==t&&s.splice(t,1);for(let t=0;t<s.length;t++)if(r.get(s[t]).priority<=o){s.splice(t,0,e);return}s.push(e)}return}throw TypeError("not a valid backend")};let o=async e=>{let t=r.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(e){return r||(t.error=`${e}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},a=async e=>{let t;let r=e.executionProviders||[],a=r.map(e=>"string"==typeof e?e:e.name),n=0===a.length?s:a,i=[],l=new Set;for(let e of n){let r=await o(e);"string"==typeof r?i.push({name:e,err:r}):(t||(t=r),t===r&&l.add(e))}if(!t)throw Error(`no available backend found. ERR: ${i.map(e=>`[${e.name}] ${e.err}`).join(", ")}`);for(let{name:e,err:t}of i)a.includes(e)&&console.warn(`removing requested execution provider "${e}" from session options because it is not available: ${t}`);let c=r.filter(e=>l.has("string"==typeof e?e:e.name));return[t,new Proxy(e,{get:(e,t)=>"executionProviders"===t?c:Reflect.get(e,t)})]};t.resolveBackendAndExecutionProviders=a},95526:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerBackend=void 0;var s=r(67570);Object.defineProperty(t,"registerBackend",{enumerable:!0,get:function(){return s.registerBackend}})},87621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;let s=r(35039),o="warning";t.env={wasm:{},webgl:{},webgpu:{},versions:{common:s.version},set logLevel(value){if(void 0===value)return;if("string"!=typeof value||-1===["verbose","info","warning","error","fatal"].indexOf(value))throw Error(`Unsupported logging level: ${value}`);o=value},get logLevel(){return o}},Object.defineProperty(t.env,"logLevel",{enumerable:!0})},27106:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;let s=r(87621);t.env=s.env},81723:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,o)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(95526),t),o(r(27106),t),o(r(28166),t),o(r(5045),t),o(r(68404),t),o(r(22738),t),o(r(24262),t),o(r(8543),t),o(r(73575),t)},64298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InferenceSession=void 0;let s=r(67570),o=r(5045),a=r(24262);class n{constructor(e){this.handler=e}async run(e,t,r){(0,a.TRACE_FUNC_BEGIN)();let s={},n={};if("object"!=typeof e||null===e||e instanceof o.Tensor||Array.isArray(e))throw TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let i=!0;if("object"==typeof t){if(null===t)throw TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof o.Tensor)throw TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw TypeError("'fetches' cannot be an empty array.");for(let e of(i=!1,t)){if("string"!=typeof e)throw TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw RangeError(`'fetches' contains invalid output name: ${e}.`);s[e]=null}if("object"==typeof r&&null!==r)n=r;else if(void 0!==r)throw TypeError("'options' must be an object.")}else{let e=!1,a=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==a.indexOf(r)){let a=t[r];(null===a||a instanceof o.Tensor)&&(e=!0,i=!1,s[r]=a)}if(e){if("object"==typeof r&&null!==r)n=r;else if(void 0!==r)throw TypeError("'options' must be an object.")}else n=t}}else if(void 0!==t)throw TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(void 0===e[t])throw Error(`input '${t}' is missing in 'feeds'.`);if(i)for(let e of this.outputNames)s[e]=null;let l=await this.handler.run(e,s,n),c={};for(let e in l)if(Object.hasOwnProperty.call(l,e)){let t=l[e];t instanceof o.Tensor?c[e]=t:c[e]=new o.Tensor(t.type,t.data,t.dims)}return(0,a.TRACE_FUNC_END)(),c}async release(){return this.handler.dispose()}static async create(e,t,r,o){let i;(0,a.TRACE_FUNC_BEGIN)();let l={};if("string"==typeof e){if(i=e,"object"==typeof t&&null!==t)l=t;else if(void 0!==t)throw TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(i=e,"object"==typeof t&&null!==t)l=t;else if(void 0!==t)throw TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer){let s=0,a=e.byteLength;if("object"==typeof t&&null!==t)l=t;else if("number"==typeof t){if(!Number.isSafeInteger(s=t))throw RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(a=e.byteLength-s,"number"==typeof r){if(!Number.isSafeInteger(a=r))throw RangeError("'byteLength' must be an integer.");if(a<=0||s+a>e.byteLength)throw RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof o&&null!==o)l=o;else if(void 0!==o)throw TypeError("'options' must be an object.")}else if(void 0!==r)throw TypeError("'byteLength' must be a number.")}else if(void 0!==t)throw TypeError("'options' must be an object.");i=new Uint8Array(e,s,a)}else throw TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[c,d]=await (0,s.resolveBackendAndExecutionProviders)(l),u=await c.createInferenceSessionHandler(i,d);return(0,a.TRACE_FUNC_END)(),new n(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}t.InferenceSession=n},28166:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InferenceSession=void 0;let s=r(64298);t.InferenceSession=s.InferenceSession},8543:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},73575:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},48714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tensorToImageData=t.tensorToDataURL=void 0,t.tensorToDataURL=(e,t)=>{let r="undefined"!=typeof document?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let s=r.getContext("2d");if(null!=s){let o,a,n,i;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[3]):(o=e.dims[3],a=e.dims[2]);let l=t?.format!==void 0?t.format:"RGB",c=t?.norm;void 0===c||void 0===c.mean?n=[255,255,255,255]:"number"==typeof c.mean?n=[c.mean,c.mean,c.mean,c.mean]:(n=[c.mean[0],c.mean[1],c.mean[2],0],void 0!==c.mean[3]&&(n[3]=c.mean[3])),void 0===c||void 0===c.bias?i=[0,0,0,0]:"number"==typeof c.bias?i=[c.bias,c.bias,c.bias,c.bias]:(i=[c.bias[0],c.bias[1],c.bias[2],0],void 0!==c.bias[3]&&(i[3]=c.bias[3]));let d=a*o,u=0,m=d,p=2*d,h=-1;"RGBA"===l?(u=0,m=d,p=2*d,h=3*d):"RGB"===l?(u=0,m=d,p=2*d):"RBG"===l&&(u=0,p=d,m=2*d);for(let t=0;t<a;t++)for(let r=0;r<o;r++){let o=(e.data[u++]-i[0])*n[0],a=(e.data[m++]-i[1])*n[1],l=(e.data[p++]-i[2])*n[2],c=-1===h?255:(e.data[h++]-i[3])*n[3];s.fillStyle="rgba("+o+","+a+","+l+","+c+")",s.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw Error("toDataURL is not supported")}throw Error("Can not access image data")},t.tensorToImageData=(e,t)=>{let r;let s="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null!=s){let o,a,n,i,l;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[1],n=e.dims[3]):(o=e.dims[3],a=e.dims[2],n=e.dims[1]);let c=void 0!==t&&void 0!==t.format?t.format:"RGB",d=t?.norm;void 0===d||void 0===d.mean?i=[255,255,255,255]:"number"==typeof d.mean?i=[d.mean,d.mean,d.mean,d.mean]:(i=[d.mean[0],d.mean[1],d.mean[2],255],void 0!==d.mean[3]&&(i[3]=d.mean[3])),void 0===d||void 0===d.bias?l=[0,0,0,0]:"number"==typeof d.bias?l=[d.bias,d.bias,d.bias,d.bias]:(l=[d.bias[0],d.bias[1],d.bias[2],0],void 0!==d.bias[3]&&(l[3]=d.bias[3]));let u=a*o;if(void 0!==t&&(void 0!==t.format&&4===n&&"RGBA"!==t.format||3===n&&"RGB"!==t.format&&"BGR"!==t.format))throw Error("Tensor format doesn't match input tensor dims");let m=0,p=1,h=2,f=3,_=0,g=u,M=2*u,y=-1;"RGBA"===c?(_=0,g=u,M=2*u,y=3*u):"RGB"===c?(_=0,g=u,M=2*u):"RBG"===c&&(_=0,M=u,g=2*u),r=s.createImageData(o,a);for(let t=0;t<a*o;m+=4,p+=4,h+=4,f+=4,t++)r.data[m]=(e.data[_++]-l[0])*i[0],r.data[p]=(e.data[g++]-l[1])*i[1],r.data[h]=(e.data[M++]-l[2])*i[2],r.data[f]=-1===y?255:(e.data[y++]-l[3])*i[3]}else throw Error("Can not access image data");return r}},68404:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},57311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tensorFromPinnedBuffer=t.tensorFromMLTensor=t.tensorFromGpuBuffer=t.tensorFromTexture=t.tensorFromImage=t.bufferToTensor=void 0;let s=r(53904);t.bufferToTensor=(e,t)=>{let r,o;if(void 0===e)throw Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw Error("NHWC Tensor layout is not supported yet");let{height:a,width:n}=t,i=t.norm??{mean:255,bias:0};r="number"==typeof i.mean?[i.mean,i.mean,i.mean,i.mean]:[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],o="number"==typeof i.bias?[i.bias,i.bias,i.bias,i.bias]:[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let l=void 0!==t.format?t.format:"RGBA",c=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",d=a*n,u=new Float32Array("RGBA"===c?4*d:3*d),m=4,p=0,h=1,f=2,_=3,g=0,M=d,y=2*d,w=-1;"RGB"===l&&(m=3,p=0,h=1,f=2,_=-1),"RGBA"===c?w=3*d:"RBG"===c?(g=0,y=d,M=2*d):"BGR"===c&&(y=0,M=d,g=2*d);for(let t=0;t<d;t++,p+=m,f+=m,h+=m,_+=m)u[g++]=(e[p]+o[0])/r[0],u[M++]=(e[h]+o[1])/r[1],u[y++]=(e[f]+o[2])/r[2],-1!==w&&-1!==_&&(u[w++]=(e[_]+o[3])/r[3]);return"RGBA"===c?new s.Tensor("float32",u,[1,4,a,n]):new s.Tensor("float32",u,[1,3,a,n])};let o=async(e,r)=>{let s;let o="undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,a="undefined"!=typeof ImageData&&e instanceof ImageData,n="undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap,i="string"==typeof e,l=r??{},c=()=>{if("undefined"!=typeof document)return document.createElement("canvas");if("undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(1,1);throw Error("Canvas is not supported")},d=e=>"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement?e.getContext("2d"):e instanceof OffscreenCanvas?e.getContext("2d"):null;if(o){let t=c();t.width=e.width,t.height=e.height;let o=d(t);if(null!=o){let t=e.height,a=e.width;if(void 0!==r&&void 0!==r.resizedHeight&&void 0!==r.resizedWidth&&(t=r.resizedHeight,a=r.resizedWidth),void 0!==r){if(l=r,void 0!==r.tensorFormat)throw Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=t,l.width=a}else l.tensorFormat="RGBA",l.height=t,l.width=a;o.drawImage(e,0,0),s=o.getImageData(0,0,a,t).data}else throw Error("Can not access image data")}else if(a){let t,o;if(void 0!==r&&void 0!==r.resizedWidth&&void 0!==r.resizedHeight?(t=r.resizedHeight,o=r.resizedWidth):(t=e.height,o=e.width),void 0!==r&&(l=r),l.format="RGBA",l.height=t,l.width=o,void 0!==r){let r=c();r.width=o,r.height=t;let a=d(r);if(null!=a)a.putImageData(e,0,0),s=a.getImageData(0,0,o,t).data;else throw Error("Can not access image data")}else s=e.data}else if(n){if(void 0===r)throw Error("Please provide image config with format for Imagebitmap");let o=c();o.width=e.width,o.height=e.height;let a=d(o);if(null!=a){let r=e.height,o=e.width;return a.drawImage(e,0,0,o,r),s=a.getImageData(0,0,o,r).data,l.height=r,l.width=o,(0,t.bufferToTensor)(s,l)}throw Error("Can not access image data")}else if(i)return new Promise((r,s)=>{let o=c(),a=d(o);if(!e||!a)return s();let n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=()=>{o.width=n.width,o.height=n.height,a.drawImage(n,0,0,o.width,o.height);let e=a.getImageData(0,0,o.width,o.height);l.height=o.height,l.width=o.width,r((0,t.bufferToTensor)(e.data,l))}});else throw Error("Input data provided is not supported - aborted tensor creation");if(void 0!==s)return(0,t.bufferToTensor)(s,l);throw Error("Input data provided is not supported - aborted tensor creation")};t.tensorFromImage=o,t.tensorFromTexture=(e,t)=>{let{width:r,height:o,download:a,dispose:n}=t;return new s.Tensor({location:"texture",type:"float32",texture:e,dims:[1,o,r,4],download:a,dispose:n})},t.tensorFromGpuBuffer=(e,t)=>{let{dataType:r,dims:o,download:a,dispose:n}=t;return new s.Tensor({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:o,download:a,dispose:n})},t.tensorFromMLTensor=(e,t)=>{let{dataType:r,dims:o,download:a,dispose:n}=t;return new s.Tensor({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:o,download:a,dispose:n})},t.tensorFromPinnedBuffer=(e,t,r)=>new s.Tensor({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})},22738:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},55539:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkTypedArray=t.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=void 0,t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),t.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let r=!1;t.checkTypedArray=()=>{if(!r){r=!0;let e="undefined"!=typeof BigInt64Array&&BigInt64Array.from,s="undefined"!=typeof BigUint64Array&&BigUint64Array.from,o=globalThis.Float16Array,a=void 0!==o&&o.from;e&&(t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),t.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64")),s&&(t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),t.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64")),a?(t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",o),t.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(o,"float16")):t.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",Uint16Array)}}},53904:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;let s=r(48714),o=r(57311),a=r(55539),n=r(45266);class i{constructor(e,t,r){let s,o;if((0,a.checkTypedArray)(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,s=e.type,o=e.dims,e.location){case"cpu-pinned":{let t=a.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(s);if(!t)throw TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==s)throw TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==s&&"float16"!==s&&"int32"!==s&&"int64"!==s&&"uint32"!==s&&"uint8"!==s&&"bool"!==s&&"uint4"!==s&&"int4"!==s)throw TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==s&&"float16"!==s&&"int32"!==s&&"int64"!==s&&"uint32"!==s&&"uint64"!==s&&"int8"!==s&&"uint8"!==s&&"bool"!==s&&"uint4"!==s&&"int4"!==s)throw TypeError(`unsupported type "${s}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let n,i;if("string"==typeof e){if(s=e,i=r,"string"===e){if(!Array.isArray(t))throw TypeError("A string tensor's data must be a string array.");n=t}else{let r=a.NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(e);if(void 0===r)throw TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e&&r===Uint16Array||"uint4"===e||"int4"===e)throw TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${r.name} as data.`);n="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else if(t instanceof r)n=t;else if(t instanceof Uint8ClampedArray){if("uint8"===e)n=Uint8Array.from(t);else throw TypeError("A Uint8ClampedArray tensor's data must be type of uint8")}else if("float16"===e&&t instanceof Uint16Array&&r!==Uint16Array)n=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw TypeError(`A ${s} tensor's data must be type of ${r}`)}}else if(i=t,Array.isArray(e)){if(0===e.length)throw TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)s="string",n=e;else if("boolean"===t)s="bool",n=Uint8Array.from(e);else throw TypeError(`Invalid element type of data array: ${t}.`)}else if(e instanceof Uint8ClampedArray)s="uint8",n=Uint8Array.from(e);else{let t=a.NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(e.constructor);if(void 0===t)throw TypeError(`Unsupported type for tensor data: ${e.constructor}.`);s=t,n=e}if(void 0===i)i=[n.length];else if(!Array.isArray(i))throw TypeError("A tensor's dims must be a number array");o=i,this.cpuData=n,this.dataLocation="cpu"}let i=(0,n.calculateSize)(o);if(this.cpuData&&i!==this.cpuData.length){if(("uint4"===s||"int4"===s)&&Math.ceil(i/2)===this.cpuData.length);else throw Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`)}this.type=s,this.dims=o,this.size=i}static async fromImage(e,t){return(0,o.tensorFromImage)(e,t)}static fromTexture(e,t){return(0,o.tensorFromTexture)(e,t)}static fromGpuBuffer(e,t){return(0,o.tensorFromGpuBuffer)(e,t)}static fromMLTensor(e,t){return(0,o.tensorFromMLTensor)(e,t)}static fromPinnedBuffer(e,t,r){return(0,o.tensorFromPinnedBuffer)(e,t,r)}toDataURL(e){return(0,s.tensorToDataURL)(this,e)}toImageData(e){return(0,s.tensorToImageData)(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw Error("Cannot reshape a tensor that owns GPU resource.");return(0,n.tensorReshape)(this,e)}}t.Tensor=i},45266:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tensorReshape=t.calculateSize=void 0;let s=r(53904);t.calculateSize=e=>{let t=1;for(let r=0;r<e.length;r++){let s=e[r];if("number"!=typeof s||!Number.isSafeInteger(s))throw TypeError(`dims[${r}] must be an integer, got: ${s}`);if(s<0)throw RangeError(`dims[${r}] must be a non-negative integer, got: ${s}`);t*=s}return t},t.tensorReshape=(e,t)=>{switch(e.location){case"cpu":return new s.Tensor(e.type,e.data,t);case"cpu-pinned":return new s.Tensor({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new s.Tensor({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new s.Tensor({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new s.Tensor({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw Error(`tensorReshape: tensor location ${e.location} is not supported`)}}},5045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tensor=void 0;let s=r(53904);t.Tensor=s.Tensor},24262:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRACE_FUNC_END=t.TRACE_FUNC_BEGIN=t.TRACE=void 0;let s=r(87621);t.TRACE=(e,t)=>{(void 0===s.env.trace?!s.env.wasm.trace:!s.env.trace)||console.timeStamp(`${e}::ORT::${t}`)};let o=(e,r)=>{let s=Error().stack?.split(/\r\n|\r|\n/g)||[],o=!1;for(let a=0;a<s.length;a++){if(o&&!s[a].includes("TRACE_FUNC")){let o=`FUNC_${e}::${s[a].trim().split(" ")[1]}`;r&&(o+=`::${r}`),(0,t.TRACE)("CPU",o);return}s[a].includes("TRACE_FUNC")&&(o=!0)}};t.TRACE_FUNC_BEGIN=e=>{(void 0===s.env.trace?!s.env.wasm.trace:!s.env.trace)||o("BEGIN",e)},t.TRACE_FUNC_END=e=>{(void 0===s.env.trace?!s.env.wasm.trace:!s.env.trace)||o("END",e)}},35039:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="1.21.0"},5994:(e,t,r)=>{"use strict";r.d(t,{DefaultEmbeddingFunction:()=>ee});var s={};r.r(s),r.d(s,{InferenceSession:()=>G,TRACE:()=>D,TRACE_FUNC_BEGIN:()=>V,TRACE_FUNC_END:()=>B,Tensor:()=>N,env:()=>b,registerBackend:()=>_});var o=new(r(43350))({strict:!1,allErrors:!0}),a={"amazon-bedrock":{$schema:"http://json-schema.org/draft-07/schema#",title:"Amazon Bedrock Embedding Function Schema",description:"Schema for the Amazon Bedrock embedding function configuration",version:"1.0.0",type:"object",properties:{session_args:{type:"object",description:"The arguments to pass to the boto3 session"},model_name:{type:"string",description:"The name of the model to use for embeddings"},kwargs:{type:"object",description:"Additional arguments to pass to the Amazon Bedrock client"}},required:["session_args","model_name","kwargs"],additionalProperties:!1},"base-schema":{$schema:"http://json-schema.org/draft-07/schema#",title:"Embedding Function Base Schema",description:"Base schema for all embedding functions in Chroma",type:"object",properties:{version:{type:"string",description:"Schema version for the embedding function"},name:{type:"string",description:"Name of the embedding function"},config:{type:"object",description:"Configuration parameters for the embedding function"}},required:["version","name","config"],additionalProperties:!1},"chroma-langchain":{$schema:"http://json-schema.org/draft-07/schema#",title:"Langchain Embedding Function Schema",description:"Schema for the langchain embedding function configuration",version:"1.0.0",type:"object",properties:{embedding_function:{type:"string",description:"Parameter embedding_function for the langchain embedding function"}},required:["embedding_function"],additionalProperties:!1},cohere:{$schema:"http://json-schema.org/draft-07/schema#",title:"Cohere Embedding Function Schema",description:"Schema for the Cohere embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Cohere API"}},required:["api_key_env_var","model_name"],additionalProperties:!1},default:{$schema:"http://json-schema.org/draft-07/schema#",title:"Default Embedding Function Schema",description:"Schema for the default embedding function configuration",version:"1.0.0",type:"object",properties:{},required:[],additionalProperties:!1},"google-generative-ai":{$schema:"http://json-schema.org/draft-07/schema#",title:"Google Generative AI Embedding Function Schema",description:"Schema for the Google Generative AI embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},task_type:{type:"string",description:"The task type for the embeddings (e.g., RETRIEVAL_DOCUMENT)"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Google Generative AI API"}},required:["api_key_env_var","model_name","task_type"],additionalProperties:!1},"google-palm":{$schema:"http://json-schema.org/draft-07/schema#",title:"Google PaLM Embedding Function Schema",description:"Schema for the Google PaLM embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Google PaLM API"}},required:["api_key_env_var","model_name"],additionalProperties:!1},"google-vertex":{$schema:"http://json-schema.org/draft-07/schema#",title:"Google Vertex Embedding Function Schema",description:"Schema for the Google Vertex embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},project_id:{type:"string",description:"The Google Cloud project ID"},region:{type:"string",description:"The Google Cloud region"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Google Vertex API"}},required:["api_key_env_var","model_name","project_id","region"],additionalProperties:!1},huggingface:{$schema:"http://json-schema.org/draft-07/schema#",title:"HuggingFace Embedding Function Schema",description:"Schema for the HuggingFace embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the HuggingFace API"}},required:["api_key_env_var","model_name"],additionalProperties:!1},"huggingface-server":{$schema:"http://json-schema.org/draft-07/schema#",title:"HuggingFace Embedding Server Schema",description:"Schema for the HuggingFace embedding server configuration",version:"1.0.0",type:"object",properties:{url:{type:"string",description:"The URL of the HuggingFace Embedding Server"},api_key_env_var:{type:"string",description:"The environment variable name that contains your API key for the HuggingFace API"}},required:["url"],additionalProperties:!1},instructor:{$schema:"http://json-schema.org/draft-07/schema#",title:"Instructor Embedding Function Schema",description:"Schema for the instructor embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Parameter model_name for the instructor embedding function"},device:{type:"string",description:"Parameter device for the instructor embedding function"},instruction:{type:"string",description:"Parameter instruction for the instructor embedding function"}},required:["model_name","device"],additionalProperties:!1},jina:{$schema:"http://json-schema.org/draft-07/schema#",title:"Jina Embedding Function Schema",description:"Schema for the jina embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Parameter model_name for the jina embedding function"},api_key_env_var:{type:"string",description:"Parameter api_key_env_var for the jina embedding function"},task:{type:"string",description:"Parameter task for the jina embedding function"},late_chunking:{type:"boolean",description:"Parameter late_chunking for the jina embedding function"},truncate:{type:"boolean",description:"Parameter truncate for the jina embedding function"},dimensions:{type:"integer",description:"Parameter dimensions for the jina embedding function"},embedding_type:{type:"string",description:"Parameter embedding_type for the jina embedding function"},normalized:{type:"boolean",description:"Parameter normalized for the jina embedding function"}},required:["api_key_env_var","model_name"],additionalProperties:!1},ollama:{$schema:"http://json-schema.org/draft-07/schema#",title:"Ollama Embedding Function Schema",description:"Schema for the Ollama embedding function configuration",version:"1.0.0",type:"object",properties:{url:{type:"string",description:"The URL of the Ollama server"},model_name:{type:"string",description:"The name of the model to use for embeddings"},timeout:{type:"integer",description:"Timeout in seconds for the API request"}},required:["url","model_name"],additionalProperties:!1},"onnx-mini-lm-l6-v2":{$schema:"http://json-schema.org/draft-07/schema#",title:"Onnx_mini_lm_l6_v2 Embedding Function Schema",description:"Schema for the onnx_mini_lm_l6_v2 embedding function configuration",version:"1.0.0",type:"object",properties:{preferred_providers:{type:"array",items:{type:"string"},description:"Parameter preferred_providers for the onnx_mini_lm_l6_v2 embedding function"}},required:[],additionalProperties:!1},"open-clip":{$schema:"http://json-schema.org/draft-07/schema#",title:"Open_clip Embedding Function Schema",description:"Schema for the open_clip embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Parameter model_name for the open_clip embedding function"},checkpoint:{type:"string",description:"Parameter checkpoint for the open_clip embedding function"},device:{type:"string",description:"Parameter device for the open_clip embedding function"}},required:["model_name","checkpoint","device"],additionalProperties:!1},openai:{$schema:"http://json-schema.org/draft-07/schema#",title:"OpenAI Embedding Function Schema",description:"Schema for the OpenAI embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},organization_id:{type:["string","null"],description:"The OpenAI organization ID if applicable"},api_base:{type:["string","null"],description:"The base path for the API"},api_type:{type:["string","null"],description:"The type of the API deployment"},api_version:{type:["string","null"],description:"The api version for the API"},deployment_id:{type:["string","null"],description:"Deployment ID for Azure OpenAI"},default_headers:{type:["object","null"],description:"A mapping of default headers to be sent with each API request"},dimensions:{type:["integer","null"],description:"The number of dimensions for the embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the OpenAI API"}},required:["api_key_env_var","model_name"],additionalProperties:!1},roboflow:{$schema:"http://json-schema.org/draft-07/schema#",title:"Roboflow Embedding Function Schema",description:"Schema for the roboflow embedding function configuration",version:"1.0.0",type:"object",properties:{api_url:{type:"string",description:"Parameter api_url for the roboflow embedding function"},api_key_env_var:{type:"string",description:"Parameter api_key_env_var for the roboflow embedding function"}},required:["api_key_env_var","api_url"],additionalProperties:!1},"sentence-transformer":{$schema:"http://json-schema.org/draft-07/schema#",title:"SentenceTransformer Embedding Function Schema",description:"Schema for the SentenceTransformer embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Identifier of the SentenceTransformer model"},device:{type:"string",description:"Device used for computation"},normalize_embeddings:{type:"boolean",description:"Whether to normalize returned vectors"},kwargs:{type:"object",description:"Additional arguments to pass to the SentenceTransformer model",additionalProperties:{type:["string","integer","number","boolean","array","object"]}}},required:["model_name","device","normalize_embeddings"],additionalProperties:!1},text2vec:{$schema:"http://json-schema.org/draft-07/schema#",title:"Text2vec Embedding Function Schema",description:"Schema for the text2vec embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Parameter model_name for the text2vec embedding function"}},required:["model_name"],additionalProperties:!1},transformers:{$schema:"http://json-schema.org/draft-07/schema#",title:"Transformers Embedding Function Schema",description:"Schema for the Transformers embedding function configuration",version:"1.0.0",type:"object",properties:{model:{type:"string",description:"Identifier of the SentenceTransformer model"},revision:{type:"string",description:"Specific model version to use (can be a branch, tag name, or commit id)"},quantized:{type:"boolean",description:"Whether to load the 8-bit quantized version of the model"}},required:["model","revision","quantized"],additionalProperties:!1},voyageai:{$schema:"http://json-schema.org/draft-07/schema#",title:"Voyageai Embedding Function Schema",description:"Schema for the voyageai embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"Parameter model_name for the voyageai embedding function"},api_key_env_var:{type:"string",description:"Parameter api_key_env_var for the voyageai embedding function"},input_type:{type:"string",description:"Parameter input_type for the voyageai embedding function"},truncation:{type:"boolean",description:"Parameter truncation for the voyageai embedding function"}},required:["api_key_env_var","model_name"],additionalProperties:!1},"cloudflare-worker-ai":{$schema:"http://json-schema.org/draft-07/schema#",title:"Cloudflare Workers AI Embedding Function Schema",description:"Schema for the Cloudflare Workers AI embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},account_id:{type:"string",description:"The account ID for the Cloudflare Workers AI API"},api_key_env_var:{type:"string",description:"The environment variable name that contains your API key for the Cloudflare Workers AI API"},gateway_id:{type:"string",description:"The ID of the Cloudflare AI Gateway to use for a more customized solution"}},required:["api_key_env_var","model_name","account_id"],additionalProperties:!1},"together-ai":{$schema:"http://json-schema.org/draft-07/schema#",title:"Together AI Embedding Function Schema",description:"Schema for the Together AI embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for text embeddings"},api_key_env_var:{type:"string",description:"The environment variable name that contains your API key for the Together AI API"}},required:["api_key_env_var","model_name"],additionalProperties:!1},mistral:{$schema:"http://json-schema.org/draft-07/schema#",title:"Mistral Embedding Function Schema",description:"Schema for the Mistral embedding function configuration",version:"1.0.0",type:"object",properties:{model:{type:"string",description:"Parameter model for the Mistral embedding function"},api_key_env_var:{type:"string",description:"Parameter api_key_env_var for the Mistral embedding function"}},required:["api_key_env_var","model"],additionalProperties:!1},morph:{$schema:"http://json-schema.org/draft-07/schema#",title:"Morph Embedding Function Schema",description:"Schema for the Morph embedding function configuration",version:"1.0.0",type:"object",properties:{model_name:{type:"string",description:"The name of the model to use for embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Morph API"},api_base:{type:["string","null"],description:"The base URL for the Morph API"},encoding_format:{type:["string","null"],description:"The format for embeddings (float or base64)"}},required:["api_key_env_var","model_name"],additionalProperties:!1},"chroma-cloud-qwen":{$schema:"http://json-schema.org/draft-07/schema#",title:"Chroma Cloud Qwen Embedding Function Schema",description:"Schema for the Chroma Cloud Qwen embedding function configuration",version:"1.0.0",type:"object",properties:{model:{type:"string",enum:["Qwen/Qwen3-Embedding-0.6B"],description:"The specific Qwen model to use for embeddings"},task:{type:"string",enum:["nl_to_code"],description:"The task for which embeddings are being generated"},instructions:{type:"object",description:"A mapping of tasks to instructions for targets (documents/queries)",properties:{nl_to_code:{type:"object",properties:{documents:{type:"string",description:"Instructions for embedding documents"},query:{type:"string",description:"Instructions for embedding queries"}},required:["documents","query"],additionalProperties:!1}},required:["nl_to_code"],additionalProperties:!1},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Chroma Embedding API",default:"CHROMA_API_KEY"}},required:["model","task"],additionalProperties:!1},"chroma-cloud-splade":{$schema:"http://json-schema.org/draft-07/schema#",title:"Chroma Cloud Splade Embedding Function Schema",description:"Schema for the Chroma Cloud Splade sparse embedding function configuration",version:"1.0.0",type:"object",properties:{model:{type:"string",enum:["prithivida/Splade_PP_en_v1"],description:"The specific Splade model to use for sparse embeddings"},api_key_env_var:{type:"string",description:"Environment variable name that contains your API key for the Chroma Embedding API",default:"CHROMA_API_KEY"}},required:["api_key_env_var","model"],additionalProperties:!1},chroma_bm25:{$schema:"http://json-schema.org/draft-07/schema#",title:"Chroma BM25 Embedding Function Schema",description:"Schema for the Chroma BM25 sparse embedding function configuration",version:"1.0.0",type:"object",properties:{k:{type:"number",description:"BM25 saturation parameter controlling term frequency scaling"},b:{type:"number",description:"BM25 length normalization parameter"},avg_doc_length:{type:"number",description:"Average document length in tokens used for normalization"},token_max_length:{type:"number",description:"Maximum token length allowed before filtering"},stopwords:{type:"array",description:"Optional custom stopword list (in lowercase) to override the defaults",items:{type:"string"}}},additionalProperties:!1}},n=e=>e.replace(/([A-Z])/g,"_$1").toLowerCase(),i=e=>Array.isArray(e)?e.map(i):null!==e&&"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,t])=>[n(e),i(t)])):e,l=r(87561),c=r.t(l,2),d=r(49411),u=r.t(d,2),m=r(41041),p=r.t(m,2);let h=new Map,f=[],_=(e,t,r)=>{if(t&&"function"==typeof t.init&&"function"==typeof t.createInferenceSessionHandler){let s=h.get(e);if(void 0===s)h.set(e,{backend:t,priority:r});else if(s.priority>r)return;else if(s.priority===r&&s.backend!==t)throw Error(`cannot register backend "${e}" using priority ${r}`);if(r>=0){let t=f.indexOf(e);-1!==t&&f.splice(t,1);for(let t=0;t<f.length;t++)if(h.get(f[t]).priority<=r){f.splice(t,0,e);return}f.push(e)}return}throw TypeError("not a valid backend")},g=async e=>{let t=h.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(e){return r||(t.error=`${e}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},M=async e=>{let t;let r=e.executionProviders||[],s=r.map(e=>"string"==typeof e?e:e.name),o=0===s.length?f:s,a=[],n=new Set;for(let e of o){let r=await g(e);"string"==typeof r?a.push({name:e,err:r}):(t||(t=r),t===r&&n.add(e))}if(!t)throw Error(`no available backend found. ERR: ${a.map(e=>`[${e.name}] ${e.err}`).join(", ")}`);for(let{name:e,err:t}of a)s.includes(e)&&console.warn(`removing requested execution provider "${e}" from session options because it is not available: ${t}`);let i=r.filter(e=>n.has("string"==typeof e?e:e.name));return[t,new Proxy(e,{get:(e,t)=>"executionProviders"===t?i:Reflect.get(e,t)})]},y="warning",w={wasm:{},webgl:{},webgpu:{},versions:{common:"1.21.0"},set logLevel(value){if(void 0===value)return;if("string"!=typeof value||-1===["verbose","info","warning","error","fatal"].indexOf(value))throw Error(`Unsupported logging level: ${value}`);y=value},get logLevel(){return y}};Object.defineProperty(w,"logLevel",{enumerable:!0});let b=w,v=(e,t)=>{let r="undefined"!=typeof document?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let s=r.getContext("2d");if(null!=s){let o,a,n,i;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[3]):(o=e.dims[3],a=e.dims[2]);let l=t?.format!==void 0?t.format:"RGB",c=t?.norm;void 0===c||void 0===c.mean?n=[255,255,255,255]:"number"==typeof c.mean?n=[c.mean,c.mean,c.mean,c.mean]:(n=[c.mean[0],c.mean[1],c.mean[2],0],void 0!==c.mean[3]&&(n[3]=c.mean[3])),void 0===c||void 0===c.bias?i=[0,0,0,0]:"number"==typeof c.bias?i=[c.bias,c.bias,c.bias,c.bias]:(i=[c.bias[0],c.bias[1],c.bias[2],0],void 0!==c.bias[3]&&(i[3]=c.bias[3]));let d=a*o,u=0,m=d,p=2*d,h=-1;"RGBA"===l?(u=0,m=d,p=2*d,h=3*d):"RGB"===l?(u=0,m=d,p=2*d):"RBG"===l&&(u=0,p=d,m=2*d);for(let t=0;t<a;t++)for(let r=0;r<o;r++){let o=(e.data[u++]-i[0])*n[0],a=(e.data[m++]-i[1])*n[1],l=(e.data[p++]-i[2])*n[2],c=-1===h?255:(e.data[h++]-i[3])*n[3];s.fillStyle="rgba("+o+","+a+","+l+","+c+")",s.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw Error("toDataURL is not supported")}throw Error("Can not access image data")},x=(e,t)=>{let r;let s="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null!=s){let o,a,n,i,l;t?.tensorLayout!==void 0&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[1],n=e.dims[3]):(o=e.dims[3],a=e.dims[2],n=e.dims[1]);let c=void 0!==t&&void 0!==t.format?t.format:"RGB",d=t?.norm;void 0===d||void 0===d.mean?i=[255,255,255,255]:"number"==typeof d.mean?i=[d.mean,d.mean,d.mean,d.mean]:(i=[d.mean[0],d.mean[1],d.mean[2],255],void 0!==d.mean[3]&&(i[3]=d.mean[3])),void 0===d||void 0===d.bias?l=[0,0,0,0]:"number"==typeof d.bias?l=[d.bias,d.bias,d.bias,d.bias]:(l=[d.bias[0],d.bias[1],d.bias[2],0],void 0!==d.bias[3]&&(l[3]=d.bias[3]));let u=a*o;if(void 0!==t&&(void 0!==t.format&&4===n&&"RGBA"!==t.format||3===n&&"RGB"!==t.format&&"BGR"!==t.format))throw Error("Tensor format doesn't match input tensor dims");let m=0,p=1,h=2,f=3,_=0,g=u,M=2*u,y=-1;"RGBA"===c?(_=0,g=u,M=2*u,y=3*u):"RGB"===c?(_=0,g=u,M=2*u):"RBG"===c&&(_=0,M=u,g=2*u),r=s.createImageData(o,a);for(let t=0;t<a*o;m+=4,p+=4,h+=4,f+=4,t++)r.data[m]=(e.data[_++]-l[0])*i[0],r.data[p]=(e.data[g++]-l[1])*i[1],r.data[h]=(e.data[M++]-l[2])*i[2],r.data[f]=-1===y?255:(e.data[y++]-l[3])*i[3]}else throw Error("Can not access image data");return r},P=(e,t)=>{let r,s;if(void 0===e)throw Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw Error("NHWC Tensor layout is not supported yet");let{height:o,width:a}=t,n=t.norm??{mean:255,bias:0};r="number"==typeof n.mean?[n.mean,n.mean,n.mean,n.mean]:[n.mean[0],n.mean[1],n.mean[2],n.mean[3]??255],s="number"==typeof n.bias?[n.bias,n.bias,n.bias,n.bias]:[n.bias[0],n.bias[1],n.bias[2],n.bias[3]??0];let i=void 0!==t.format?t.format:"RGBA",l=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",c=o*a,d=new Float32Array("RGBA"===l?4*c:3*c),u=4,m=0,p=1,h=2,f=3,_=0,g=c,M=2*c,y=-1;"RGB"===i&&(u=3,m=0,p=1,h=2,f=-1),"RGBA"===l?y=3*c:"RBG"===l?(_=0,M=c,g=2*c):"BGR"===l&&(M=0,g=c,_=2*c);for(let t=0;t<c;t++,m+=u,h+=u,p+=u,f+=u)d[_++]=(e[m]+s[0])/r[0],d[g++]=(e[p]+s[1])/r[1],d[M++]=(e[h]+s[2])/r[2],-1!==y&&-1!==f&&(d[y++]=(e[f]+s[3])/r[3]);return"RGBA"===l?new O("float32",d,[1,4,o,a]):new O("float32",d,[1,3,o,a])},T=async(e,t)=>{let r;let s="undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,o="undefined"!=typeof ImageData&&e instanceof ImageData,a="undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap,n="string"==typeof e,i=t??{},l=()=>{if("undefined"!=typeof document)return document.createElement("canvas");if("undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(1,1);throw Error("Canvas is not supported")},c=e=>"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement?e.getContext("2d"):e instanceof OffscreenCanvas?e.getContext("2d"):null;if(s){let s=l();s.width=e.width,s.height=e.height;let o=c(s);if(null!=o){let s=e.height,a=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(s=t.resizedHeight,a=t.resizedWidth),void 0!==t){if(i=t,void 0!==t.tensorFormat)throw Error("Image input config format must be RGBA for HTMLImageElement");i.tensorFormat="RGBA",i.height=s,i.width=a}else i.tensorFormat="RGBA",i.height=s,i.width=a;o.drawImage(e,0,0),r=o.getImageData(0,0,a,s).data}else throw Error("Can not access image data")}else if(o){let s,o;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(s=t.resizedHeight,o=t.resizedWidth):(s=e.height,o=e.width),void 0!==t&&(i=t),i.format="RGBA",i.height=s,i.width=o,void 0!==t){let t=l();t.width=o,t.height=s;let a=c(t);if(null!=a)a.putImageData(e,0,0),r=a.getImageData(0,0,o,s).data;else throw Error("Can not access image data")}else r=e.data}else if(a){if(void 0===t)throw Error("Please provide image config with format for Imagebitmap");let s=l();s.width=e.width,s.height=e.height;let o=c(s);if(null!=o){let t=e.height,s=e.width;return o.drawImage(e,0,0,s,t),r=o.getImageData(0,0,s,t).data,i.height=t,i.width=s,P(r,i)}throw Error("Can not access image data")}else if(n)return new Promise((t,r)=>{let s=l(),o=c(s);if(!e||!o)return r();let a=new Image;a.crossOrigin="Anonymous",a.src=e,a.onload=()=>{s.width=a.width,s.height=a.height,o.drawImage(a,0,0,s.width,s.height);let e=o.getImageData(0,0,s.width,s.height);i.height=s.height,i.width=s.width,t(P(e.data,i))}});else throw Error("Input data provided is not supported - aborted tensor creation");if(void 0!==r)return P(r,i);throw Error("Input data provided is not supported - aborted tensor creation")},k=(e,t)=>{let{width:r,height:s,download:o,dispose:a}=t;return new O({location:"texture",type:"float32",texture:e,dims:[1,s,r,4],download:o,dispose:a})},F=(e,t)=>{let{dataType:r,dims:s,download:o,dispose:a}=t;return new O({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:s,download:o,dispose:a})},S=(e,t)=>{let{dataType:r,dims:s,download:o,dispose:a}=t;return new O({location:"ml-tensor",type:r??"float32",mlTensor:e,dims:s,download:o,dispose:a})},C=(e,t,r)=>new O({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]}),E=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),A=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),I=!1,$=()=>{if(!I){I=!0;let e="undefined"!=typeof BigInt64Array&&BigInt64Array.from,t="undefined"!=typeof BigUint64Array&&BigUint64Array.from,r=globalThis.Float16Array,s=void 0!==r&&r.from;e&&(E.set("int64",BigInt64Array),A.set(BigInt64Array,"int64")),t&&(E.set("uint64",BigUint64Array),A.set(BigUint64Array,"uint64")),s?(E.set("float16",r),A.set(r,"float16")):E.set("float16",Uint16Array)}},L=e=>{let t=1;for(let r=0;r<e.length;r++){let s=e[r];if("number"!=typeof s||!Number.isSafeInteger(s))throw TypeError(`dims[${r}] must be an integer, got: ${s}`);if(s<0)throw RangeError(`dims[${r}] must be a non-negative integer, got: ${s}`);t*=s}return t},j=(e,t)=>{switch(e.location){case"cpu":return new O(e.type,e.data,t);case"cpu-pinned":return new O({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new O({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new O({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new O({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw Error(`tensorReshape: tensor location ${e.location} is not supported`)}};class O{constructor(e,t,r){let s,o;if($(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,s=e.type,o=e.dims,e.location){case"cpu-pinned":{let t=E.get(s);if(!t)throw TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==s)throw TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==s&&"float16"!==s&&"int32"!==s&&"int64"!==s&&"uint32"!==s&&"uint8"!==s&&"bool"!==s&&"uint4"!==s&&"int4"!==s)throw TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==s&&"float16"!==s&&"int32"!==s&&"int64"!==s&&"uint32"!==s&&"uint64"!==s&&"int8"!==s&&"uint8"!==s&&"bool"!==s&&"uint4"!==s&&"int4"!==s)throw TypeError(`unsupported type "${s}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,n;if("string"==typeof e){if(s=e,n=r,"string"===e){if(!Array.isArray(t))throw TypeError("A string tensor's data must be a string array.");a=t}else{let r=E.get(e);if(void 0===r)throw TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e&&r===Uint16Array||"uint4"===e||"int4"===e)throw TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${r.name} as data.`);a="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else if(t instanceof r)a=t;else if(t instanceof Uint8ClampedArray){if("uint8"===e)a=Uint8Array.from(t);else throw TypeError("A Uint8ClampedArray tensor's data must be type of uint8")}else if("float16"===e&&t instanceof Uint16Array&&r!==Uint16Array)a=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw TypeError(`A ${s} tensor's data must be type of ${r}`)}}else if(n=t,Array.isArray(e)){if(0===e.length)throw TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)s="string",a=e;else if("boolean"===t)s="bool",a=Uint8Array.from(e);else throw TypeError(`Invalid element type of data array: ${t}.`)}else if(e instanceof Uint8ClampedArray)s="uint8",a=Uint8Array.from(e);else{let t=A.get(e.constructor);if(void 0===t)throw TypeError(`Unsupported type for tensor data: ${e.constructor}.`);s=t,a=e}if(void 0===n)n=[a.length];else if(!Array.isArray(n))throw TypeError("A tensor's dims must be a number array");o=n,this.cpuData=a,this.dataLocation="cpu"}let a=L(o);if(this.cpuData&&a!==this.cpuData.length){if(("uint4"===s||"int4"===s)&&Math.ceil(a/2)===this.cpuData.length);else throw Error(`Tensor's size(${a}) does not match data length(${this.cpuData.length}).`)}this.type=s,this.dims=o,this.size=a}static async fromImage(e,t){return T(e,t)}static fromTexture(e,t){return k(e,t)}static fromGpuBuffer(e,t){return F(e,t)}static fromMLTensor(e,t){return S(e,t)}static fromPinnedBuffer(e,t,r){return C(e,t,r)}toDataURL(e){return v(this,e)}toImageData(e){return x(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw Error("Cannot reshape a tensor that owns GPU resource.");return j(this,e)}}let N=O,D=(e,t)=>{(void 0===w.trace?!w.wasm.trace:!w.trace)||console.timeStamp(`${e}::ORT::${t}`)},z=(e,t)=>{let r=Error().stack?.split(/\r\n|\r|\n/g)||[],s=!1;for(let o=0;o<r.length;o++){if(s&&!r[o].includes("TRACE_FUNC")){let s=`FUNC_${e}::${r[o].trim().split(" ")[1]}`;t&&(s+=`::${t}`),D("CPU",s);return}r[o].includes("TRACE_FUNC")&&(s=!0)}},V=e=>{(void 0===w.trace?!w.wasm.trace:!w.trace)||z("BEGIN",e)},B=e=>{(void 0===w.trace?!w.wasm.trace:!w.trace)||z("END",e)};class R{constructor(e){this.handler=e}async run(e,t,r){V();let s={},o={};if("object"!=typeof e||null===e||e instanceof N||Array.isArray(e))throw TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if("object"==typeof t){if(null===t)throw TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof N)throw TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw TypeError("'fetches' cannot be an empty array.");for(let e of(a=!1,t)){if("string"!=typeof e)throw TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw RangeError(`'fetches' contains invalid output name: ${e}.`);s[e]=null}if("object"==typeof r&&null!==r)o=r;else if(void 0!==r)throw TypeError("'options' must be an object.")}else{let e=!1,n=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==n.indexOf(r)){let o=t[r];(null===o||o instanceof N)&&(e=!0,a=!1,s[r]=o)}if(e){if("object"==typeof r&&null!==r)o=r;else if(void 0!==r)throw TypeError("'options' must be an object.")}else o=t}}else if(void 0!==t)throw TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(void 0===e[t])throw Error(`input '${t}' is missing in 'feeds'.`);if(a)for(let e of this.outputNames)s[e]=null;let n=await this.handler.run(e,s,o),i={};for(let e in n)if(Object.hasOwnProperty.call(n,e)){let t=n[e];t instanceof N?i[e]=t:i[e]=new N(t.type,t.data,t.dims)}return B(),i}async release(){return this.handler.dispose()}static async create(e,t,r,s){let o;V();let a={};if("string"==typeof e){if(o=e,"object"==typeof t&&null!==t)a=t;else if(void 0!==t)throw TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(o=e,"object"==typeof t&&null!==t)a=t;else if(void 0!==t)throw TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer){let n=0,i=e.byteLength;if("object"==typeof t&&null!==t)a=t;else if("number"==typeof t){if(!Number.isSafeInteger(n=t))throw RangeError("'byteOffset' must be an integer.");if(n<0||n>=e.byteLength)throw RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(i=e.byteLength-n,"number"==typeof r){if(!Number.isSafeInteger(i=r))throw RangeError("'byteLength' must be an integer.");if(i<=0||n+i>e.byteLength)throw RangeError(`'byteLength' is out of range (0, ${e.byteLength-n}].`);if("object"==typeof s&&null!==s)a=s;else if(void 0!==s)throw TypeError("'options' must be an object.")}else if(void 0!==r)throw TypeError("'byteLength' must be a number.")}else if(void 0!==t)throw TypeError("'options' must be an object.");o=new Uint8Array(e,n,i)}else throw TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[n,i]=await M(a),l=await n.createInferenceSessionHandler(o,i);return B(),new R(l)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}let G=R;var q=r(56536),U=r.t(q,2),W=r(57441),H=r.t(W,2),Q={"node:fs":e=>{e.exports=c},"node:path":e=>{e.exports=u},"node:url":e=>{e.exports=p},"onnxruntime-common":e=>{e.exports=s},"onnxruntime-node":e=>{e.exports=U},sharp:e=>{e.exports=H},"?8b6b":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,t,r)=>{r.r(t),r.d(t,{Environment:()=>ei,Interpreter:()=>ed,Template:()=>ep,parse:()=>R,tokenize:()=>d});var s=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),o=class{constructor(e,t){this.value=e,this.type=t}};function a(e){return/\w/.test(e)}function n(e){return/[0-9]/.test(e)}function i(e){return/\s/.test(e)}var l=[["{%",s.OpenStatement],["%}",s.CloseStatement],["{{",s.OpenExpression],["}}",s.CloseExpression],["(",s.OpenParen],[")",s.CloseParen],["{",s.OpenCurlyBracket],["}",s.CloseCurlyBracket],["[",s.OpenSquareBracket],["]",s.CloseSquareBracket],[",",s.Comma],[".",s.Dot],[":",s.Colon],["|",s.Pipe],["<=",s.ComparisonBinaryOperator],[">=",s.ComparisonBinaryOperator],["==",s.ComparisonBinaryOperator],["!=",s.ComparisonBinaryOperator],["<",s.ComparisonBinaryOperator],[">",s.ComparisonBinaryOperator],["+",s.AdditiveBinaryOperator],["-",s.AdditiveBinaryOperator],["~",s.AdditiveBinaryOperator],["*",s.MultiplicativeBinaryOperator],["/",s.MultiplicativeBinaryOperator],["%",s.MultiplicativeBinaryOperator],["=",s.Equals]],c=new Map([["n","\n"],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function d(e,t={}){let r=[],d=function(e,t={}){return e.endsWith("\n")&&(e=e.slice(0,-1)),t.lstrip_blocks&&(e=e.replace(/^[ \t]*({[#%-])/gm,"$1")),t.trim_blocks&&(e=e.replace(/([#%-]})\n/g,"$1")),e.replace(/{%\s*(end)?generation\s*%}/gs,"")}(e,t),u=0,m=0,p=e=>{let t="";for(;e(d[u]);){if("\\"===d[u]){if(++u>=d.length)throw SyntaxError("Unexpected end of input");let e=d[u++],r=c.get(e);if(void 0===r)throw SyntaxError(`Unexpected escaped character: ${e}`);t+=r;continue}if(t+=d[u++],u>=d.length)throw SyntaxError("Unexpected end of input")}return t},h=()=>{let e=r.at(-1);e&&e.type===s.Text&&(e.value=e.value.trimEnd(),""===e.value&&r.pop())},f=()=>{for(;u<d.length&&i(d[u]);)++u};e:for(;u<d.length;){let e=r.at(-1)?.type;if(void 0===e||e===s.CloseStatement||e===s.CloseExpression||e===s.Comment){let e="";for(;u<d.length&&!("{"===d[u]&&("%"===d[u+1]||"{"===d[u+1]||"#"===d[u+1]));)e+=d[u++];if(e.length>0){r.push(new o(e,s.Text));continue}}if("{"===d[u]&&"#"===d[u+1]){let e="-"===d[u+=2];e&&++u;let t="";for(;"#"!==d[u]||"}"!==d[u+1];){if(u+2>=d.length)throw SyntaxError("Missing end of comment tag");t+=d[u++]}let a=t.endsWith("-");a&&(t=t.slice(0,-1)),e&&h(),r.push(new o(t,s.Comment)),u+=2,a&&f();continue}if("{%-"===d.slice(u,u+3)){h(),r.push(new o("{%",s.OpenStatement)),u+=3;continue}if("{{-"===d.slice(u,u+3)){h(),r.push(new o("{{",s.OpenExpression)),m=0,u+=3;continue}if(p(i),"-%}"===d.slice(u,u+3)){r.push(new o("%}",s.CloseStatement)),u+=3,f();continue}if("-}}"===d.slice(u,u+3)){r.push(new o("}}",s.CloseExpression)),u+=3,f();continue}let t=d[u];if("-"===t||"+"===t){let e=r.at(-1)?.type;if(e===s.Text||void 0===e)throw SyntaxError(`Unexpected character: ${t}`);switch(e){case s.Identifier:case s.NumericLiteral:case s.StringLiteral:case s.CloseParen:case s.CloseSquareBracket:break;default:{++u;let e=p(n);r.push(new o(`${t}${e}`,e.length>0?s.NumericLiteral:s.UnaryOperator));continue}}}for(let[e,t]of l)if(("}}"!==e||!(m>0))&&d.slice(u,u+e.length)===e){r.push(new o(e,t)),t===s.OpenExpression?m=0:t===s.OpenCurlyBracket?++m:t===s.CloseCurlyBracket&&--m,u+=e.length;continue e}if("'"===t||'"'===t){++u;let e=p(e=>e!==t);r.push(new o(e,s.StringLiteral)),++u;continue}if(n(t)){let e=p(n);if("."===d[u]&&n(d[u+1])){++u;let t=p(n);e=`${e}.${t}`}r.push(new o(e,s.NumericLiteral));continue}if(a(t)){let e=p(a);r.push(new o(e,s.Identifier));continue}throw SyntaxError(`Unexpected character: ${t}`)}return r}var u=class{type="Statement"},m=class extends u{constructor(e){super(),this.body=e}type="Program"},p=class extends u{constructor(e,t,r){super(),this.test=e,this.body=t,this.alternate=r}type="If"},h=class extends u{constructor(e,t,r,s){super(),this.loopvar=e,this.iterable=t,this.body=r,this.defaultBlock=s}type="For"},f=class extends u{type="Break"},_=class extends u{type="Continue"},g=class extends u{constructor(e,t,r){super(),this.assignee=e,this.value=t,this.body=r}type="Set"},M=class extends u{constructor(e,t,r){super(),this.name=e,this.args=t,this.body=r}type="Macro"},y=class extends u{constructor(e){super(),this.value=e}type="Comment"},w=class extends u{type="Expression"},b=class extends w{constructor(e,t,r){super(),this.object=e,this.property=t,this.computed=r}type="MemberExpression"},v=class extends w{constructor(e,t){super(),this.callee=e,this.args=t}type="CallExpression"},x=class extends w{constructor(e){super(),this.value=e}type="Identifier"},P=class extends w{constructor(e){super(),this.value=e}type="Literal"},T=class extends P{type="IntegerLiteral"},k=class extends P{type="FloatLiteral"},F=class extends P{type="StringLiteral"},S=class extends P{type="ArrayLiteral"},C=class extends P{type="TupleLiteral"},E=class extends P{type="ObjectLiteral"},A=class extends w{constructor(e,t,r){super(),this.operator=e,this.left=t,this.right=r}type="BinaryExpression"},I=class extends w{constructor(e,t){super(),this.operand=e,this.filter=t}type="FilterExpression"},$=class extends u{constructor(e,t){super(),this.filter=e,this.body=t}type="FilterStatement"},L=class extends w{constructor(e,t){super(),this.lhs=e,this.test=t}type="SelectExpression"},j=class extends w{constructor(e,t,r){super(),this.operand=e,this.negate=t,this.test=r}type="TestExpression"},O=class extends w{constructor(e,t){super(),this.operator=e,this.argument=t}type="UnaryExpression"},N=class extends w{constructor(e,t,r){super(),this.start=e,this.stop=t,this.step=r}type="SliceExpression"},D=class extends w{constructor(e,t){super(),this.key=e,this.value=t}type="KeywordArgumentExpression"},z=class extends w{constructor(e){super(),this.argument=e}type="SpreadExpression"},V=class extends u{constructor(e,t,r){super(),this.call=e,this.callerArgs=t,this.body=r}type="CallStatement"},B=class extends w{constructor(e,t,r){super(),this.condition=e,this.trueExpr=t,this.falseExpr=r}type="Ternary"};function R(e){let t=new m([]),r=0;function a(t,s){let o=e[r++];if(!o||o.type!==t)throw Error(`Parser Error: ${s}. ${o.type} !== ${t}.`);return o}function n(e){if(!c(e))throw SyntaxError(`Expected ${e}`);++r}function i(...t){return r+t.length<=e.length&&t.every((t,s)=>t===e[r+s].type)}function l(...t){return e[r]?.type===s.OpenStatement&&e[r+1]?.type===s.Identifier&&t.includes(e[r+1]?.value)}function c(...t){return r+t.length<=e.length&&t.every((t,s)=>"Identifier"===e[r+s].type&&t===e[r+s].value)}function d(e=!1){let t=e?X:u,o=[t()],a=i(s.Comma);for(;a&&(++r,o.push(t()),i(s.Comma)););return a?new C(o):o[0]}function u(){return function e(){let t=w();if(c("if")){++r;let s=w();return c("else")?(++r,new B(s,t,e())):new L(t,s)}return t}()}function w(){let t=P();for(;c("or");){let s=e[r];++r,t=new A(s,t,P())}return t}function P(){let t=R();for(;c("and");){let s=e[r];++r,t=new A(s,t,R())}return t}function R(){let t;for(;c("not");){let s=e[r];++r,t=new O(s,R())}return t??function(){let t=G();for(;;){let a;if(c("not","in"))a=new o("not in",s.Identifier),r+=2;else if(c("in"))a=e[r++];else if(i(s.ComparisonBinaryOperator))a=e[r++];else break;t=new A(a,t,G())}return t}()}function G(){let t=H();for(;i(s.AdditiveBinaryOperator);){let s=e[r];++r,t=new A(s,t,H())}return t}function q(e){let t=new v(e,U());return t=W(t),i(s.OpenParen)&&(t=q(t)),t}function U(){a(s.OpenParen,"Expected opening parenthesis for arguments list");let t=function(){let t=[];for(;!i(s.CloseParen);){let o;if(e[r].type===s.MultiplicativeBinaryOperator&&"*"===e[r].value)++r,o=new z(u());else if(o=u(),i(s.Equals)){if(++r,!(o instanceof x))throw SyntaxError("Expected identifier for keyword argument");o=new D(o,u())}t.push(o),i(s.Comma)&&++r}return t}();return a(s.CloseParen,"Expected closing parenthesis for arguments list"),t}function W(t){for(;i(s.Dot)||i(s.OpenSquareBracket);){let o;let n=e[r];++r;let l=n.type===s.OpenSquareBracket;if(l)o=function(){let e=[],t=!1;for(;!i(s.CloseSquareBracket);)i(s.Colon)?(e.push(void 0),++r,t=!0):(e.push(u()),i(s.Colon)&&(++r,t=!0));if(0===e.length)throw SyntaxError("Expected at least one argument for member/slice expression");if(t){if(e.length>3)throw SyntaxError("Expected 0-3 arguments for slice expression");return new N(...e)}return e[0]}(),a(s.CloseSquareBracket,"Expected closing square bracket");else if("Identifier"!==(o=X()).type)throw SyntaxError("Expected identifier following dot operator");t=new b(t,o,l)}return t}function H(){let t=Q();for(;i(s.MultiplicativeBinaryOperator);)t=new A(e[r++],t,Q());return t}function Q(){let e=function(){let e=function(){let e=W(X());return i(s.OpenParen)?q(e):e}();for(;i(s.Pipe);){++r;let t=X();if(!(t instanceof x))throw SyntaxError("Expected identifier for the filter");i(s.OpenParen)&&(t=q(t)),e=new I(e,t)}return e}();for(;c("is");){++r;let t=c("not");t&&++r;let s=X();if(!(s instanceof x))throw SyntaxError("Expected identifier for the test");e=new j(e,t,s)}return e}function X(){let t=e[r++];switch(t.type){case s.NumericLiteral:{let e=t.value;return e.includes(".")?new k(Number(e)):new T(Number(e))}case s.StringLiteral:{let o=t.value;for(;i(s.StringLiteral);)o+=e[r++].value;return new F(o)}case s.Identifier:return new x(t.value);case s.OpenParen:{let e=d();return a(s.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),e}case s.OpenSquareBracket:{let e=[];for(;!i(s.CloseSquareBracket);)e.push(u()),i(s.Comma)&&++r;return++r,new S(e)}case s.OpenCurlyBracket:{let e=new Map;for(;!i(s.CloseCurlyBracket);){let t=u();a(s.Colon,"Expected colon between key and value in object literal");let o=u();e.set(t,o),i(s.Comma)&&++r}return++r,new E(e)}default:throw SyntaxError(`Unexpected token: ${t.type}`)}}for(;r<e.length;)t.body.push(function t(){switch(e[r].type){case s.Comment:return new y(e[r++].value);case s.Text:return new F(a(s.Text,"Expected text token").value);case s.OpenStatement:return function(){let o;if(a(s.OpenStatement,"Expected opening statement token"),e[r].type!==s.Identifier)throw SyntaxError(`Unknown statement, got ${e[r].type}`);let m=e[r].value;switch(m){case"set":++r,o=function(){let e=d(),o=null,c=[];if(i(s.Equals))++r,o=d();else{for(a(s.CloseStatement,"Expected %} token");!l("endset");)c.push(t());a(s.OpenStatement,"Expected {% token"),n("endset")}return a(s.CloseStatement,"Expected closing statement token"),new g(e,o,c)}();break;case"if":++r,o=function e(){let o=u();a(s.CloseStatement,"Expected closing statement token");let n=[],i=[];for(;!l("elif","else","endif");)n.push(t());if(l("elif")){++r,++r;let t=e();i.push(t)}else if(l("else"))for(++r,++r,a(s.CloseStatement,"Expected closing statement token");!l("endif");)i.push(t());return new p(o,n,i)}(),a(s.OpenStatement,"Expected {% token"),n("endif"),a(s.CloseStatement,"Expected %} token");break;case"macro":++r,o=function(){let e=X();if("Identifier"!==e.type)throw SyntaxError("Expected identifier following macro statement");let r=U();a(s.CloseStatement,"Expected closing statement token");let o=[];for(;!l("endmacro");)o.push(t());return new M(e,r,o)}(),a(s.OpenStatement,"Expected {% token"),n("endmacro"),a(s.CloseStatement,"Expected %} token");break;case"for":++r,o=function(){let e=d(!0);if(!(e instanceof x||e instanceof C))throw SyntaxError(`Expected identifier/tuple for the loop variable, got ${e.type} instead`);if(!c("in"))throw SyntaxError("Expected `in` keyword following loop variable");++r;let o=u();a(s.CloseStatement,"Expected closing statement token");let n=[];for(;!l("endfor","else");)n.push(t());let i=[];if(l("else"))for(++r,++r,a(s.CloseStatement,"Expected closing statement token");!l("endfor");)i.push(t());return new h(e,o,n,i)}(),a(s.OpenStatement,"Expected {% token"),n("endfor"),a(s.CloseStatement,"Expected %} token");break;case"call":{++r;let e=null;i(s.OpenParen)&&(e=U());let c=X();if("Identifier"!==c.type)throw SyntaxError("Expected identifier following call statement");let d=U();a(s.CloseStatement,"Expected closing statement token");let u=[];for(;!l("endcall");)u.push(t());a(s.OpenStatement,"Expected '{%'"),n("endcall"),a(s.CloseStatement,"Expected closing statement token"),o=new V(new v(c,d),e,u);break}case"break":++r,a(s.CloseStatement,"Expected closing statement token"),o=new f;break;case"continue":++r,a(s.CloseStatement,"Expected closing statement token"),o=new _;break;case"filter":{++r;let e=X();e instanceof x&&i(s.OpenParen)&&(e=q(e)),a(s.CloseStatement,"Expected closing statement token");let c=[];for(;!l("endfilter");)c.push(t());a(s.OpenStatement,"Expected '{%'"),n("endfilter"),a(s.CloseStatement,"Expected '%}'"),o=new $(e,c);break}default:throw SyntaxError(`Unknown statement type: ${m}`)}return o}();case s.OpenExpression:return function(){a(s.OpenExpression,"Expected opening expression token");let e=u();return a(s.CloseExpression,"Expected closing expression token"),e}();default:throw SyntaxError(`Unexpected token type: ${e[r].type}`)}}());return t}function G(e,t,r=1){void 0===t&&(t=e,e=0);let s=[];for(let o=e;o<t;o+=r)s.push(o);return s}function q(e,t,r,s=1){let o=Math.sign(s);o>=0?(t=(t??=0)<0?Math.max(e.length+t,0):Math.min(t,e.length),r=(r??=e.length)<0?Math.max(e.length+r,0):Math.min(r,e.length)):(t=(t??=e.length-1)<0?Math.max(e.length+t,-1):Math.min(t,e.length-1),r=(r??=-1)<-1?Math.max(e.length+r,-1):Math.min(r,e.length-1));let a=[];for(let n=t;o*n<o*r;n+=s)a.push(e[n]);return a}function U(e){return function(e,t){let r=new Intl.DateTimeFormat(void 0,{month:"long"}),s=new Intl.DateTimeFormat(void 0,{month:"short"}),o=e=>e<10?"0"+e:e.toString();return t.replace(/%[YmdbBHM%]/g,t=>{switch(t){case"%Y":return e.getFullYear().toString();case"%m":return o(e.getMonth()+1);case"%d":return o(e.getDate());case"%b":return s.format(e);case"%B":return r.format(e);case"%H":return o(e.getHours());case"%M":return o(e.getMinutes());case"%%":return"%";default:return t}})}(new Date,e)}var W=class extends Error{},H=class extends Error{},Q=class{type="RuntimeValue";value;builtins=new Map;constructor(e){this.value=e}__bool__(){return new Y(!!this.value)}toString(){return String(this.value)}},X=class extends Q{type="IntegerValue"},J=class extends Q{type="FloatValue";toString(){return this.value%1==0?this.value.toFixed(1):this.value.toString()}},K=class extends Q{type="StringValue";builtins=new Map([["upper",new eo(()=>new K(this.value.toUpperCase()))],["lower",new eo(()=>new K(this.value.toLowerCase()))],["strip",new eo(()=>new K(this.value.trim()))],["title",new eo(()=>new K(this.value.replace(/\b\w/g,e=>e.toUpperCase())))],["capitalize",new eo(()=>new K(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new X(this.value.length)],["rstrip",new eo(()=>new K(this.value.trimEnd()))],["lstrip",new eo(()=>new K(this.value.trimStart()))],["startswith",new eo(e=>{if(0===e.length)throw Error("startswith() requires at least one argument");let t=e[0];if(t instanceof K)return new Y(this.value.startsWith(t.value));if(t instanceof er){for(let e of t.value){if(!(e instanceof K))throw Error("startswith() tuple elements must be strings");if(this.value.startsWith(e.value))return new Y(!0)}return new Y(!1)}throw Error("startswith() argument must be a string or tuple of strings")})],["endswith",new eo(e=>{if(0===e.length)throw Error("endswith() requires at least one argument");let t=e[0];if(t instanceof K)return new Y(this.value.endsWith(t.value));if(t instanceof er){for(let e of t.value){if(!(e instanceof K))throw Error("endswith() tuple elements must be strings");if(this.value.endsWith(e.value))return new Y(!0)}return new Y(!1)}throw Error("endswith() argument must be a string or tuple of strings")})],["split",new eo(e=>{let t=e[0]??new ea;if(!(t instanceof K||t instanceof ea))throw Error("sep argument must be a string or null");let r=e[1]??new X(-1);if(!(r instanceof X))throw Error("maxsplit argument must be a number");let s=[];if(t instanceof ea){let e=this.value.trimStart();for(let{0:t,index:o}of e.matchAll(/\S+/g)){if(-1!==r.value&&s.length>=r.value&&void 0!==o){s.push(t+e.slice(o+t.length));break}s.push(t)}}else{if(""===t.value)throw Error("empty separator");s=this.value.split(t.value),-1!==r.value&&s.length>r.value&&s.push(s.splice(r.value).join(t.value))}return new er(s.map(e=>new K(e)))})],["replace",new eo(e=>{let t;if(e.length<2)throw Error("replace() requires at least two arguments");let r=e[0],s=e[1];if(!(r instanceof K&&s instanceof K))throw Error("replace() arguments must be strings");if(!((t=e.length>2?"KeywordArgumentsValue"===e[2].type?e[2].value.get("count")??new ea:e[2]:new ea)instanceof X||t instanceof ea))throw Error("replace() count argument must be a number or null");return new K(function(e,t,r,s){if(0===s)return e;let o=null==s||s<0?1/0:s,a=0===t.length?RegExp("(?=)","gu"):RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gu");return e.replaceAll(a,e=>o>0?(--o,r):e)}(this.value,r.value,s.value,t.value))})]])},Y=class extends Q{type="BooleanValue"};function Z(e,t,r,s=!0){let o=r??0;switch(e.type){case"NullValue":return"null";case"UndefinedValue":return s?"null":"undefined";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(e.value);case"ArrayValue":case"ObjectValue":{let r=t?" ".repeat(t):"",a="\n"+r.repeat(o),n=a+r;if("ArrayValue"===e.type){let r=e.value.map(e=>Z(e,t,o+1,s));return t?`[${n}${r.join(`,${n}`)}${a}]`:`[${r.join(", ")}]`}{let r=Array.from(e.value.entries()).map(([e,r])=>{let a=`"${e}": ${Z(r,t,o+1,s)}`;return t?`${n}${a}`:a});return t?`{${r.join(",")}${a}}`:`{${r.join(", ")}}`}}default:throw Error(`Cannot convert to JSON: ${e.type}`)}}var ee=class extends Q{type="ObjectValue";__bool__(){return new Y(this.value.size>0)}builtins=new Map([["get",new eo(([e,t])=>{if(!(e instanceof K))throw Error(`Object key must be a string: got ${e.type}`);return this.value.get(e.value)??t??new ea})],["items",new eo(()=>this.items())],["keys",new eo(()=>this.keys())],["values",new eo(()=>this.values())],["dictsort",new eo(e=>{let t=new Map,r=e.filter(e=>!(e instanceof et)||(t=e.value,!1)),s=r.at(0)??t.get("case_sensitive")??new Y(!1);if(!(s instanceof Y))throw Error("case_sensitive must be a boolean");let o=r.at(1)??t.get("by")??new K("key");if(!(o instanceof K))throw Error("by must be a string");if(!["key","value"].includes(o.value))throw Error("by must be either 'key' or 'value'");let a=r.at(2)??t.get("reverse")??new Y(!1);if(!(a instanceof Y))throw Error("reverse must be a boolean");let n=Array.from(this.value.entries()).map(([e,t])=>new er([new K(e),t])).sort((e,t)=>{let r="key"===o.value?0:1,n=ec(e.value[r],t.value[r],s.value);return a.value?-n:n});return new er(n)})]]);items(){return new er(Array.from(this.value.entries()).map(([e,t])=>new er([new K(e),t])))}keys(){return new er(Array.from(this.value.keys()).map(e=>new K(e)))}values(){return new er(Array.from(this.value.values()))}toString(){return Z(this,null,0,!1)}},et=class extends ee{type="KeywordArgumentsValue"},er=class extends Q{type="ArrayValue";builtins=new Map([["length",new X(this.value.length)]]);__bool__(){return new Y(this.value.length>0)}toString(){return Z(this,null,0,!1)}},es=class extends er{type="TupleValue"},eo=class extends Q{type="FunctionValue"},ea=class extends Q{type="NullValue"},en=class extends Q{type="UndefinedValue"},ei=class{constructor(e){this.parent=e}variables=new Map([["namespace",new eo(e=>{if(0===e.length)return new ee(new Map);if(1!==e.length||!(e[0]instanceof ee))throw Error("`namespace` expects either zero arguments or a single object argument");return e[0]})]]);tests=new Map([["boolean",e=>"BooleanValue"===e.type],["callable",e=>e instanceof eo],["odd",e=>{if(!(e instanceof X))throw Error(`cannot odd on ${e.type}`);return e.value%2!=0}],["even",e=>{if(!(e instanceof X))throw Error(`cannot even on ${e.type}`);return e.value%2==0}],["false",e=>"BooleanValue"===e.type&&!e.value],["true",e=>"BooleanValue"===e.type&&e.value],["none",e=>"NullValue"===e.type],["string",e=>"StringValue"===e.type],["number",e=>e instanceof X||e instanceof J],["integer",e=>e instanceof X],["iterable",e=>"ArrayValue"===e.type||"StringValue"===e.type],["mapping",e=>"ObjectValue"===e.type],["lower",e=>{let t=e.value;return"StringValue"===e.type&&t===t.toLowerCase()}],["upper",e=>{let t=e.value;return"StringValue"===e.type&&t===t.toUpperCase()}],["none",e=>"NullValue"===e.type],["defined",e=>"UndefinedValue"!==e.type],["undefined",e=>"UndefinedValue"===e.type],["equalto",(e,t)=>e.value===t.value],["eq",(e,t)=>e.value===t.value]]);set(e,t){return this.declareVariable(e,function e(t){switch(typeof t){case"number":return Number.isInteger(t)?new X(t):new J(t);case"string":return new K(t);case"boolean":return new Y(t);case"undefined":return new en;case"object":if(null===t)return new ea;if(Array.isArray(t))return new er(t.map(e));return new ee(new Map(Object.entries(t).map(([t,r])=>[t,e(r)])));case"function":return new eo((r,s)=>e(t(...r.map(e=>e.value))??null));default:throw Error(`Cannot convert to runtime value: ${t}`)}}(t))}declareVariable(e,t){if(this.variables.has(e))throw SyntaxError(`Variable already declared: ${e}`);return this.variables.set(e,t),t}setVariable(e,t){return this.variables.set(e,t),t}resolve(e){if(this.variables.has(e))return this;if(this.parent)return this.parent.resolve(e);throw Error(`Unknown variable: ${e}`)}lookupVariable(e){try{return this.resolve(e).variables.get(e)??new en}catch{return new en}}};function el(e,t){let r=t.split("."),s=e;for(let e of r)if(s instanceof ee)s=s.value.get(e)??new en;else{if(!(s instanceof er))return new en;let t=parseInt(e,10);if(isNaN(t)||!(t>=0)||!(t<s.value.length))return new en;s=s.value[t]}return s}function ec(e,t,r=!1){if(e instanceof ea&&t instanceof ea)return 0;if(e instanceof ea||t instanceof ea)throw Error(`Cannot compare ${e.type} with ${t.type}`);if(e instanceof en&&t instanceof en)return 0;if(e instanceof en||t instanceof en)throw Error(`Cannot compare ${e.type} with ${t.type}`);let s=e=>e instanceof Y?e.value?1:0:e.value;if((e instanceof X||e instanceof J||e instanceof Y)&&(t instanceof X||t instanceof J||t instanceof Y)){let r=s(e),o=s(t);return r<o?-1:r>o?1:0}if(e.type!==t.type)throw Error(`Cannot compare different types: ${e.type} and ${t.type}`);if("StringValue"===e.type){let s=e.value,o=t.value;return r||(s=s.toLowerCase(),o=o.toLowerCase()),s<o?-1:s>o?1:0}throw Error(`Cannot compare type: ${e.type}`)}var ed=class{global;constructor(e){this.global=e??new ei}run(e){return this.evaluate(e,this.global)}evaluateBinaryExpression(e,t){let r=this.evaluate(e.left,t);switch(e.operator.value){case"and":return r.__bool__().value?this.evaluate(e.right,t):r;case"or":return r.__bool__().value?r:this.evaluate(e.right,t)}let s=this.evaluate(e.right,t);switch(e.operator.value){case"==":return new Y(r.value==s.value);case"!=":return new Y(r.value!=s.value)}if(r instanceof en||s instanceof en){if(s instanceof en&&["in","not in"].includes(e.operator.value))return new Y("not in"===e.operator.value);throw Error(`Cannot perform operation ${e.operator.value} on undefined values`)}if(r instanceof ea||s instanceof ea)throw Error("Cannot perform operation on null values");if("~"===e.operator.value)return new K(r.value.toString()+s.value.toString());if((r instanceof X||r instanceof J)&&(s instanceof X||s instanceof J)){let t=r.value,o=s.value;switch(e.operator.value){case"+":case"-":case"*":{let a="+"===e.operator.value?t+o:"-"===e.operator.value?t-o:t*o;return r instanceof J||s instanceof J?new J(a):new X(a)}case"/":return new J(t/o);case"%":{let e=t%o;return r instanceof J||s instanceof J?new J(e):new X(e)}case"<":return new Y(t<o);case">":return new Y(t>o);case">=":return new Y(t>=o);case"<=":return new Y(t<=o)}}else if(r instanceof er&&s instanceof er){if("+"===e.operator.value)return new er(r.value.concat(s.value))}else if(s instanceof er){let t=void 0!==s.value.find(e=>e.value===r.value);switch(e.operator.value){case"in":return new Y(t);case"not in":return new Y(!t)}}if((r instanceof K||s instanceof K)&&"+"===e.operator.value)return new K(r.value.toString()+s.value.toString());if(r instanceof K&&s instanceof K)switch(e.operator.value){case"in":return new Y(s.value.includes(r.value));case"not in":return new Y(!s.value.includes(r.value))}if(r instanceof K&&s instanceof ee)switch(e.operator.value){case"in":return new Y(s.value.has(r.value));case"not in":return new Y(!s.value.has(r.value))}throw SyntaxError(`Unknown operator "${e.operator.value}" between ${r.type} and ${s.type}`)}evaluateArguments(e,t){let r=[],s=new Map;for(let o of e)if("SpreadExpression"===o.type){let e=this.evaluate(o.argument,t);if(!(e instanceof er))throw Error(`Cannot unpack non-iterable type: ${e.type}`);for(let t of e.value)r.push(t)}else if("KeywordArgumentExpression"===o.type)s.set(o.key.value,this.evaluate(o.value,t));else{if(s.size>0)throw Error("Positional arguments must come before keyword arguments");r.push(this.evaluate(o,t))}return[r,s]}applyFilter(e,t,r){if("Identifier"===t.type){if("tojson"===t.value)return new K(Z(e));if(e instanceof er)switch(t.value){case"list":return e;case"first":return e.value[0];case"last":return e.value[e.value.length-1];case"length":return new X(e.value.length);case"reverse":return new er(e.value.slice().reverse());case"sort":return new er(e.value.slice().sort((e,t)=>ec(e,t,!1)));case"join":return new K(e.value.map(e=>e.value).join(""));case"string":return new K(Z(e,null,0,!1));case"unique":{let t=new Set,r=[];for(let s of e.value)t.has(s.value)||(t.add(s.value),r.push(s));return new er(r)}default:throw Error(`Unknown ArrayValue filter: ${t.value}`)}else if(e instanceof K)switch(t.value){case"length":case"upper":case"lower":case"title":case"capitalize":{let s=e.builtins.get(t.value);if(s instanceof eo)return s.value([],r);if(s instanceof X)return s;throw Error(`Unknown StringValue filter: ${t.value}`)}case"trim":return new K(e.value.trim());case"indent":return new K(e.value.split("\n").map((e,t)=>0===t||0===e.length?e:"    "+e).join("\n"));case"join":case"string":return e;case"int":{let t=parseInt(e.value,10);return new X(isNaN(t)?0:t)}case"float":{let t=parseFloat(e.value);return new J(isNaN(t)?0:t)}default:throw Error(`Unknown StringValue filter: ${t.value}`)}else if(e instanceof X||e instanceof J)switch(t.value){case"abs":return e instanceof X?new X(Math.abs(e.value)):new J(Math.abs(e.value));case"int":return new X(Math.floor(e.value));case"float":return new J(e.value);default:throw Error(`Unknown NumericValue filter: ${t.value}`)}else if(e instanceof ee)switch(t.value){case"items":return new er(Array.from(e.value.entries()).map(([e,t])=>new er([new K(e),t])));case"length":return new X(e.value.size);default:{let s=e.builtins.get(t.value);if(s){if(s instanceof eo)return s.value([],r);return s}throw Error(`Unknown ObjectValue filter: ${t.value}`)}}else if(e instanceof Y)switch(t.value){case"bool":return new Y(e.value);case"int":return new X(e.value?1:0);case"float":return new J(e.value?1:0);case"string":return new K(e.value?"true":"false");default:throw Error(`Unknown BooleanValue filter: ${t.value}`)}throw Error(`Cannot apply filter "${t.value}" to type: ${e.type}`)}if("CallExpression"===t.type){if("Identifier"!==t.callee.type)throw Error(`Unknown filter: ${t.callee.type}`);let s=t.callee.value;if("tojson"===s){let[,s]=this.evaluateArguments(t.args,r),o=s.get("indent")??new ea;if(!(o instanceof X||o instanceof ea))throw Error("If set, indent must be a number");return new K(Z(e,o.value))}if("join"===s){let o;if(e instanceof K)o=Array.from(e.value);else if(e instanceof er)o=e.value.map(e=>e.value);else throw Error(`Cannot apply filter "${s}" to type: ${e.type}`);let[a,n]=this.evaluateArguments(t.args,r),i=a.at(0)??n.get("separator")??new K("");if(!(i instanceof K))throw Error("separator must be a string");return new K(o.join(i.value))}if("int"===s||"float"===s){let[o,a]=this.evaluateArguments(t.args,r),n=o.at(0)??a.get("default")??("int"===s?new X(0):new J(0));if(e instanceof K){let t="int"===s?parseInt(e.value,10):parseFloat(e.value);return isNaN(t)?n:"int"===s?new X(t):new J(t)}if(e instanceof X||e instanceof J)return e;if(e instanceof Y)return"int"===s?new X(e.value?1:0):new J(e.value?1:0);throw Error(`Cannot apply filter "${s}" to type: ${e.type}`)}if("default"===s){let[s,o]=this.evaluateArguments(t.args,r),a=s[0]??new K(""),n=s[1]??o.get("boolean")??new Y(!1);if(!(n instanceof Y))throw Error("`default` filter flag must be a boolean");return e instanceof en||n.value&&!e.__bool__().value?a:e}if(e instanceof er){switch(s){case"sort":{let[s,o]=this.evaluateArguments(t.args,r),a=s.at(0)??o.get("reverse")??new Y(!1);if(!(a instanceof Y))throw Error("reverse must be a boolean");let n=s.at(1)??o.get("case_sensitive")??new Y(!1);if(!(n instanceof Y))throw Error("case_sensitive must be a boolean");let i=s.at(2)??o.get("attribute")??new ea;if(!(i instanceof K||i instanceof X||i instanceof ea))throw Error("attribute must be a string, integer, or null");let l=e=>i instanceof ea?e:el(e,i instanceof X?String(i.value):i.value);return new er(e.value.slice().sort((e,t)=>{let r=ec(l(e),l(t),n.value);return a.value?-r:r}))}case"selectattr":case"rejectattr":{let o;let a="selectattr"===s;if(e.value.some(e=>!(e instanceof ee)))throw Error(`\`${s}\` can only be applied to array of objects`);if(t.args.some(e=>"StringLiteral"!==e.type))throw Error(`arguments of \`${s}\` must be strings`);let[n,i,l]=t.args.map(e=>this.evaluate(e,r));if(i){let e=r.tests.get(i.value);if(!e)throw Error(`Unknown test: ${i.value}`);o=e}else o=(...e)=>e[0].__bool__().value;return new er(e.value.filter(e=>{let t=e.value.get(n.value),r=!!t&&o(t,l);return a?r:!r}))}case"map":{let[,s]=this.evaluateArguments(t.args,r);if(s.has("attribute")){let t=s.get("attribute");if(!(t instanceof K))throw Error("attribute must be a string");let r=s.get("default");return new er(e.value.map(e=>{if(!(e instanceof ee))throw Error("items in map must be an object");let s=el(e,t.value);return s instanceof en?r??new en:s}))}throw Error("`map` expressions without `attribute` set are not currently supported.")}}throw Error(`Unknown ArrayValue filter: ${s}`)}if(e instanceof K){switch(s){case"indent":{let[s,o]=this.evaluateArguments(t.args,r),a=s.at(0)??o.get("width")??new X(4);if(!(a instanceof X))throw Error("width must be a number");let n=s.at(1)??o.get("first")??new Y(!1),i=s.at(2)??o.get("blank")??new Y(!1),l=e.value.split("\n"),c=" ".repeat(a.value);return new K(l.map((e,t)=>(n.value||0!==t)&&(i.value||0!==e.length)?c+e:e).join("\n"))}case"replace":{let s=e.builtins.get("replace");if(!(s instanceof eo))throw Error("replace filter not available");let[o,a]=this.evaluateArguments(t.args,r);return s.value([...o,new et(a)],r)}}throw Error(`Unknown StringValue filter: ${s}`)}if(e instanceof ee){let o=e.builtins.get(s);if(o&&o instanceof eo){let[e,s]=this.evaluateArguments(t.args,r);return s.size>0&&e.push(new et(s)),o.value(e,r)}throw Error(`Unknown ObjectValue filter: ${s}`)}throw Error(`Cannot apply filter "${s}" to type: ${e.type}`)}throw Error(`Unknown filter: ${t.type}`)}evaluateFilterExpression(e,t){let r=this.evaluate(e.operand,t);return this.applyFilter(r,e.filter,t)}evaluateTestExpression(e,t){let r=this.evaluate(e.operand,t),s=t.tests.get(e.test.value);if(!s)throw Error(`Unknown test: ${e.test.value}`);let o=s(r);return new Y(e.negate?!o:o)}evaluateSelectExpression(e,t){return this.evaluate(e.test,t).__bool__().value?this.evaluate(e.lhs,t):new en}evaluateUnaryExpression(e,t){let r=this.evaluate(e.argument,t);if("not"===e.operator.value)return new Y(!r.value);throw SyntaxError(`Unknown operator: ${e.operator.value}`)}evaluateTernaryExpression(e,t){return this.evaluate(e.condition,t).__bool__().value?this.evaluate(e.trueExpr,t):this.evaluate(e.falseExpr,t)}evalProgram(e,t){return this.evaluateBlock(e.body,t)}evaluateBlock(e,t){let r="";for(let s of e){let e=this.evaluate(s,t);"NullValue"!==e.type&&"UndefinedValue"!==e.type&&(r+=e.toString())}return new K(r)}evaluateIdentifier(e,t){return t.lookupVariable(e.value)}evaluateCallExpression(e,t){let[r,s]=this.evaluateArguments(e.args,t);s.size>0&&r.push(new et(s));let o=this.evaluate(e.callee,t);if("FunctionValue"!==o.type)throw Error(`Cannot call something that is not a function: got ${o.type}`);return o.value(r,t)}evaluateSliceExpression(e,t,r){if(!(e instanceof er||e instanceof K))throw Error("Slice object must be an array or string");let s=this.evaluate(t.start,r),o=this.evaluate(t.stop,r),a=this.evaluate(t.step,r);if(!(s instanceof X||s instanceof en))throw Error("Slice start must be numeric or undefined");if(!(o instanceof X||o instanceof en))throw Error("Slice stop must be numeric or undefined");if(!(a instanceof X||a instanceof en))throw Error("Slice step must be numeric or undefined");return e instanceof er?new er(q(e.value,s.value,o.value,a.value)):new K(q(Array.from(e.value),s.value,o.value,a.value).join(""))}evaluateMemberExpression(e,t){let r,s;let o=this.evaluate(e.object,t);if(e.computed){if("SliceExpression"===e.property.type)return this.evaluateSliceExpression(o,e.property,t);r=this.evaluate(e.property,t)}else r=new K(e.property.value);if(o instanceof ee){if(!(r instanceof K))throw Error(`Cannot access property with non-string: got ${r.type}`);s=o.value.get(r.value)??o.builtins.get(r.value)}else if(o instanceof er||o instanceof K){if(r instanceof X)s=o.value.at(r.value),o instanceof K&&(s=new K(o.value.at(r.value)));else if(r instanceof K)s=o.builtins.get(r.value);else throw Error(`Cannot access property with non-string/non-number: got ${r.type}`)}else{if(!(r instanceof K))throw Error(`Cannot access property with non-string: got ${r.type}`);s=o.builtins.get(r.value)}return s instanceof Q?s:new en}evaluateSet(e,t){let r=e.value?this.evaluate(e.value,t):this.evaluateBlock(e.body,t);if("Identifier"===e.assignee.type){let s=e.assignee.value;t.setVariable(s,r)}else if("TupleLiteral"===e.assignee.type){let s=e.assignee;if(!(r instanceof er))throw Error(`Cannot unpack non-iterable type in set: ${r.type}`);let o=r.value;if(o.length!==s.value.length)throw Error(`Too ${s.value.length>o.length?"few":"many"} items to unpack in set`);for(let e=0;e<s.value.length;++e){let r=s.value[e];if("Identifier"!==r.type)throw Error(`Cannot unpack to non-identifier in set: ${r.type}`);t.setVariable(r.value,o[e])}}else if("MemberExpression"===e.assignee.type){let s=e.assignee,o=this.evaluate(s.object,t);if(!(o instanceof ee))throw Error("Cannot assign to member of non-object");if("Identifier"!==s.property.type)throw Error("Cannot assign to member with non-identifier property");o.value.set(s.property.value,r)}else throw Error(`Invalid LHS inside assignment expression: ${JSON.stringify(e.assignee)}`);return new ea}evaluateIf(e,t){let r=this.evaluate(e.test,t);return this.evaluateBlock(r.__bool__().value?e.body:e.alternate,t)}evaluateFor(e,t){let r,s;let o=new ei(t);if("SelectExpression"===e.iterable.type){let t=e.iterable;s=this.evaluate(t.lhs,o),r=t.test}else s=this.evaluate(e.iterable,o);if(!(s instanceof er||s instanceof ee))throw Error(`Expected iterable or object type in for loop: got ${s.type}`);s instanceof ee&&(s=s.keys());let a=[],n=[];for(let t=0;t<s.value.length;++t){let i;let l=new ei(o),c=s.value[t];if("Identifier"===e.loopvar.type)i=t=>t.setVariable(e.loopvar.value,c);else if("TupleLiteral"===e.loopvar.type){let t=e.loopvar;if("ArrayValue"!==c.type)throw Error(`Cannot unpack non-iterable type: ${c.type}`);if(t.value.length!==c.value.length)throw Error(`Too ${t.value.length>c.value.length?"few":"many"} items to unpack`);i=e=>{for(let r=0;r<t.value.length;++r){if("Identifier"!==t.value[r].type)throw Error(`Cannot unpack non-identifier type: ${t.value[r].type}`);e.setVariable(t.value[r].value,c.value[r])}}}else throw Error(`Invalid loop variable(s): ${e.loopvar.type}`);(!r||(i(l),this.evaluate(r,l).__bool__().value))&&(a.push(c),n.push(i))}let i="",l=!0;for(let t=0;t<a.length;++t){let r=new Map([["index",new X(t+1)],["index0",new X(t)],["revindex",new X(a.length-t)],["revindex0",new X(a.length-t-1)],["first",new Y(0===t)],["last",new Y(t===a.length-1)],["length",new X(a.length)],["previtem",t>0?a[t-1]:new en],["nextitem",t<a.length-1?a[t+1]:new en]]);o.setVariable("loop",new ee(r)),n[t](o);try{let t=this.evaluateBlock(e.body,o);i+=t.value}catch(e){if(e instanceof H)continue;if(e instanceof W)break;throw e}l=!1}return l&&(i+=this.evaluateBlock(e.defaultBlock,o).value),new K(i)}evaluateMacro(e,t){return t.setVariable(e.name.value,new eo((t,r)=>{let s;let o=new ei(r);t=t.slice(),t.at(-1)?.type==="KeywordArgumentsValue"&&(s=t.pop());for(let r=0;r<e.args.length;++r){let a=e.args[r],n=t[r];if("Identifier"===a.type){if(!n)throw Error(`Missing positional argument: ${a.value}`);o.setVariable(a.value,n)}else if("KeywordArgumentExpression"===a.type){let e=n??s?.value.get(a.key.value)??this.evaluate(a.value,o);o.setVariable(a.key.value,e)}else throw Error(`Unknown argument type: ${a.type}`)}return this.evaluateBlock(e.body,o)})),new ea}evaluateCallStatement(e,t){let r=new eo((t,r)=>{let s=new ei(r);if(e.callerArgs)for(let r=0;r<e.callerArgs.length;++r){let o=e.callerArgs[r];if("Identifier"!==o.type)throw Error(`Caller parameter must be an identifier, got ${o.type}`);s.setVariable(o.value,t[r]??new en)}return this.evaluateBlock(e.body,s)}),[s,o]=this.evaluateArguments(e.call.args,t);s.push(new et(o));let a=this.evaluate(e.call.callee,t);if("FunctionValue"!==a.type)throw Error(`Cannot call something that is not a function: got ${a.type}`);let n=new ei(t);return n.setVariable("caller",r),a.value(s,n)}evaluateFilterStatement(e,t){let r=this.evaluateBlock(e.body,t);return this.applyFilter(r,e.filter,t)}evaluate(e,t){if(!e)return new en;switch(e.type){case"Program":return this.evalProgram(e,t);case"Set":return this.evaluateSet(e,t);case"If":return this.evaluateIf(e,t);case"For":return this.evaluateFor(e,t);case"Macro":return this.evaluateMacro(e,t);case"CallStatement":return this.evaluateCallStatement(e,t);case"Break":throw new W;case"Continue":throw new H;case"IntegerLiteral":return new X(e.value);case"FloatLiteral":return new J(e.value);case"StringLiteral":return new K(e.value);case"ArrayLiteral":return new er(e.value.map(e=>this.evaluate(e,t)));case"TupleLiteral":return new es(e.value.map(e=>this.evaluate(e,t)));case"ObjectLiteral":{let r=new Map;for(let[s,o]of e.value){let e=this.evaluate(s,t);if(!(e instanceof K))throw Error(`Object keys must be strings: got ${e.type}`);r.set(e.value,this.evaluate(o,t))}return new ee(r)}case"Identifier":return this.evaluateIdentifier(e,t);case"CallExpression":return this.evaluateCallExpression(e,t);case"MemberExpression":return this.evaluateMemberExpression(e,t);case"UnaryExpression":return this.evaluateUnaryExpression(e,t);case"BinaryExpression":return this.evaluateBinaryExpression(e,t);case"FilterExpression":return this.evaluateFilterExpression(e,t);case"FilterStatement":return this.evaluateFilterStatement(e,t);case"TestExpression":return this.evaluateTestExpression(e,t);case"SelectExpression":return this.evaluateSelectExpression(e,t);case"Ternary":return this.evaluateTernaryExpression(e,t);case"Comment":return new ea;default:throw SyntaxError(`Unknown node type: ${e.type}`)}}};function eu(...e){return"{%- "+e.join(" ")+" -%}"}function em(e,t=-1){switch(e.type){case"SpreadExpression":return`*${em(e.argument)}`;case"Identifier":return e.value;case"IntegerLiteral":case"FloatLiteral":return`${e.value}`;case"StringLiteral":return JSON.stringify(e.value);case"BinaryExpression":{let r=function(e){switch(e.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":if("and"===e.operator.value)return 1;if("in"===e.operator.value||"not in"===e.operator.value)return 2}return 0}(e),s=em(e.left,r),o=em(e.right,r+1),a=`${s} ${e.operator.value} ${o}`;return r<t?`(${a})`:a}case"UnaryExpression":return e.operator.value+("not"===e.operator.value?" ":"")+em(e.argument,1/0);case"CallExpression":{let t=e.args.map(em).join(", ");return`${em(e.callee)}(${t})`}case"MemberExpression":{let t=em(e.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(e.object.type)||(t=`(${t})`);let r=em(e.property);return e.computed||"Identifier"===e.property.type||(r=`(${r})`),e.computed?`${t}[${r}]`:`${t}.${r}`}case"FilterExpression":{let t=em(e.operand,1/0);if("CallExpression"===e.filter.type)return`${t} | ${em(e.filter)}`;return`${t} | ${e.filter.value}`}case"SelectExpression":return`${em(e.lhs)} if ${em(e.test)}`;case"TestExpression":return`${em(e.operand)} is${e.negate?" not":""} ${e.test.value}`;case"ArrayLiteral":case"TupleLiteral":{let t=e.value.map(em),r="ArrayLiteral"===e.type?"[]":"()";return`${r[0]}${t.join(", ")}${r[1]}`}case"ObjectLiteral":{let t=Array.from(e.value.entries()).map(([e,t])=>`${em(e)}: ${em(t)}`);return`{${t.join(", ")}}`}case"SliceExpression":{let t=e.start?em(e.start):"",r=e.stop?em(e.stop):"",s=e.step?`:${em(e.step)}`:"";return`${t}:${r}${s}`}case"KeywordArgumentExpression":return`${e.key.value}=${em(e.value)}`;case"Ternary":{let r=`${em(e.trueExpr)} if ${em(e.condition,0)} else ${em(e.falseExpr)}`;return t>-1?`(${r})`:r}default:throw Error(`Unknown expression type: ${e.type}`)}}var ep=class{parsed;constructor(e){let t=d(e,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=R(t)}render(e){let t=new ei;if(t.set("false",!1),t.set("true",!0),t.set("none",null),t.set("raise_exception",e=>{throw Error(e)}),t.set("range",G),t.set("strftime_now",U),t.set("True",!0),t.set("False",!1),t.set("None",null),e)for(let[r,s]of Object.entries(e))t.set(r,s);return new ed(t).run(this.parsed).value}format(e){return function(e,t="	"){let r="number"==typeof t?" ".repeat(t):t;return(function e(t,r,s){return t.map(t=>(function(t,r,s){let o=s.repeat(r);switch(t.type){case"Program":return e(t.body,r,s);case"If":return function(t,r,s){let o=s.repeat(r),a=[],n=t;for(;n;)if(a.push({test:n.test,body:n.body}),1===n.alternate.length&&"If"===n.alternate[0].type)n=n.alternate[0];else break;let i=o+eu("if",em(a[0].test))+"\n"+e(a[0].body,r+1,s);for(let t=1;t<a.length;++t)i+="\n"+o+eu("elif",em(a[t].test))+"\n"+e(a[t].body,r+1,s);return n&&n.alternate.length>0&&(i+="\n"+o+eu("else")+"\n"+e(n.alternate,r+1,s)),i+="\n"+o+eu("endif")}(t,r,s);case"For":return function(t,r,s){let o=s.repeat(r),a="";if("SelectExpression"===t.iterable.type){let e=t.iterable;a=`${em(e.lhs)} if ${em(e.test)}`}else a=em(t.iterable);let n=o+eu("for",em(t.loopvar),"in",a)+"\n"+e(t.body,r+1,s);return t.defaultBlock.length>0&&(n+="\n"+o+eu("else")+"\n"+e(t.defaultBlock,r+1,s)),n+="\n"+o+eu("endfor")}(t,r,s);case"Set":return function(t,r,s){let o=s.repeat(r),a=em(t.assignee),n=t.value?em(t.value):"",i=o+eu("set",`${a}${t.value?" = "+n:""}`);return 0===t.body.length?i:i+"\n"+e(t.body,r+1,s)+"\n"+o+eu("endset")}(t,r,s);case"Macro":return function(t,r,s){let o=s.repeat(r),a=t.args.map(em).join(", ");return o+eu("macro",`${t.name.value}(${a})`)+"\n"+e(t.body,r+1,s)+"\n"+o+eu("endmacro")}(t,r,s);case"Break":return o+eu("break");case"Continue":return o+eu("continue");case"CallStatement":return function(t,r,s){let o=s.repeat(r),a=t.callerArgs&&t.callerArgs.length>0?`(${t.callerArgs.map(em).join(", ")})`:"";return o+eu(`call${a}`,em(t.call))+"\n"+(e(t.body,r+1,s)+"\n")+(o+eu("endcall"))}(t,r,s);case"FilterStatement":return function(t,r,s){let o=s.repeat(r);return o+eu("filter","Identifier"===t.filter.type?t.filter.value:em(t.filter))+"\n"+(e(t.body,r+1,s)+"\n")+(o+eu("endfilter"))}(t,r,s);case"Comment":return o+"{# "+t.value+" #}";default:return o+"{{- "+em(t)+" -}}"}})(t,r,s)).join("\n")})(e.body,0,r).replace(/\n$/,"")}(this.parsed,e?.indent||"	")}}},"./src/backends/onnx.js":(e,t,r)=>{let s,o;r.r(t),r.d(t,{Tensor:()=>c.Tensor,createInferenceSession:()=>_,deviceToExecutionProviders:()=>h,isONNXProxy:()=>v,isONNXTensor:()=>w,runInferenceSession:()=>y});var a,n=r("./src/env.js"),i=r("onnxruntime-node"),l=r("?8b6b"),c=r("onnxruntime-common");let d=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),u=[],m=Symbol.for("onnxruntime");if(m in globalThis)o=globalThis[m];else if(n.apis.IS_NODE_ENV){switch(o=i.default??i,process.platform){case"win32":u.push("dml");break;case"linux":"x64"===process.arch&&u.push("cuda")}u.push("cpu"),s=["cpu"]}else o=a||(a=r.t(l,2)),n.apis.IS_WEBNN_AVAILABLE&&u.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),n.apis.IS_WEBGPU_AVAILABLE&&u.push("webgpu"),u.push("wasm"),s=["wasm"];let p=o.InferenceSession;function h(e=null){if(!e)return s;switch(e){case"auto":return u;case"gpu":return u.filter(e=>["webgpu","cuda","dml","webnn-gpu"].includes(e))}if(u.includes(e))return[d[e]??e];throw Error(`Unsupported device: "${e}". Should be one of: ${u.join(", ")}.`)}let f=null;async function _(e,t,r){f&&await f;let s=p.create(e,t);f??=s;let o=await s;return o.config=r,o}let g=Promise.resolve(),M=n.apis.IS_BROWSER_ENV||n.apis.IS_WEBWORKER_ENV;async function y(e,t){let r=()=>e.run(t);return await (M?g=g.then(r):r())}function w(e){return e instanceof o.Tensor}let b=o?.env;function v(){return b?.wasm?.proxy}b?.wasm&&("undefined"!=typeof ServiceWorkerGlobalScope&&self instanceof ServiceWorkerGlobalScope||b.wasm.wasmPaths||(b.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${n.env.version}/dist/`),b.wasm.proxy=!1),b?.webgpu&&(b.webgpu.powerPreference="high-performance"),n.env.backends.onnx=b},"./src/base/feature_extraction_utils.js":(e,t,r)=>{r.r(t),r.d(t,{FeatureExtractor:()=>n,validate_audio_inputs:()=>i});var s=r("./src/utils/constants.js"),o=r("./src/utils/generic.js"),a=r("./src/utils/hub.js");class n extends o.Callable{constructor(e){super(),this.config=e}static async from_pretrained(e,t={}){return new this(await (0,a.getModelJSON)(e,s.FEATURE_EXTRACTOR_NAME,!0,t))}}function i(e,t){if(!(e instanceof Float32Array||e instanceof Float64Array))throw Error(`${t} expects input to be a Float32Array or a Float64Array, but got ${e?.constructor?.name??typeof e} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(e,t,r)=>{r.r(t),r.d(t,{ImageProcessor:()=>_,center_to_corners_format:()=>u,post_process_instance_segmentation:()=>f,post_process_object_detection:()=>m,post_process_panoptic_segmentation:()=>h,post_process_semantic_segmentation:()=>p});var s=r("./src/utils/generic.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/maths.js");r("./src/utils/image.js");var n=r("./src/utils/core.js"),i=r("./src/utils/hub.js"),l=r("./src/utils/constants.js");function c(e,t,r=0,s=null){let o=e/t,n=(0,a.bankers_round)(o)*t;return null!==s&&n>s&&(n=Math.floor(o)*t),n<r&&(n=Math.ceil(o)*t),n}function d([e,t],r){return[Math.max(Math.floor(e/r),1)*r,Math.max(Math.floor(t/r),1)*r]}function u([e,t,r,s]){return[e-r/2,t-s/2,e+r/2,t+s/2]}function m(e,t=.5,r=null,s=!1){let o=e.logits,n=e.pred_boxes,[i,l,c]=o.dims;if(null!==r&&r.length!==i)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let d=[];for(let e=0;e<i;++e){let i=null!==r?r[e]:null,m={boxes:[],classes:[],scores:[]},p=o[e],h=n[e];for(let e=0;e<l;++e){let r,o=p[e],n=[];if(s){r=o.sigmoid().data;for(let e=0;e<r.length;++e)r[e]>t&&n.push(e)}else{let e=(0,a.max)(o.data)[1];if(e===c-1||(r=(0,a.softmax)(o.data))[e]<t)continue;n.push(e)}for(let t of n){let s=h[e].data;s=u(s),null!==i&&(s=s.map((e,t)=>e*i[(t+1)%2])),m.boxes.push(s),m.classes.push(t),m.scores.push(r[t])}}d.push(m)}return d}function p(e,t=null){let r=e.logits,s=r.dims[0];if(null!==t&&t.length!==s)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let a=[];for(let e=0;e<s;++e){let s=null!==t?t[e]:null,n=r[e];null!==s&&(n=(0,o.interpolate)(n,s,"bilinear",!1));let[i,l]=s??n.dims.slice(-2),c=new o.Tensor("int32",new Int32Array(i*l),[i,l]),d=n[0].data,u=c.data;for(let e=1;e<n.dims[0];++e){let t=n[e].data;for(let r=0;r<t.length;++r)t[r]>d[r]&&(d[r]=t[r],u[r]=e)}let m=Array(n.dims[0]);for(let e=0;e<u.length;++e){let t=u[e];m[t]=t}let p=m.filter(e=>void 0!==e);a.push({segmentation:c,labels:p})}return a}function h(e,t=.5,r=.5,s=.8,n=null,i=null){null===n&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),n=new Set);let l=e.class_queries_logits??e.logits,c=(e.masks_queries_logits??e.pred_masks).sigmoid(),[d,u,m]=l.dims;if(m-=1,null!==i&&i.length!==d)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let p=[];for(let e=0;e<d;++e){let d=null!==i?i[e]:null,u=l[e],h=c[e],[f,_,g]=function(e,t,r,s){let o=[],n=[],i=[];for(let l=0;l<e.dims[0];++l){let c=e[l],d=t[l],u=(0,a.max)(c.data)[1];if(u===s)continue;let m=(0,a.softmax)(c.data)[u];m>r&&(o.push(d),n.push(m),i.push(u))}return[o,n,i]}(u,h,t,m);if(0===g.length){let[e,t]=d??h.dims.slice(-2),r=new o.Tensor("int32",new Int32Array(e*t).fill(-1),[e,t]);p.push({segmentation:r,segments_info:[]});continue}let[M,y]=function(e,t,r,s,a,n=null,i=null){let[l,c]=i??e[0].dims,d=new o.Tensor("int32",new Int32Array(l*c),[l,c]),u=[];if(null!==i)for(let t=0;t<e.length;++t)e[t]=(0,o.interpolate)(e[t],i,"bilinear",!1);let m=new Int32Array(e[0].data.length),p=new Float32Array(e[0].data.length);for(let r=0;r<e.length;++r){let s=t[r],o=e[r].data;for(let e=0;e<o.length;++e)o[e]*=s,o[e]>p[e]&&(m[e]=r,p[e]=o[e])}let h=0,f=d.data;for(let o=0;o<r.length;++o){let n=r[o],[i,l]=function(e,t,r,s=.5,o=.8){let a=[],n=0,i=0,l=t[r].data;for(let t=0;t<e.length;++t)e[t]===r&&(a.push(t),++n),l[t]>=s&&++i;let c=n>0&&i>0;return c&&(c=n/i>o),[c,a]}(m,e,o,s,a);if(i){for(let e of(++h,l))f[e]=h;u.push({id:h,label_id:n,score:t[o]})}}return[d,u]}(f,_,g,r,s,n,d);p.push({segmentation:M,segments_info:y})}return p}function f(e,t=.5,r=null){throw Error("`post_process_instance_segmentation` is not yet implemented.")}class _ extends s.Callable{constructor(e){super(),this.image_mean=e.image_mean??e.mean,this.image_std=e.image_std??e.std,this.resample=e.resample??2,this.do_rescale=e.do_rescale??!0,this.rescale_factor=e.rescale_factor??1/255,this.do_normalize=e.do_normalize,this.do_thumbnail=e.do_thumbnail,this.size=e.size??e.image_size,this.do_resize=e.do_resize??void 0!==this.size,this.size_divisibility=e.size_divisibility??e.size_divisor,this.do_center_crop=e.do_center_crop,this.crop_size=e.crop_size,this.do_convert_rgb=e.do_convert_rgb??!0,this.do_crop_margin=e.do_crop_margin,this.pad_size=e.pad_size,this.do_pad=e.do_pad,this.min_pixels=e.min_pixels,this.max_pixels=e.max_pixels,this.do_pad&&!this.pad_size&&this.size&&void 0!==this.size.width&&void 0!==this.size.height&&(this.pad_size=this.size),this.do_flip_channel_order=e.do_flip_channel_order??!1,this.config=e}async thumbnail(e,t,r=2){let s=e.height,o=e.width,a=t.height,n=t.width,i=Math.min(s,a),l=Math.min(o,n);return i===s&&l===o?e:(s>o?l=Math.floor(o*i/s):o>s&&(i=Math.floor(s*l/o)),await e.resize(l,i,{resample:r}))}async crop_margin(e,t=200){let r=e.clone().grayscale(),s=(0,a.min)(r.data)[0],o=(0,a.max)(r.data)[0]-s;if(0===o)return e;let n=t/255,i=r.width,l=r.height,c=0,d=0,u=r.data;for(let e=0;e<r.height;++e){let t=e*r.width;for(let a=0;a<r.width;++a)(u[t+a]-s)/o<n&&(i=Math.min(i,a),l=Math.min(l,e),c=Math.max(c,a),d=Math.max(d,e))}return e=await e.crop([i,l,c,d])}pad_image(e,t,r,{mode:s="constant",center:o=!1,constant_values:a=0}={}){let i,l;let[c,d,u]=t;if("number"==typeof r?(i=r,l=r):"square"===r?i=l=Math.max(c,d):(i=r.width,l=r.height),i!==d||l!==c){let r=new Float32Array(i*l*u);if(Array.isArray(a))for(let e=0;e<r.length;++e)r[e]=a[e%u];else 0!==a&&r.fill(a);let[m,p]=o?[Math.floor((i-d)/2),Math.floor((l-c)/2)]:[0,0];for(let t=0;t<c;++t){let s=(t+p)*i,o=t*d;for(let t=0;t<d;++t){let a=(s+t+m)*u,n=(o+t)*u;for(let t=0;t<u;++t)r[a+t]=e[n+t]}}if("symmetric"===s){if(o)throw Error("`center` padding is not supported when `mode` is set to `symmetric`.");let t=c-1,s=d-1;for(let o=0;o<l;++o){let a=o*i,l=(0,n.calculateReflectOffset)(o,t)*d;for(let t=0;t<i;++t){if(o<c&&t<d)continue;let i=(a+t)*u,m=(l+(0,n.calculateReflectOffset)(t,s))*u;for(let t=0;t<u;++t)r[i+t]=e[m+t]}}}e=r,t=[l,i,u]}return[e,t]}rescale(e){for(let t=0;t<e.length;++t)e[t]=this.rescale_factor*e[t]}get_resize_output_image_size(e,t){let r,s;let[o,a]=e.size;if(this.do_thumbnail){let{height:e,width:s}=t;r=Math.min(e,s)}else Number.isInteger(t)?(r=t,s=this.config.max_size??r):void 0!==t&&(r=t.shortest_edge,s=t.longest_edge);if(void 0!==r||void 0!==s){let e=void 0===r?1:Math.max(r/o,r/a),t=o*e,n=a*e,i=void 0===s?1:Math.min(s/t,s/n),l=Math.floor(Number((t*i).toFixed(2))),c=Math.floor(Number((n*i).toFixed(2)));return void 0!==this.size_divisibility&&([l,c]=d([l,c],this.size_divisibility)),[l,c]}if(void 0!==t&&void 0!==t.width&&void 0!==t.height){let e=t.width,r=t.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let t=r/a,s=e/o;Math.abs(1-s)<Math.abs(1-t)?t=s:s=t,r=c(t*a,this.config.ensure_multiple_of),e=c(s*o,this.config.ensure_multiple_of)}return[e,r]}if(void 0!==this.size_divisibility)return d([o,a],this.size_divisibility);if(void 0!==this.min_pixels&&void 0!==this.max_pixels)return function(e,t,r=28,s=3136,o=1003520){if(e<r||t<r)throw Error(`height:${e} or width:${t} must be larger than factor:${r}`);if(Math.max(e,t)/Math.min(e,t)>200)throw Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(e,t)/Math.min(e,t)}`);let a=Math.round(e/r)*r,n=Math.round(t/r)*r;if(a*n>o){let s=Math.sqrt(e*t/o);a=Math.floor(e/s/r)*r,n=Math.floor(t/s/r)*r}else if(a*n<s){let o=Math.sqrt(s/(e*t));a=Math.ceil(e*o/r)*r,n=Math.ceil(t*o/r)*r}return[a,n]}(a,o,this.config.patch_size*this.config.merge_size,this.min_pixels,this.max_pixels);throw Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(t)}`)}async resize(e){let[t,r]=this.get_resize_output_image_size(e,this.size);return await e.resize(t,r,{resample:this.resample})}async preprocess(e,{do_normalize:t=null,do_pad:r=null,do_convert_rgb:s=null,do_convert_grayscale:a=null,do_flip_channel_order:n=null}={}){this.do_crop_margin&&(e=await this.crop_margin(e));let[i,l]=e.size;if(s??this.do_convert_rgb?e=e.rgb():a&&(e=e.grayscale()),this.do_resize&&(e=await this.resize(e)),this.do_thumbnail&&(e=await this.thumbnail(e,this.size,this.resample)),this.do_center_crop){let t,r;Number.isInteger(this.crop_size)?(t=this.crop_size,r=this.crop_size):(t=this.crop_size.width,r=this.crop_size.height),e=await e.center_crop(t,r)}let c=[e.height,e.width],u=Float32Array.from(e.data),m=[e.height,e.width,e.channels];if(this.do_rescale&&this.rescale(u),t??this.do_normalize){let t=this.image_mean;Array.isArray(this.image_mean)||(t=Array(e.channels).fill(t));let r=this.image_std;if(Array.isArray(this.image_std)||(r=Array(e.channels).fill(r)),t.length!==e.channels||r.length!==e.channels)throw Error(`When set to arrays, the length of \`image_mean\` (${t.length}) and \`image_std\` (${r.length}) must match the number of channels in the image (${e.channels}).`);for(let s=0;s<u.length;s+=e.channels)for(let o=0;o<e.channels;++o)u[s+o]=(u[s+o]-t[o])/r[o]}if(r??this.do_pad){if(this.pad_size){let t=this.pad_image(u,[e.height,e.width,e.channels],this.pad_size);[u,m]=t}else if(this.size_divisibility){let[e,t]=d([m[1],m[0]],this.size_divisibility);[u,m]=this.pad_image(u,m,{width:e,height:t})}}if(n??this.do_flip_channel_order){if(3!==m[2])throw Error("Flipping channel order is only supported for RGB images.");for(let e=0;e<u.length;e+=3){let t=u[e];u[e]=u[e+2],u[e+2]=t}}return{original_size:[l,i],reshaped_input_size:c,pixel_values:new o.Tensor("float32",u,m).permute(2,0,1)}}async _call(e,...t){Array.isArray(e)||(e=[e]);let r=await Promise.all(e.map(e=>this.preprocess(e)));return{pixel_values:(0,o.stack)(r.map(e=>e.pixel_values),0),original_sizes:r.map(e=>e.original_size),reshaped_input_sizes:r.map(e=>e.reshaped_input_size)}}static async from_pretrained(e,t={}){return new this(await (0,i.getModelJSON)(e,l.IMAGE_PROCESSOR_NAME,!0,t))}}},"./src/base/processing_utils.js":(e,t,r)=>{r.r(t),r.d(t,{Processor:()=>n});var s=r("./src/utils/constants.js"),o=r("./src/utils/generic.js"),a=r("./src/utils/hub.js");class n extends o.Callable{static classes=["image_processor_class","tokenizer_class","feature_extractor_class"];static uses_processor_config=!1;static uses_chat_template_file=!1;constructor(e,t,r){super(),this.config=e,this.components=t,this.chat_template=r}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(e,t={}){if(!this.tokenizer)throw Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(e,{tokenize:!1,chat_template:this.chat_template??void 0,...t})}batch_decode(...e){if(!this.tokenizer)throw Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...e)}decode(...e){if(!this.tokenizer)throw Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...e)}async _call(e,...t){for(let r of[this.image_processor,this.feature_extractor,this.tokenizer])if(r)return r(e,...t);throw Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(e,t={}){let[r,o,n]=await Promise.all([this.uses_processor_config?(0,a.getModelJSON)(e,s.PROCESSOR_NAME,!0,t):{},Promise.all(this.classes.filter(e=>e in this).map(async r=>{let s=await this[r].from_pretrained(e,t);return[r.replace(/_class$/,""),s]})).then(Object.fromEntries),this.uses_chat_template_file?(0,a.getModelText)(e,s.CHAT_TEMPLATE_NAME,!0,t):null]);return new this(r,o,n)}}},"./src/configs.js":(e,t,r)=>{r.r(t),r.d(t,{AutoConfig:()=>l,PretrainedConfig:()=>i,getCacheShapes:()=>n});var s=r("./src/utils/core.js"),o=r("./src/utils/hub.js");async function a(e,t){return await (0,o.getModelJSON)(e,"config.json",!0,t)}function n(e,t){if("lfm2"===e.model_type){let r=t?.prefix??"past_key_values",s="present"===r?"present":"past",o={},{layer_types:a,num_attention_heads:n,num_key_value_heads:i,hidden_size:l,conv_L_cache:c}=e,d=l/n,u=t?.batch_size??1;for(let e=0;e<a.length;++e)if("full_attention"===a[e])for(let t of["key","value"])o[`${r}.${e}.${t}`]=[u,i,0,d];else if("conv"===a[e])o[`${s}_conv.${e}`]=[u,l,c];else throw Error(`Unsupported layer type: ${a[e]}`);return o}return function(e,{prefix:t="past_key_values",batch_size:r=1}={}){let s={},o=e.normalized_config;if(o.is_encoder_decoder&&"num_encoder_heads"in o&&"num_decoder_heads"in o){let e=o.encoder_dim_kv??o.encoder_hidden_size/o.num_encoder_heads,a=o.decoder_dim_kv??o.decoder_hidden_size/o.num_decoder_heads,n=[r,o.num_encoder_heads,0,e],i=[r,o.num_decoder_heads,0,a];for(let e=0;e<o.num_decoder_layers;++e)s[`${t}.${e}.encoder.key`]=n,s[`${t}.${e}.encoder.value`]=n,s[`${t}.${e}.decoder.key`]=i,s[`${t}.${e}.decoder.value`]=i}else{let e=o.num_heads,a=o.num_layers,n=o.dim_kv??o.hidden_size/(o.num_attention_heads??e);if("falcon"===o.model_type){let o=[r*e,0,n];for(let e=0;e<a;++e)s[`${t}.${e}.key`]=o,s[`${t}.${e}.value`]=o}else if(o.multi_query){let o=[r*e,0,2*n];for(let e=0;e<a;++e)s[`${t}.${e}.key_value`]=o}else if("bloom"===o.model_type){let o=[r*e,n,0],i=[r*e,0,n];for(let e=0;e<a;++e)s[`${t}.${e}.key`]=o,s[`${t}.${e}.value`]=i}else if("openelm"===o.model_type)for(let o=0;o<a;++o){let a=[r,e[o],0,n];s[`${t}.${o}.key`]=a,s[`${t}.${o}.value`]=a}else{let o=[r,e,0,n];for(let e=0;e<a;++e)s[`${t}.${e}.key`]=o,s[`${t}.${e}.value`]=o}}return s}(e,t)}class i{model_type=null;is_encoder_decoder=!1;max_position_embeddings;"transformers.js_config";constructor(e){Object.assign(this,e),this.normalized_config=function e(t){let r={},o={};switch(t.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":case"mistral3":o=e(t.text_config);break;case"moondream1":o=e(t.phi_config);break;case"musicgen":o=e(t.decoder);break;case"multi_modality":o=e(t.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":r.num_heads="n_head",r.num_layers="n_layer",r.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":r.num_heads="num_attention_heads",r.num_layers="num_hidden_layers",r.hidden_size="hidden_size";break;case"llama":case"llama4_text":case"nanochat":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"granitemoehybrid":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":r.num_heads="num_key_value_heads",r.num_layers="num_hidden_layers",r.hidden_size="hidden_size",r.num_attention_heads="num_attention_heads",r.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"vaultgemma":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":case"ministral":case"ministral3":r.num_heads="num_key_value_heads",r.num_layers="num_hidden_layers",r.dim_kv="head_dim";break;case"openelm":r.num_heads="num_kv_heads",r.num_layers="num_transformer_layers",r.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":r.num_heads="num_heads",r.num_layers="num_layers",r.hidden_size="hidden_size";break;case"bloom":r.num_heads="n_head",r.num_layers="n_layer",r.hidden_size="hidden_size";break;case"mpt":r.num_heads="n_heads",r.num_layers="n_layers",r.hidden_size="d_model";break;case"exaone":r.num_heads="num_key_value_heads",r.num_layers="num_layers",r.dim_kv="head_dim",r.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":r.num_decoder_layers="num_decoder_layers",r.num_decoder_heads="num_heads",r.decoder_dim_kv="d_kv",r.num_encoder_layers="num_layers",r.num_encoder_heads="num_heads",r.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":r.num_decoder_layers="decoder_layers",r.num_decoder_heads="decoder_attention_heads",r.decoder_hidden_size="d_model",r.num_encoder_layers="encoder_layers",r.num_encoder_heads="encoder_attention_heads",r.encoder_hidden_size="d_model";break;case"speecht5":r.num_decoder_layers="decoder_layers",r.num_decoder_heads="decoder_attention_heads",r.decoder_hidden_size="hidden_size",r.num_encoder_layers="encoder_layers",r.num_encoder_heads="encoder_attention_heads",r.encoder_hidden_size="hidden_size";break;case"trocr":r.num_encoder_layers=r.num_decoder_layers="decoder_layers",r.num_encoder_heads=r.num_decoder_heads="decoder_attention_heads",r.encoder_hidden_size=r.decoder_hidden_size="d_model";break;case"musicgen_decoder":r.num_encoder_layers=r.num_decoder_layers="num_hidden_layers",r.num_encoder_heads=r.num_decoder_heads="num_attention_heads",r.encoder_hidden_size=r.decoder_hidden_size="hidden_size";break;case"moonshine":r.num_decoder_layers="decoder_num_hidden_layers",r.num_decoder_heads="decoder_num_key_value_heads",r.num_encoder_layers="encoder_num_hidden_layers",r.num_encoder_heads="encoder_num_key_value_heads",r.encoder_hidden_size=r.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":let a=e(t.decoder),n=(0,s.pick)(t,["model_type","is_encoder_decoder"]);return"num_decoder_layers"in a?(n.num_decoder_layers=a.num_decoder_layers,n.num_decoder_heads=a.num_decoder_heads,n.decoder_hidden_size=a.decoder_hidden_size,n.num_encoder_layers=a.num_encoder_layers,n.num_encoder_heads=a.num_encoder_heads,n.encoder_hidden_size=a.encoder_hidden_size):(n.num_layers=a.num_layers,n.num_heads=a.num_heads,n.hidden_size=a.hidden_size),n}let i={...o,...(0,s.pick)(t,["model_type","multi_query","is_encoder_decoder"])};for(let e in r)i[e]=t[r[e]];return i}(this)}static async from_pretrained(e,{progress_callback:t=null,config:r=null,cache_dir:s=null,local_files_only:o=!1,revision:n="main"}={}){return!r||r instanceof i||(r=new i(r)),new this(r??await a(e,{progress_callback:t,config:r,cache_dir:s,local_files_only:o,revision:n}))}}class l{static async from_pretrained(...e){return i.from_pretrained(...e)}}},"./src/env.js":(e,t,r)=>{r.r(t),r.d(t,{apis:()=>_,env:()=>b});var s=r("node:fs"),o=r("node:path"),a=r("node:url");let n="undefined"!=typeof window&&void 0!==window.document,i="undefined"!=typeof self&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes(self.constructor?.name),l="undefined"!=typeof self&&"caches"in self,c="undefined"!=typeof navigator&&"gpu"in navigator,d="undefined"!=typeof navigator&&"ml"in navigator,u="undefined"!=typeof process,m=u&&process?.release?.name==="node",p=!v(s.default),h=!v(o.default),f=void 0!==globalThis.Deno;globalThis.Bun;let _=Object.freeze({IS_BROWSER_ENV:n,IS_WEBWORKER_ENV:i,IS_WEB_CACHE_AVAILABLE:l,IS_WEBGPU_AVAILABLE:c,IS_WEBNN_AVAILABLE:d,IS_PROCESS_AVAILABLE:u,IS_NODE_ENV:m,IS_FS_AVAILABLE:p,IS_PATH_AVAILABLE:h}),g=p&&h,M="./";if(g){let e=Object({}).url;e?M=o.default.dirname(o.default.dirname(a.default.fileURLToPath(e))):"undefined"!=typeof __dirname&&(M=o.default.dirname(__dirname))}let y=g?o.default.join(M,"/.cache/"):null,w="/models/",b={version:"3.8.1",backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(n||i),localModelPath:g?o.default.join(M,w):w,useFS:p,useBrowserCache:l&&!f,useFSCache:p,cacheDir:y,useCustomCache:!1,customCache:null};function v(e){return 0===Object.keys(e).length}},"./src/generation/configuration_utils.js":(e,t,r)=>{r.r(t),r.d(t,{GenerationConfig:()=>o});var s=r("./src/utils/core.js");class o{max_length=20;max_new_tokens=null;min_length=0;min_new_tokens=null;early_stopping=!1;max_time=null;do_sample=!1;num_beams=1;num_beam_groups=1;penalty_alpha=null;use_cache=!0;temperature=1;top_k=50;top_p=1;typical_p=1;epsilon_cutoff=0;eta_cutoff=0;diversity_penalty=0;repetition_penalty=1;encoder_repetition_penalty=1;length_penalty=1;no_repeat_ngram_size=0;bad_words_ids=null;force_words_ids=null;renormalize_logits=!1;constraints=null;forced_bos_token_id=null;forced_eos_token_id=null;remove_invalid_values=!1;exponential_decay_length_penalty=null;suppress_tokens=null;streamer=null;begin_suppress_tokens=null;forced_decoder_ids=null;guidance_scale=null;num_return_sequences=1;output_attentions=!1;output_hidden_states=!1;output_scores=!1;return_dict_in_generate=!1;pad_token_id=null;bos_token_id=null;eos_token_id=null;encoder_no_repeat_ngram_size=0;decoder_start_token_id=null;generation_kwargs={};constructor(e){Object.assign(this,(0,s.pick)(e,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,t,r)=>{r.r(t),r.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>g,ForcedBOSTokenLogitsProcessor:()=>l,ForcedEOSTokenLogitsProcessor:()=>c,LogitsProcessor:()=>a,LogitsProcessorList:()=>i,LogitsWarper:()=>n,MinLengthLogitsProcessor:()=>h,MinNewTokensLengthLogitsProcessor:()=>f,NoBadWordsLogitsProcessor:()=>_,NoRepeatNGramLogitsProcessor:()=>m,RepetitionPenaltyLogitsProcessor:()=>p,SuppressTokensAtBeginLogitsProcessor:()=>d,TemperatureLogitsWarper:()=>M,TopKLogitsWarper:()=>w,TopPLogitsWarper:()=>y,WhisperTimeStampLogitsProcessor:()=>u});var s=r("./src/utils/generic.js");r("./src/utils/tensor.js");var o=r("./src/utils/maths.js");class a extends s.Callable{_call(e,t){throw Error("`_call` should be implemented in a subclass")}}class n extends s.Callable{_call(e,t){throw Error("`_call` should be implemented in a subclass")}}class i extends s.Callable{constructor(){super(),this.processors=[]}push(e){this.processors.push(e)}extend(e){this.processors.push(...e)}_call(e,t){let r=t;for(let t of this.processors)r=t(e,r);return r}[Symbol.iterator](){return this.processors.values()}}class l extends a{constructor(e){super(),this.bos_token_id=e}_call(e,t){for(let r=0;r<e.length;++r)if(1===e[r].length){let e=t[r].data;e.fill(-1/0),e[this.bos_token_id]=0}return t}}class c extends a{constructor(e,t){super(),this.max_length=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let r=0;r<e.length;++r)if(e[r].length===this.max_length-1){let e=t[r].data;for(let t of(e.fill(-1/0),this.eos_token_id))e[t]=0}return t}}class d extends a{constructor(e,t){super(),this.begin_suppress_tokens=e,this.begin_index=t}_call(e,t){for(let r=0;r<e.length;++r)if(e[r].length===this.begin_index){let e=t[r].data;for(let t of this.begin_suppress_tokens)e[t]=-1/0}return t}}class u extends a{constructor(e,t){super(),this.eos_token_id=Array.isArray(e.eos_token_id)?e.eos_token_id[0]:e.eos_token_id,this.no_timestamps_token_id=e.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=t.length,t.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=e.max_initial_timestamp_index}_call(e,t){for(let r=0;r<e.length;++r){let s=t[r].data;if(s[this.no_timestamps_token_id]=-1/0,e[r].length===this.begin_index-1){s.fill(-1/0),s[this.timestamp_begin]=0;continue}let a=e[r].slice(this.begin_index),n=a.length>=1&&a[a.length-1]>=this.timestamp_begin,i=a.length<2||a[a.length-2]>=this.timestamp_begin;if(n&&(i?s.subarray(this.timestamp_begin).fill(-1/0):s.subarray(0,this.eos_token_id).fill(-1/0)),e[r].length===this.begin_index&&null!==this.max_initial_timestamp_index){let e=this.timestamp_begin+this.max_initial_timestamp_index;s.subarray(e+1).fill(-1/0)}let l=(0,o.log_softmax)(s);Math.log(l.subarray(this.timestamp_begin).map(Math.exp).reduce((e,t)=>e+t))>(0,o.max)(l.subarray(0,this.timestamp_begin))[0]&&s.subarray(0,this.timestamp_begin).fill(-1/0)}return t}}class m extends a{constructor(e){super(),this.no_repeat_ngram_size=e}getNgrams(e){let t=e.length,r=[];for(let s=0;s<t+1-this.no_repeat_ngram_size;++s){let t=[];for(let r=0;r<this.no_repeat_ngram_size;++r)t.push(e[s+r]);r.push(t.map(Number))}let s=new Map;for(let e of r){let t=JSON.stringify(e.slice(0,e.length-1)),r=s.get(t)??[];r.push(e[e.length-1]),s.set(t,r)}return s}getGeneratedNgrams(e,t){let r=t.slice(t.length+1-this.no_repeat_ngram_size,t.length);return e.get(JSON.stringify(r.map(Number)))??[]}calcBannedNgramTokens(e){if(e.length+1<this.no_repeat_ngram_size)return[];{let t=this.getNgrams(e);return this.getGeneratedNgrams(t,e)}}_call(e,t){for(let r=0;r<e.length;++r){let s=t[r].data;for(let t of this.calcBannedNgramTokens(e[r]))s[t]=-1/0}return t}}class p extends a{constructor(e){super(),this.penalty=e}_call(e,t){for(let r=0;r<e.length;++r){let s=t[r].data;for(let t of new Set(e[r])){let e=Number(t);s[e]<0?s[e]*=this.penalty:s[e]/=this.penalty}}return t}}class h extends a{constructor(e,t){super(),this.min_length=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let r=0;r<e.length;++r)if(e[r].length<this.min_length){let e=t[r].data;for(let t of this.eos_token_id)e[t]=-1/0}return t}}class f extends a{constructor(e,t,r){super(),this.prompt_length_to_skip=e,this.min_new_tokens=t,this.eos_token_id=Array.isArray(r)?r:[r]}_call(e,t){for(let r=0;r<e.length;++r)if(e[r].length-this.prompt_length_to_skip<this.min_new_tokens){let e=t[r].data;for(let t of this.eos_token_id)e[t]=-1/0}return t}}class _ extends a{constructor(e,t){super(),this.bad_words_ids=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let r=0;r<e.length;++r){let s=t[r].data,o=e[r];for(let e of this.bad_words_ids){if(o.length<e.length-1)continue;let t=!0;for(let r=1;r<=e.length-1;++r)if(e.at(-r-1)!=o.at(-r)){t=!1;break}t&&(s[e.at(-1)]=-1/0)}}return t}}class g extends a{constructor(e){if(super(),e<=1)throw Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${e}.`);this.guidance_scale=e}_call(e,t){if(t.dims[0]!==2*e.length)throw Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${t.dims[0]} for the logits and ${e.length} for the input ids.`);let r=e.length,s=t.slice([0,r],null),o=t.slice([r,t.dims[0]],null);for(let e=0;e<o.data.length;++e)o.data[e]+=(s.data[e]-o.data[e])*this.guidance_scale;return o}}class M extends n{constructor(e){super(),this.temperature=e}_call(e,t){let r=t.data;for(let e=0;e<r.length;++e)r[e]/=this.temperature;return t}}class y extends n{constructor(e,{filter_value:t=-1/0,min_tokens_to_keep:r=1}={}){if(super(),e<0||e>1)throw Error(`\`top_p\` must be a float > 0 and < 1, but is ${e}`);if(!Number.isInteger(r)||r<1)throw Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${r}`);this.top_p=e,this.filter_value=t,this.min_tokens_to_keep=r}}class w extends n{constructor(e,{filter_value:t=-1/0,min_tokens_to_keep:r=1}={}){if(super(),!Number.isInteger(e)||e<0)throw Error(`\`top_k\` must be a positive integer, but is ${e}`);this.top_k=Math.max(e,r),this.filter_value=t}}},"./src/generation/logits_sampler.js":(e,t,r)=>{r.r(t),r.d(t,{LogitsSampler:()=>n});var s=r("./src/utils/generic.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/maths.js");r("./src/generation/configuration_utils.js");class n extends s.Callable{constructor(e){super(),this.generation_config=e}async _call(e){return this.sample(e)}async sample(e){throw Error("sample should be implemented in subclasses.")}getLogits(e,t){let r=e.dims.at(-1),s=e.data;if(-1===t)s=s.slice(-r);else{let e=t*r;s=s.slice(e,e+r)}return s}randomSelect(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r];let r=Math.random()*t;for(let t=0;t<e.length;++t)if((r-=e[t])<=0)return t;return 0}static getSampler(e){if(e.do_sample)return new l(e);if(e.num_beams>1)return new c(e);if(e.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${e.num_return_sequences}.`);return new i(e)}}class i extends n{async sample(e){return[[BigInt((0,a.max)(e.data)[1]),0]]}}class l extends n{async sample(e){let t=e.dims.at(-1);this.generation_config.top_k>0&&(t=Math.min(this.generation_config.top_k,t));let[r,s]=await (0,o.topk)(e,t),n=(0,a.softmax)(r.data);return Array.from({length:this.generation_config.num_beams},()=>{let e=this.randomSelect(n);return[s.data[e],Math.log(n[e])]})}}class c extends n{async sample(e){let t=e.dims.at(-1);this.generation_config.top_k>0&&(t=Math.min(this.generation_config.top_k,t));let[r,s]=await (0,o.topk)(e,t),n=(0,a.softmax)(r.data);return Array.from({length:this.generation_config.num_beams},(e,t)=>[s.data[t],Math.log(n[t])])}}},"./src/generation/stopping_criteria.js":(e,t,r)=>{r.r(t),r.d(t,{EosTokenCriteria:()=>i,InterruptableStoppingCriteria:()=>l,MaxLengthCriteria:()=>n,StoppingCriteria:()=>o,StoppingCriteriaList:()=>a});var s=r("./src/utils/generic.js");class o extends s.Callable{_call(e,t){throw Error("StoppingCriteria needs to be subclassed")}}class a extends s.Callable{constructor(){super(),this.criteria=[]}push(e){this.criteria.push(e)}extend(e){e instanceof a?e=e.criteria:e instanceof o&&(e=[e]),this.criteria.push(...e)}_call(e,t){let r=Array(e.length).fill(!1);for(let s of this.criteria){let o=s(e,t);for(let e=0;e<r.length;++e)r[e]||=o[e]}return r}[Symbol.iterator](){return this.criteria.values()}}class n extends o{constructor(e,t=null){super(),this.max_length=e,this.max_position_embeddings=t}_call(e){return e.map(e=>e.length>=this.max_length)}}class i extends o{constructor(e){super(),Array.isArray(e)||(e=[e]),this.eos_token_id=e}_call(e,t){return e.map(e=>{let t=e.at(-1);return this.eos_token_id.some(e=>t==e)})}}class l extends o{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(e,t){return Array(e.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,t,r)=>{r.r(t),r.d(t,{BaseStreamer:()=>n,TextStreamer:()=>l,WhisperTextStreamer:()=>c});var s=r("./src/utils/core.js"),o=r("./src/tokenizers.js"),a=r("./src/env.js");class n{put(e){throw Error("Not implemented")}end(){throw Error("Not implemented")}}let i=a.apis.IS_PROCESS_AVAILABLE?e=>process.stdout.write(e):e=>console.log(e);class l extends n{constructor(e,{skip_prompt:t=!1,callback_function:r=null,token_callback_function:s=null,skip_special_tokens:o=!0,decode_kwargs:a={},...n}={}){super(),this.tokenizer=e,this.skip_prompt=t,this.callback_function=r??i,this.token_callback_function=s,this.decode_kwargs={skip_special_tokens:o,...a,...n},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(e){let t;if(e.length>1)throw Error("TextStreamer only supports batch size of 1");let r=this.next_tokens_are_prompt;if(r&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;let a=e[0];this.token_callback_function?.(a),this.token_cache=(0,s.mergeArrays)(this.token_cache,a);let n=this.tokenizer.decode(this.token_cache,this.decode_kwargs);r||n.endsWith("\n")?(t=n.slice(this.print_len),this.token_cache=[],this.print_len=0):(t=n.length>0&&(0,o.is_chinese_char)(n.charCodeAt(n.length-1))?n.slice(this.print_len):n.slice(this.print_len,n.lastIndexOf(" ")+1),this.print_len+=t.length),this.on_finalized_text(t,!1)}end(){let e;this.token_cache.length>0?(e=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):e="",this.next_tokens_are_prompt=!0,this.on_finalized_text(e,!0)}on_finalized_text(e,t){e.length>0&&this.callback_function?.(e),t&&this.callback_function===i&&a.apis.IS_PROCESS_AVAILABLE&&this.callback_function?.("\n")}}class c extends l{constructor(e,{skip_prompt:t=!1,callback_function:r=null,token_callback_function:s=null,on_chunk_start:o=null,on_chunk_end:a=null,on_finalize:n=null,time_precision:i=.02,skip_special_tokens:l=!0,decode_kwargs:c={}}={}){super(e,{skip_prompt:t,skip_special_tokens:l,callback_function:r,token_callback_function:s,decode_kwargs:c}),this.timestamp_begin=e.timestamp_begin,this.on_chunk_start=o,this.on_chunk_end=a,this.on_finalize=n,this.time_precision=i,this.waiting_for_timestamp=!1}put(e){if(e.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");let t=e[0];if(1===t.length){let e=Number(t[0])-this.timestamp_begin;if(e>=0){let r=e*this.time_precision;this.waiting_for_timestamp?this.on_chunk_end?.(r):this.on_chunk_start?.(r),this.waiting_for_timestamp=!this.waiting_for_timestamp,this.token_callback_function?.(t);return}}return super.put(e)}end(){super.end(),this.on_finalize?.()}}},"./src/models.js":(e,t,r)=>{r.r(t),r.d(t,{ASTForAudioClassification:()=>re,ASTModel:()=>t9,ASTPreTrainedModel:()=>t7,AlbertForMaskedLM:()=>ty,AlbertForQuestionAnswering:()=>tM,AlbertForSequenceClassification:()=>tg,AlbertModel:()=>t_,AlbertPreTrainedModel:()=>tf,ArceeForCausalLM:()=>sm,ArceeModel:()=>su,ArceePreTrainedModel:()=>sd,AutoModel:()=>cu,AutoModelForAudioClassification:()=>cE,AutoModelForAudioFrameClassification:()=>cI,AutoModelForAudioTextToText:()=>cB,AutoModelForCTC:()=>cC,AutoModelForCausalLM:()=>cM,AutoModelForDepthEstimation:()=>cO,AutoModelForDocumentQuestionAnswering:()=>c$,AutoModelForImageClassification:()=>cv,AutoModelForImageFeatureExtraction:()=>cz,AutoModelForImageMatting:()=>cL,AutoModelForImageSegmentation:()=>cx,AutoModelForImageTextToText:()=>cV,AutoModelForImageToImage:()=>cj,AutoModelForMaskGeneration:()=>cS,AutoModelForMaskedLM:()=>cy,AutoModelForNormalEstimation:()=>cN,AutoModelForObjectDetection:()=>ck,AutoModelForPoseEstimation:()=>cD,AutoModelForQuestionAnswering:()=>cw,AutoModelForSemanticSegmentation:()=>cP,AutoModelForSeq2SeqLM:()=>ch,AutoModelForSequenceClassification:()=>cm,AutoModelForSpeechSeq2Seq:()=>cf,AutoModelForTextToSpectrogram:()=>c_,AutoModelForTextToWaveform:()=>cg,AutoModelForTokenClassification:()=>cp,AutoModelForUniversalSegmentation:()=>cT,AutoModelForVision2Seq:()=>cb,AutoModelForXVector:()=>cA,AutoModelForZeroShotObjectDetection:()=>cF,BartForConditionalGeneration:()=>tA,BartForSequenceClassification:()=>tI,BartModel:()=>tE,BartPretrainedModel:()=>tC,BaseModelOutput:()=>H,BeitForImageClassification:()=>o3,BeitModel:()=>o2,BeitPreTrainedModel:()=>o1,BertForMaskedLM:()=>J,BertForQuestionAnswering:()=>Z,BertForSequenceClassification:()=>K,BertForTokenClassification:()=>Y,BertModel:()=>X,BertPreTrainedModel:()=>Q,BlenderbotForConditionalGeneration:()=>tV,BlenderbotModel:()=>tz,BlenderbotPreTrainedModel:()=>tD,BlenderbotSmallForConditionalGeneration:()=>tG,BlenderbotSmallModel:()=>tR,BlenderbotSmallPreTrainedModel:()=>tB,BloomForCausalLM:()=>op,BloomModel:()=>om,BloomPreTrainedModel:()=>ou,CLIPModel:()=>rF,CLIPPreTrainedModel:()=>rk,CLIPSegForImageSegmentation:()=>rq,CLIPSegModel:()=>rG,CLIPSegPreTrainedModel:()=>rR,CLIPTextModel:()=>rS,CLIPTextModelWithProjection:()=>rC,CLIPVisionModel:()=>rE,CLIPVisionModelWithProjection:()=>rA,CamembertForMaskedLM:()=>eO,CamembertForQuestionAnswering:()=>ez,CamembertForSequenceClassification:()=>eN,CamembertForTokenClassification:()=>eD,CamembertModel:()=>ej,CamembertPreTrainedModel:()=>eL,CausalLMOutput:()=>cQ,CausalLMOutputWithPast:()=>cX,ChineseCLIPModel:()=>rN,ChineseCLIPPreTrainedModel:()=>rO,ClapAudioModelWithProjection:()=>ij,ClapModel:()=>i$,ClapPreTrainedModel:()=>iI,ClapTextModelWithProjection:()=>iL,CodeGenForCausalLM:()=>st,CodeGenModel:()=>se,CodeGenPreTrainedModel:()=>r9,CohereForCausalLM:()=>sU,CohereModel:()=>sq,CoherePreTrainedModel:()=>sG,ConvBertForMaskedLM:()=>eP,ConvBertForQuestionAnswering:()=>eF,ConvBertForSequenceClassification:()=>eT,ConvBertForTokenClassification:()=>ek,ConvBertModel:()=>ex,ConvBertPreTrainedModel:()=>ev,ConvNextForImageClassification:()=>a8,ConvNextModel:()=>a5,ConvNextPreTrainedModel:()=>a4,ConvNextV2ForImageClassification:()=>a9,ConvNextV2Model:()=>a7,ConvNextV2PreTrainedModel:()=>a6,DFineForObjectDetection:()=>ah,DFineModel:()=>ap,DFinePreTrainedModel:()=>am,DINOv3ConvNextModel:()=>nc,DINOv3ConvNextPreTrainedModel:()=>nl,DINOv3ViTModel:()=>ni,DINOv3ViTPreTrainedModel:()=>nn,DPTForDepthEstimation:()=>aN,DPTModel:()=>aO,DPTPreTrainedModel:()=>aj,DacDecoderModel:()=>lA,DacDecoderOutput:()=>lS,DacEncoderModel:()=>lE,DacEncoderOutput:()=>lF,DacModel:()=>lC,DacPreTrainedModel:()=>lk,DebertaForMaskedLM:()=>eR,DebertaForQuestionAnswering:()=>eU,DebertaForSequenceClassification:()=>eG,DebertaForTokenClassification:()=>eq,DebertaModel:()=>eB,DebertaPreTrainedModel:()=>eV,DebertaV2ForMaskedLM:()=>eQ,DebertaV2ForQuestionAnswering:()=>eK,DebertaV2ForSequenceClassification:()=>eX,DebertaV2ForTokenClassification:()=>eJ,DebertaV2Model:()=>eH,DebertaV2PreTrainedModel:()=>eW,DecisionTransformerModel:()=>la,DecisionTransformerPreTrainedModel:()=>lo,DeiTForImageClassification:()=>ab,DeiTModel:()=>aw,DeiTPreTrainedModel:()=>ay,DepthAnythingForDepthEstimation:()=>az,DepthAnythingPreTrainedModel:()=>aD,DepthProForDepthEstimation:()=>aU,DepthProPreTrainedModel:()=>aq,DetrForObjectDetection:()=>o8,DetrForSegmentation:()=>o6,DetrModel:()=>o5,DetrObjectDetectionOutput:()=>o7,DetrPreTrainedModel:()=>o4,DetrSegmentationOutput:()=>o9,Dinov2ForImageClassification:()=>nr,Dinov2Model:()=>nt,Dinov2PreTrainedModel:()=>ne,Dinov2WithRegistersForImageClassification:()=>na,Dinov2WithRegistersModel:()=>no,Dinov2WithRegistersPreTrainedModel:()=>ns,DistilBertForMaskedLM:()=>e3,DistilBertForQuestionAnswering:()=>e2,DistilBertForSequenceClassification:()=>e0,DistilBertForTokenClassification:()=>e1,DistilBertModel:()=>eZ,DistilBertPreTrainedModel:()=>eY,DonutSwinModel:()=>a3,DonutSwinPreTrainedModel:()=>a2,EdgeTamModel:()=>nv,EfficientNetForImageClassification:()=>iH,EfficientNetModel:()=>iW,EfficientNetPreTrainedModel:()=>iU,ElectraForMaskedLM:()=>eE,ElectraForQuestionAnswering:()=>e$,ElectraForSequenceClassification:()=>eA,ElectraForTokenClassification:()=>eI,ElectraModel:()=>eC,ElectraPreTrainedModel:()=>eS,Ernie4_5ForCausalLM:()=>iT,Ernie4_5Model:()=>iP,Ernie4_5PreTrainedModel:()=>ix,EsmForMaskedLM:()=>e8,EsmForSequenceClassification:()=>e6,EsmForTokenClassification:()=>e7,EsmModel:()=>e5,EsmPreTrainedModel:()=>e4,ExaoneForCausalLM:()=>sF,ExaoneModel:()=>sk,ExaonePreTrainedModel:()=>sT,FalconForCausalLM:()=>iA,FalconModel:()=>iE,FalconPreTrainedModel:()=>iC,FastViTForImageClassification:()=>oV,FastViTModel:()=>oz,FastViTPreTrainedModel:()=>oD,Florence2ForConditionalGeneration:()=>rh,Florence2PreTrainedModel:()=>rp,GLPNForDepthEstimation:()=>a1,GLPNModel:()=>a0,GLPNPreTrainedModel:()=>aZ,GPT2LMHeadModel:()=>rH,GPT2Model:()=>rW,GPT2PreTrainedModel:()=>rU,GPTBigCodeForCausalLM:()=>r7,GPTBigCodeModel:()=>r6,GPTBigCodePreTrainedModel:()=>r8,GPTJForCausalLM:()=>r5,GPTJModel:()=>r4,GPTJPreTrainedModel:()=>r3,GPTNeoForCausalLM:()=>rZ,GPTNeoModel:()=>rY,GPTNeoPreTrainedModel:()=>rK,GPTNeoXForCausalLM:()=>r2,GPTNeoXModel:()=>r1,GPTNeoXPreTrainedModel:()=>r0,Gemma2ForCausalLM:()=>sK,Gemma2Model:()=>sJ,Gemma2PreTrainedModel:()=>sX,Gemma3ForCausalLM:()=>s3,Gemma3Model:()=>s2,Gemma3PreTrainedModel:()=>s1,Gemma3nForConditionalGeneration:()=>rw,Gemma3nPreTrainedModel:()=>ry,GemmaForCausalLM:()=>sQ,GemmaModel:()=>sH,GemmaPreTrainedModel:()=>sW,GlmForCausalLM:()=>sP,GlmModel:()=>sx,GlmPreTrainedModel:()=>sv,GraniteForCausalLM:()=>sz,GraniteModel:()=>sD,GraniteMoeHybridForCausalLM:()=>sR,GraniteMoeHybridModel:()=>sB,GraniteMoeHybridPreTrainedModel:()=>sV,GranitePreTrainedModel:()=>sN,GroundingDinoForObjectDetection:()=>nu,GroundingDinoPreTrainedModel:()=>nd,GroupViTModel:()=>oN,GroupViTPreTrainedModel:()=>oO,HeliumForCausalLM:()=>sb,HeliumModel:()=>sw,HeliumPreTrainedModel:()=>sy,HieraForImageClassification:()=>aP,HieraModel:()=>ax,HieraPreTrainedModel:()=>av,HubertForCTC:()=>n3,HubertForSequenceClassification:()=>n4,HubertModel:()=>n2,HubertPreTrainedModel:()=>n1,IJepaForImageClassification:()=>oT,IJepaModel:()=>oP,IJepaPreTrainedModel:()=>ox,Idefics3ForConditionalGeneration:()=>rv,Idefics3PreTrainedModel:()=>rb,ImageMattingOutput:()=>cJ,JAISLMHeadModel:()=>rJ,JAISModel:()=>rX,JAISPreTrainedModel:()=>rQ,JinaCLIPModel:()=>rz,JinaCLIPPreTrainedModel:()=>rD,JinaCLIPTextModel:()=>rV,JinaCLIPVisionModel:()=>rB,Lfm2ForCausalLM:()=>sf,Lfm2Model:()=>sh,Lfm2PreTrainedModel:()=>sp,LiteWhisperForConditionalGeneration:()=>ro,Llama4ForCausalLM:()=>sn,Llama4PreTrainedModel:()=>sa,LlamaForCausalLM:()=>so,LlamaModel:()=>ss,LlamaPreTrainedModel:()=>sr,LlavaForConditionalGeneration:()=>rd,LlavaOnevisionForConditionalGeneration:()=>ru,LlavaPreTrainedModel:()=>rc,LlavaQwen2ForCausalLM:()=>rg,LongT5ForConditionalGeneration:()=>tT,LongT5Model:()=>tP,LongT5PreTrainedModel:()=>tx,M2M100ForConditionalGeneration:()=>nC,M2M100Model:()=>nS,M2M100PreTrainedModel:()=>nF,MBartForCausalLM:()=>tN,MBartForConditionalGeneration:()=>tj,MBartForSequenceClassification:()=>tO,MBartModel:()=>tL,MBartPreTrainedModel:()=>t$,MPNetForMaskedLM:()=>tn,MPNetForQuestionAnswering:()=>tc,MPNetForSequenceClassification:()=>ti,MPNetForTokenClassification:()=>tl,MPNetModel:()=>ta,MPNetPreTrainedModel:()=>to,MT5ForConditionalGeneration:()=>tS,MT5Model:()=>tF,MT5PreTrainedModel:()=>tk,MarianMTModel:()=>nk,MarianModel:()=>nT,MarianPreTrainedModel:()=>nP,MaskFormerForInstanceSegmentation:()=>aY,MaskFormerModel:()=>aK,MaskFormerPreTrainedModel:()=>aJ,MaskedLMOutput:()=>cW,Metric3DForDepthEstimation:()=>aH,Metric3DPreTrainedModel:()=>aW,Metric3Dv2ForDepthEstimation:()=>aX,Metric3Dv2PreTrainedModel:()=>aQ,MgpstrForSceneTextRecognition:()=>ld,MgpstrModelOutput:()=>ll,MgpstrPreTrainedModel:()=>lc,MimiDecoderModel:()=>lT,MimiDecoderOutput:()=>lv,MimiEncoderModel:()=>lP,MimiEncoderOutput:()=>lb,MimiModel:()=>lx,MimiPreTrainedModel:()=>lw,Ministral3ForCausalLM:()=>iv,Ministral3Model:()=>ib,Ministral3PreTrainedModel:()=>iw,MinistralForCausalLM:()=>iy,MinistralModel:()=>iM,MinistralPreTrainedModel:()=>ig,Mistral3ForConditionalGeneration:()=>rM,MistralForCausalLM:()=>i_,MistralModel:()=>ih,MistralPreTrainedModel:()=>ip,MobileBertForMaskedLM:()=>tt,MobileBertForQuestionAnswering:()=>ts,MobileBertForSequenceClassification:()=>tr,MobileBertModel:()=>te,MobileBertPreTrainedModel:()=>e9,MobileLLMForCausalLM:()=>sE,MobileLLMModel:()=>sC,MobileLLMPreTrainedModel:()=>sS,MobileNetV1ForImageClassification:()=>i0,MobileNetV1ForSemanticSegmentation:()=>i1,MobileNetV1Model:()=>iZ,MobileNetV1PreTrainedModel:()=>iY,MobileNetV2ForImageClassification:()=>i4,MobileNetV2ForSemanticSegmentation:()=>i5,MobileNetV2Model:()=>i3,MobileNetV2PreTrainedModel:()=>i2,MobileNetV3ForImageClassification:()=>i7,MobileNetV3ForSemanticSegmentation:()=>i9,MobileNetV3Model:()=>i6,MobileNetV3PreTrainedModel:()=>i8,MobileNetV4ForImageClassification:()=>lr,MobileNetV4ForSemanticSegmentation:()=>ls,MobileNetV4Model:()=>lt,MobileNetV4PreTrainedModel:()=>le,MobileViTForImageClassification:()=>oU,MobileViTModel:()=>oq,MobileViTPreTrainedModel:()=>oG,MobileViTV2ForImageClassification:()=>oQ,MobileViTV2Model:()=>oH,MobileViTV2PreTrainedModel:()=>oW,ModelOutput:()=>W,ModernBertDecoderForCausalLM:()=>ep,ModernBertDecoderModel:()=>em,ModernBertDecoderPreTrainedModel:()=>eu,ModernBertForMaskedLM:()=>el,ModernBertForSequenceClassification:()=>ec,ModernBertForTokenClassification:()=>ed,ModernBertModel:()=>ei,ModernBertPreTrainedModel:()=>en,Moondream1ForConditionalGeneration:()=>rm,MoonshineForConditionalGeneration:()=>ri,MoonshineModel:()=>rn,MoonshinePreTrainedModel:()=>ra,MptForCausalLM:()=>o_,MptModel:()=>of,MptPreTrainedModel:()=>oh,MultiModalityCausalLM:()=>li,MultiModalityPreTrainedModel:()=>ln,MusicgenForCausalLM:()=>iJ,MusicgenForConditionalGeneration:()=>iK,MusicgenModel:()=>iX,MusicgenPreTrainedModel:()=>iQ,NanoChatForCausalLM:()=>sc,NanoChatModel:()=>sl,NanoChatPreTrainedModel:()=>si,NeoBertForMaskedLM:()=>er,NeoBertForQuestionAnswering:()=>ea,NeoBertForSequenceClassification:()=>es,NeoBertForTokenClassification:()=>eo,NeoBertModel:()=>et,NeoBertPreTrainedModel:()=>ee,NomicBertModel:()=>ef,NomicBertPreTrainedModel:()=>eh,OPTForCausalLM:()=>oy,OPTModel:()=>oM,OPTPreTrainedModel:()=>og,Olmo2ForCausalLM:()=>sO,Olmo2Model:()=>sj,Olmo2PreTrainedModel:()=>sL,OlmoForCausalLM:()=>s$,OlmoModel:()=>sI,OlmoPreTrainedModel:()=>sA,OpenELMForCausalLM:()=>s8,OpenELMModel:()=>s5,OpenELMPreTrainedModel:()=>s4,OwlViTForObjectDetection:()=>oK,OwlViTModel:()=>oJ,OwlViTPreTrainedModel:()=>oX,Owlv2ForObjectDetection:()=>o0,Owlv2Model:()=>oZ,Owlv2PreTrainedModel:()=>oY,PaliGemmaForConditionalGeneration:()=>r_,PaliGemmaPreTrainedModel:()=>rf,ParakeetForCTC:()=>nO,ParakeetPreTrainedModel:()=>nj,PatchTSMixerForPrediction:()=>l_,PatchTSMixerModel:()=>lf,PatchTSMixerPreTrainedModel:()=>lh,PatchTSTForPrediction:()=>lp,PatchTSTModel:()=>lm,PatchTSTPreTrainedModel:()=>lu,Phi3ForCausalLM:()=>od,Phi3Model:()=>oc,Phi3PreTrainedModel:()=>ol,Phi3VForCausalLM:()=>rT,Phi3VPreTrainedModel:()=>rP,PhiForCausalLM:()=>oi,PhiModel:()=>on,PhiPreTrainedModel:()=>oa,PreTrainedModel:()=>U,PretrainedMixin:()=>lO,PvtForImageClassification:()=>oE,PvtModel:()=>oC,PvtPreTrainedModel:()=>oS,PyAnnoteForAudioFrameClassification:()=>nz,PyAnnoteModel:()=>nD,PyAnnotePreTrainedModel:()=>nN,QuestionAnsweringModelOutput:()=>cH,Qwen2ForCausalLM:()=>s9,Qwen2Model:()=>s7,Qwen2PreTrainedModel:()=>s6,Qwen2VLForConditionalGeneration:()=>oo,Qwen2VLPreTrainedModel:()=>os,Qwen3ForCausalLM:()=>or,Qwen3Model:()=>ot,Qwen3PreTrainedModel:()=>oe,RFDetrForObjectDetection:()=>ad,RFDetrModel:()=>ac,RFDetrObjectDetectionOutput:()=>au,RFDetrPreTrainedModel:()=>al,RTDetrForObjectDetection:()=>ar,RTDetrModel:()=>at,RTDetrObjectDetectionOutput:()=>as,RTDetrPreTrainedModel:()=>ae,RTDetrV2ForObjectDetection:()=>an,RTDetrV2Model:()=>aa,RTDetrV2ObjectDetectionOutput:()=>ai,RTDetrV2PreTrainedModel:()=>ao,ResNetForImageClassification:()=>aF,ResNetModel:()=>ak,ResNetPreTrainedModel:()=>aT,RoFormerForMaskedLM:()=>eM,RoFormerForQuestionAnswering:()=>eb,RoFormerForSequenceClassification:()=>ey,RoFormerForTokenClassification:()=>ew,RoFormerModel:()=>eg,RoFormerPreTrainedModel:()=>e_,RobertaForMaskedLM:()=>tW,RobertaForQuestionAnswering:()=>tX,RobertaForSequenceClassification:()=>tH,RobertaForTokenClassification:()=>tQ,RobertaModel:()=>tU,RobertaPreTrainedModel:()=>tq,Sam2ImageSegmentationOutput:()=>ny,Sam2Model:()=>nb,Sam2PreTrainedModel:()=>nw,Sam3TrackerModel:()=>nx,SamImageSegmentationOutput:()=>nM,SamModel:()=>ng,SamPreTrainedModel:()=>n_,SapiensForDepthEstimation:()=>aR,SapiensForNormalEstimation:()=>aG,SapiensForSemanticSegmentation:()=>aB,SapiensPreTrainedModel:()=>aV,SegformerForImageClassification:()=>iV,SegformerForSemanticSegmentation:()=>iB,SegformerModel:()=>iz,SegformerPreTrainedModel:()=>iD,Seq2SeqLMOutput:()=>cR,SequenceClassifierOutput:()=>cG,SiglipModel:()=>r$,SiglipPreTrainedModel:()=>rI,SiglipTextModel:()=>rL,SiglipVisionModel:()=>rj,SmolLM3ForCausalLM:()=>sM,SmolLM3Model:()=>sg,SmolLM3PreTrainedModel:()=>s_,SmolVLMForConditionalGeneration:()=>rx,SnacDecoderModel:()=>lj,SnacEncoderModel:()=>lL,SnacModel:()=>l$,SnacPreTrainedModel:()=>lI,SpeechT5ForSpeechToText:()=>ia,SpeechT5ForTextToSpeech:()=>ii,SpeechT5HifiGan:()=>il,SpeechT5Model:()=>io,SpeechT5PreTrainedModel:()=>is,SqueezeBertForMaskedLM:()=>tm,SqueezeBertForQuestionAnswering:()=>th,SqueezeBertForSequenceClassification:()=>tp,SqueezeBertModel:()=>tu,SqueezeBertPreTrainedModel:()=>td,StableLmForCausalLM:()=>iq,StableLmModel:()=>iG,StableLmPreTrainedModel:()=>iR,Starcoder2ForCausalLM:()=>iS,Starcoder2Model:()=>iF,Starcoder2PreTrainedModel:()=>ik,StyleTextToSpeech2Model:()=>ir,StyleTextToSpeech2PreTrainedModel:()=>it,SupertonicForConditionalGeneration:()=>id,SupertonicPreTrainedModel:()=>ic,Swin2SRForImageSuperResolution:()=>aL,Swin2SRModel:()=>a$,Swin2SRPreTrainedModel:()=>aI,SwinForImageClassification:()=>aE,SwinForSemanticSegmentation:()=>aA,SwinModel:()=>aC,SwinPreTrainedModel:()=>aS,T5ForConditionalGeneration:()=>tv,T5Model:()=>tb,T5PreTrainedModel:()=>tw,TableTransformerForObjectDetection:()=>ag,TableTransformerModel:()=>a_,TableTransformerObjectDetectionOutput:()=>aM,TableTransformerPreTrainedModel:()=>af,TokenClassifierOutput:()=>cU,TrOCRForCausalLM:()=>im,TrOCRPreTrainedModel:()=>iu,UltravoxModel:()=>lM,UltravoxPreTrainedModel:()=>lg,UniSpeechForCTC:()=>nq,UniSpeechForSequenceClassification:()=>nU,UniSpeechModel:()=>nG,UniSpeechPreTrainedModel:()=>nR,UniSpeechSatForAudioFrameClassification:()=>nJ,UniSpeechSatForCTC:()=>nQ,UniSpeechSatForSequenceClassification:()=>nX,UniSpeechSatModel:()=>nH,UniSpeechSatPreTrainedModel:()=>nW,VaultGemmaForCausalLM:()=>s0,VaultGemmaModel:()=>sZ,VaultGemmaPreTrainedModel:()=>sY,ViTForImageClassification:()=>ov,ViTMAEModel:()=>oI,ViTMAEPreTrainedModel:()=>oA,ViTMSNForImageClassification:()=>oj,ViTMSNModel:()=>oL,ViTMSNPreTrainedModel:()=>o$,ViTModel:()=>ob,ViTPreTrainedModel:()=>ow,VisionEncoderDecoderModel:()=>rl,VitMatteForImageMatting:()=>oR,VitMattePreTrainedModel:()=>oB,VitPoseForPoseEstimation:()=>oF,VitPosePreTrainedModel:()=>ok,VitsModel:()=>iN,VitsModelOutput:()=>cK,VitsPreTrainedModel:()=>iO,VoxtralForConditionalGeneration:()=>ly,Wav2Vec2BertForCTC:()=>nZ,Wav2Vec2BertForSequenceClassification:()=>n0,Wav2Vec2BertModel:()=>nY,Wav2Vec2BertPreTrainedModel:()=>nK,Wav2Vec2ForAudioFrameClassification:()=>nL,Wav2Vec2ForCTC:()=>nI,Wav2Vec2ForSequenceClassification:()=>n$,Wav2Vec2Model:()=>nA,Wav2Vec2PreTrainedModel:()=>nE,WavLMForAudioFrameClassification:()=>ie,WavLMForCTC:()=>n6,WavLMForSequenceClassification:()=>n7,WavLMForXVector:()=>n9,WavLMModel:()=>n8,WavLMPreTrainedModel:()=>n5,WeSpeakerResNetModel:()=>nB,WeSpeakerResNetPreTrainedModel:()=>nV,WhisperForConditionalGeneration:()=>rs,WhisperModel:()=>rr,WhisperPreTrainedModel:()=>rt,XLMForQuestionAnswering:()=>t1,XLMForSequenceClassification:()=>tZ,XLMForTokenClassification:()=>t0,XLMModel:()=>tK,XLMPreTrainedModel:()=>tJ,XLMRobertaForMaskedLM:()=>t4,XLMRobertaForQuestionAnswering:()=>t6,XLMRobertaForSequenceClassification:()=>t5,XLMRobertaForTokenClassification:()=>t8,XLMRobertaModel:()=>t3,XLMRobertaPreTrainedModel:()=>t2,XLMWithLMHeadModel:()=>tY,XVectorOutput:()=>cq,YolosForObjectDetection:()=>nh,YolosModel:()=>np,YolosObjectDetectionOutput:()=>nf,YolosPreTrainedModel:()=>nm});var s=r("./src/configs.js"),o=r("./src/backends/onnx.js"),a=r("./src/utils/dtypes.js"),n=r("./src/utils/generic.js"),i=r("./src/utils/core.js"),l=r("./src/utils/hub.js"),c=r("./src/utils/constants.js"),d=r("./src/generation/logits_process.js"),u=r("./src/generation/configuration_utils.js"),m=r("./src/utils/tensor.js"),p=r("./src/utils/image.js"),h=r("./src/utils/maths.js"),f=r("./src/generation/stopping_criteria.js"),_=r("./src/generation/logits_sampler.js"),g=r("./src/env.js"),M=r("./src/models/whisper/generation_whisper.js"),y=r("./src/models/whisper/common_whisper.js");let w={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12,Supertonic:13},b=new Map,v=new Map,x=new Map;async function P(e,t,r){let n=r.config?.["transformers.js_config"]??{},i=r.device??n.device;i&&"string"!=typeof i&&(i.hasOwnProperty(t)?i=i[t]:(console.warn(`device not specified for "${t}". Using the default device.`),i=null));let c=i??(g.apis.IS_NODE_ENV?"cpu":"wasm"),d=(0,o.deviceToExecutionProviders)(c),u=n.device_config??{};u.hasOwnProperty(c)&&(n={...n,...u[c]});let m=r.dtype??n.dtype;if("string"!=typeof m&&(m&&m.hasOwnProperty(t)?m=m[t]:(m=a.DEFAULT_DEVICE_DTYPE_MAPPING[c]??a.DATA_TYPES.fp32,console.warn(`dtype not specified for "${t}". Using the default dtype (${m}) for this device (${c}).`))),m===a.DATA_TYPES.auto){let e=n.dtype;"string"!=typeof e&&(e=e?.[t]),m=e&&e!==a.DATA_TYPES.auto&&a.DATA_TYPES.hasOwnProperty(e)?e:a.DEFAULT_DEVICE_DTYPE_MAPPING[c]??a.DATA_TYPES.fp32}let p=m;if(a.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(p)){if(p===a.DATA_TYPES.fp16&&"webgpu"===c&&!await (0,a.isWebGpuFp16Supported)())throw Error(`The device (${c}) does not support fp16.`)}else throw Error(`Invalid dtype: ${p}. Should be one of: ${Object.keys(a.DATA_TYPES).join(", ")}`);let h=n.kv_cache_dtype,f=h?"string"==typeof h?h:h[p]??"float32":void 0;if(f&&!["float32","float16"].includes(f))throw Error(`Invalid kv_cache_dtype: ${f}. Should be one of: float32, float16`);let _=a.DEFAULT_DTYPE_SUFFIX_MAPPING[p],M=`${t}${_}.onnx`,y=`${r.subfolder??""}/${M}`,w={...r.session_options};w.executionProviders??=d;let b=n.free_dimension_overrides;b?w.freeDimensionOverrides??=b:c.startsWith("webnn")&&!w.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${c}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);let v=g.apis.IS_NODE_ENV&&g.env.useFSCache,x=(0,l.getModelFile)(e,y,!0,r,v),P=r.use_external_data_format??n.use_external_data_format,T=[];if(P){let s=+("object"==typeof P?P.hasOwnProperty(M)?P[M]:!!P.hasOwnProperty(t)&&P[t]:P);if(s>l.MAX_EXTERNAL_DATA_CHUNKS)throw Error(`The number of external data chunks (${s}) exceeds the maximum allowed value (${l.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let t=0;t<s;++t){let s=`${M}_data${0===t?"":"_"+t}`,o=`${r.subfolder??""}/${s}`;T.push(new Promise(async(t,a)=>{let n=await (0,l.getModelFile)(e,o,!0,r,v);t(n instanceof Uint8Array?{path:s,data:n}:s)}))}}else void 0!==w.externalData&&(T=w.externalData.map(async t=>{if("string"==typeof t.data){let s=await (0,l.getModelFile)(e,t.data,!0,r);return{...t,data:s}}return t}));if(T.length>0){let e=await Promise.all(T);g.apis.IS_NODE_ENV||(w.externalData=e)}if("webgpu"===c){let e=(0,s.getCacheShapes)(r.config,{prefix:"present"});if(Object.keys(e).length>0&&!(0,o.isONNXProxy)()){let t={};for(let r in e)t[r]="gpu-buffer";w.preferredOutputLocation=t}}return{buffer_or_path:await x,session_options:w,session_config:{dtype:p,kv_cache_dtype:f,device:c}}}async function T(e,t,r){return Object.fromEntries(await Promise.all(Object.keys(t).map(async s=>{let{buffer_or_path:a,session_options:n,session_config:i}=await P(e,t[s],r);return[s,await (0,o.createInferenceSession)(a,n,i)]})))}async function k(e,t,r){return Object.fromEntries(await Promise.all(Object.keys(t).map(async s=>{let o=await (0,l.getModelJSON)(e,t[s],!1,r);return[s,o]})))}async function F(e,t){let r=function(e,t){let r=Object.create(null),s=[];for(let a of e.inputNames){let e=t[a];if(!(e instanceof m.Tensor)){s.push(a);continue}r[a]=(0,o.isONNXProxy)()?e.clone():e}if(s.length>0)throw Error(`An error occurred during model execution: "Missing the following inputs: ${s.join(", ")}.`);let a=Object.keys(t).length,n=e.inputNames.length;if(a>n){let r=Object.keys(t).filter(t=>!e.inputNames.includes(t));console.warn(`WARNING: Too many inputs were provided (${a} > ${n}). The following inputs will be ignored: "${r.join(", ")}".`)}return r}(e,t);try{let t=Object.fromEntries(Object.entries(r).map(([e,t])=>[e,t.ort_tensor])),s=await (0,o.runInferenceSession)(e,t);return function e(t){for(let r in t)(0,o.isONNXTensor)(t[r])?t[r]=new m.Tensor(t[r]):"object"==typeof t[r]&&e(t[r]);return t}(s)}catch(t){let e=Object.fromEntries(Object.entries(r).map(([e,t])=>{let r={type:t.type,dims:t.dims,location:t.location};return"gpu-buffer"!==r.location&&(r.data=t.data),[e,r]}));throw console.error(`An error occurred during model execution: "${t}".`),console.error("Inputs given to model:",e),t}}function S(e){if(e instanceof m.Tensor)return e;if(0===e.length)throw Error("items must be non-empty");if(!Array.isArray(e[0]))return new m.Tensor("int64",BigInt64Array.from(e.map(e=>BigInt(e))),[1,e.length]);if(e.some(t=>t.length!==e[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new m.Tensor("int64",BigInt64Array.from(e.flat().map(e=>BigInt(e))),[e.length,e[0].length])}function C(e){return new m.Tensor("bool",[e],[1])}async function E(e,t){let{encoder_outputs:r,input_ids:s,decoder_input_ids:o,...a}=t;if(!r){let s=(0,i.pick)(t,e.sessions.model.inputNames);r=(await A(e,s)).last_hidden_state}return a.input_ids=o,a.encoder_hidden_states=r,e.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(a.encoder_attention_mask=t.attention_mask),await $(e,a,!0)}async function A(e,t){let r=e.sessions.model,s=(0,i.pick)(t,r.inputNames);if(r.inputNames.includes("inputs_embeds")&&!s.inputs_embeds){if(!t.input_ids)throw Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");s.inputs_embeds=await e.encode_text({input_ids:t.input_ids})}if(r.inputNames.includes("token_type_ids")&&!s.token_type_ids){if(!s.input_ids)throw Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");s.token_type_ids=(0,m.zeros_like)(s.input_ids)}if(r.inputNames.includes("pixel_mask")&&!s.pixel_mask){if(!s.pixel_values)throw Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");let e=s.pixel_values.dims;s.pixel_mask=(0,m.ones)([e[0],e[2],e[3]])}return await F(r,s)}async function I(e,t){let r=await e.encode(t);return await e.decode(r)}async function $(e,t,r=!1){let s=e.sessions[r?"decoder_model_merged":"model"],{past_key_values:o,...a}=t;if(s.inputNames.includes("use_cache_branch")&&(a.use_cache_branch=C(!!o)),s.inputNames.includes("position_ids")&&a.attention_mask&&!a.position_ids){let t=["paligemma","gemma3_text","gemma3"].includes(e.config.model_type)?1:0;a.position_ids=function(e,t=null,r=0){let{input_ids:s,inputs_embeds:o,attention_mask:a}=e,{data:n,dims:i}=V(a,r),l=new m.Tensor("int64",n,i);if(t){let e=-(s??o).dims.at(1);l=l.slice(null,[e,null])}return l}(a,o,t)}e.addPastKeyValues(a,o);let n=(0,i.pick)(a,s.inputNames);return await F(s,n)}function L({modality_token_id:e,inputs_embeds:t,modality_features:r,input_ids:s,attention_mask:o}){let a=s.tolist().map(t=>t.reduce((t,r,s)=>(r==e&&t.push(s),t),[])),n=a.reduce((e,t)=>e+t.length,0),i=r.dims[0];if(n!==i)throw Error(`Number of tokens and features do not match: tokens: ${n}, features ${i}`);let l=0;for(let e=0;e<a.length;++e){let s=a[e],o=t[e];for(let e=0;e<s.length;++e)o[s[e]].data.set(r[l++].data)}return{inputs_embeds:t,attention_mask:o}}function j({image_token_id:e,inputs_embeds:t,image_features:r,input_ids:s,attention_mask:o}){return L({modality_token_id:e,inputs_embeds:t,modality_features:r,input_ids:s,attention_mask:o})}function O({audio_token_id:e,inputs_embeds:t,audio_features:r,input_ids:s,attention_mask:o}){return L({modality_token_id:e,inputs_embeds:t,modality_features:r,input_ids:s,attention_mask:o})}async function N(e,{encode_function:t,merge_function:r,modality_input_name:s,modality_output_name:o,input_ids:a=null,attention_mask:n=null,position_ids:i=null,inputs_embeds:l=null,past_key_values:c=null,generation_config:d=null,logits_processor:u=null,...p}){let h=p[s];if(!l){if(l=await e.encode_text({input_ids:a,...p}),h&&1!==a.dims[1]){let e=await t({[s]:h,...p});({inputs_embeds:l,attention_mask:n}=r({[o]:e,inputs_embeds:l,input_ids:a,attention_mask:n}))}else if(c&&h&&1===a.dims[1]){let e=a.dims[1],t=Object.values(c)[0].dims.at(-2);n=(0,m.cat)([(0,m.ones)([a.dims[0],t]),n.slice(null,[n.dims[1]-e,n.dims[1]])],1)}}if(!i&&"qwen2_vl"===e.config.model_type){let{image_grid_thw:t,video_grid_thw:r}=p;[i]=e.get_rope_index(a,t,r,n)}return await $(e,{inputs_embeds:l,past_key_values:c,attention_mask:n,position_ids:i,generation_config:d,logits_processor:u},!0)}async function D(e,t){return await N(e,{...t,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:e.encode_audio.bind(e),merge_function:e._merge_input_ids_with_audio_features.bind(e)})}async function z(e,t){return await N(e,{...t,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:e.encode_image.bind(e),merge_function:e._merge_input_ids_with_image_features.bind(e)})}function V(e,t=0){let[r,s]=e.dims,o=e.data,a=new BigInt64Array(o.length);for(let e=0;e<r;++e){let r=e*s,n=BigInt(t);for(let e=0;e<s;++e){let t=r+e;0n===o[t]?a[t]=BigInt(1):(a[t]=n,n+=o[t])}}return{data:a,dims:e.dims}}function B(e,t,r,s){let o=r.past_key_values?Object.values(r.past_key_values)[0].dims.at(-2):0;if(!r.attention_mask){let e;for(let t of["input_ids","inputs_embeds","position_ids"])if(r[t]){e=r[t].dims;break}if(!e)throw Error("attention_mask is not provided, and unable to infer its shape from model inputs.");r.attention_mask=(0,m.ones)([e[0],o+e[1]])}if(r.past_key_values){let{input_ids:e,attention_mask:t}=r;t&&t.dims[1]>e.dims[1]||o<e.dims[1]&&(r.input_ids=e.slice(null,[o,null]))}return r}function R(e,t,r,s){return r.past_key_values&&(t=t.map(e=>[e.at(-1)])),{...r,decoder_input_ids:S(t)}}function G(e,...t){return e.config.is_encoder_decoder?R(e,...t):B(e,...t)}function q(e,t,r,s){let o=!!r.past_key_values;return null!==s.guidance_scale&&s.guidance_scale>1&&(o?r.input_ids=(0,m.cat)([r.input_ids,r.input_ids],0):(r.input_ids=(0,m.cat)([r.input_ids,(0,m.full_like)(r.input_ids,BigInt(s.pad_token_id))],0),r.attention_mask=(0,m.cat)([r.attention_mask,(0,m.full_like)(r.attention_mask,0n)],0))),(o||!r.pixel_values)&&(r.pixel_values=(0,m.full)([0,0,3,384,384],1)),o&&(r.images_seq_mask=new m.Tensor("bool",[,].fill(!0).fill(!1,0,1),[1,1]),r.images_emb_mask=new m.Tensor("bool",[].fill(!1),[1,1,0])),r}class U extends n.Callable{main_input_name="input_ids";forward_params=["input_ids","attention_mask"];constructor(e,t,r){super(),this.config=e,this.sessions=t,this.configs=r;let s=x.get(this.constructor),o=b.get(s);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,o){case w.DecoderOnly:this.can_generate=!0,this._forward=$,this._prepare_inputs_for_generation=B;break;case w.Seq2Seq:case w.Vision2Seq:case w.Musicgen:this.can_generate=!0,this._forward=E,this._prepare_inputs_for_generation=R;break;case w.EncoderDecoder:this._forward=E;break;case w.ImageTextToText:this.can_generate=!0,this._forward=z,this._prepare_inputs_for_generation=G;break;case w.AudioTextToText:this.can_generate=!0,this._forward=D,this._prepare_inputs_for_generation=G;break;case w.Phi3V:case w.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=G;break;case w.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=q;break;case w.AutoEncoder:this._forward=I;break;default:this._forward=A}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){let e=[];for(let t of Object.values(this.sessions))t?.handler?.dispose&&e.push(t.handler.dispose());return await Promise.all(e)}static async from_pretrained(e,{progress_callback:t=null,config:r=null,cache_dir:o=null,local_files_only:a=!1,revision:n="main",model_file_name:i=null,subfolder:l="onnx",device:d=null,dtype:u=null,use_external_data_format:m=null,session_options:p={}}={}){let h,f={progress_callback:t,config:r,cache_dir:o,local_files_only:a,revision:n,model_file_name:i,subfolder:l,device:d,dtype:u,use_external_data_format:m,session_options:p},_=x.get(this),g=b.get(_);if(r=f.config=await s.AutoConfig.from_pretrained(e,f),g===w.DecoderOnly)h=await Promise.all([T(e,{model:f.model_file_name??"model"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.Seq2Seq||g===w.Vision2Seq)h=await Promise.all([T(e,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.MaskGeneration)h=await Promise.all([T(e,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},f)]);else if(g===w.EncoderDecoder)h=await Promise.all([T(e,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},f)]);else if(g===w.ImageTextToText){let t={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};r.is_encoder_decoder&&(t.model="encoder_model"),h=await Promise.all([T(e,t,f),k(e,{generation_config:"generation_config.json"},f)])}else if(g===w.AudioTextToText)h=await Promise.all([T(e,{embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.ImageAudioTextToText)h=await Promise.all([T(e,{embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.Musicgen)h=await Promise.all([T(e,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.MultiModality)h=await Promise.all([T(e,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.Phi3V)h=await Promise.all([T(e,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},f),k(e,{generation_config:"generation_config.json"},f)]);else if(g===w.AutoEncoder)h=await Promise.all([T(e,{encoder_model:"encoder_model",decoder_model:"decoder_model"},f)]);else if(g===w.Supertonic)h=await Promise.all([T(e,{text_encoder:"text_encoder",latent_denoiser:"latent_denoiser",voice_decoder:"voice_decoder"},f)]);else{if(g!==w.EncoderOnly){let e=_??r?.model_type;"custom"!==e&&console.warn(`Model type for '${e}' not found, assuming encoder-only architecture. Please report this at ${c.GITHUB_ISSUE_URL}.`)}h=await Promise.all([T(e,{model:f.model_file_name??"model"},f)])}return new this(r,...h)}async _call(e){return await this.forward(e)}async forward(e){return await this._forward(this,e)}get generation_config(){return this.configs?.generation_config??null}_get_logits_processor(e,t,r=null){let s=new d.LogitsProcessorList;if(null!==e.repetition_penalty&&1!==e.repetition_penalty&&s.push(new d.RepetitionPenaltyLogitsProcessor(e.repetition_penalty)),null!==e.no_repeat_ngram_size&&e.no_repeat_ngram_size>0&&s.push(new d.NoRepeatNGramLogitsProcessor(e.no_repeat_ngram_size)),null!==e.bad_words_ids&&s.push(new d.NoBadWordsLogitsProcessor(e.bad_words_ids,e.eos_token_id)),null!==e.min_length&&null!==e.eos_token_id&&e.min_length>0&&s.push(new d.MinLengthLogitsProcessor(e.min_length,e.eos_token_id)),null!==e.min_new_tokens&&null!==e.eos_token_id&&e.min_new_tokens>0&&s.push(new d.MinNewTokensLengthLogitsProcessor(t,e.min_new_tokens,e.eos_token_id)),null!==e.forced_bos_token_id&&s.push(new d.ForcedBOSTokenLogitsProcessor(e.forced_bos_token_id)),null!==e.forced_eos_token_id&&s.push(new d.ForcedEOSTokenLogitsProcessor(e.max_length,e.forced_eos_token_id)),null!==e.begin_suppress_tokens){let r=t>1||null===e.forced_bos_token_id?t:t+1;s.push(new d.SuppressTokensAtBeginLogitsProcessor(e.begin_suppress_tokens,r))}return null!==e.guidance_scale&&e.guidance_scale>1&&s.push(new d.ClassifierFreeGuidanceLogitsProcessor(e.guidance_scale)),0===e.temperature&&e.do_sample&&(console.warn("`do_sample` changed to false because `temperature: 0` implies greedy sampling (always selecting the most likely token), which is incompatible with `do_sample: true`."),e.do_sample=!1),e.do_sample&&null!==e.temperature&&1!==e.temperature&&s.push(new d.TemperatureLogitsWarper(e.temperature)),null!==r&&s.extend(r),s}_prepare_generation_config(e,t,r=u.GenerationConfig){let s={...this.config};for(let e of["decoder","generator","text_config"])e in s&&Object.assign(s,s[e]);let o=new r(s);return Object.assign(o,this.generation_config??{}),e&&Object.assign(o,e),t&&Object.assign(o,(0,i.pick)(t,Object.getOwnPropertyNames(o))),o}_get_stopping_criteria(e,t=null){let r=new f.StoppingCriteriaList;return null!==e.max_length&&r.push(new f.MaxLengthCriteria(e.max_length,this.config.max_position_embeddings??null)),null!==e.eos_token_id&&r.push(new f.EosTokenCriteria(e.eos_token_id)),t&&r.extend(t),r}_validate_model_class(){if(!this.can_generate){let e=x.get(this.constructor),t=new Set,r=this.config.model_type;for(let e of[lH,lK,lW,lB]){let s=e.get(r);s&&t.add(s[0])}let s=`The current model class (${e}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw t.size>0&&(s+=` Please use the following class instead: ${[...t].join(", ")}`),Error(s)}}prepare_inputs_for_generation(...e){return this._prepare_inputs_for_generation(this,...e)}_update_model_kwargs_for_generation({generated_input_ids:e,outputs:t,model_inputs:r,is_encoder_decoder:s}){return r.past_key_values=this.getPastKeyValues(t,r.past_key_values),r.input_ids=new m.Tensor("int64",e.flat(),[e.length,1]),s||(r.attention_mask=(0,m.cat)([r.attention_mask,(0,m.ones)([r.attention_mask.dims[0],1])],1)),r.position_ids=null,r}_prepare_model_inputs({inputs:e,bos_token_id:t,model_kwargs:r}){let s=(0,i.pick)(r,this.forward_params),o=this.main_input_name;if(o in s){if(e)throw Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else s[o]=e;return{inputs_tensor:s[o],model_inputs:s,model_input_name:o}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:e,model_inputs:t,model_input_name:r,generation_config:s}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!t.inputs_embeds&&"_prepare_inputs_embeds"in this){let{input_ids:e,pixel_values:r,attention_mask:s,...o}=t,a=await this._prepare_inputs_embeds(t);t={...o,...(0,i.pick)(a,["inputs_embeds","attention_mask"])}}let{last_hidden_state:o}=await A(this,t);if(null!==s.guidance_scale&&s.guidance_scale>1)o=(0,m.cat)([o,(0,m.full_like)(o,0)],0),"attention_mask"in t&&(t.attention_mask=(0,m.cat)([t.attention_mask,(0,m.zeros_like)(t.attention_mask)],0));else if(t.decoder_input_ids){let e=S(t.decoder_input_ids).dims[0];if(e!==o.dims[0]){if(1!==o.dims[0])throw Error(`The encoder outputs have a different batch size (${o.dims[0]}) than the decoder inputs (${e}).`);o=(0,m.cat)(Array.from({length:e},()=>o),0)}}return t.encoder_outputs=o,t}_prepare_decoder_input_ids_for_generation({batch_size:e,model_input_name:t,model_kwargs:r,decoder_start_token_id:s,bos_token_id:o,generation_config:a}){let{decoder_input_ids:n,...i}=r;if(!(n instanceof m.Tensor)){if(n)Array.isArray(n[0])||(n=Array.from({length:e},()=>n));else if(s??=o,"musicgen"===this.config.model_type)n=Array.from({length:e*this.config.decoder.num_codebooks},()=>[s]);else if(Array.isArray(s)){if(s.length!==e)throw Error(`\`decoder_start_token_id\` expcted to have length ${e} but got ${s.length}`);n=s}else n=Array.from({length:e},()=>[s]);n=S(n)}return r.decoder_attention_mask=(0,m.ones_like)(n),{input_ids:n,model_inputs:i}}async generate({inputs:e=null,generation_config:t=null,logits_processor:r=null,stopping_criteria:s=null,streamer:o=null,...a}){let n,i;this._validate_model_class(),t=this._prepare_generation_config(t,a);let{inputs_tensor:l,model_inputs:c,model_input_name:d}=this._prepare_model_inputs({inputs:e,model_kwargs:a}),u=this.config.is_encoder_decoder;u&&("encoder_outputs"in c||(c=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:l,model_inputs:c,model_input_name:d,generation_config:t}))),u?{input_ids:n,model_inputs:c}=this._prepare_decoder_input_ids_for_generation({batch_size:c[d].dims.at(0),model_input_name:d,model_kwargs:c,decoder_start_token_id:t.decoder_start_token_id,bos_token_id:t.bos_token_id,generation_config:t}):n=c[d];let p=n.dims.at(-1);null!==t.max_new_tokens&&(t.max_length=p+t.max_new_tokens);let h=this._get_logits_processor(t,p,r),f=this._get_stopping_criteria(t,s),g=c[d].dims.at(0),M=_.LogitsSampler.getSampler(t),y=Array(g).fill(0),w=n.tolist();o&&o.put(w);let b={};for(;;){if(c=this.prepare_inputs_for_generation(w,c,t),i=await this.forward(c),t.output_attentions&&t.return_dict_in_generate){let e=this.getAttentions(i);for(let t in e)t in b||(b[t]=[]),b[t].push(e[t])}let e=h(w,i.logits.slice(null,-1,null)),r=[];for(let t=0;t<e.dims.at(0);++t){let s=e[t];for(let[e,o]of(await M(s))){let s=BigInt(e);y[t]+=o,w[t].push(s),r.push([s]);break}}if(o&&o.put(r),f(w).every(e=>e))break;c=this._update_model_kwargs_for_generation({generated_input_ids:r,outputs:i,model_inputs:c,is_encoder_decoder:u})}o&&o.end();let v=this.getPastKeyValues(i,c.past_key_values,!0),x=new m.Tensor("int64",w.flat(),[w.length,w[0].length]);if(t.return_dict_in_generate)return{sequences:x,past_key_values:v,...b};for(let e of Object.values(i))"gpu-buffer"===e.location&&e.dispose();return x}getPastKeyValues(e,t,r=!1){let s=Object.create(null);for(let o in e)if(o.startsWith("present")){let a=o.replace("present_conv","past_conv").replace("present","past_key_values"),n=o.includes("encoder");if(n&&t?s[a]=t[a]:s[a]=e[o],t&&(!n||r)){let e=t[a];"gpu-buffer"===e.location&&e.dispose()}}return s}getAttentions(e){let t={};for(let r of["cross_attentions","encoder_attentions","decoder_attentions"])for(let s in e)s.startsWith(r)&&(r in t||(t[r]=[]),t[r].push(e[s]));return t}addPastKeyValues(e,t){if(t)Object.assign(e,t);else{let t=this.sessions.decoder_model_merged??this.sessions.model,r=(e[this.main_input_name]??e.attention_mask)?.dims?.[0]??1,o=t?.config?.kv_cache_dtype??"float32",a="float16"===o?m.DataTypeMap.float16:m.DataTypeMap.float32,n=(0,s.getCacheShapes)(this.config,{batch_size:r});for(let t in n){let r=n[t].reduce((e,t)=>e*t,1);e[t]=new m.Tensor(o,new a(r),n[t])}}}async encode_image({pixel_values:e}){return(await F(this.sessions.vision_encoder,{pixel_values:e})).image_features}async encode_text({input_ids:e}){return(await F(this.sessions.embed_tokens,{input_ids:e})).inputs_embeds}async encode_audio({audio_values:e}){return(await F(this.sessions.audio_encoder,{audio_values:e})).audio_features}}class W{}class H extends W{constructor({last_hidden_state:e,hidden_states:t=null,attentions:r=null}){super(),this.last_hidden_state=e,this.hidden_states=t,this.attentions=r}}class Q extends U{}class X extends Q{}class J extends Q{async _call(e){return new cW(await super._call(e))}}class K extends Q{async _call(e){return new cG(await super._call(e))}}class Y extends Q{async _call(e){return new cU(await super._call(e))}}class Z extends Q{async _call(e){return new cH(await super._call(e))}}class ee extends U{}class et extends ee{}class er extends ee{async _call(e){return new cW(await super._call(e))}}class es extends ee{async _call(e){return new cG(await super._call(e))}}class eo extends ee{async _call(e){return new cU(await super._call(e))}}class ea extends ee{async _call(e){return new cH(await super._call(e))}}class en extends U{}class ei extends en{}class el extends en{async _call(e){return new cW(await super._call(e))}}class ec extends en{async _call(e){return new cG(await super._call(e))}}class ed extends en{async _call(e){return new cU(await super._call(e))}}class eu extends U{}class em extends eu{}class ep extends eu{}class eh extends U{}class ef extends eh{}class e_ extends U{}class eg extends e_{}class eM extends e_{async _call(e){return new cW(await super._call(e))}}class ey extends e_{async _call(e){return new cG(await super._call(e))}}class ew extends e_{async _call(e){return new cU(await super._call(e))}}class eb extends e_{async _call(e){return new cH(await super._call(e))}}class ev extends U{}class ex extends ev{}class eP extends ev{async _call(e){return new cW(await super._call(e))}}class eT extends ev{async _call(e){return new cG(await super._call(e))}}class ek extends ev{async _call(e){return new cU(await super._call(e))}}class eF extends ev{async _call(e){return new cH(await super._call(e))}}class eS extends U{}class eC extends eS{}class eE extends eS{async _call(e){return new cW(await super._call(e))}}class eA extends eS{async _call(e){return new cG(await super._call(e))}}class eI extends eS{async _call(e){return new cU(await super._call(e))}}class e$ extends eS{async _call(e){return new cH(await super._call(e))}}class eL extends U{}class ej extends eL{}class eO extends eL{async _call(e){return new cW(await super._call(e))}}class eN extends eL{async _call(e){return new cG(await super._call(e))}}class eD extends eL{async _call(e){return new cU(await super._call(e))}}class ez extends eL{async _call(e){return new cH(await super._call(e))}}class eV extends U{}class eB extends eV{}class eR extends eV{async _call(e){return new cW(await super._call(e))}}class eG extends eV{async _call(e){return new cG(await super._call(e))}}class eq extends eV{async _call(e){return new cU(await super._call(e))}}class eU extends eV{async _call(e){return new cH(await super._call(e))}}class eW extends U{}class eH extends eW{}class eQ extends eW{async _call(e){return new cW(await super._call(e))}}class eX extends eW{async _call(e){return new cG(await super._call(e))}}class eJ extends eW{async _call(e){return new cU(await super._call(e))}}class eK extends eW{async _call(e){return new cH(await super._call(e))}}class eY extends U{}class eZ extends eY{}class e0 extends eY{async _call(e){return new cG(await super._call(e))}}class e1 extends eY{async _call(e){return new cU(await super._call(e))}}class e2 extends eY{async _call(e){return new cH(await super._call(e))}}class e3 extends eY{async _call(e){return new cW(await super._call(e))}}class e4 extends U{}class e5 extends e4{}class e8 extends e4{async _call(e){return new cW(await super._call(e))}}class e6 extends e4{async _call(e){return new cG(await super._call(e))}}class e7 extends e4{async _call(e){return new cU(await super._call(e))}}class e9 extends U{}class te extends e9{}class tt extends e9{async _call(e){return new cW(await super._call(e))}}class tr extends e9{async _call(e){return new cG(await super._call(e))}}class ts extends e9{async _call(e){return new cH(await super._call(e))}}class to extends U{}class ta extends to{}class tn extends to{async _call(e){return new cW(await super._call(e))}}class ti extends to{async _call(e){return new cG(await super._call(e))}}class tl extends to{async _call(e){return new cU(await super._call(e))}}class tc extends to{async _call(e){return new cH(await super._call(e))}}class td extends U{}class tu extends td{}class tm extends td{async _call(e){return new cW(await super._call(e))}}class tp extends td{async _call(e){return new cG(await super._call(e))}}class th extends td{async _call(e){return new cH(await super._call(e))}}class tf extends U{}class t_ extends tf{}class tg extends tf{async _call(e){return new cG(await super._call(e))}}class tM extends tf{async _call(e){return new cH(await super._call(e))}}class ty extends tf{async _call(e){return new cW(await super._call(e))}}class tw extends U{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"]}class tb extends tw{}class tv extends tw{}class tx extends U{}class tP extends tx{}class tT extends tx{}class tk extends U{}class tF extends tk{}class tS extends tk{}class tC extends U{}class tE extends tC{}class tA extends tC{}class tI extends tC{async _call(e){return new cG(await super._call(e))}}class t$ extends U{}class tL extends t${}class tj extends t${}class tO extends t${async _call(e){return new cG(await super._call(e))}}class tN extends t${}class tD extends U{}class tz extends tD{}class tV extends tD{}class tB extends U{}class tR extends tB{}class tG extends tB{}class tq extends U{}class tU extends tq{}class tW extends tq{async _call(e){return new cW(await super._call(e))}}class tH extends tq{async _call(e){return new cG(await super._call(e))}}class tQ extends tq{async _call(e){return new cU(await super._call(e))}}class tX extends tq{async _call(e){return new cH(await super._call(e))}}class tJ extends U{}class tK extends tJ{}class tY extends tJ{async _call(e){return new cW(await super._call(e))}}class tZ extends tJ{async _call(e){return new cG(await super._call(e))}}class t0 extends tJ{async _call(e){return new cU(await super._call(e))}}class t1 extends tJ{async _call(e){return new cH(await super._call(e))}}class t2 extends U{}class t3 extends t2{}class t4 extends t2{async _call(e){return new cW(await super._call(e))}}class t5 extends t2{async _call(e){return new cG(await super._call(e))}}class t8 extends t2{async _call(e){return new cU(await super._call(e))}}class t6 extends t2{async _call(e){return new cH(await super._call(e))}}class t7 extends U{}class t9 extends t7{}class re extends t7{}class rt extends U{requires_attention_mask=!1;main_input_name="input_features";forward_params=["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"]}class rr extends rt{}class rs extends rt{_prepare_generation_config(e,t){return super._prepare_generation_config(e,t,M.WhisperGenerationConfig)}_retrieve_init_tokens(e){let t=[e.decoder_start_token_id],r=e.language,s=e.task;if(e.is_multilingual){r||(console.warn("No language specified - defaulting to English (en)."),r="en");let o=(0,y.whisper_language_to_code)(r),a=`<|${o}|>`;t.push(e.lang_to_id[a]),t.push(e.task_to_id[s??"transcribe"])}else if(r||s)throw Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!e.return_timestamps&&e.no_timestamps_token_id&&t.at(-1)!==e.no_timestamps_token_id?t.push(e.no_timestamps_token_id):e.return_timestamps&&t.at(-1)===e.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),t.pop()),t.filter(e=>null!=e)}async generate({inputs:e=null,generation_config:t=null,logits_processor:r=null,stopping_criteria:s=null,...o}){t=this._prepare_generation_config(t,o);let a=o.decoder_input_ids??this._retrieve_init_tokens(t);if(t.return_timestamps&&(r??=new d.LogitsProcessorList).push(new d.WhisperTimeStampLogitsProcessor(t,a)),t.begin_suppress_tokens&&(r??=new d.LogitsProcessorList).push(new d.SuppressTokensAtBeginLogitsProcessor(t.begin_suppress_tokens,a.length)),t.return_token_timestamps){if(!t.alignment_heads)throw Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");"translate"===t.task&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),t.output_attentions=!0,t.return_dict_in_generate=!0}let n=await super.generate({inputs:e,generation_config:t,logits_processor:r,decoder_input_ids:a,...o});return t.return_token_timestamps&&(n.token_timestamps=this._extract_token_timestamps(n,t.alignment_heads,t.num_frames)),n}_extract_token_timestamps(e,t,r=null,s=.02){if(!e.cross_attentions)throw Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");null==r&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let o=this.config.median_filter_width;void 0===o&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),o=7);let a=e.cross_attentions,n=Array.from({length:this.config.decoder_layers},(e,t)=>(0,m.cat)(a.map(e=>e[t]),2)),l=(0,m.stack)(t.map(([e,t])=>{if(e>=n.length)throw Error(`Layer index ${e} is out of bounds for cross attentions (length ${n.length}).`);return r?n[e].slice(null,t,null,[0,r]):n[e].slice(null,t)})).transpose(1,0,2,3),[c,d]=(0,m.std_mean)(l,-2,0,!0),u=l.clone();for(let e=0;e<u.dims[0];++e){let t=u[e];for(let r=0;r<t.dims[0];++r){let s=t[r],a=c[e][r][0].data,n=d[e][r][0].data;for(let e=0;e<s.dims[0];++e){let t=s[e].data;for(let e=0;e<t.length;++e)t[e]=(t[e]-n[e])/a[e];t.set((0,h.medianFilter)(t,o))}}}let p=[(0,m.mean)(u,1)],f=e.sequences.dims,_=new m.Tensor("float32",new Float32Array(f[0]*f[1]),f);for(let e=0;e<f[0];++e){let t=p[e].neg().squeeze_(0),[r,o]=(0,h.dynamic_time_warping)(t.tolist()),a=Array.from({length:r.length-1},(e,t)=>r[t+1]-r[t]),n=(0,i.mergeArrays)([1],a).map(e=>!!e),l=[];for(let e=0;e<n.length;++e)n[e]&&l.push(o[e]*s);_[e].data.set(l,1)}return _}}class ro extends rs{}class ra extends U{requires_attention_mask=!1;main_input_name="input_values";forward_params=["input_values","decoder_input_ids","past_key_values"]}class rn extends ra{}class ri extends ra{}class rl extends U{main_input_name="pixel_values";forward_params=["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"]}class rc extends U{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class rd extends rc{_merge_input_ids_with_image_features(e){let t=e.image_features.dims.at(-1),r=e.image_features.view(-1,t);return j({image_token_id:this.config.image_token_index,...e,image_features:r})}}class ru extends rd{}class rm extends rd{}class rp extends U{forward_params=["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"];main_input_name="inputs_embeds"}class rh extends rp{_merge_input_ids_with_image_features({inputs_embeds:e,image_features:t,input_ids:r,attention_mask:s}){return{inputs_embeds:(0,m.cat)([t,e],1),attention_mask:(0,m.cat)([(0,m.ones)(t.dims.slice(0,2)),s],1)}}async _prepare_inputs_embeds({input_ids:e,pixel_values:t,inputs_embeds:r,attention_mask:s}){let o,a;if(!e&&!t)throw Error("Either `input_ids` or `pixel_values` should be provided.");return e&&(o=await this.encode_text({input_ids:e})),t&&(a=await this.encode_image({pixel_values:t})),o&&a?{inputs_embeds:r,attention_mask:s}=this._merge_input_ids_with_image_features({inputs_embeds:o,image_features:a,input_ids:e,attention_mask:s}):r=o||a,{inputs_embeds:r,attention_mask:s}}async forward({input_ids:e,pixel_values:t,attention_mask:r,decoder_input_ids:s,decoder_attention_mask:o,encoder_outputs:a,past_key_values:n,inputs_embeds:i,decoder_inputs_embeds:l}){if(i||({inputs_embeds:i,attention_mask:r}=await this._prepare_inputs_embeds({input_ids:e,pixel_values:t,inputs_embeds:i,attention_mask:r})),!a){let{last_hidden_state:e}=await A(this,{inputs_embeds:i,attention_mask:r});a=e}if(!l){if(!s)throw Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");l=await this.encode_text({input_ids:s})}let c={inputs_embeds:l,attention_mask:o,encoder_attention_mask:r,encoder_hidden_states:a,past_key_values:n};return await $(this,c,!0)}}class rf extends U{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class r_ extends rf{_merge_input_ids_with_image_features(e){let t=e.image_features.dims.at(-1),r=e.image_features.view(-1,t);return j({image_token_id:this.config.image_token_index,...e,image_features:r})}}class rg extends rc{_merge_input_ids_with_image_features(e){let t=e.image_features.dims.at(-1),r=e.image_features.view(-1,t);return j({image_token_id:this.config.image_token_index,...e,image_features:r})}}class rM extends rg{}class ry extends U{forward_params=["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"]}class rw extends ry{async forward({input_ids:e=null,attention_mask:t=null,pixel_values:r=null,input_features:s=null,input_features_mask:o=null,position_ids:a=null,inputs_embeds:n=null,per_layer_inputs:i=null,past_key_values:l=null,generation_config:c=null,logits_processor:d=null,...u}){if((!n||!i)&&({inputs_embeds:n,per_layer_inputs:i}=await F(this.sessions.embed_tokens,{input_ids:e}),1!==e.dims[1])){if(r){let{image_features:s}=await F(this.sessions.vision_encoder,{pixel_values:r});({inputs_embeds:n,attention_mask:t}=this._merge_input_ids_with_image_features({image_features:s,inputs_embeds:n,input_ids:e,attention_mask:t}))}if(s){let{audio_features:r}=await F(this.sessions.audio_encoder,{input_features:s,input_features_mask:o});({inputs_embeds:n,attention_mask:t}=this._merge_input_ids_with_audio_features({audio_features:r,inputs_embeds:n,input_ids:e,attention_mask:t}))}}return await $(this,{inputs_embeds:n,per_layer_inputs:i,past_key_values:l,attention_mask:t,position_ids:a,generation_config:c,logits_processor:d},!0)}_merge_input_ids_with_image_features(e){let t=e.image_features.dims.at(-1),r=e.image_features.view(-1,t);return j({image_token_id:this.config.image_token_id,...e,image_features:r})}_merge_input_ids_with_audio_features(e){let t=e.audio_features.dims.at(-1),r=e.audio_features.view(-1,t);return O({audio_token_id:this.config.audio_token_id,...e,audio_features:r})}}class rb extends U{forward_params=["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"]}class rv extends rb{async encode_image({pixel_values:e,pixel_attention_mask:t}){return(await F(this.sessions.vision_encoder,{pixel_values:e,pixel_attention_mask:t})).image_features}_merge_input_ids_with_image_features(e){let t=e.image_features.dims.at(-1),r=e.image_features.view(-1,t);return j({image_token_id:this.config.image_token_id,...e,image_features:r})}}class rx extends rv{}class rP extends U{forward_params=["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"]}class rT extends rP{async forward({input_ids:e=null,attention_mask:t=null,pixel_values:r=null,image_sizes:s=null,position_ids:o=null,inputs_embeds:a=null,past_key_values:n=null,generation_config:i=null,logits_processor:l=null,...c}){if(!a){let t;if(r&&1!==e.dims[1]){if(!s)throw Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:t}=await F(this.sessions.vision_encoder,{pixel_values:r,image_sizes:s}))}else{let e=this.config.normalized_config.hidden_size;t=new m.Tensor("float32",[],[0,e])}({inputs_embeds:a}=await F(this.sessions.prepare_inputs_embeds,{input_ids:e,image_features:t}))}return await $(this,{inputs_embeds:a,past_key_values:n,attention_mask:t,position_ids:o,generation_config:i,logits_processor:l},!1)}}class rk extends U{}class rF extends rk{}class rS extends rk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"text_model"})}}class rC extends rk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"text_model"})}}class rE extends rk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"vision_model"})}}class rA extends rk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"vision_model"})}}class rI extends U{}class r$ extends rI{}class rL extends rI{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"text_model"})}}class rj extends rk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"vision_model"})}}class rO extends U{}class rN extends rO{}class rD extends U{}class rz extends rD{async forward(e){let t=!e.input_ids,r=!e.pixel_values;if(t&&r)throw Error("Either `input_ids` or `pixel_values` should be provided.");if(t&&(e.input_ids=(0,m.ones)([e.pixel_values.dims[0],1])),r){let{image_size:t}=this.config.vision_config;e.pixel_values=(0,m.full)([0,3,t,t],0)}let{text_embeddings:s,image_embeddings:o,l2norm_text_embeddings:a,l2norm_image_embeddings:n}=await super.forward(e),i={};return t||(i.text_embeddings=s,i.l2norm_text_embeddings=a),r||(i.image_embeddings=o,i.l2norm_image_embeddings=n),i}}class rV extends rD{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"text_model"})}}class rB extends rD{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"vision_model"})}}class rR extends U{}class rG extends rR{}class rq extends rR{}class rU extends U{}class rW extends rU{}class rH extends rU{}class rQ extends U{}class rX extends rQ{}class rJ extends rQ{}class rK extends U{}class rY extends rK{}class rZ extends rK{}class r0 extends U{}class r1 extends r0{}class r2 extends r0{}class r3 extends U{}class r4 extends r3{}class r5 extends r3{}class r8 extends U{}class r6 extends r8{}class r7 extends r8{}class r9 extends U{}class se extends r9{}class st extends r9{}class sr extends U{}class ss extends sr{}class so extends sr{}class sa extends U{}class sn extends sa{}class si extends U{}class sl extends si{}class sc extends si{}class sd extends U{}class su extends sd{}class sm extends sd{}class sp extends U{}class sh extends sp{}class sf extends sp{}class s_ extends U{}class sg extends s_{}class sM extends s_{}class sy extends U{}class sw extends sy{}class sb extends sy{}class sv extends U{}class sx extends sv{}class sP extends sv{}class sT extends U{}class sk extends sT{}class sF extends sT{}class sS extends U{}class sC extends sS{}class sE extends sS{}class sA extends U{}class sI extends sA{}class s$ extends sA{}class sL extends U{}class sj extends sL{}class sO extends sL{}class sN extends U{}class sD extends sN{}class sz extends sN{}class sV extends U{}class sB extends sV{}class sR extends sV{}class sG extends U{}class sq extends sG{}class sU extends sG{}class sW extends U{}class sH extends sW{}class sQ extends sW{}class sX extends U{}class sJ extends sX{}class sK extends sX{}class sY extends U{}class sZ extends sY{}class s0 extends sY{}class s1 extends U{}class s2 extends s1{}class s3 extends s1{}class s4 extends U{}class s5 extends s4{}class s8 extends s4{}class s6 extends U{}class s7 extends s6{}class s9 extends s6{}class oe extends U{}class ot extends oe{}class or extends oe{}class os extends U{forward_params=["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"]}class oo extends os{get_rope_index(e,t,r,s){let{vision_config:o,image_token_id:a,video_token_id:n,vision_start_token_id:i}=this.config,l=o.spatial_merge_size??2,c=[];if(t||r){let o=e.tolist();s||(s=(0,m.ones_like)(e));let d=s.tolist(),u=Array.from({length:3},t=>Array.from({length:e.dims[0]},t=>Array.from({length:e.dims[1]},e=>1))),p=t?t.tolist():[],f=r?r.tolist():[],_=0,g=0;for(let e=0;e<o.length;++e){let t=o[e].filter((t,r)=>1==d[e][r]),r=t.reduce((e,t,r)=>(t==i&&e.push(r),e),[]).map(e=>t[e+1]),s=r.filter(e=>e==a).length,m=r.filter(e=>e==n).length,M=[],y=0,w=s,b=m;for(let e=0;e<r.length;++e){let e,r,s,o;let i=t.findIndex((e,t)=>t>y&&e==a),c=t.findIndex((e,t)=>t>y&&e==n),d=w>0&&-1!==i?i:t.length+1,u=b>0&&-1!==c?c:t.length+1;d<u?([r,s,o]=p[_],++_,--w,e=d):([r,s,o]=f[g],++g,--b,e=u);let[m,v,x]=[Number(r),Math.floor(Number(s)/l),Math.floor(Number(o)/l)],P=e-y,T=M.length>0?(0,h.max)(M.at(-1))[0]+1:0;M.push(Array.from({length:3*P},(e,t)=>T+t%P));let k=P+T,F=m*v*x,S=Array.from({length:F},(e,t)=>k+Math.floor(t/(v*x))),C=Array.from({length:F},(e,t)=>k+Math.floor(t/x)%v),E=Array.from({length:F},(e,t)=>k+t%x);M.push([S,C,E].flat()),y=e+F}if(y<t.length){let e=M.length>0?(0,h.max)(M.at(-1))[0]+1:0,r=t.length-y;M.push(Array.from({length:3*r},(t,s)=>e+s%r))}let v=M.reduce((e,t)=>e+t.length,0),x=Array(v),P=0;for(let e=0;e<3;++e)for(let t=0;t<M.length;++t){let r=M[t],s=r.length/3;for(let t=e*s;t<(e+1)*s;++t)x[P++]=r[t]}let T=0,k=d[e];for(let t=0;t<k.length;++t)if(1==k[t]){for(let r=0;r<3;++r)u[r][e][t]=x[r*v/3+T];++T}let F=(0,h.max)(x)[0];c.push(F+1-o[e].length)}return[new m.Tensor("int64",u.flat(1/0),[3,e.dims[0],e.dims[1]]),new m.Tensor("int64",c,[c.length,1])]}if(s){let{data:e,dims:t}=V(s),r=BigInt64Array.from({length:3*e.length},(t,r)=>e[r%e.length]),o=Array.from({length:t[0]},(r,s)=>(0,h.max)(e.subarray(t[1]*s,t[1]*(s+1)))[0]+1n+BigInt(t[1]));return[new m.Tensor("int64",r,[3,...t]),new m.Tensor("int64",o,[o.length,1])]}{let[t,r]=e.dims,s=BigInt64Array.from({length:3*t*r},(e,s)=>BigInt(Math.floor(s%r/t)));return[new m.Tensor("int64",s,[3,...e.dims]),(0,m.zeros)([t,1])]}}async encode_image({pixel_values:e,image_grid_thw:t}){return(await F(this.sessions.vision_encoder,{pixel_values:e,grid_thw:t})).image_features}_merge_input_ids_with_image_features(e){return j({image_token_id:this.config.image_token_id,...e})}prepare_inputs_for_generation(e,t,r){if(t.attention_mask&&!t.position_ids){if(t.past_key_values){t.pixel_values=null;let e=BigInt(Object.values(t.past_key_values)[0].dims.at(-2)),r=t.rope_deltas.map(t=>e+t);t.position_ids=(0,m.stack)([r,r,r],0)}else[t.position_ids,t.rope_deltas]=this.get_rope_index(t.input_ids,t.image_grid_thw,t.video_grid_thw,t.attention_mask)}return t}}class oa extends U{}class on extends oa{}class oi extends oa{}class ol extends U{}class oc extends ol{}class od extends ol{}class ou extends U{}class om extends ou{}class op extends ou{}class oh extends U{}class of extends oh{}class o_ extends oh{}class og extends U{}class oM extends og{}class oy extends og{}class ow extends U{}class ob extends ow{}class ov extends ow{async _call(e){return new cG(await super._call(e))}}class ox extends U{}class oP extends ox{}class oT extends ox{async _call(e){return new cG(await super._call(e))}}class ok extends U{}class oF extends ok{}class oS extends U{}class oC extends oS{}class oE extends oS{async _call(e){return new cG(await super._call(e))}}class oA extends U{}class oI extends oA{}class o$ extends U{}class oL extends o${}class oj extends o${async _call(e){return new cG(await super._call(e))}}class oO extends U{}class oN extends oO{}class oD extends U{}class oz extends oD{}class oV extends oD{async _call(e){return new cG(await super._call(e))}}class oB extends U{}class oR extends oB{async _call(e){return new cJ(await super._call(e))}}class oG extends U{}class oq extends oG{}class oU extends oG{async _call(e){return new cG(await super._call(e))}}class oW extends U{}class oH extends oW{}class oQ extends oW{async _call(e){return new cG(await super._call(e))}}class oX extends U{}class oJ extends oX{}class oK extends oX{}class oY extends U{}class oZ extends oY{}class o0 extends oY{}class o1 extends U{}class o2 extends o1{}class o3 extends o1{async _call(e){return new cG(await super._call(e))}}class o4 extends U{}class o5 extends o4{}class o8 extends o4{async _call(e){return new o7(await super._call(e))}}class o6 extends o4{async _call(e){return new o9(await super._call(e))}}class o7 extends W{constructor({logits:e,pred_boxes:t}){super(),this.logits=e,this.pred_boxes=t}}class o9 extends W{constructor({logits:e,pred_boxes:t,pred_masks:r}){super(),this.logits=e,this.pred_boxes=t,this.pred_masks=r}}class ae extends U{}class at extends ae{}class ar extends ae{async _call(e){return new as(await super._call(e))}}class as extends W{constructor({logits:e,pred_boxes:t}){super(),this.logits=e,this.pred_boxes=t}}class ao extends U{}class aa extends ao{}class an extends ao{async _call(e){return new ai(await super._call(e))}}class ai extends as{}class al extends U{}class ac extends al{}class ad extends al{async _call(e){return new au(await super._call(e))}}class au extends as{}class am extends U{}class ap extends am{}class ah extends am{async _call(e){return new as(await super._call(e))}}class af extends U{}class a_ extends af{}class ag extends af{async _call(e){return new aM(await super._call(e))}}class aM extends o7{}class ay extends U{}class aw extends ay{}class ab extends ay{async _call(e){return new cG(await super._call(e))}}class av extends U{}class ax extends av{}class aP extends av{async _call(e){return new cG(await super._call(e))}}class aT extends U{}class ak extends aT{}class aF extends aT{async _call(e){return new cG(await super._call(e))}}class aS extends U{}class aC extends aS{}class aE extends aS{async _call(e){return new cG(await super._call(e))}}class aA extends aS{}class aI extends U{}class a$ extends aI{}class aL extends aI{}class aj extends U{}class aO extends aj{}class aN extends aj{}class aD extends U{}class az extends aD{}class aV extends U{}class aB extends aV{}class aR extends aV{}class aG extends aV{}class aq extends U{}class aU extends aq{}class aW extends U{}class aH extends aW{}class aQ extends U{}class aX extends aQ{}class aJ extends U{}class aK extends aJ{}class aY extends aJ{}class aZ extends U{}class a0 extends aZ{}class a1 extends aZ{}class a2 extends U{}class a3 extends a2{}class a4 extends U{}class a5 extends a4{}class a8 extends a4{async _call(e){return new cG(await super._call(e))}}class a6 extends U{}class a7 extends a6{}class a9 extends a6{async _call(e){return new cG(await super._call(e))}}class ne extends U{}class nt extends ne{}class nr extends ne{async _call(e){return new cG(await super._call(e))}}class ns extends U{}class no extends ns{}class na extends ns{async _call(e){return new cG(await super._call(e))}}class nn extends U{}class ni extends nn{}class nl extends U{}class nc extends nl{}class nd extends U{}class nu extends nd{}class nm extends U{}class np extends nm{}class nh extends nm{async _call(e){return new nf(await super._call(e))}}class nf extends W{constructor({logits:e,pred_boxes:t}){super(),this.logits=e,this.pred_boxes=t}}class n_ extends U{}class ng extends n_{async get_image_embeddings({pixel_values:e}){return await A(this,{pixel_values:e})}async forward(e){e=e.image_embeddings&&e.image_positional_embeddings?{...e}:{...e,...await this.get_image_embeddings(e)},e.input_labels??=(0,m.ones)(e.input_points.dims.slice(0,-1));let t={image_embeddings:e.image_embeddings,image_positional_embeddings:e.image_positional_embeddings};return e.input_points&&(t.input_points=e.input_points),e.input_labels&&(t.input_labels=e.input_labels),e.input_boxes&&(t.input_boxes=e.input_boxes),await F(this.sessions.prompt_encoder_mask_decoder,t)}async _call(e){return new nM(await super._call(e))}}class nM extends W{constructor({iou_scores:e,pred_masks:t}){super(),this.iou_scores=e,this.pred_masks=t}}class ny extends W{constructor({iou_scores:e,pred_masks:t,object_score_logits:r}){super(),this.iou_scores=e,this.pred_masks=t,this.object_score_logits=r}}class nw extends U{}class nb extends nw{async get_image_embeddings({pixel_values:e}){return await A(this,{pixel_values:e})}async forward(e){let{num_feature_levels:t}=this.config.vision_config;if((e=Array.from({length:t},(e,t)=>`image_embeddings.${t}`).some(t=>!e[t])?{...e,...await this.get_image_embeddings(e)}:{...e}).input_points){if(e.input_boxes&&1!==e.input_boxes.dims[1])throw Error("When both `input_points` and `input_boxes` are provided, the number of boxes per image must be 1.");let t=e.input_points.dims;e.input_labels??=(0,m.ones)(t.slice(0,-1)),e.input_boxes??=(0,m.full)([t[0],0,4],0)}else if(e.input_boxes){let t=e.input_boxes.dims;e.input_labels=(0,m.full)([t[0],t[1],0],-1n),e.input_points=(0,m.full)([t[0],1,0,2],0)}else throw Error("At least one of `input_points` or `input_boxes` must be provided.");let r=this.sessions.prompt_encoder_mask_decoder,s=(0,i.pick)(e,r.inputNames);return await F(r,s)}async _call(e){return new ny(await super._call(e))}}class nv extends nb{}class nx extends nb{}class nP extends U{}class nT extends nP{}class nk extends nP{}class nF extends U{}class nS extends nF{}class nC extends nF{}class nE extends U{}class nA extends nE{}class nI extends nE{async _call(e){return new cQ(await super._call(e))}}class n$ extends nE{async _call(e){return new cG(await super._call(e))}}class nL extends nE{async _call(e){return new cU(await super._call(e))}}class nj extends U{}class nO extends nj{async _call(e){return new cQ(await super._call(e))}}class nN extends U{}class nD extends nN{}class nz extends nN{async _call(e){return new cU(await super._call(e))}}class nV extends U{}class nB extends nV{}class nR extends U{}class nG extends nR{}class nq extends nR{async _call(e){return new cQ(await super._call(e))}}class nU extends nR{async _call(e){return new cG(await super._call(e))}}class nW extends U{}class nH extends nW{}class nQ extends nW{async _call(e){return new cQ(await super._call(e))}}class nX extends nW{async _call(e){return new cG(await super._call(e))}}class nJ extends nW{async _call(e){return new cU(await super._call(e))}}class nK extends U{}class nY extends nK{}class nZ extends nK{async _call(e){return new cQ(await super._call(e))}}class n0 extends nK{async _call(e){return new cG(await super._call(e))}}class n1 extends U{}class n2 extends nE{}class n3 extends nE{async _call(e){return new cQ(await super._call(e))}}class n4 extends nE{async _call(e){return new cG(await super._call(e))}}class n5 extends U{}class n8 extends n5{}class n6 extends n5{async _call(e){return new cQ(await super._call(e))}}class n7 extends n5{async _call(e){return new cG(await super._call(e))}}class n9 extends n5{async _call(e){return new cq(await super._call(e))}}class ie extends n5{async _call(e){return new cU(await super._call(e))}}class it extends U{}class ir extends it{}class is extends U{}class io extends is{}class ia extends is{}class ii extends is{async generate_speech(e,t,{threshold:r=.5,minlenratio:s=0,maxlenratio:o=20,vocoder:a=null}={}){let{encoder_outputs:n,encoder_attention_mask:i}=await A(this,{input_ids:e}),l=n.dims[1]/this.config.reduction_factor,c=Math.floor(l*o),d=Math.floor(l*s),u=this.config.num_mel_bins,p=[],h=null,f=null,_=0;for(;;){++_;let e={use_cache_branch:C(!!f),output_sequence:f?f.output_sequence_out:new m.Tensor("float32",new Float32Array(u),[1,1,u]),encoder_attention_mask:i,speaker_embeddings:t,encoder_hidden_states:n};this.addPastKeyValues(e,h),f=await F(this.sessions.decoder_model_merged,e),h=this.getPastKeyValues(f,h);let{prob:s,spectrum:o}=f;if(p.push(o),_>=d&&(Array.from(s.data).filter(e=>e>=r).length>0||_>=c))break}let g=(0,m.cat)(p),{waveform:M}=await F(a.sessions.model,{spectrogram:g});return{spectrogram:g,waveform:M}}}class il extends U{main_input_name="spectrogram"}class ic extends U{}class id extends ic{async generate_speech({input_ids:e,attention_mask:t,style:r,num_inference_steps:s=5,speed:o=1.05}){let{sampling_rate:a,chunk_compress_factor:n,base_chunk_size:i,latent_dim:l}=this.config,{last_hidden_state:c,durations:d}=await F(this.sessions.text_encoder,{input_ids:e,attention_mask:t,style:r});d.div_(o);let u=d.max().item()*a,p=i*n,h=Math.floor((u+p-1)/p),f=e.dims[0],_=(0,m.ones)([f,h]),g=(0,m.full)([f],s),M=(0,m.randn)([f,l*n,h]);for(let e=0;e<s;++e){let s=(0,m.full)([f],e);({denoised_latents:M}=await F(this.sessions.latent_denoiser,{style:r,noisy_latents:M,latent_mask:_,encoder_outputs:c,attention_mask:t,timestep:s,num_inference_steps:g}))}let{waveform:y}=await F(this.sessions.voice_decoder,{latents:M});return{waveform:y,durations:d}}}class iu extends U{}class im extends iu{}class ip extends U{}class ih extends ip{}class i_ extends ip{}class ig extends U{}class iM extends ig{}class iy extends ig{}class iw extends U{}class ib extends iw{}class iv extends iw{}class ix extends U{}class iP extends ix{}class iT extends ix{}class ik extends U{}class iF extends ik{}class iS extends ik{}class iC extends U{}class iE extends iC{}class iA extends iC{}class iI extends U{}class i$ extends iI{}class iL extends iI{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"text_model"})}}class ij extends iI{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"audio_model"})}}class iO extends U{}class iN extends iO{async _call(e){return new cK(await super._call(e))}}class iD extends U{}class iz extends iD{}class iV extends iD{}class iB extends iD{}class iR extends U{}class iG extends iR{}class iq extends iR{}class iU extends U{}class iW extends iU{}class iH extends iU{async _call(e){return new cG(await super._call(e))}}class iQ extends U{}class iX extends iQ{}class iJ extends iQ{}class iK extends U{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"];_apply_and_filter_by_delay_pattern_mask(e){let[t,r]=e.dims,s=this.config.decoder.num_codebooks,o=r-s,a=0;for(let t=0;t<e.size;++t){if(e.data[t]===this.config.decoder.pad_token_id)continue;let n=t%r-Math.floor(t/r)%s;n>0&&n<=o&&(e.data[a++]=e.data[t])}let n=Math.floor(t/s),i=a/(n*s);return new m.Tensor(e.type,e.data.slice(0,a),[n,s,i])}prepare_inputs_for_generation(e,t,r){let s=structuredClone(e);for(let e=0;e<s.length;++e)for(let t=0;t<s[e].length;++t)e%this.config.decoder.num_codebooks>=t&&(s[e][t]=BigInt(this.config.decoder.pad_token_id));return null!==r.guidance_scale&&r.guidance_scale>1&&(s=s.concat(s)),super.prepare_inputs_for_generation(s,t,r)}async generate(e){let t=await super.generate(e),r=this._apply_and_filter_by_delay_pattern_mask(t).unsqueeze_(0),{audio_values:s}=await F(this.sessions.encodec_decode,{audio_codes:r});return s}}class iY extends U{}class iZ extends iY{}class i0 extends iY{async _call(e){return new cG(await super._call(e))}}class i1 extends iY{}class i2 extends U{}class i3 extends i2{}class i4 extends i2{async _call(e){return new cG(await super._call(e))}}class i5 extends i2{}class i8 extends U{}class i6 extends i8{}class i7 extends i8{async _call(e){return new cG(await super._call(e))}}class i9 extends i8{}class le extends U{}class lt extends le{}class lr extends le{async _call(e){return new cG(await super._call(e))}}class ls extends le{}class lo extends U{}class la extends lo{}class ln extends U{}class li extends ln{forward_params=["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"];constructor(...e){super(...e),this._generation_mode="text"}async forward(e){let t;let r=this._generation_mode??"text";if("text"!==r&&e.past_key_values){let r=this.sessions.gen_img_embeds,s=(0,i.pick)({image_ids:e.input_ids},r.inputNames);t=await F(r,s)}else{let r=this.sessions.prepare_inputs_embeds,s=(0,i.pick)(e,r.inputNames);t=await F(r,s)}let s={...e,...t},o=await $(this,s),a=this.sessions["text"===r?"lm_head":"gen_head"];if(!a)throw Error(`Unable to find "${a}" generation head`);let n=await F(a,(0,i.pick)(o,a.inputNames));return{...t,...o,...n}}async generate(e){return this._generation_mode="text",super.generate(e)}async generate_images(e){this._generation_mode="image";let t=(e.inputs??e[this.main_input_name]).dims[1],r=(await super.generate(e)).slice(null,[t,null]),s=this.sessions.image_decode,{decoded_image:o}=await F(s,{generated_tokens:r}),a=o.add_(1).mul_(127.5).clamp_(0,255).to("uint8"),n=[];for(let e of a){let t=p.RawImage.fromTensor(e);n.push(t)}return n}}class ll extends W{constructor({char_logits:e,bpe_logits:t,wp_logits:r}){super(),this.char_logits=e,this.bpe_logits=t,this.wp_logits=r}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class lc extends U{}class ld extends lc{async _call(e){return new ll(await super._call(e))}}class lu extends U{}class lm extends lu{}class lp extends lu{}class lh extends U{}class lf extends lh{}class l_ extends lh{}class lg extends U{forward_params=["input_ids","attention_mask","position_ids","audio_values","past_key_values"]}class lM extends lg{_merge_input_ids_with_audio_features(e){let t=e.audio_features.dims.at(-1),r=e.audio_features.view(-1,t);return O({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...e,audio_features:r})}}class ly extends lM{}class lw extends U{main_input_name="input_values";forward_params=["input_values"]}class lb extends W{constructor({audio_codes:e}){super(),this.audio_codes=e}}class lv extends W{constructor({audio_values:e}){super(),this.audio_values=e}}class lx extends lw{async encode(e){return new lb(await F(this.sessions.encoder_model,e))}async decode(e){return new lv(await F(this.sessions.decoder_model,e))}}class lP extends lw{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"encoder_model"})}}class lT extends lw{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"decoder_model"})}}class lk extends U{main_input_name="input_values";forward_params=["input_values"]}class lF extends W{constructor({audio_codes:e}){super(),this.audio_codes=e}}class lS extends W{constructor({audio_values:e}){super(),this.audio_values=e}}class lC extends lk{async encode(e){return new lF(await F(this.sessions.encoder_model,e))}async decode(e){return new lS(await F(this.sessions.decoder_model,e))}}class lE extends lk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"encoder_model"})}}class lA extends lk{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"decoder_model"})}}class lI extends U{main_input_name="input_values";forward_params=["input_values"]}class l$ extends lI{async encode(e){return await F(this.sessions.encoder_model,e)}async decode(e){return await F(this.sessions.decoder_model,e)}}class lL extends lI{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"encoder_model"})}}class lj extends lI{static async from_pretrained(e,t={}){return super.from_pretrained(e,{...t,model_file_name:t.model_file_name??"decoder_model"})}}class lO{static MODEL_CLASS_MAPPINGS=null;static BASE_IF_FAIL=!1;static async from_pretrained(e,{progress_callback:t=null,config:r=null,cache_dir:o=null,local_files_only:a=!1,revision:n="main",model_file_name:i=null,subfolder:l="onnx",device:c=null,dtype:d=null,use_external_data_format:u=null,session_options:m={}}={}){let p={progress_callback:t,config:r,cache_dir:o,local_files_only:a,revision:n,model_file_name:i,subfolder:l,device:c,dtype:d,use_external_data_format:u,session_options:m};if(p.config=await s.AutoConfig.from_pretrained(e,p),!this.MODEL_CLASS_MAPPINGS)throw Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);let h=p.config.model_type;for(let t of this.MODEL_CLASS_MAPPINGS){let r=t.get(h);if(!r){for(let e of t.values())if(e[0]===h){r=e;break}if(!r)continue}return await r[1].from_pretrained(e,p)}if(this.BASE_IF_FAIL)return cd.has(h)||console.warn(`Unknown model class "${h}", attempting to construct from base class.`),await U.from_pretrained(e,p);throw Error(`Unsupported model type: ${h}`)}}let lN=new Map([["bert",["BertModel",X]],["neobert",["NeoBertModel",et]],["modernbert",["ModernBertModel",ei]],["nomic_bert",["NomicBertModel",ef]],["roformer",["RoFormerModel",eg]],["electra",["ElectraModel",eC]],["esm",["EsmModel",e5]],["convbert",["ConvBertModel",ex]],["camembert",["CamembertModel",ej]],["deberta",["DebertaModel",eB]],["deberta-v2",["DebertaV2Model",eH]],["mpnet",["MPNetModel",ta]],["albert",["AlbertModel",t_]],["distilbert",["DistilBertModel",eZ]],["roberta",["RobertaModel",tU]],["xlm",["XLMModel",tK]],["xlm-roberta",["XLMRobertaModel",t3]],["clap",["ClapModel",i$]],["clip",["CLIPModel",rF]],["clipseg",["CLIPSegModel",rG]],["chinese_clip",["ChineseCLIPModel",rN]],["siglip",["SiglipModel",r$]],["jina_clip",["JinaCLIPModel",rz]],["mobilebert",["MobileBertModel",te]],["squeezebert",["SqueezeBertModel",tu]],["wav2vec2",["Wav2Vec2Model",nA]],["wav2vec2-bert",["Wav2Vec2BertModel",nY]],["unispeech",["UniSpeechModel",nG]],["unispeech-sat",["UniSpeechSatModel",nH]],["hubert",["HubertModel",n2]],["wavlm",["WavLMModel",n8]],["audio-spectrogram-transformer",["ASTModel",t9]],["vits",["VitsModel",iN]],["pyannote",["PyAnnoteModel",nD]],["wespeaker-resnet",["WeSpeakerResNetModel",nB]],["detr",["DetrModel",o5]],["rt_detr",["RTDetrModel",at]],["rt_detr_v2",["RTDetrV2Model",aa]],["rf_detr",["RFDetrModel",ac]],["d_fine",["DFineModel",ap]],["table-transformer",["TableTransformerModel",a_]],["vit",["ViTModel",ob]],["ijepa",["IJepaModel",oP]],["pvt",["PvtModel",oC]],["vit_msn",["ViTMSNModel",oL]],["vit_mae",["ViTMAEModel",oI]],["groupvit",["GroupViTModel",oN]],["fastvit",["FastViTModel",oz]],["mobilevit",["MobileViTModel",oq]],["mobilevitv2",["MobileViTV2Model",oH]],["owlvit",["OwlViTModel",oJ]],["owlv2",["Owlv2Model",oZ]],["beit",["BeitModel",o2]],["deit",["DeiTModel",aw]],["hiera",["HieraModel",ax]],["convnext",["ConvNextModel",a5]],["convnextv2",["ConvNextV2Model",a7]],["dinov2",["Dinov2Model",nt]],["dinov2_with_registers",["Dinov2WithRegistersModel",no]],["dinov3_vit",["DINOv3ViTModel",ni]],["dinov3_convnext",["DINOv3ConvNextModel",nc]],["resnet",["ResNetModel",ak]],["swin",["SwinModel",aC]],["swin2sr",["Swin2SRModel",a$]],["donut-swin",["DonutSwinModel",a3]],["yolos",["YolosModel",np]],["dpt",["DPTModel",aO]],["glpn",["GLPNModel",a0]],["hifigan",["SpeechT5HifiGan",il]],["efficientnet",["EfficientNetModel",iW]],["decision_transformer",["DecisionTransformerModel",la]],["patchtst",["PatchTSTForPrediction",lm]],["patchtsmixer",["PatchTSMixerForPrediction",lf]],["mobilenet_v1",["MobileNetV1Model",iZ]],["mobilenet_v2",["MobileNetV2Model",i3]],["mobilenet_v3",["MobileNetV3Model",i6]],["mobilenet_v4",["MobileNetV4Model",lt]],["maskformer",["MaskFormerModel",aK]],["mgp-str",["MgpstrForSceneTextRecognition",ld]],["style_text_to_speech_2",["StyleTextToSpeech2Model",ir]]]),lD=new Map([["t5",["T5Model",tb]],["longt5",["LongT5Model",tP]],["mt5",["MT5Model",tF]],["bart",["BartModel",tE]],["mbart",["MBartModel",tL]],["marian",["MarianModel",nT]],["whisper",["WhisperModel",rr]],["m2m_100",["M2M100Model",nS]],["blenderbot",["BlenderbotModel",tz]],["blenderbot-small",["BlenderbotSmallModel",tR]]]),lz=new Map([["mimi",["MimiModel",lx]],["dac",["DacModel",lC]],["snac",["SnacModel",l$]]]),lV=new Map([["bloom",["BloomModel",om]],["jais",["JAISModel",rX]],["gpt2",["GPT2Model",rW]],["gptj",["GPTJModel",r4]],["gpt_bigcode",["GPTBigCodeModel",r6]],["gpt_neo",["GPTNeoModel",rY]],["gpt_neox",["GPTNeoXModel",r1]],["codegen",["CodeGenModel",se]],["llama",["LlamaModel",ss]],["nanochat",["NanoChatModel",sl]],["arcee",["ArceeModel",su]],["lfm2",["Lfm2Model",sh]],["smollm3",["SmolLM3Model",sg]],["exaone",["ExaoneModel",sk]],["olmo",["OlmoModel",sI]],["olmo2",["Olmo2Model",sj]],["mobilellm",["MobileLLMModel",sC]],["granite",["GraniteModel",sD]],["granitemoehybrid",["GraniteMoeHybridModel",sB]],["cohere",["CohereModel",sq]],["gemma",["GemmaModel",sH]],["gemma2",["Gemma2Model",sJ]],["vaultgemma",["VaultGemmaModel",sZ]],["gemma3_text",["Gemma3Model",s2]],["helium",["HeliumModel",sw]],["glm",["GlmModel",sx]],["openelm",["OpenELMModel",s5]],["qwen2",["Qwen2Model",s7]],["qwen3",["Qwen3Model",ot]],["phi",["PhiModel",on]],["phi3",["Phi3Model",oc]],["mpt",["MptModel",of]],["opt",["OPTModel",oM]],["mistral",["MistralModel",ih]],["ministral",["MinistralModel",iM]],["ministral3",["Ministral3Model",ib]],["ernie4_5",["Ernie4_5Model",iP]],["starcoder2",["Starcoder2Model",iF]],["falcon",["FalconModel",iE]],["stablelm",["StableLmModel",iG]],["modernbert-decoder",["ModernBertDecoderModel",em]]]),lB=new Map([["speecht5",["SpeechT5ForSpeechToText",ia]],["whisper",["WhisperForConditionalGeneration",rs]],["lite-whisper",["LiteWhisperForConditionalGeneration",ro]],["moonshine",["MoonshineForConditionalGeneration",ri]]]),lR=new Map([["speecht5",["SpeechT5ForTextToSpeech",ii]]]),lG=new Map([["vits",["VitsModel",iN]],["musicgen",["MusicgenForConditionalGeneration",iK]],["supertonic",["SupertonicForConditionalGeneration",id]]]),lq=new Map([["bert",["BertForSequenceClassification",K]],["neobert",["NeoBertForSequenceClassification",es]],["modernbert",["ModernBertForSequenceClassification",ec]],["roformer",["RoFormerForSequenceClassification",ey]],["electra",["ElectraForSequenceClassification",eA]],["esm",["EsmForSequenceClassification",e6]],["convbert",["ConvBertForSequenceClassification",eT]],["camembert",["CamembertForSequenceClassification",eN]],["deberta",["DebertaForSequenceClassification",eG]],["deberta-v2",["DebertaV2ForSequenceClassification",eX]],["mpnet",["MPNetForSequenceClassification",ti]],["albert",["AlbertForSequenceClassification",tg]],["distilbert",["DistilBertForSequenceClassification",e0]],["roberta",["RobertaForSequenceClassification",tH]],["xlm",["XLMForSequenceClassification",tZ]],["xlm-roberta",["XLMRobertaForSequenceClassification",t5]],["bart",["BartForSequenceClassification",tI]],["mbart",["MBartForSequenceClassification",tO]],["mobilebert",["MobileBertForSequenceClassification",tr]],["squeezebert",["SqueezeBertForSequenceClassification",tp]]]),lU=new Map([["bert",["BertForTokenClassification",Y]],["neobert",["NeoBertForTokenClassification",eo]],["modernbert",["ModernBertForTokenClassification",ed]],["roformer",["RoFormerForTokenClassification",ew]],["electra",["ElectraForTokenClassification",eI]],["esm",["EsmForTokenClassification",e7]],["convbert",["ConvBertForTokenClassification",ek]],["camembert",["CamembertForTokenClassification",eD]],["deberta",["DebertaForTokenClassification",eq]],["deberta-v2",["DebertaV2ForTokenClassification",eJ]],["mpnet",["MPNetForTokenClassification",tl]],["distilbert",["DistilBertForTokenClassification",e1]],["roberta",["RobertaForTokenClassification",tQ]],["xlm",["XLMForTokenClassification",t0]],["xlm-roberta",["XLMRobertaForTokenClassification",t8]]]),lW=new Map([["t5",["T5ForConditionalGeneration",tv]],["longt5",["LongT5ForConditionalGeneration",tT]],["mt5",["MT5ForConditionalGeneration",tS]],["bart",["BartForConditionalGeneration",tA]],["mbart",["MBartForConditionalGeneration",tj]],["marian",["MarianMTModel",nk]],["m2m_100",["M2M100ForConditionalGeneration",nC]],["blenderbot",["BlenderbotForConditionalGeneration",tV]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",tG]]]),lH=new Map([["bloom",["BloomForCausalLM",op]],["gpt2",["GPT2LMHeadModel",rH]],["jais",["JAISLMHeadModel",rJ]],["gptj",["GPTJForCausalLM",r5]],["gpt_bigcode",["GPTBigCodeForCausalLM",r7]],["gpt_neo",["GPTNeoForCausalLM",rZ]],["gpt_neox",["GPTNeoXForCausalLM",r2]],["codegen",["CodeGenForCausalLM",st]],["llama",["LlamaForCausalLM",so]],["nanochat",["NanoChatForCausalLM",sc]],["llama4_text",["Llama4ForCausalLM",sn]],["arcee",["ArceeForCausalLM",sm]],["lfm2",["Lfm2ForCausalLM",sf]],["smollm3",["SmolLM3ForCausalLM",sM]],["exaone",["ExaoneForCausalLM",sF]],["olmo",["OlmoForCausalLM",s$]],["olmo2",["Olmo2ForCausalLM",sO]],["mobilellm",["MobileLLMForCausalLM",sE]],["granite",["GraniteForCausalLM",sz]],["granitemoehybrid",["GraniteMoeHybridForCausalLM",sR]],["cohere",["CohereForCausalLM",sU]],["gemma",["GemmaForCausalLM",sQ]],["gemma2",["Gemma2ForCausalLM",sK]],["vaultgemma",["VaultGemmaForCausalLM",s0]],["gemma3_text",["Gemma3ForCausalLM",s3]],["helium",["HeliumForCausalLM",sb]],["glm",["GlmForCausalLM",sP]],["openelm",["OpenELMForCausalLM",s8]],["qwen2",["Qwen2ForCausalLM",s9]],["qwen3",["Qwen3ForCausalLM",or]],["phi",["PhiForCausalLM",oi]],["phi3",["Phi3ForCausalLM",od]],["mpt",["MptForCausalLM",o_]],["opt",["OPTForCausalLM",oy]],["mbart",["MBartForCausalLM",tN]],["mistral",["MistralForCausalLM",i_]],["ministral",["MinistralForCausalLM",iy]],["ministral3",["Ministral3ForCausalLM",iv]],["ernie4_5",["Ernie4_5ForCausalLM",iT]],["starcoder2",["Starcoder2ForCausalLM",iS]],["falcon",["FalconForCausalLM",iA]],["trocr",["TrOCRForCausalLM",im]],["stablelm",["StableLmForCausalLM",iq]],["modernbert-decoder",["ModernBertDecoderForCausalLM",ep]],["phi3_v",["Phi3VForCausalLM",rT]]]),lQ=new Map([["multi_modality",["MultiModalityCausalLM",li]]]),lX=new Map([["bert",["BertForMaskedLM",J]],["neobert",["NeoBertForMaskedLM",er]],["modernbert",["ModernBertForMaskedLM",el]],["roformer",["RoFormerForMaskedLM",eM]],["electra",["ElectraForMaskedLM",eE]],["esm",["EsmForMaskedLM",e8]],["convbert",["ConvBertForMaskedLM",eP]],["camembert",["CamembertForMaskedLM",eO]],["deberta",["DebertaForMaskedLM",eR]],["deberta-v2",["DebertaV2ForMaskedLM",eQ]],["mpnet",["MPNetForMaskedLM",tn]],["albert",["AlbertForMaskedLM",ty]],["distilbert",["DistilBertForMaskedLM",e3]],["roberta",["RobertaForMaskedLM",tW]],["xlm",["XLMWithLMHeadModel",tY]],["xlm-roberta",["XLMRobertaForMaskedLM",t4]],["mobilebert",["MobileBertForMaskedLM",tt]],["squeezebert",["SqueezeBertForMaskedLM",tm]]]),lJ=new Map([["bert",["BertForQuestionAnswering",Z]],["neobert",["NeoBertForQuestionAnswering",ea]],["roformer",["RoFormerForQuestionAnswering",eb]],["electra",["ElectraForQuestionAnswering",e$]],["convbert",["ConvBertForQuestionAnswering",eF]],["camembert",["CamembertForQuestionAnswering",ez]],["deberta",["DebertaForQuestionAnswering",eU]],["deberta-v2",["DebertaV2ForQuestionAnswering",eK]],["mpnet",["MPNetForQuestionAnswering",tc]],["albert",["AlbertForQuestionAnswering",tM]],["distilbert",["DistilBertForQuestionAnswering",e2]],["roberta",["RobertaForQuestionAnswering",tX]],["xlm",["XLMForQuestionAnswering",t1]],["xlm-roberta",["XLMRobertaForQuestionAnswering",t6]],["mobilebert",["MobileBertForQuestionAnswering",ts]],["squeezebert",["SqueezeBertForQuestionAnswering",th]]]),lK=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",rl]],["idefics3",["Idefics3ForConditionalGeneration",rv]],["smolvlm",["SmolVLMForConditionalGeneration",rx]]]),lY=new Map([["llava",["LlavaForConditionalGeneration",rd]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",ru]],["moondream1",["Moondream1ForConditionalGeneration",rm]],["florence2",["Florence2ForConditionalGeneration",rh]],["qwen2-vl",["Qwen2VLForConditionalGeneration",oo]],["idefics3",["Idefics3ForConditionalGeneration",rv]],["smolvlm",["SmolVLMForConditionalGeneration",rx]],["paligemma",["PaliGemmaForConditionalGeneration",r_]],["llava_qwen2",["LlavaQwen2ForCausalLM",rg]],["gemma3n",["Gemma3nForConditionalGeneration",rw]],["mistral3",["Mistral3ForConditionalGeneration",rM]]]),lZ=new Map([["ultravox",["UltravoxModel",lM]],["voxtral",["VoxtralForConditionalGeneration",ly]]]),l0=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",rl]]]),l1=new Map([["vit",["ViTForImageClassification",ov]],["ijepa",["IJepaForImageClassification",oT]],["pvt",["PvtForImageClassification",oE]],["vit_msn",["ViTMSNForImageClassification",oj]],["fastvit",["FastViTForImageClassification",oV]],["mobilevit",["MobileViTForImageClassification",oU]],["mobilevitv2",["MobileViTV2ForImageClassification",oQ]],["beit",["BeitForImageClassification",o3]],["deit",["DeiTForImageClassification",ab]],["hiera",["HieraForImageClassification",aP]],["convnext",["ConvNextForImageClassification",a8]],["convnextv2",["ConvNextV2ForImageClassification",a9]],["dinov2",["Dinov2ForImageClassification",nr]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",na]],["resnet",["ResNetForImageClassification",aF]],["swin",["SwinForImageClassification",aE]],["segformer",["SegformerForImageClassification",iV]],["efficientnet",["EfficientNetForImageClassification",iH]],["mobilenet_v1",["MobileNetV1ForImageClassification",i0]],["mobilenet_v2",["MobileNetV2ForImageClassification",i4]],["mobilenet_v3",["MobileNetV3ForImageClassification",i7]],["mobilenet_v4",["MobileNetV4ForImageClassification",lr]]]),l2=new Map([["detr",["DetrForObjectDetection",o8]],["rt_detr",["RTDetrForObjectDetection",ar]],["rt_detr_v2",["RTDetrV2ForObjectDetection",an]],["rf_detr",["RFDetrForObjectDetection",ad]],["d_fine",["DFineForObjectDetection",ah]],["table-transformer",["TableTransformerForObjectDetection",ag]],["yolos",["YolosForObjectDetection",nh]]]),l3=new Map([["owlvit",["OwlViTForObjectDetection",oK]],["owlv2",["Owlv2ForObjectDetection",o0]],["grounding-dino",["GroundingDinoForObjectDetection",nu]]]),l4=new Map([["detr",["DetrForSegmentation",o6]],["clipseg",["CLIPSegForImageSegmentation",rq]]]),l5=new Map([["segformer",["SegformerForSemanticSegmentation",iB]],["sapiens",["SapiensForSemanticSegmentation",aB]],["swin",["SwinForSemanticSegmentation",aA]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",i1]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",i5]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",i9]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",ls]]]),l8=new Map([["detr",["DetrForSegmentation",o6]],["maskformer",["MaskFormerForInstanceSegmentation",aY]]]),l6=new Map([["sam",["SamModel",ng]],["sam2",["Sam2Model",nb]],["edgetam",["EdgeTamModel",nv]],["sam3_tracker",["Sam3TrackerModel",nx]]]),l7=new Map([["wav2vec2",["Wav2Vec2ForCTC",nI]],["wav2vec2-bert",["Wav2Vec2BertForCTC",nZ]],["unispeech",["UniSpeechForCTC",nq]],["unispeech-sat",["UniSpeechSatForCTC",nQ]],["wavlm",["WavLMForCTC",n6]],["hubert",["HubertForCTC",n3]],["parakeet_ctc",["ParakeetForCTC",nO]]]),l9=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",n$]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",n0]],["unispeech",["UniSpeechForSequenceClassification",nU]],["unispeech-sat",["UniSpeechSatForSequenceClassification",nX]],["wavlm",["WavLMForSequenceClassification",n7]],["hubert",["HubertForSequenceClassification",n4]],["audio-spectrogram-transformer",["ASTForAudioClassification",re]]]),ce=new Map([["wavlm",["WavLMForXVector",n9]]]),ct=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",nJ]],["wavlm",["WavLMForAudioFrameClassification",ie]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",nL]],["pyannote",["PyAnnoteForAudioFrameClassification",nz]]]),cr=new Map([["vitmatte",["VitMatteForImageMatting",oR]]]),cs=new Map([["patchtst",["PatchTSTForPrediction",lp]],["patchtsmixer",["PatchTSMixerForPrediction",l_]]]),co=new Map([["swin2sr",["Swin2SRForImageSuperResolution",aL]]]),ca=new Map([["dpt",["DPTForDepthEstimation",aN]],["depth_anything",["DepthAnythingForDepthEstimation",az]],["glpn",["GLPNForDepthEstimation",a1]],["sapiens",["SapiensForDepthEstimation",aR]],["depth_pro",["DepthProForDepthEstimation",aU]],["metric3d",["Metric3DForDepthEstimation",aH]],["metric3dv2",["Metric3Dv2ForDepthEstimation",aX]]]),cn=new Map([["sapiens",["SapiensForNormalEstimation",aG]]]),ci=new Map([["vitpose",["VitPoseForPoseEstimation",oF]]]),cl=new Map([["clip",["CLIPVisionModelWithProjection",rA]],["siglip",["SiglipVisionModel",rj]],["jina_clip",["JinaCLIPVisionModel",rB]]]),cc=[[lN,w.EncoderOnly],[lD,w.EncoderDecoder],[lV,w.DecoderOnly],[lz,w.AutoEncoder],[lq,w.EncoderOnly],[lU,w.EncoderOnly],[lW,w.Seq2Seq],[lB,w.Seq2Seq],[lH,w.DecoderOnly],[lQ,w.MultiModality],[lX,w.EncoderOnly],[lJ,w.EncoderOnly],[lK,w.Vision2Seq],[lY,w.ImageTextToText],[lZ,w.AudioTextToText],[l1,w.EncoderOnly],[l4,w.EncoderOnly],[l8,w.EncoderOnly],[l5,w.EncoderOnly],[cr,w.EncoderOnly],[cs,w.EncoderOnly],[co,w.EncoderOnly],[ca,w.EncoderOnly],[cn,w.EncoderOnly],[ci,w.EncoderOnly],[l2,w.EncoderOnly],[l3,w.EncoderOnly],[l6,w.MaskGeneration],[l7,w.EncoderOnly],[l9,w.EncoderOnly],[lR,w.Seq2Seq],[lG,w.EncoderOnly],[ce,w.EncoderOnly],[ct,w.EncoderOnly],[cl,w.EncoderOnly]];for(let[e,t]of cc)for(let[r,s]of e.values())b.set(r,t),x.set(s,r),v.set(r,s);for(let[e,t,r]of[["MusicgenForConditionalGeneration",iK,w.Musicgen],["Phi3VForCausalLM",rT,w.Phi3V],["CLIPTextModelWithProjection",rC,w.EncoderOnly],["SiglipTextModel",rL,w.EncoderOnly],["JinaCLIPTextModel",rV,w.EncoderOnly],["ClapTextModelWithProjection",iL,w.EncoderOnly],["ClapAudioModelWithProjection",ij,w.EncoderOnly],["DacEncoderModel",lE,w.EncoderOnly],["DacDecoderModel",lA,w.EncoderOnly],["MimiEncoderModel",lP,w.EncoderOnly],["MimiDecoderModel",lT,w.EncoderOnly],["SnacEncoderModel",lL,w.EncoderOnly],["SnacDecoderModel",lj,w.EncoderOnly],["Gemma3nForConditionalGeneration",rw,w.ImageAudioTextToText],["SupertonicForConditionalGeneration",id,w.Supertonic]])b.set(e,r),x.set(t,e),v.set(e,t);let cd=new Map([["modnet",l4],["birefnet",l4],["isnet",l4],["ben",l4]]);for(let[e,t]of cd.entries())t.set(e,["PreTrainedModel",U]),b.set(e,w.EncoderOnly),x.set(U,e),v.set(e,U);class cu extends lO{static MODEL_CLASS_MAPPINGS=cc.map(e=>e[0]);static BASE_IF_FAIL=!0}class cm extends lO{static MODEL_CLASS_MAPPINGS=[lq]}class cp extends lO{static MODEL_CLASS_MAPPINGS=[lU]}class ch extends lO{static MODEL_CLASS_MAPPINGS=[lW]}class cf extends lO{static MODEL_CLASS_MAPPINGS=[lB]}class c_ extends lO{static MODEL_CLASS_MAPPINGS=[lR]}class cg extends lO{static MODEL_CLASS_MAPPINGS=[lG]}class cM extends lO{static MODEL_CLASS_MAPPINGS=[lH]}class cy extends lO{static MODEL_CLASS_MAPPINGS=[lX]}class cw extends lO{static MODEL_CLASS_MAPPINGS=[lJ]}class cb extends lO{static MODEL_CLASS_MAPPINGS=[lK]}class cv extends lO{static MODEL_CLASS_MAPPINGS=[l1]}class cx extends lO{static MODEL_CLASS_MAPPINGS=[l4]}class cP extends lO{static MODEL_CLASS_MAPPINGS=[l5]}class cT extends lO{static MODEL_CLASS_MAPPINGS=[l8]}class ck extends lO{static MODEL_CLASS_MAPPINGS=[l2]}class cF extends lO{static MODEL_CLASS_MAPPINGS=[l3]}class cS extends lO{static MODEL_CLASS_MAPPINGS=[l6]}class cC extends lO{static MODEL_CLASS_MAPPINGS=[l7]}class cE extends lO{static MODEL_CLASS_MAPPINGS=[l9]}class cA extends lO{static MODEL_CLASS_MAPPINGS=[ce]}class cI extends lO{static MODEL_CLASS_MAPPINGS=[ct]}class c$ extends lO{static MODEL_CLASS_MAPPINGS=[l0]}class cL extends lO{static MODEL_CLASS_MAPPINGS=[cr]}class cj extends lO{static MODEL_CLASS_MAPPINGS=[co]}class cO extends lO{static MODEL_CLASS_MAPPINGS=[ca]}class cN extends lO{static MODEL_CLASS_MAPPINGS=[cn]}class cD extends lO{static MODEL_CLASS_MAPPINGS=[ci]}class cz extends lO{static MODEL_CLASS_MAPPINGS=[cl]}class cV extends lO{static MODEL_CLASS_MAPPINGS=[lY]}class cB extends lO{static MODEL_CLASS_MAPPINGS=[lZ]}class cR extends W{constructor({logits:e,past_key_values:t,encoder_outputs:r,decoder_attentions:s=null,cross_attentions:o=null}){super(),this.logits=e,this.past_key_values=t,this.encoder_outputs=r,this.decoder_attentions=s,this.cross_attentions=o}}class cG extends W{constructor({logits:e,...t}){super(),this.logits=e;let r=Object.values(t);r.length>0&&(this.attentions=r)}}class cq extends W{constructor({logits:e,embeddings:t}){super(),this.logits=e,this.embeddings=t}}class cU extends W{constructor({logits:e}){super(),this.logits=e}}class cW extends W{constructor({logits:e}){super(),this.logits=e}}class cH extends W{constructor({start_logits:e,end_logits:t}){super(),this.start_logits=e,this.end_logits=t}}class cQ extends W{constructor({logits:e}){super(),this.logits=e}}class cX extends W{constructor({logits:e,past_key_values:t}){super(),this.logits=e,this.past_key_values=t}}class cJ extends W{constructor({alphas:e}){super(),this.alphas=e}}class cK extends W{constructor({waveform:e,spectrogram:t}){super(),this.waveform=e,this.spectrogram=t}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var o=r("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(e){super(e);let t=this.config.sampling_rate,r=(0,o.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=r,this.window=(0,o.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(e,t){return(0,o.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:t,transpose:!0})}async _call(e){(0,s.validate_audio_inputs)(e,"ASTFeatureExtractor");let t=await this._extract_fbank_features(e,this.config.max_length);if(this.config.do_normalize){let e=2*this.std,r=t.data;for(let t=0;t<r.length;++t)r[t]=(r[t]-this.mean)/e}return{input_values:t.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoFeatureExtractor:()=>n});var s=r("./src/utils/constants.js"),o=r("./src/utils/hub.js");r("./src/base/feature_extraction_utils.js");var a=r("./src/models/feature_extractors.js");class n{static async from_pretrained(e,t={}){let r=await (0,o.getModelJSON)(e,s.FEATURE_EXTRACTOR_NAME,!0,t),n=r.feature_extractor_type,i=a[n];if(!i)throw Error(`Unknown feature_extractor_type: '${n}'. Please report this at ${s.GITHUB_ISSUE_URL}.`);return new i(r)}}},"./src/models/auto/image_processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoImageProcessor:()=>i});var s=r("./src/utils/constants.js"),o=r("./src/utils/hub.js"),a=r("./src/base/image_processors_utils.js"),n=r("./src/models/image_processors.js");class i{static async from_pretrained(e,t={}){let r=await (0,o.getModelJSON)(e,s.IMAGE_PROCESSOR_NAME,!0,t),i=r.image_processor_type??r.feature_extractor_type,l=n[i?.replace(/Fast$/,"")];return l||(void 0!==i&&console.warn(`Image processor type '${i}' not found, assuming base ImageProcessor. Please report this at ${s.GITHUB_ISSUE_URL}.`),l=a.ImageProcessor),new l(r)}}},"./src/models/auto/processing_auto.js":(e,t,r)=>{r.r(t),r.d(t,{AutoProcessor:()=>c});var s=r("./src/utils/constants.js"),o=r("./src/utils/hub.js"),a=r("./src/base/processing_utils.js"),n=r("./src/models/processors.js"),i=r("./src/models/image_processors.js"),l=r("./src/models/feature_extractors.js");class c{static async from_pretrained(e,t={}){let r=await (0,o.getModelJSON)(e,s.IMAGE_PROCESSOR_NAME,!0,t),{image_processor_type:c,feature_extractor_type:d,processor_class:u}=r;if(u&&n[u])return n[u].from_pretrained(e,t);if(!c&&!d)throw Error("No `image_processor_type` or `feature_extractor_type` found in the config.");let m={};if(c){let e=i[c.replace(/Fast$/,"")];if(!e)throw Error(`Unknown image_processor_type: '${c}'.`);m.image_processor=new e(r)}if(d){let e=i[d];if(e)m.image_processor=new e(r);else{let e=l[d];if(!e)throw Error(`Unknown feature_extractor_type: '${d}'.`);m.feature_extractor=new e(r)}}return new a.Processor({},m,null)}}},"./src/models/beit/image_processing_beit.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,t,r)=>{r.r(t),r.d(t,{BitImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,t,r)=>{r.r(t),r.d(t,{ChineseCLIPFeatureExtractor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,t,r)=>{r.r(t),r.d(t,{ClapFeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var o=r("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(e){super(e),this.mel_filters=(0,o.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,o.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,o.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(e,t,r,s){let o;let a=e.length-t;if(a>0){if("rand_trunc"===r){let r=Math.floor(Math.random()*(a+1));e=e.subarray(r,r+t),o=await this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples)}else throw Error(`Truncation strategy "${r}" not implemented`)}else{if(a<0){let r=new Float64Array(t);if(r.set(e),"repeat"===s)for(let s=e.length;s<t;s+=e.length)r.set(e.subarray(0,Math.min(e.length,t-s)),s);else if("repeatpad"===s)for(let t=e.length;t<-a;t+=e.length)r.set(e,t);e=r}if("fusion"===r)throw Error(`Truncation strategy "${r}" not implemented`);o=await this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples)}return o.unsqueeze_(0)}async _extract_fbank_features(e,t,r=null){return(0,o.spectrogram)(e,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:t,log_mel:"dB",max_num_frames:r,do_pad:!1,transpose:!0})}async _call(e,{max_length:t=null}={}){return(0,s.validate_audio_inputs)(e,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(e,t??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,t,r)=>{r.r(t),r.d(t,{CLIPFeatureExtractor:()=>a,CLIPImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/convnext/image_processing_convnext.js":(e,t,r)=>{r.r(t),r.d(t,{ConvNextFeatureExtractor:()=>a,ConvNextImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{constructor(e){super(e),this.crop_pct=this.config.crop_pct??.875}async resize(e){let t=this.size?.shortest_edge;if(void 0===t)throw Error("Size dictionary must contain 'shortest_edge' key.");if(t<384){let r=Math.floor(t/this.crop_pct),[s,o]=this.get_resize_output_image_size(e,{shortest_edge:r});e=await e.resize(s,o,{resample:this.resample}),e=await e.center_crop(t,t)}else e=await e.resize(t,t,{resample:this.resample});return e}}class a extends o{}},"./src/models/dac/feature_extraction_dac.js":(e,t,r)=>{r.r(t),r.d(t,{DacFeatureExtractor:()=>o});var s=r("./src/models/encodec/feature_extraction_encodec.js");class o extends s.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(e,t,r)=>{r.r(t),r.d(t,{DeiTFeatureExtractor:()=>a,DeiTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/detr/image_processing_detr.js":(e,t,r)=>{r.r(t),r.d(t,{DetrFeatureExtractor:()=>n,DetrImageProcessor:()=>a});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(e){let t=await super._call(e),r=[t.pixel_values.dims[0],64,64],s=(0,o.full)(r,1n);return{...t,pixel_mask:s}}post_process_object_detection(...e){return(0,s.post_process_object_detection)(...e)}post_process_panoptic_segmentation(...e){return(0,s.post_process_panoptic_segmentation)(...e)}post_process_instance_segmentation(...e){return(0,s.post_process_instance_segmentation)(...e)}}class n extends a{}},"./src/models/dinov3_vit/image_processing_dinov3_vit.js":(e,t,r)=>{r.r(t),r.d(t,{DINOv3ViTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/donut/image_processing_donut.js":(e,t,r)=>{r.r(t),r.d(t,{DonutFeatureExtractor:()=>a,DonutImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{pad_image(e,t,r,s={}){let[o,a,n]=t,i=this.image_mean;Array.isArray(this.image_mean)||(i=Array(n).fill(i));let l=this.image_std;Array.isArray(l)||(l=Array(n).fill(i));let c=i.map((e,t)=>-e/l[t]);return super.pad_image(e,t,r,{center:!0,constant_values:c,...s})}}class a extends o{}},"./src/models/dpt/image_processing_dpt.js":(e,t,r)=>{r.r(t),r.d(t,{DPTFeatureExtractor:()=>a,DPTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,t,r)=>{r.r(t),r.d(t,{EfficientNetImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{constructor(e){super(e),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(e=>e*e))}}},"./src/models/encodec/feature_extraction_encodec.js":(e,t,r)=>{r.r(t),r.d(t,{EncodecFeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js");class a extends s.FeatureExtractor{async _call(e){(0,s.validate_audio_inputs)(e,"EncodecFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let t=this.config.feature_size;if(e.length%t!=0)throw Error(`The length of the audio data must be a multiple of the number of channels (${t}).`);let r=[1,t,e.length/t];return{input_values:new o.Tensor("float32",e,r)}}}},"./src/models/feature_extractors.js":(e,t,r)=>{r.r(t),r.d(t,{ASTFeatureExtractor:()=>s.ASTFeatureExtractor,ClapFeatureExtractor:()=>a.ClapFeatureExtractor,DacFeatureExtractor:()=>n.DacFeatureExtractor,EncodecFeatureExtractor:()=>o.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>i.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>g.ImageProcessor,MoonshineFeatureExtractor:()=>l.MoonshineFeatureExtractor,ParakeetFeatureExtractor:()=>c.ParakeetFeatureExtractor,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>u.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>m.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>p.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>h.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>f.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>_.WhisperFeatureExtractor});var s=r("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),o=r("./src/models/encodec/feature_extraction_encodec.js"),a=r("./src/models/clap/feature_extraction_clap.js"),n=r("./src/models/dac/feature_extraction_dac.js"),i=r("./src/models/gemma3n/feature_extraction_gemma3n.js"),l=r("./src/models/moonshine/feature_extraction_moonshine.js"),c=r("./src/models/parakeet/feature_extraction_parakeet.js"),d=r("./src/models/pyannote/feature_extraction_pyannote.js"),u=r("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),m=r("./src/models/snac/feature_extraction_snac.js"),p=r("./src/models/speecht5/feature_extraction_speecht5.js"),h=r("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),f=r("./src/models/wespeaker/feature_extraction_wespeaker.js"),_=r("./src/models/whisper/feature_extraction_whisper.js"),g=r("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");class n extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;constructor(e,t,r){super(e,t,r);let{tasks_answer_post_processing_type:s,task_prompts_without_inputs:o,task_prompts_with_input:a}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(s??{})),this.task_prompts_without_inputs=new Map(Object.entries(o??{})),this.task_prompts_with_input=new Map(Object.entries(a??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(e){"string"==typeof e&&(e=[e]);let t=[];for(let r of e)if(this.task_prompts_without_inputs.has(r))t.push(this.task_prompts_without_inputs.get(r));else{for(let[e,s]of this.task_prompts_with_input)if(r.includes(e)){t.push(s.replaceAll("{input}",r).replaceAll(e,""));break}t.length!==e.length&&t.push(r)}return t}post_process_generation(e,t,r){let s;let o=this.tasks_answer_post_processing_type.get(t)??"pure_text";switch(e=e.replaceAll("<s>","").replaceAll("</s>",""),o){case"pure_text":s=e;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":let a="ocr"===o?"quad_boxes":"bboxes",n=e.matchAll(this.regexes[a]),i=[],l=[];for(let[e,t,...s]of n)i.push(t?t.trim():i.at(-1)??""),l.push(s.map((e,t)=>(Number(e)+.5)/this.size_per_bin*r[t%2]));s={labels:i,[a]:l};break;default:throw Error(`Task "${t}" (of type "${o}") not yet implemented.`)}return{[t]:s}}async _call(e,t=null,r={}){if(!e&&!t)throw Error("Either text or images must be provided");let s=await this.image_processor(e,r),o=t?this.tokenizer(this.construct_prompts(t),r):{};return{...s,...o}}}},"./src/models/gemma3n/feature_extraction_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nAudioFeatureExtractor:()=>n});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/audio.js");class n extends s.FeatureExtractor{constructor(e){super(e);let{fft_length:t,feature_size:r,min_frequency:s,max_frequency:o,sampling_rate:n,frame_length:i}=this.config,l=(0,a.mel_filter_bank)(Math.floor(1+t/2),r,s,o,n,null,"htk",!1);this.mel_filters=l,this.window=(0,a.window_function)(i,"hann")}async _extract_fbank_features(e,t){return(0,a.spectrogram)(e,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(e,{max_length:t=48e4,truncation:r=!0,padding:a=!0,pad_to_multiple_of:n=128}={}){if((0,s.validate_audio_inputs)(e,"Gemma3nAudioFeatureExtractor"),r&&e.length>t&&(e=e.slice(0,t)),a&&e.length%n!=0){let t=n-e.length%n,r=new Float64Array(e.length+t);r.set(e),0!==this.config.padding_value&&r.fill(this.config.padding_value,e.length),e=r}let i=await this._extract_fbank_features(e,this.config.max_length),l=(0,o.full)([1,i.dims[0]],!0);return{input_features:i.unsqueeze_(0),input_features_mask:l}}}},"./src/models/gemma3n/processing_gemma3n.js":(e,t,r)=>{r.r(t),r.d(t,{Gemma3nProcessor:()=>i});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/models/auto/feature_extraction_auto.js"),n=r("./src/tokenizers.js");r("./src/utils/image.js"),r("./src/utils/audio.js");class i extends s.Processor{static image_processor_class=o.AutoImageProcessor;static feature_extractor_class=a.AutoFeatureExtractor;static tokenizer_class=n.AutoTokenizer;static uses_processor_config=!0;static uses_chat_template_file=!0;constructor(e,t,r){super(e,t,r),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;let{audio_token_id:s,boa_token:o,audio_token:a,eoa_token:n,image_token_id:i,boi_token:l,image_token:c,eoi_token:d}=this.tokenizer.config;this.audio_token_id=s,this.boa_token=o,this.audio_token=a;let u=a.repeat(this.audio_seq_length);this.full_audio_sequence=`

${o}${u}${n}

`,this.image_token_id=i,this.boi_token=l,this.image_token=c;let m=c.repeat(this.image_seq_length);this.full_image_sequence=`

${l}${m}${d}

`}async _call(e,t=null,r=null,s={}){let o,a;return"string"==typeof e&&(e=[e]),r&&(o=await this.feature_extractor(r,s),e=e.map(e=>e.replaceAll(this.audio_token,this.full_audio_sequence))),t&&(a=await this.image_processor(t,s),e=e.map(e=>e.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(e,s),...a,...o}}}},"./src/models/glpn/image_processing_glpn.js":(e,t,r)=>{r.r(t),r.d(t,{GLPNFeatureExtractor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoImageProcessor:()=>a});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(e){let t=await super._call(e),r=t.pixel_values.dims,s=(0,o.ones)([r[0],r[2],r[3]]);return{...t,pixel_mask:s}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,t,r)=>{r.r(t),r.d(t,{GroundingDinoProcessor:()=>i});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js"),n=r("./src/base/image_processors_utils.js");class i extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;async _call(e,t,r={}){let s=e?await this.image_processor(e,r):{};return{...t?this.tokenizer(t,r):{},...s}}post_process_grounded_object_detection(e,t,{box_threshold:r=.25,text_threshold:s=.25,target_sizes:o=null}={}){let{logits:a,pred_boxes:i}=e,l=a.dims[0];if(null!==o&&o.length!==l)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let c=a.dims.at(1),d=a.sigmoid(),u=d.max(-1).tolist(),m=i.tolist().map(e=>e.map(e=>(0,n.center_to_corners_format)(e))),p=[];for(let e=0;e<l;++e){let a=null!==o?o[e]:null;null!==a&&(m[e]=m[e].map(e=>e.map((e,t)=>e*a[(t+1)%2])));let n=u[e],i=[],l=[],h=[];for(let o=0;o<c;++o){let a=n[o];if(a<=r)continue;let c=m[e][o],u=d[e][o];i.push(a),h.push(c);let p=function(e,t){let r=e.dims.at(-1)-1,s=e.tolist();s.fill(!1,0,1),s.fill(!1,r);let o=t.tolist();return s.map((e,t)=>e?t:null).filter(e=>null!==e).map(e=>o[e])}(u.gt(s),t[e]);l.push(p)}p.push({scores:i,boxes:h,labels:this.batch_decode(l)})}return p}}},"./src/models/idefics3/image_processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3ImageProcessor:()=>a});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");class a extends s.ImageProcessor{constructor(e){super(e),this.do_image_splitting=e.do_image_splitting??!0,this.max_image_size=e.max_image_size}get_resize_for_vision_encoder(e,t){let[r,s]=e.dims.slice(-2),o=s/r;return s>=r?r=Math.ceil((r=Math.floor((s=Math.ceil(s/t)*t)/o))/t)*t:s=Math.ceil((s=Math.floor((r=Math.ceil(r/t)*t)*o))/t)*t,{height:r,width:s}}async _call(e,{do_image_splitting:t=null,return_row_col_info:r=!1}={}){let s,a,n;if(Array.isArray(e)){if(0===e.length||!e[0])throw Error("No images provided.");s=Array.isArray(e[0])?e:[e]}else s=[[e]];let i=[],l=[],c=[],d=[],u=[];for(let e of s){let r,s=await Promise.all(e.map(e=>this.preprocess(e)));d.push(...s.map(e=>e.original_size)),u.push(...s.map(e=>e.reshaped_input_size)),s.forEach(e=>e.pixel_values.unsqueeze_(0));let{longest_edge:a}=this.max_image_size;if(t??this.do_image_splitting){let e=Array(s.length),t=Array(s.length);r=await Promise.all(s.map(async(r,s)=>{let n=this.get_resize_for_vision_encoder(r.pixel_values,a),i=await (0,o.interpolate_4d)(r.pixel_values,{size:[n.height,n.width]}),{frames:l,num_splits_h:c,num_splits_w:d}=await this.split_image(i,this.max_image_size);return e[s]=c,t[s]=d,(0,o.cat)(l,0)})),l.push(e),c.push(t)}else{let e=[a,a];r=await Promise.all(s.map(t=>(0,o.interpolate_4d)(t.pixel_values,{size:e}))),l.push(Array(s.length).fill(0)),c.push(Array(s.length).fill(0))}i.push((0,o.cat)(r,0))}let m=i.length,[p,h,f,_]=i[0].dims;if(1===m)a=i[0].unsqueeze_(0),n=(0,o.full)([m,p,f,_],!0);else{let e=Math.max(...i.map(e=>e.dims.at(0))),t=(n=(0,o.full)([m,e,f,_],!0)).data,r=e*f*_;for(let s=0;s<m;++s){let a=i[s].dims[0];if(a<e){i[s]=(0,o.cat)([i[s],(0,o.full)([e-a,h,f,_],0)],0);let n=s*r+a*f*_,l=(s+1)*r;t.fill(!1,n,l)}}a=(0,o.stack)(i,0)}return{pixel_values:a,pixel_attention_mask:n,original_sizes:d,reshaped_input_sizes:u,...r?{rows:l,cols:c}:{}}}async split_image(e,{longest_edge:t}){let r=[],[s,a]=e.dims.slice(-2),n=0,i=0;if(s>t||a>t){n=Math.ceil(s/t),i=Math.ceil(a/t);let l=Math.ceil(s/n),c=Math.ceil(a/i);for(let t=0;t<n;++t)for(let d=0;d<i;++d){let u,m,p,h;t===n-1?(m=s-l,h=s):(m=t*l,h=(t+1)*l),d===i-1?(u=a-c,p=a):(u=d*c,p=(d+1)*c);let f=[m,u],_=[h,p],g=await (0,o.slice)(e,f,_,[2,3]);r.push(g)}(s!==t||a!==t)&&(e=await (0,o.interpolate_4d)(e,{size:[t,t]}))}return r.push(e),{frames:r,num_splits_h:n,num_splits_w:i}}}},"./src/models/idefics3/processing_idefics3.js":(e,t,r)=>{r.r(t),r.d(t,{Idefics3Processor:()=>i});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");r("./src/utils/image.js");var n=r("./src/utils/core.js");class i extends s.Processor{static image_processor_class=o.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;static uses_processor_config=!0;fake_image_token="<fake_token_around_image>";image_token="<image>";global_img_token="<global-img>";async _call(e,t=null,r={}){let s;r.return_row_col_info??=!0,t&&(s=await this.image_processor(t,r)),Array.isArray(e)||(e=[e]);let o=s.rows??[Array(e.length).fill(0)],a=s.cols??[Array(e.length).fill(0)],i=this.config.image_seq_len,l=[],c=[];for(let t=0;t<e.length;++t){let r=e[t],s=o[t],d=a[t];l.push((0,n.count)(r,this.image_token));let u=s.map((e,t)=>{var r,s,o,a,n,l;return r=e,s=d[t],o=i,a=this.fake_image_token,n=this.image_token,l=this.global_img_token,0===r&&0===s?`${a}${l}`+n.repeat(o)+`${a}`:function(e,t,r,s,o,a){let n="";for(let a=0;a<t;++a){for(let t=0;t<r;++t)n+=s+`<row_${a+1}_col_${t+1}>`+o.repeat(e);n+="\n"}return n+(`
${s}${a}`+o.repeat(e))+`${s}`}(o,r,s,a,n,l)}),m=r.split(this.image_token);if(0===m.length)throw Error("The image token should be present in the text.");let p=m[0];for(let e=0;e<u.length;++e)p+=u[e]+m[e+1];c.push(p)}return{...this.tokenizer(c),...s}}}},"./src/models/image_processors.js":(e,t,r)=>{r.r(t),r.d(t,{BeitFeatureExtractor:()=>s.BeitFeatureExtractor,BitImageProcessor:()=>o.BitImageProcessor,CLIPFeatureExtractor:()=>n.CLIPFeatureExtractor,CLIPImageProcessor:()=>n.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>a.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>i.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>i.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>d.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>m.DPTFeatureExtractor,DPTImageProcessor:()=>m.DPTImageProcessor,DeiTFeatureExtractor:()=>l.DeiTFeatureExtractor,DeiTImageProcessor:()=>l.DeiTImageProcessor,DetrFeatureExtractor:()=>c.DetrFeatureExtractor,DetrImageProcessor:()=>c.DetrImageProcessor,DonutFeatureExtractor:()=>u.DonutFeatureExtractor,DonutImageProcessor:()=>u.DonutImageProcessor,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>h.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>f.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>_.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>M.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>y.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>w.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>b.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>b.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>v.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>v.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>x.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>x.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>P.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>P.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>T.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>T.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>k.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>k.MobileViTImageProcessor,NougatImageProcessor:()=>F.NougatImageProcessor,OwlViTFeatureExtractor:()=>C.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>C.OwlViTImageProcessor,Owlv2ImageProcessor:()=>S.Owlv2ImageProcessor,Phi3VImageProcessor:()=>E.Phi3VImageProcessor,PixtralImageProcessor:()=>A.PixtralImageProcessor,PvtImageProcessor:()=>I.PvtImageProcessor,Qwen2VLImageProcessor:()=>$.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>L.RTDetrImageProcessor,Sam2ImageProcessor:()=>O.Sam2ImageProcessor,Sam3ImageProcessor:()=>N.Sam3ImageProcessor,SamImageProcessor:()=>j.SamImageProcessor,SegformerFeatureExtractor:()=>D.SegformerFeatureExtractor,SegformerImageProcessor:()=>D.SegformerImageProcessor,SiglipImageProcessor:()=>z.SiglipImageProcessor,SmolVLMImageProcessor:()=>V.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>B.Swin2SRImageProcessor,VLMImageProcessor:()=>g.VLMImageProcessor,ViTFeatureExtractor:()=>R.ViTFeatureExtractor,ViTImageProcessor:()=>R.ViTImageProcessor,VitMatteImageProcessor:()=>G.VitMatteImageProcessor,VitPoseImageProcessor:()=>q.VitPoseImageProcessor,YolosFeatureExtractor:()=>U.YolosFeatureExtractor,YolosImageProcessor:()=>U.YolosImageProcessor});var s=r("./src/models/beit/image_processing_beit.js"),o=r("./src/models/bit/image_processing_bit.js"),a=r("./src/models/chinese_clip/image_processing_chinese_clip.js"),n=r("./src/models/clip/image_processing_clip.js"),i=r("./src/models/convnext/image_processing_convnext.js"),l=r("./src/models/deit/image_processing_deit.js"),c=r("./src/models/detr/image_processing_detr.js"),d=r("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),u=r("./src/models/donut/image_processing_donut.js"),m=r("./src/models/dpt/image_processing_dpt.js"),p=r("./src/models/efficientnet/image_processing_efficientnet.js"),h=r("./src/models/glpn/image_processing_glpn.js"),f=r("./src/models/grounding_dino/image_processing_grounding_dino.js"),_=r("./src/models/idefics3/image_processing_idefics3.js"),g=r("./src/models/janus/image_processing_janus.js"),M=r("./src/models/jina_clip/image_processing_jina_clip.js"),y=r("./src/models/llava_onevision/image_processing_llava_onevision.js"),w=r("./src/models/mask2former/image_processing_mask2former.js"),b=r("./src/models/maskformer/image_processing_maskformer.js"),v=r("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),x=r("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),P=r("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),T=r("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),k=r("./src/models/mobilevit/image_processing_mobilevit.js"),F=r("./src/models/nougat/image_processing_nougat.js"),S=r("./src/models/owlv2/image_processing_owlv2.js"),C=r("./src/models/owlvit/image_processing_owlvit.js"),E=r("./src/models/phi3_v/image_processing_phi3_v.js"),A=r("./src/models/pixtral/image_processing_pixtral.js"),I=r("./src/models/pvt/image_processing_pvt.js"),$=r("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),L=r("./src/models/rt_detr/image_processing_rt_detr.js"),j=r("./src/models/sam/image_processing_sam.js"),O=r("./src/models/sam2/image_processing_sam2.js"),N=r("./src/models/sam3/image_processing_sam3.js"),D=r("./src/models/segformer/image_processing_segformer.js"),z=r("./src/models/siglip/image_processing_siglip.js"),V=r("./src/models/smolvlm/image_processing_smolvlm.js"),B=r("./src/models/swin2sr/image_processing_swin2sr.js"),R=r("./src/models/vit/image_processing_vit.js"),G=r("./src/models/vitmatte/image_processing_vitmatte.js"),q=r("./src/models/vitpose/image_processing_vitpose.js"),U=r("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLMImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{constructor(e){super({do_pad:!0,pad_size:{width:e.image_size,height:e.image_size},...e}),this.constant_values=this.config.background_color.map(e=>e*this.rescale_factor)}pad_image(e,t,r,s){return super.pad_image(e,t,r,{constant_values:this.constant_values,center:!0,...s})}}},"./src/models/janus/processing_janus.js":(e,t,r)=>{r.r(t),r.d(t,{VLChatProcessor:()=>c});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js"),n=r("./src/utils/core.js"),i=r("./src/utils/tensor.js"),l=r("./src/utils/image.js");class c extends s.Processor{static image_processor_class=o.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;static uses_processor_config=!0;constructor(e,t,r){super(e,t,r),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(e,{images:t=null,chat_template:r="default"}={}){t?Array.isArray(t)||(t=[t]):t=await Promise.all(e.filter(e=>e.images).flatMap(e=>e.images).map(e=>l.RawImage.read(e)));let s=this.tokenizer,o=s.apply_chat_template(e,{tokenize:!1,add_generation_prompt:!0,chat_template:r}),a=e=>s.encode(e,{add_special_tokens:!1}),c=o.split(this.image_tag),d=c.length-1;if(t.length!==d)throw Error(`Number of images provided (${t.length}) does not match number of "${this.image_tag}" image tags (${d})`);let[u,m,p]=s.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]),h=a(c[0]),f=Array(h.length).fill(!1);for(let e=1;e<c.length;++e){let t=Array(this.num_image_tokens).fill(u),r=a(c[e]);h=(0,n.mergeArrays)(h,[m],t,[p],r);let s=Array(this.num_image_tokens).fill(!0);f=(0,n.mergeArrays)(f,[!1],s,[!1],Array(r.length).fill(!1))}let _=[1,h.length],g={input_ids:new i.Tensor("int64",h,_),attention_mask:new i.Tensor("int64",Array(h.length).fill(1),_),images_seq_mask:new i.Tensor("bool",f,_),images_emb_mask:new i.Tensor("bool",Array(d*this.num_image_tokens).fill(!0),[1,d,this.num_image_tokens])};if(t&&t.length>0){let e=await this.image_processor(t);return e.pixel_values.unsqueeze_(0),{...g,...e}}return g}}},"./src/models/jina_clip/image_processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{constructor(e){let{resize_mode:t,fill_color:r,interpolation:s,size:o,...a}=e;super({...a,size:"squash"===t?{width:o,height:o}:"shortest"===t?{shortest_edge:o}:{longest_edge:o},resample:"bicubic"===s?3:2,do_center_crop:!0,crop_size:o,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(e,t,r)=>{r.r(t),r.d(t,{JinaCLIPProcessor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");class n extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;async _call(e=null,t=null,r={}){if(!e&&!t)throw Error("Either text or images must be provided");let s=e?this.tokenizer(e,r):{},o=t?await this.image_processor(t,r):{};return{...s,...o}}}},"./src/models/llava/processing_llava.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaProcessor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");class n extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;static uses_processor_config=!0;async _call(e,t=null,r={}){let s=await this.image_processor(e,r);if(t){let[e,r]=s.pixel_values.dims.slice(-2),{image_token:o,patch_size:a,num_additional_image_tokens:n}=this.config,i=Math.floor(e/a)*Math.floor(r/a)+n;Array.isArray(t=structuredClone(t))||(t=[t]);for(let e=0;e<t.length;++e)t[e]=t[e].replace(o,o.repeat(i))}let o=t?this.tokenizer(t,r):{};return{...s,...o}}}},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,t,r)=>{r.r(t),r.d(t,{LlavaOnevisionImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,t,r)=>{r.r(t),r.d(t,{Mask2FormerImageProcessor:()=>o});var s=r("./src/models/maskformer/image_processing_maskformer.js");class o extends s.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,t,r)=>{r.r(t),r.d(t,{MaskFormerFeatureExtractor:()=>a,MaskFormerImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_panoptic_segmentation(...e){return(0,s.post_process_panoptic_segmentation)(...e)}post_process_instance_segmentation(...e){return(0,s.post_process_instance_segmentation)(...e)}}class a extends o{}},"./src/models/mgp_str/processing_mgp_str.js":(e,t,r)=>{r.r(t),r.d(t,{MgpstrProcessor:()=>l});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js"),n=r("./src/utils/maths.js");let i={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class l extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(e,t){if(!i.hasOwnProperty(t))throw Error(`Format ${t} is not supported.`);let[r,s]=i[t],o=this[r].bind(this),[a,l]=e.dims,c=[],d=[],u=e.tolist();for(let e=0;e<a;++e){let t=u[e],r=[],o=[];for(let e=1;e<l;++e){let[a,i]=(0,n.max)((0,n.softmax)(t[e]));if(o.push(a),i==s)break;r.push(i)}let a=o.length>0?o.reduce((e,t)=>e*t,1):0;d.push(r),c.push(a)}return[o(d),c]}char_decode(e){return this.char_tokenizer.batch_decode(e).map(e=>e.replaceAll(" ",""))}bpe_decode(e){return this.bpe_tokenizer.batch_decode(e)}wp_decode(e){return this.wp_tokenizer.batch_decode(e).map(e=>e.replaceAll(" ",""))}batch_decode([e,t,r]){let[s,o]=this._decode_helper(e,"char"),[a,i]=this._decode_helper(t,"bpe"),[l,c]=this._decode_helper(r,"wp"),d=[],u=[];for(let e=0;e<s.length;++e){let[t,r]=(0,n.max)([o[e],i[e],c[e]]);d.push([s[e],a[e],l[e]][r]),u.push(t)}return{generated_text:d,scores:u,char_preds:s,bpe_preds:a,wp_preds:l}}static async from_pretrained(...e){let t=await super.from_pretrained(...e),r=await a.AutoTokenizer.from_pretrained("Xenova/gpt2"),s=await a.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return t.components={image_processor:t.image_processor,char_tokenizer:t.tokenizer,bpe_tokenizer:r,wp_tokenizer:s},t}async _call(e,t=null){let r=await this.image_processor(e);return t&&(r.labels=this.tokenizer(t).input_ids),r}}},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV1FeatureExtractor:()=>a,MobileNetV1ImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV2FeatureExtractor:()=>a,MobileNetV2ImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV3FeatureExtractor:()=>a,MobileNetV3ImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,t,r)=>{r.r(t),r.d(t,{MobileNetV4FeatureExtractor:()=>a,MobileNetV4ImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,t,r)=>{r.r(t),r.d(t,{MobileViTFeatureExtractor:()=>a,MobileViTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineFeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js");class a extends s.FeatureExtractor{async _call(e){(0,s.validate_audio_inputs)(e,"MoonshineFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let t=[1,e.length];return{input_values:new o.Tensor("float32",e,t)}}}},"./src/models/moonshine/processing_moonshine.js":(e,t,r)=>{r.r(t),r.d(t,{MoonshineProcessor:()=>n});var s=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/tokenizers.js"),a=r("./src/base/processing_utils.js");class n extends a.Processor{static tokenizer_class=o.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(e){return await this.feature_extractor(e)}}},"./src/models/nougat/image_processing_nougat.js":(e,t,r)=>{r.r(t),r.d(t,{NougatImageProcessor:()=>o});var s=r("./src/models/donut/image_processing_donut.js");class o extends s.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,t,r)=>{r.r(t),r.d(t,{Owlv2ImageProcessor:()=>o});var s=r("./src/models/owlvit/image_processing_owlvit.js");class o extends s.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTFeatureExtractor:()=>a,OwlViTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_object_detection(...e){return(0,s.post_process_object_detection)(...e)}}class a extends o{}},"./src/models/owlvit/processing_owlvit.js":(e,t,r)=>{r.r(t),r.d(t,{OwlViTProcessor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");class n extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor}},"./src/models/paligemma/processing_paligemma.js":(e,t,r)=>{r.r(t),r.d(t,{PaliGemmaProcessor:()=>i});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");let n="<image>";class i extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;static uses_processor_config=!1;async _call(e,t=null,r={}){let s;t||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),t=""),Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);let o=this.tokenizer.bos_token,a=this.image_processor.config.image_seq_length;t.some(e=>e.includes(n))?s=t.map(e=>{let t=e.replaceAll(n,n.repeat(a)),r=t.lastIndexOf(n),s=-1===r?0:r+n.length;return t.slice(0,s)+o+t.slice(s)+"\n"}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),s=t.map(t=>{var r;return r=e.length,`${n.repeat(a*r)}${o}${t}
`}));let i=this.tokenizer(s,r);return{...await this.image_processor(e,r),...i}}}},"./src/models/parakeet/feature_extraction_parakeet.js":(e,t,r)=>{r.r(t),r.d(t,{ParakeetFeatureExtractor:()=>n});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/audio.js");class n extends s.FeatureExtractor{constructor(e){super(e),this.config.mel_filters??=(0,a.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,this.config.sampling_rate/2,this.config.sampling_rate,"slaney","slaney");let t=(0,a.window_function)(this.config.win_length,"hann",{periodic:!1});this.window=new Float64Array(this.config.n_fft);let r=Math.floor((this.config.n_fft-this.config.win_length)/2);this.window.set(t,r)}async _extract_fbank_features(e){let t=this.config.preemphasis;e=new Float64Array(e);for(let r=e.length-1;r>=1;--r)e[r]-=t*e[r-1];return await (0,a.spectrogram)(e,this.window,this.window.length,this.config.hop_length,{fft_length:this.config.n_fft,power:2,mel_filters:this.config.mel_filters,log_mel:"log",mel_floor:-1/0,pad_mode:"constant",center:!0,transpose:!0,mel_offset:5960464477539063e-23})}async _call(e){(0,s.validate_audio_inputs)(e,"ParakeetFeatureExtractor");let t=await this._extract_fbank_features(e),r=Math.floor((e.length+2*Math.floor(this.config.n_fft/2)-this.config.n_fft)/this.config.hop_length),a=t.data;a.fill(0,r*t.dims[1]);let[n,i]=t.dims,l=new Float64Array(i),c=new Float64Array(i);for(let e=0;e<r;++e){let t=e*i;for(let e=0;e<i;++e){let r=a[t+e];l[e]+=r,c[e]+=r*r}}let d=r>1?r-1:1;for(let e=0;e<i;++e){let t=l[e]/r,s=1/(Math.sqrt((c[e]-r*t*t)/d)+1e-5);for(let o=0;o<r;++o){let r=o*i+e;a[r]=(a[r]-t)*s}}let u=new BigInt64Array(n);return u.fill(1n,0,r),{input_features:t.unsqueeze_(0),attention_mask:new o.Tensor("int64",u,[1,n])}}}},"./src/models/phi3_v/image_processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VImageProcessor:()=>c});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");let a=[2,3],{ceil:n,floor:i,sqrt:l}=Math;class c extends s.ImageProcessor{constructor(e){super({...e,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=e.num_crops}calc_num_image_tokens_from_image_size(e,t){let{num_img_tokens:r}=this.config;return i((i(t/336)*i(e/336)+1)*r+1+(i(t/336)+1)*l(r))}get_resize_output_image_size(e,t){let r=this._num_crops,[s,o]=e.size,a=s/o,n=1;for(;n*Math.ceil(n/a)<=r;)n+=1;let i=Math.floor(336*(n-=1));return[i,Math.floor(i/a)]}pad_image(e,t,r,s={}){let[o,a]=t,i=336*n(o/336),l=336*n(a/336),c=[1,1,1].map((e,t)=>(e-this.image_mean[t])/this.image_std[t]);return super.pad_image(e,t,{width:l,height:i},{center:!0,constant_values:c,...s})}async _call(e,{num_crops:t=null}={}){if(this._num_crops=t??=this.config.num_crops,t<4||l(t)%1!=0)throw Error("num_crops must be a square number >= 4");Array.isArray(e)||(e=[e]);let r=e.length,s=await Promise.all(e.map(e=>this.preprocess(e))),c=s.map(e=>e.original_size),d=s.map(e=>e.reshaped_input_size),u=[];for(let{pixel_values:e}of s){e.unsqueeze_(0);let[r,s]=e.dims.slice(-2),n=await (0,o.interpolate_4d)(e,{size:[336,336],mode:"bicubic"});if(t>0){let c=[],d=l(t),m=i(s/d),p=i(r/d);for(let t=0;t<d;++t)for(let n=0;n<d;++n){let i,l,u,h;t===d-1?(l=r-p,h=r):(l=t*p,h=(t+1)*p),n===d-1?(i=s-m,u=s):(i=n*m,u=(n+1)*m);let f=[l,i],_=[h,u],g=await (0,o.slice)(e,f,_,a);c.push(g)}let h=await (0,o.interpolate_4d)((0,o.cat)(c,0),{size:[336,336],mode:"bicubic"});u.push((0,o.cat)([n,h],0))}else u.push(n)}let m=(0,o.stack)(u,0),p=d.map(e=>e.map(e=>336*n(e/336)));return{pixel_values:m,original_sizes:c,reshaped_input_sizes:d,image_sizes:new o.Tensor("int64",p.flat(),[r,2]),num_img_tokens:p.map(([e,t])=>this.calc_num_image_tokens_from_image_size(t,e))}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,t,r)=>{r.r(t),r.d(t,{Phi3VProcessor:()=>l});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");r("./src/utils/image.js");let n="<|image|>",i=/<\|image_\d+\|>/g;class l extends s.Processor{static image_processor_class=o.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;async _call(e,t=null,{padding:r=!0,truncation:s=!0,num_crops:o=null}={}){let a,l;if(Array.isArray(e)||(e=[e]),t){let{num_img_tokens:c}=l=await this.image_processor(t,{num_crops:o}),d=e.map((e,t)=>e.split(i).join(n.repeat(c[t])));a=this.tokenizer(d,{padding:r,truncation:s});let u=this.tokenizer.model.convert_tokens_to_ids([n])[0];a.input_ids.map_(e=>e==u?-e:e)}else a=this.tokenizer(e);return{...a,...l}}}},"./src/models/pixtral/image_processing_pixtral.js":(e,t,r)=>{r.r(t),r.d(t,{PixtralImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{get_resize_output_image_size(e,t){let{longest_edge:r}=t;if(void 0===r)throw Error("size must contain 'longest_edge'");let[s,o]=e.size,a=Math.max(s,o)/r,n=s,i=o;a>1&&(n=Math.floor(s/a),i=Math.floor(o/a));let{patch_size:l,spatial_merge_size:c}=this.config;if(!c)throw Error("config must contain 'spatial_merge_size'");let d=l*c,u=Math.floor((n-1)/d)+1,m=Math.floor((i-1)/d)+1;return[u*d,m*d]}}},"./src/models/pixtral/processing_pixtral.js":(e,t,r)=>{r.r(t),r.d(t,{PixtralProcessor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");class n extends s.Processor{static tokenizer_class=a.AutoTokenizer;static image_processor_class=o.AutoImageProcessor;static uses_processor_config=!0;async _call(e,t=null,r={}){let s=await this.image_processor(e,r);if(t){let[e,r]=s.pixel_values.dims.slice(-2),{image_token:o,image_break_token:a,image_end_token:n,patch_size:i,spatial_merge_size:l}=this.config,c=i*l,d=Math.floor(e/c),u=Math.floor(r/c);Array.isArray(t=structuredClone(t))||(t=[t]);for(let e=0;e<t.length;++e){let r=o.repeat(u),s=r+a,i=r+n,l=s.repeat(d-1)+i;t[e]=t[e].replace(o,l)}}let o=t?this.tokenizer(t,r):{};return{...s,...o}}}},"./src/models/processors.js":(e,t,r)=>{r.r(t),r.d(t,{Florence2Processor:()=>s.Florence2Processor,Gemma3nProcessor:()=>o.Gemma3nProcessor,GroundingDinoProcessor:()=>a.GroundingDinoProcessor,Idefics3Processor:()=>n.Idefics3Processor,JinaCLIPProcessor:()=>l.JinaCLIPProcessor,LlavaProcessor:()=>c.LlavaProcessor,MgpstrProcessor:()=>d.MgpstrProcessor,MoonshineProcessor:()=>u.MoonshineProcessor,OwlViTProcessor:()=>m.OwlViTProcessor,PaliGemmaProcessor:()=>p.PaliGemmaProcessor,Phi3VProcessor:()=>h.Phi3VProcessor,PixtralProcessor:()=>f.PixtralProcessor,PyAnnoteProcessor:()=>_.PyAnnoteProcessor,Qwen2VLProcessor:()=>g.Qwen2VLProcessor,Sam2Processor:()=>y.Sam2Processor,Sam2VideoProcessor:()=>y.Sam2VideoProcessor,SamProcessor:()=>M.SamProcessor,SmolVLMProcessor:()=>w.SmolVLMProcessor,SpeechT5Processor:()=>b.SpeechT5Processor,UltravoxProcessor:()=>v.UltravoxProcessor,VLChatProcessor:()=>i.VLChatProcessor,VoxtralProcessor:()=>x.VoxtralProcessor,Wav2Vec2Processor:()=>P.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>T.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>k.WhisperProcessor});var s=r("./src/models/florence2/processing_florence2.js"),o=r("./src/models/gemma3n/processing_gemma3n.js"),a=r("./src/models/grounding_dino/processing_grounding_dino.js"),n=r("./src/models/idefics3/processing_idefics3.js"),i=r("./src/models/janus/processing_janus.js"),l=r("./src/models/jina_clip/processing_jina_clip.js"),c=r("./src/models/llava/processing_llava.js"),d=r("./src/models/mgp_str/processing_mgp_str.js"),u=r("./src/models/moonshine/processing_moonshine.js"),m=r("./src/models/owlvit/processing_owlvit.js"),p=r("./src/models/paligemma/processing_paligemma.js"),h=r("./src/models/phi3_v/processing_phi3_v.js"),f=r("./src/models/pixtral/processing_pixtral.js"),_=r("./src/models/pyannote/processing_pyannote.js"),g=r("./src/models/qwen2_vl/processing_qwen2_vl.js"),M=r("./src/models/sam/processing_sam.js"),y=r("./src/models/sam2/processing_sam2.js"),w=r("./src/models/smolvlm/processing_smolvlm.js"),b=r("./src/models/speecht5/processing_speecht5.js"),v=r("./src/models/ultravox/processing_ultravox.js"),x=r("./src/models/voxtral/processing_voxtral.js"),P=r("./src/models/wav2vec2/processing_wav2vec2.js"),T=r("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),k=r("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,t,r)=>{r.r(t),r.d(t,{PvtImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteFeatureExtractor:()=>n});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/maths.js");class n extends s.FeatureExtractor{async _call(e){(0,s.validate_audio_inputs)(e,"PyAnnoteFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let t=[1,1,e.length];return{input_values:new o.Tensor("float32",e,t)}}samples_to_frames(e){return(e-this.config.offset)/this.config.step}post_process_speaker_diarization(e,t){let r=t/this.samples_to_frames(t)/this.config.sampling_rate,s=[];for(let t of e.tolist()){let e=[],o=-1;for(let r=0;r<t.length;++r){let s=(0,a.softmax)(t[r]),[n,i]=(0,a.max)(s),[l,c]=[r,r+1];i!==o?(o=i,e.push({id:i,start:l,end:c,score:n})):(e.at(-1).end=c,e.at(-1).score+=n)}s.push(e.map(({id:e,start:t,end:s,score:o})=>({id:e,start:t*r,end:s*r,confidence:o/(s-t)})))}return s}}},"./src/models/pyannote/processing_pyannote.js":(e,t,r)=>{r.r(t),r.d(t,{PyAnnoteProcessor:()=>a});var s=r("./src/base/processing_utils.js"),o=r("./src/models/pyannote/feature_extraction_pyannote.js");class a extends s.Processor{static feature_extractor_class=o.PyAnnoteFeatureExtractor;async _call(e){return await this.feature_extractor(e)}post_process_speaker_diarization(...e){return this.feature_extractor.post_process_speaker_diarization(...e)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLImageProcessor:()=>a});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(e,...t){let{pixel_values:r,original_sizes:s,reshaped_input_sizes:a}=await super._call(e,...t),n=r,{temporal_patch_size:i,merge_size:l,patch_size:c}=this.config;1===n.dims[0]&&(n=(0,o.cat)(Array.from({length:i},()=>n),0));let d=n.dims[0]/i,u=n.dims[1],m=Math.floor(n.dims[2]/c),p=Math.floor(n.dims[3]/c);return{pixel_values:n.view(d,i,u,Math.floor(m/l),l,c,Math.floor(p/l),l,c).permute(0,3,6,4,7,2,1,5,8).view(d*m*p,u*i*c*c),image_grid_thw:new o.Tensor("int64",[d,m,p],[1,3]),original_sizes:s,reshaped_input_sizes:a}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,t,r)=>{r.r(t),r.d(t,{Qwen2VLProcessor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js"),a=r("./src/tokenizers.js");r("./src/utils/image.js");class n extends s.Processor{static image_processor_class=o.AutoImageProcessor;static tokenizer_class=a.AutoTokenizer;async _call(e,t=null,...r){let s,o;if(Array.isArray(e)||(e=[e]),t&&(o=(s=await this.image_processor(t)).image_grid_thw),o){let t=this.image_processor.config.merge_size**2,r=0,s=o.tolist();e=e.map(e=>{for(;e.includes("<|image_pad|>");){let o=Number(s[r++].reduce((e,t)=>e*t,1n));e=e.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(o/t)))}return e.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(e),...s}}}},"./src/models/rt_detr/image_processing_rt_detr.js":(e,t,r)=>{r.r(t),r.d(t,{RTDetrImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_object_detection(...e){return(0,s.post_process_object_detection)(...e)}}},"./src/models/sam/image_processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamImageProcessor:()=>n});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/core.js"),a=r("./src/utils/tensor.js");class n extends s.ImageProcessor{reshape_input_points(e,t,r,s=!1){e=structuredClone(e);let n=(0,o.calculateDimensions)(e);if(3===n.length)s||(n=[1,...n]),e=[e];else if(4!==n.length)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let s=0;s<e.length;++s){let[o,a]=t[s],[n,i]=r[s],l=[i/a,n/o];for(let t=0;t<e[s].length;++t)for(let r=0;r<e[s][t].length;++r)for(let o=0;o<e[s][t][r].length;++o)e[s][t][r][o]*=l[o%2]}return new a.Tensor("float32",Float32Array.from(e.flat(1/0)),n)}add_input_labels(e,t){let r=(0,o.calculateDimensions)(e);if(2===r.length)r=[1,...r],e=[e];else if(3!==r.length)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(r.some((e,r)=>e!==t.dims[r]))throw Error(`The first ${r.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new a.Tensor("int64",e.flat(1/0).map(BigInt),r)}async _call(e,{input_points:t=null,input_labels:r=null,input_boxes:s=null}={}){let o=await super._call(e);if(t&&(o.input_points=this.reshape_input_points(t,o.original_sizes,o.reshaped_input_sizes)),r){if(!o.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");o.input_labels=this.add_input_labels(r,o.input_points)}return s&&(o.input_boxes=this.reshape_input_points(s,o.original_sizes,o.reshaped_input_sizes,!0)),o}async post_process_masks(e,t,r,{mask_threshold:s=0,binarize:o=!0,pad_size:n=null}={}){let i=[],l=[(n=n??this.pad_size??this.size).height,n.width];for(let n=0;n<t.length;++n){let c=t[n],d=r[n],u=await (0,a.interpolate_4d)(e[n],{mode:"bilinear",size:l});if(u=u.slice(null,null,[0,d[0]],[0,d[1]]),u=await (0,a.interpolate_4d)(u,{mode:"bilinear",size:c}),o){let e=u.data,t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)e[r]>s&&(t[r]=1);u=new a.Tensor("bool",t,u.dims)}i.push(u)}return i}generate_crop_boxes(e,t,{crop_n_layers:r=0,overlap_ratio:s=512/1500,points_per_crop:o=32,crop_n_points_downscale_factor:a=1}={}){}}},"./src/models/sam/processing_sam.js":(e,t,r)=>{r.r(t),r.d(t,{SamProcessor:()=>a});var s=r("./src/base/processing_utils.js"),o=r("./src/models/auto/image_processing_auto.js");class a extends s.Processor{static image_processor_class=o.AutoImageProcessor;async _call(...e){return await this.image_processor(...e)}post_process_masks(...e){return this.image_processor.post_process_masks(...e)}reshape_input_points(...e){return this.image_processor.reshape_input_points(...e)}}},"./src/models/sam2/image_processing_sam2.js":(e,t,r)=>{r.r(t),r.d(t,{Sam2ImageProcessor:()=>s.SamImageProcessor});var s=r("./src/models/sam/image_processing_sam.js")},"./src/models/sam2/processing_sam2.js":(e,t,r)=>{r.r(t),r.d(t,{Sam2Processor:()=>o,Sam2VideoProcessor:()=>a});var s=r("./src/models/sam/processing_sam.js");class o extends s.SamProcessor{}class a extends o{}},"./src/models/sam3/image_processing_sam3.js":(e,t,r)=>{r.r(t),r.d(t,{Sam3ImageProcessor:()=>s.Sam2ImageProcessor});var s=r("./src/models/sam2/image_processing_sam2.js")},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,t,r)=>{r.r(t),r.d(t,{SeamlessM4TFeatureExtractor:()=>n});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js"),a=r("./src/utils/audio.js");class n extends s.FeatureExtractor{constructor(e){super(e);let t=this.config.sampling_rate,r=(0,a.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=r,this.window=(0,a.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(e,t){return e=e.map(e=>32768*e),(0,a.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:t,transpose:!0})}async _call(e,{padding:t=!0,pad_to_multiple_of:r=2,do_normalize_per_mel_bins:a=!0,return_attention_mask:n=!0}={}){let i;(0,s.validate_audio_inputs)(e,"SeamlessM4TFeatureExtractor");let l=await this._extract_fbank_features(e,this.config.max_length);if(a){let[e,t]=l.dims,r=l.data;for(let s=0;s<t;++s){let o=0;for(let a=0;a<e;++a)o+=r[a*t+s];let a=o/e,n=0;for(let o=0;o<e;++o)n+=(r[o*t+s]-a)**2;let i=Math.sqrt((n/=e-1)+1e-7);for(let o=0;o<e;++o){let e=o*t+s;r[e]=(r[e]-a)/i}}}if(t){let[e,t]=l.dims,s=l.data,a=e%r;if(a>0){let r=new Float32Array(t*(e+a));r.set(s),r.fill(this.config.padding_value,s.length);let c=e+a;l=new o.Tensor(l.type,r,[c,t]),n&&(i=new o.Tensor("int64",new BigInt64Array(c),[1,c])).data.fill(1n,0,e)}}let[c,d]=l.dims,u=this.config.stride;if(0!=c%u)throw Error(`The number of frames (${c}) must be a multiple of the stride (${u}).`);let m=l.view(1,Math.floor(c/u),d*u),p={input_features:m};if(n){let e=m.dims[1],t=new BigInt64Array(e);if(i){let e=i.data;for(let r=1,s=0;r<c;r+=u,++s)t[s]=e[r]}else t.fill(1n);p.attention_mask=new o.Tensor("int64",t,[1,e])}return p}}},"./src/models/segformer/image_processing_segformer.js":(e,t,r)=>{r.r(t),r.d(t,{SegformerFeatureExtractor:()=>a,SegformerImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_semantic_segmentation(...e){return(0,s.post_process_semantic_segmentation)(...e)}}class a extends o{}},"./src/models/siglip/image_processing_siglip.js":(e,t,r)=>{r.r(t),r.d(t,{SiglipImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMImageProcessor:()=>s.Idefics3ImageProcessor});var s=r("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(e,t,r)=>{r.r(t),r.d(t,{SmolVLMProcessor:()=>s.Idefics3Processor});var s=r("./src/models/idefics3/processing_idefics3.js")},"./src/models/snac/feature_extraction_snac.js":(e,t,r)=>{r.r(t),r.d(t,{SnacFeatureExtractor:()=>o});var s=r("./src/models/dac/feature_extraction_dac.js");class o extends s.DacFeatureExtractor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5FeatureExtractor:()=>o});var s=r("./src/base/feature_extraction_utils.js");class o extends s.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,t,r)=>{r.r(t),r.d(t,{SpeechT5Processor:()=>n});var s=r("./src/base/processing_utils.js"),o=r("./src/tokenizers.js"),a=r("./src/models/auto/feature_extraction_auto.js");class n extends s.Processor{static tokenizer_class=o.AutoTokenizer;static feature_extractor_class=a.AutoFeatureExtractor;async _call(e){return await this.feature_extractor(e)}}},"./src/models/swin2sr/image_processing_swin2sr.js":(e,t,r)=>{r.r(t),r.d(t,{Swin2SRImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{pad_image(e,t,r,s={}){let[o,a,n]=t;return super.pad_image(e,t,{width:a+(r-a%r)%r,height:o+(r-o%r)%r},{mode:"symmetric",center:!1,constant_values:-1,...s})}}},"./src/models/ultravox/processing_ultravox.js":(e,t,r)=>{r.r(t),r.d(t,{UltravoxProcessor:()=>n});var s=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/tokenizers.js"),a=r("./src/base/processing_utils.js");class n extends a.Processor{static tokenizer_class=o.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;static uses_processor_config=!0;async _call(e,t=null,r={}){if(Array.isArray(e))throw Error("Batched inputs are not supported yet.");let s={};if(t){let o=t.length,{input_features:a}=await this.feature_extractor(t,{...r,max_length:o}),n=1+Math.ceil(Math.round(o/this.config.encoder_ds_factor+1e-4)/this.config.stack_factor);s.audio_token_len=[n],s.audio_values=a;let i=this.config.audio_placeholder;if(!e.includes(i))throw Error(`The input text does not contain the image token ${i}.`);e=e.replaceAll(i,i.repeat(n))}return{...this.tokenizer(e,{add_special_tokens:!1,...r}),...s}}}},"./src/models/vit/image_processing_vit.js":(e,t,r)=>{r.r(t),r.d(t,{ViTFeatureExtractor:()=>a,ViTImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{}class a extends o{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,t,r)=>{r.r(t),r.d(t,{VitMatteImageProcessor:()=>a});var s=r("./src/base/image_processors_utils.js"),o=r("./src/utils/tensor.js");class a extends s.ImageProcessor{async _call(e,t){Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);let r=await Promise.all(e.map(e=>this.preprocess(e))),s=await Promise.all(t.map(e=>this.preprocess(e,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,o.stack)(r.map((e,t)=>(0,o.cat)([e.pixel_values,s[t].pixel_values],0)),0),original_sizes:r.map(e=>e.original_size),reshaped_input_sizes:r.map(e=>e.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,t,r)=>{r.r(t),r.d(t,{VitPoseImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_pose_estimation(e,t,{threshold:r=null}={}){let s=e.tolist(),[o,a,n,i]=e.dims,l=[];for(let e=0;e<o;++e){let o=s[e],a=t[e],c=[];for(let e=0;e<a.length;++e){let t=a[e],s=[],l=[],d=[],u=t.at(-2)/i,m=t.at(-1)/n;for(let e=0;e<o.length;++e){let[t,a]=[0,0],n=0,i=-1/0,c=o[e];for(let e=0;e<c.length;++e){let r=c[e];for(let s=0;s<r.length;++s){let o=r[s];n+=o,i=Math.max(i,o),t+=(s+.5)*o,a+=e*o}}if(null!=r&&i<r)continue;let p=[u*t/n,m*a/n];s.push(p),d.push(e),l.push(i)}c.push({bbox:t,scores:l,labels:d,keypoints:s})}l.push(c)}return l}}},"./src/models/voxtral/processing_voxtral.js":(e,t,r)=>{r.r(t),r.d(t,{VoxtralProcessor:()=>l});var s=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/tokenizers.js"),a=r("./src/base/processing_utils.js"),n=r("./src/utils/tensor.js");let i="[AUDIO]";class l extends a.Processor{static tokenizer_class=o.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;static uses_processor_config=!1;async _call(e,t=null,r={}){if(Array.isArray(e))throw Error("Batched inputs are not supported yet.");let s={};if(t){if(!e.includes(i))throw Error(`The input text does not contain the audio token ${i}.`);Array.isArray(t)||(t=[t]);let o=e.split(i),a=o.length-1;if(a!==t.length)throw Error(`The number of audio inputs (${t.length}) does not match the number of audio tokens in the text (${a}).`);let l=this.feature_extractor.config.n_samples,c=t.map(e=>(function(e,t){let r=[];for(let s=0;s<e.length;s+=t)r.push(e.subarray(s,Math.min(s+t,e.length)));return r})(e,l)),d=c.map(e=>e.length),u=c.flat(),m=(await Promise.all(u.map(e=>this.feature_extractor(e,r)))).map(e=>e.input_features);s.audio_values=m.length>1?(0,n.cat)(m,0):m[0];let p=o[0];for(let e=0;e<d.length;++e){p+="[BEGIN_AUDIO]";for(let t=0;t<d[e];++t)p+=i.repeat(375);p+=o[e+1]}e=p}return{...this.tokenizer(e,{add_special_tokens:!1,...r}),...s}}}},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2FeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js"),o=r("./src/utils/tensor.js");class a extends s.FeatureExtractor{_zero_mean_unit_var_norm(e){let t=e.reduce((e,t)=>e+t,0)/e.length,r=e.reduce((e,r)=>e+(r-t)**2,0)/e.length;return e.map(e=>(e-t)/Math.sqrt(r+1e-7))}async _call(e){(0,s.validate_audio_inputs)(e,"Wav2Vec2FeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let t=e;this.config.do_normalize&&(t=this._zero_mean_unit_var_norm(t));let r=[1,t.length];return{input_values:new o.Tensor("float32",t,r),attention_mask:new o.Tensor("int64",new BigInt64Array(t.length).fill(1n),r)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2Processor:()=>n});var s=r("./src/tokenizers.js"),o=r("./src/models/auto/feature_extraction_auto.js"),a=r("./src/base/processing_utils.js");class n extends a.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=o.AutoFeatureExtractor;async _call(e){return await this.feature_extractor(e)}}},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(e,t,r)=>{r.r(t),r.d(t,{Wav2Vec2ProcessorWithLM:()=>n});var s=r("./src/tokenizers.js"),o=r("./src/models/auto/feature_extraction_auto.js"),a=r("./src/base/processing_utils.js");class n extends a.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=o.AutoFeatureExtractor;async _call(e){return await this.feature_extractor(e)}}},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,t,r)=>{r.r(t),r.d(t,{WeSpeakerFeatureExtractor:()=>a});var s=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var o=r("./src/utils/audio.js");class a extends s.FeatureExtractor{constructor(e){super(e);let t=this.config.sampling_rate,r=(0,o.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=r,this.window=(0,o.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(e){return e=e.map(e=>32768*e),(0,o.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(e){(0,s.validate_audio_inputs)(e,"WeSpeakerFeatureExtractor");let t=(await this._extract_fbank_features(e)).unsqueeze_(0);if(null===this.config.fbank_centering_span){let e=t.mean(1).data,r=t.data,[s,o,a]=t.dims;for(let t=0;t<s;++t){let s=t*o*a,n=t*a;for(let t=0;t<o;++t){let o=s+t*a;for(let t=0;t<a;++t)r[o+t]-=e[n+t]}}}return{input_features:t}}}},"./src/models/whisper/common_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WHISPER_LANGUAGE_MAPPING:()=>o,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>a,whisper_language_to_code:()=>n});let s=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],o=new Map(s),a=new Map([...s.map(([e,t])=>[t,e]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function n(e){e=e.toLowerCase();let t=a.get(e);if(void 0===t){let r=e.match(/^<\|([a-z]{2})\|>$/);if(r&&(e=r[1]),o.has(e))t=e;else{let t=2===e.length?o.keys():o.values();throw Error(`Language "${e}" is not supported. Must be one of: ${JSON.stringify(Array.from(t))}`)}}return t}},"./src/models/whisper/feature_extraction_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperFeatureExtractor:()=>n});var s=r("./src/base/feature_extraction_utils.js");r("./src/utils/tensor.js");var o=r("./src/utils/audio.js"),a=r("./src/utils/maths.js");class n extends s.FeatureExtractor{constructor(e){super(e),this.config.mel_filters??=(0,o.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney"),this.window=(0,o.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(e){let t=await (0,o.spectrogram)(e,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(e.length/this.config.hop_length),this.config.nb_max_frames)}),r=t.data,s=(0,a.max)(r)[0];for(let e=0;e<r.length;++e)r[e]=(Math.max(r[e],s-8)+4)/4;return t}async _call(e,{max_length:t=null}={}){let r;(0,s.validate_audio_inputs)(e,"WhisperFeatureExtractor");let o=t??this.config.n_samples;return e.length>o?(e.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),r=e.slice(0,o)):(r=new Float32Array(o)).set(e),{input_features:(await this._extract_fbank_features(r)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperGenerationConfig:()=>o});var s=r("./src/generation/configuration_utils.js");class o extends s.GenerationConfig{return_timestamps=null;return_token_timestamps=null;num_frames=null;alignment_heads=null;task=null;language=null;no_timestamps_token_id=null;prompt_ids=null;is_multilingual=null;lang_to_id=null;task_to_id=null;max_initial_timestamp_index=1}},"./src/models/whisper/processing_whisper.js":(e,t,r)=>{r.r(t),r.d(t,{WhisperProcessor:()=>n});var s=r("./src/models/auto/feature_extraction_auto.js"),o=r("./src/tokenizers.js"),a=r("./src/base/processing_utils.js");class n extends a.Processor{static tokenizer_class=o.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(e){return await this.feature_extractor(e)}}},"./src/models/yolos/image_processing_yolos.js":(e,t,r)=>{r.r(t),r.d(t,{YolosFeatureExtractor:()=>a,YolosImageProcessor:()=>o});var s=r("./src/base/image_processors_utils.js");class o extends s.ImageProcessor{post_process_object_detection(...e){return(0,s.post_process_object_detection)(...e)}}class a extends o{}},"./src/ops/registry.js":(e,t,r)=>{r.r(t),r.d(t,{TensorOpRegistry:()=>n});var s=r("./src/backends/onnx.js"),o=r("./src/utils/tensor.js");let a=async(e,t,r)=>{let a=await (0,s.createInferenceSession)(new Uint8Array(e),t);return async e=>{let t=(0,s.isONNXProxy)(),n=Object.fromEntries(Object.entries(e).map(([e,r])=>[e,(t?r.clone():r).ort_tensor])),i=await (0,s.runInferenceSession)(a,n);return Array.isArray(r)?r.map(e=>new o.Tensor(i[e])):new o.Tensor(i[r])}};class n{static session_options={};static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=a([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=a([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=a([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=a([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=a([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=a([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=a([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=a([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}},"./src/pipelines.js":(e,t,r)=>{r.r(t),r.d(t,{AudioClassificationPipeline:()=>S,AutomaticSpeechRecognitionPipeline:()=>E,BackgroundRemovalPipeline:()=>L,DepthEstimationPipeline:()=>B,DocumentQuestionAnsweringPipeline:()=>D,FeatureExtractionPipeline:()=>k,FillMaskPipeline:()=>y,ImageClassificationPipeline:()=>I,ImageFeatureExtractionPipeline:()=>F,ImageSegmentationPipeline:()=>$,ImageToImagePipeline:()=>V,ImageToTextPipeline:()=>A,ObjectDetectionPipeline:()=>O,Pipeline:()=>f,QuestionAnsweringPipeline:()=>M,SummarizationPipeline:()=>b,Text2TextGenerationPipeline:()=>w,TextClassificationPipeline:()=>_,TextGenerationPipeline:()=>P,TextToAudioPipeline:()=>z,TokenClassificationPipeline:()=>g,TranslationPipeline:()=>v,ZeroShotAudioClassificationPipeline:()=>C,ZeroShotClassificationPipeline:()=>T,ZeroShotImageClassificationPipeline:()=>j,ZeroShotObjectDetectionPipeline:()=>N,pipeline:()=>q});var s=r("./src/tokenizers.js"),o=r("./src/models.js"),a=r("./src/models/auto/processing_auto.js");r("./src/base/processing_utils.js");var n=r("./src/utils/generic.js"),i=r("./src/utils/core.js"),l=r("./src/utils/maths.js"),c=r("./src/utils/audio.js"),d=r("./src/utils/tensor.js"),u=r("./src/utils/image.js");async function m(e){return Array.isArray(e)||(e=[e]),await Promise.all(e.map(e=>u.RawImage.read(e)))}async function p(e,t){return Array.isArray(e)||(e=[e]),await Promise.all(e.map(e=>"string"==typeof e||e instanceof URL?(0,c.read_audio)(e,t):e instanceof Float64Array?new Float32Array(e):e))}function h(e,t){t&&(e=e.map(e=>0|e));let[r,s,o,a]=e;return{xmin:r,ymin:s,xmax:o,ymax:a}}class f extends n.Callable{constructor({task:e,model:t,tokenizer:r=null,processor:s=null}){super(),this.task=e,this.model=t,this.tokenizer=r,this.processor=s}async dispose(){await this.model.dispose()}}class _ extends f{constructor(e){super(e)}async _call(e,{top_k:t=1}={}){let r=this.tokenizer(e,{padding:!0,truncation:!0}),s=await this.model(r),o="multi_label_classification"===this.model.config.problem_type?e=>e.sigmoid():e=>new d.Tensor("float32",(0,l.softmax)(e.data),e.dims),a=this.model.config.id2label,n=[];for(let e of s.logits){let r=o(e),s=await (0,d.topk)(r,t),i=s[0].tolist(),l=s[1].tolist().map((e,t)=>({label:a?a[e]:`LABEL_${e}`,score:i[t]}));1===t?n.push(...l):n.push(l)}return Array.isArray(e)||1===t?n:n[0]}}class g extends f{constructor(e){super(e)}async _call(e,{ignore_labels:t=["O"]}={}){let r=Array.isArray(e),s=this.tokenizer(r?e:[e],{padding:!0,truncation:!0}),o=(await this.model(s)).logits,a=this.model.config.id2label,n=[];for(let e=0;e<o.dims[0];++e){let r=s.input_ids[e],i=o[e],c=[];for(let e=0;e<i.dims[0];++e){let s=i[e],o=(0,l.max)(s.data)[1],n=a?a[o]:`LABEL_${o}`;if(t.includes(n))continue;let d=this.tokenizer.decode([r[e].item()],{skip_special_tokens:!0});if(""===d)continue;let u=(0,l.softmax)(s.data);c.push({entity:n,score:u[o],index:e,word:d})}n.push(c)}return r?n:n[0]}}class M extends f{constructor(e){super(e)}async _call(e,t,{top_k:r=1}={}){let s=this.tokenizer(e,{text_pair:t,padding:!0,truncation:!0}),{start_logits:o,end_logits:a}=await this.model(s),n=s.input_ids.tolist(),c=s.attention_mask.tolist(),d=this.tokenizer.all_special_ids,u=[];for(let e=0;e<o.dims[0];++e){let t=n[e],s=t.findIndex(e=>e==this.tokenizer.sep_token_id);c[e].map((e,r)=>1==e&&(0===r||r>s&&-1===d.findIndex(e=>e==t[r])));let m=o[e].tolist(),p=a[e].tolist();for(let r=1;r<m.length;++r)(0==c[e]||r<=s||-1!==d.findIndex(e=>e==t[r]))&&(m[r]=-1/0,p[r]=-1/0);let h=(0,l.softmax)(m).map((e,t)=>[e,t]),f=(0,l.softmax)(p).map((e,t)=>[e,t]);h[0][0]=0,f[0][0]=0;let _=(0,i.product)(h,f).filter(e=>e[0][1]<=e[1][1]).map(e=>[e[0][1],e[1][1],e[0][0]*e[1][0]]).sort((e,t)=>t[2]-e[2]);for(let e=0;e<Math.min(_.length,r);++e){let[r,s,o]=_[e],a=t.slice(r,s+1),n=this.tokenizer.decode(a,{skip_special_tokens:!0});u.push({answer:n,score:o})}}return 1===r?u[0]:u}}class y extends f{constructor(e){super(e)}async _call(e,{top_k:t=5}={}){let r=this.tokenizer(e,{padding:!0,truncation:!0}),{logits:s}=await this.model(r),o=[],a=r.input_ids.tolist();for(let e=0;e<a.length;++e){let r=a[e],n=r.findIndex(e=>e==this.tokenizer.mask_token_id);if(-1===n)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);let i=s[e][n],c=await (0,d.topk)(new d.Tensor("float32",(0,l.softmax)(i.data),i.dims),t),u=c[0].tolist(),m=c[1].tolist();o.push(m.map((e,t)=>{let s=r.slice();return s[n]=e,{score:u[t],token:Number(e),token_str:this.tokenizer.decode([e]),sequence:this.tokenizer.decode(s,{skip_special_tokens:!0})}}))}return Array.isArray(e)?o:o[0]}}class w extends f{_key="generated_text";constructor(e){super(e)}async _call(e,t={}){let r;Array.isArray(e)||(e=[e]),this.model.config.prefix&&(e=e.map(e=>this.model.config.prefix+e));let s=this.model.config.task_specific_params;s&&s[this.task]&&s[this.task].prefix&&(e=e.map(e=>s[this.task].prefix+e));let o=this.tokenizer,a={padding:!0,truncation:!0};r=this instanceof v&&"_build_translation_inputs"in o?o._build_translation_inputs(e,a,t):o(e,a);let n=await this.model.generate({...r,...t});return o.batch_decode(n,{skip_special_tokens:!0}).map(e=>({[this._key]:e}))}}class b extends w{_key="summary_text";constructor(e){super(e)}}class v extends w{_key="translation_text";constructor(e){super(e)}}function x(e){return Array.isArray(e)&&e.every(e=>"role"in e&&"content"in e)}class P extends f{constructor(e){super(e)}async _call(e,t={}){let r,s,o=!1,a=!1,n=t.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1;if("string"==typeof e)r=e=[e];else if(Array.isArray(e)&&e.every(e=>"string"==typeof e))o=!0,r=e;else{if(x(e))e=[e];else if(Array.isArray(e)&&e.every(x))o=!0;else throw Error("Input must be a string, an array of strings, a Chat, or an array of Chats");a=!0,r=e.map(e=>this.tokenizer.apply_chat_template(e,{tokenize:!1,add_generation_prompt:!0})),n=!1}let i=!a&&(t.return_full_text??!0);this.tokenizer.padding_side="left";let l=this.tokenizer(r,{add_special_tokens:n,padding:!0,truncation:!0}),c=await this.model.generate({...l,...t}),d=this.tokenizer.batch_decode(c,{skip_special_tokens:!0});!i&&l.input_ids.dims.at(-1)>0&&(s=this.tokenizer.batch_decode(l.input_ids,{skip_special_tokens:!0}).map(e=>e.length));let u=Array.from({length:e.length},e=>[]);for(let t=0;t<d.length;++t){let r=Math.floor(t/c.dims[0]*e.length);s&&(d[t]=d[t].slice(s[r])),u[r].push({generated_text:a?[...e[r],{role:"assistant",content:d[t]}]:d[t]})}return o||1!==u.length?u:u[0]}}class T extends f{constructor(e){super(e),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([e,t])=>[e.toLowerCase(),t])),this.entailment_id=this.label2id.entailment,void 0===this.entailment_id&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,void 0===this.contradiction_id&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(e,t,{hypothesis_template:r="This example is {}.",multi_label:s=!1}={}){let o=Array.isArray(e);o||(e=[e]),Array.isArray(t)||(t=[t]);let a=t.map(e=>r.replace("{}",e)),n=s||1===t.length,i=[];for(let r of e){let e=[];for(let t of a){let s=this.tokenizer(r,{text_pair:t,padding:!0,truncation:!0}),o=await this.model(s);n?e.push([o.logits.data[this.contradiction_id],o.logits.data[this.entailment_id]]):e.push(o.logits.data[this.entailment_id])}let s=(n?e.map(e=>(0,l.softmax)(e)[1]):(0,l.softmax)(e)).map((e,t)=>[e,t]).sort((e,t)=>t[0]-e[0]);i.push({sequence:r,labels:s.map(e=>t[e[1]]),scores:s.map(e=>e[0])})}return o?i:i[0]}}class k extends f{constructor(e){super(e)}async _call(e,{pooling:t="none",normalize:r=!1,quantize:s=!1,precision:o="binary"}={}){let a=this.tokenizer(e,{padding:!0,truncation:!0}),n=await this.model(a),i=n.last_hidden_state??n.logits??n.token_embeddings;switch(t){case"none":break;case"mean":i=(0,d.mean_pooling)(i,a.attention_mask);break;case"first_token":case"cls":i=i.slice(null,0);break;case"last_token":case"eos":i=i.slice(null,-1);break;default:throw Error(`Pooling method '${t}' not supported.`)}return r&&(i=i.normalize(2,-1)),s&&(i=(0,d.quantize_embeddings)(i,o)),i}}class F extends f{constructor(e){super(e)}async _call(e,{pool:t=null}={}){let r;let s=await m(e),{pixel_values:o}=await this.processor(s),a=await this.model({pixel_values:o});if(t){if(!("pooler_output"in a))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");r=a.pooler_output}else r=a.last_hidden_state??a.logits??a.image_embeds;return r}}class S extends f{constructor(e){super(e)}async _call(e,{top_k:t=5}={}){let r=this.processor.feature_extractor.config.sampling_rate,s=await p(e,r),o=this.model.config.id2label,a=[];for(let e of s){let r=await this.processor(e),s=(await this.model(r)).logits[0],n=await (0,d.topk)(new d.Tensor("float32",(0,l.softmax)(s.data),s.dims),t),i=n[0].tolist(),c=n[1].tolist().map((e,t)=>({label:o?o[e]:`LABEL_${e}`,score:i[t]}));a.push(c)}return Array.isArray(e)?a:a[0]}}class C extends f{constructor(e){super(e)}async _call(e,t,{hypothesis_template:r="This is a sound of {}."}={}){let s=!Array.isArray(e);s&&(e=[e]);let o=t.map(e=>r.replace("{}",e)),a=this.tokenizer(o,{padding:!0,truncation:!0}),n=this.processor.feature_extractor.config.sampling_rate,i=await p(e,n),c=[];for(let e of i){let r=await this.processor(e),s=await this.model({...a,...r}),o=(0,l.softmax)(s.logits_per_audio.data);c.push([...o].map((e,r)=>({score:e,label:t[r]})))}return s?c[0]:c}}class E extends f{constructor(e){super(e)}async _call(e,t={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(e,t);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":case"parakeet_ctc":return this._call_wav2vec2(e,t);case"moonshine":return this._call_moonshine(e,t);default:throw Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(e,t){t.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),t.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');let r=!Array.isArray(e);r&&(e=[e]);let s=this.processor.feature_extractor.config.sampling_rate,o=await p(e,s),a=[];for(let e of o){let t=await this.processor(e),r=(await this.model(t)).logits[0],s=[];for(let e of r)s.push((0,l.max)(e.data)[1]);let o=this.tokenizer.decode(s,{skip_special_tokens:!0}).trim();a.push({text:o})}return r?a[0]:a}async _call_whisper(e,t){let r=t.return_timestamps??!1,s=t.chunk_length_s??0,o=t.force_full_sequences??!1,a=t.stride_length_s??null,n={...t};"word"===r&&(n.return_token_timestamps=!0,n.return_timestamps=!1);let i=!Array.isArray(e);i&&(e=[e]);let c=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,d=this.processor.feature_extractor.config.hop_length,u=this.processor.feature_extractor.config.sampling_rate,m=await p(e,u),h=[];for(let e of m){let t=[];if(s>0){if(null===a)a=s/6;else if(s<=a)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");let r=u*s,o=u*a,n=r-2*o,i=0;for(;;){let s=i+r,a=e.subarray(i,s),l=await this.processor(a),c=0===i,d=s>=e.length;if(t.push({stride:[a.length,c?0:o,d?0:o],input_features:l.input_features,is_last:d}),d)break;i+=n}}else t=[{stride:[e.length,0,0],input_features:(await this.processor(e)).input_features,is_last:!0}];for(let e of t){n.num_frames=Math.floor(e.stride[0]/d);let t=await this.model.generate({inputs:e.input_features,...n});"word"===r?(e.tokens=t.sequences.tolist()[0],e.token_timestamps=t.token_timestamps.tolist()[0].map(e=>(0,l.round)(e,2))):e.tokens=t[0].tolist(),e.stride=e.stride.map(e=>e/u)}let[i,m]=this.tokenizer._decode_asr(t,{time_precision:c,return_timestamps:r,force_full_sequences:o});h.push({text:i,...m})}return i?h[0]:h}async _call_moonshine(e,t){let r=!Array.isArray(e);r&&(e=[e]);let s=this.processor.feature_extractor.config.sampling_rate,o=await p(e,s),a=[];for(let e of o){let r=await this.processor(e),o=6*Math.floor(e.length/s),n=await this.model.generate({max_new_tokens:o,...t,...r}),i=this.processor.batch_decode(n,{skip_special_tokens:!0})[0];a.push({text:i})}return r?a[0]:a}}class A extends f{constructor(e){super(e)}async _call(e,t={}){let r=Array.isArray(e),s=await m(e),{pixel_values:o}=await this.processor(s),a=[];for(let e of o){e.dims=[1,...e.dims];let r=await this.model.generate({inputs:e,...t}),s=this.tokenizer.batch_decode(r,{skip_special_tokens:!0}).map(e=>({generated_text:e.trim()}));a.push(s)}return r?a:a[0]}}class I extends f{constructor(e){super(e)}async _call(e,{top_k:t=5}={}){let r=await m(e),{pixel_values:s}=await this.processor(r),o=await this.model({pixel_values:s}),a=this.model.config.id2label,n=[];for(let e of o.logits){let r=await (0,d.topk)(new d.Tensor("float32",(0,l.softmax)(e.data),e.dims),t),s=r[0].tolist(),o=r[1].tolist().map((e,t)=>({label:a?a[e]:`LABEL_${e}`,score:s[t]}));n.push(o)}return Array.isArray(e)?n:n[0]}}class $ extends f{constructor(e){super(e),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(e,{threshold:t=.5,mask_threshold:r=.5,overlap_mask_area_threshold:s=.8,label_ids_to_fuse:o=null,target_sizes:a=null,subtask:n=null}={}){if(Array.isArray(e)&&1!==e.length)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");let i=await m(e),l=i.map(e=>[e.height,e.width]),c=await this.processor(i),{inputNames:d,outputNames:p}=this.model.sessions.model;if(!d.includes("pixel_values")){if(1!==d.length)throw Error(`Expected a single input name, but got ${d.length} inputs: ${d}.`);let e=d[0];if(e in c)throw Error(`Input name ${e} already exists in the inputs.`);c[e]=c.pixel_values}let h=await this.model(c),f=null;if(null!==n)f=this.subtasks_mapping[n];else if(this.processor.image_processor){for(let[e,t]of Object.entries(this.subtasks_mapping))if(t in this.processor.image_processor){f=this.processor.image_processor[t].bind(this.processor.image_processor),n=e;break}}let _=this.model.config.id2label,g=[];if(n){if("panoptic"===n||"instance"===n){let e=f(h,t,r,s,o,a??l)[0],n=e.segmentation;for(let t of e.segments_info){let e=new Uint8ClampedArray(n.data.length);for(let r=0;r<n.data.length;++r)n.data[r]===t.id&&(e[r]=255);let r=new u.RawImage(e,n.dims[1],n.dims[0],1);g.push({score:t.score,label:_[t.label_id],mask:r})}}else if("semantic"===n){let{segmentation:e,labels:t}=f(h,a??l)[0];for(let r of t){let t=new Uint8ClampedArray(e.data.length);for(let s=0;s<e.data.length;++s)e.data[s]===r&&(t[s]=255);let s=new u.RawImage(t,e.dims[1],e.dims[0],1);g.push({score:null,label:_[r],mask:s})}}else throw Error(`Subtask ${n} not supported.`)}else{let e=h[p[0]];for(let t=0;t<l.length;++t){let r=l[t],s=e[t];s.data.some(e=>e<-.00001||e>1.00001)&&s.sigmoid_();let o=await u.RawImage.fromTensor(s.mul_(255).to("uint8")).resize(r[1],r[0]);g.push({label:null,score:null,mask:o})}}return g}}class L extends ${constructor(e){super(e)}async _call(e,t={}){if(Array.isArray(e)&&1!==e.length)throw Error("Background removal pipeline currently only supports a batch size of 1.");let r=await m(e),s=await super._call(e,t);return r.map((e,t)=>{let r=e.clone();return r.putAlpha(s[t].mask),r})}}class j extends f{constructor(e){super(e)}async _call(e,t,{hypothesis_template:r="This is a photo of {}"}={}){let s=Array.isArray(e),o=await m(e),a=t.map(e=>r.replace("{}",e)),n=this.tokenizer(a,{padding:"siglip"!==this.model.config.model_type||"max_length",truncation:!0}),{pixel_values:i}=await this.processor(o),c=await this.model({...n,pixel_values:i}),d="siglip"===this.model.config.model_type?e=>e.sigmoid().data:e=>(0,l.softmax)(e.data),u=[];for(let e of c.logits_per_image){let r=[...d(e)].map((e,r)=>({score:e,label:t[r]}));r.sort((e,t)=>t.score-e.score),u.push(r)}return s?u:u[0]}}class O extends f{constructor(e){super(e)}async _call(e,{threshold:t=.9,percentage:r=!1}={}){let s=Array.isArray(e);if(s&&1!==e.length)throw Error("Object detection pipeline currently only supports a batch size of 1.");let o=await m(e),a=r?null:o.map(e=>[e.height,e.width]),{pixel_values:n,pixel_mask:i}=await this.processor(o),l=await this.model({pixel_values:n,pixel_mask:i}),c=this.processor.image_processor.post_process_object_detection(l,t,a),d=this.model.config.id2label,u=c.map(e=>e.boxes.map((t,s)=>({score:e.scores[s],label:d[e.classes[s]],box:h(t,!r)})));return s?u:u[0]}}class N extends f{constructor(e){super(e)}async _call(e,t,{threshold:r=.1,top_k:s=null,percentage:o=!1}={}){let a=Array.isArray(e),n=await m(e),i=this.tokenizer(t,{padding:!0,truncation:!0}),l=await this.processor(n),c=[];for(let e=0;e<n.length;++e){let a;let d=n[e],u=o?null:[[d.height,d.width]],m=l.pixel_values[e].unsqueeze_(0),p=await this.model({...i,pixel_values:m});if("post_process_grounded_object_detection"in this.processor){let e=this.processor.post_process_grounded_object_detection(p,i.input_ids,{box_threshold:r,text_threshold:r,target_sizes:u})[0];a=e.boxes.map((t,r)=>({score:e.scores[r],label:e.labels[r],box:h(t,!o)}))}else{let e=this.processor.image_processor.post_process_object_detection(p,r,u,!0)[0];a=e.boxes.map((r,s)=>({score:e.scores[s],label:t[e.classes[s]],box:h(r,!o)}))}a.sort((e,t)=>t.score-e.score),null!==s&&(a=a.slice(0,s)),c.push(a)}return a?c:c[0]}}class D extends f{constructor(e){super(e)}async _call(e,t,r={}){let s=(await m(e))[0],{pixel_values:o}=await this.processor(s),a=`<s_docvqa><s_question>${t}</s_question><s_answer>`,n=this.tokenizer(a,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,i=await this.model.generate({inputs:o,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:n,...r}),l=this.tokenizer.batch_decode(i)[0].match(/<s_answer>(.*?)<\/s_answer>/),c=null;return l&&l.length>=2&&(c=l[1].trim()),[{answer:c}]}}class z extends f{DEFAULT_VOCODER_ID="Xenova/speecht5_hifigan";constructor(e){super(e),this.vocoder=e.vocoder??null}async _prepare_speaker_embeddings(e){if(("string"==typeof e||e instanceof URL)&&(e=new Float32Array(await (await fetch(e)).arrayBuffer())),e instanceof Float32Array)e=new d.Tensor("float32",e,[e.length]);else if(!(e instanceof d.Tensor))throw Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");return e}async _call(e,{speaker_embeddings:t=null,num_inference_steps:r,speed:s}={}){return this.processor?this._call_text_to_spectrogram(e,{speaker_embeddings:t}):"supertonic"===this.model.config.model_type?this._call_supertonic(e,{speaker_embeddings:t,num_inference_steps:r,speed:s}):this._call_text_to_waveform(e)}async _call_supertonic(e,{speaker_embeddings:t,num_inference_steps:r,speed:s}){if(!t)throw Error("Speaker embeddings must be provided for Supertonic models.");t=await this._prepare_speaker_embeddings(t);let{sampling_rate:o,style_dim:a}=this.model.config;t=t.view(1,-1,a);let n=this.tokenizer(e,{padding:!0,truncation:!0}),{waveform:i}=await this.model.generate_speech({...n,style:t,num_inference_steps:r,speed:s});return new c.RawAudio(i.data,o)}async _call_text_to_waveform(e){let t=this.tokenizer(e,{padding:!0,truncation:!0}),{waveform:r}=await this.model(t),s=this.model.config.sampling_rate;return new c.RawAudio(r.data,s)}async _call_text_to_spectrogram(e,{speaker_embeddings:t}){this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await o.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"}));let{input_ids:r}=this.tokenizer(e,{padding:!0,truncation:!0});t=(t=await this._prepare_speaker_embeddings(t)).view(1,-1);let{waveform:s}=await this.model.generate_speech(r,t,{vocoder:this.vocoder}),a=this.processor.feature_extractor.config.sampling_rate;return new c.RawAudio(s.data,a)}}class V extends f{constructor(e){super(e)}async _call(e){let t=await m(e),r=await this.processor(t),s=await this.model(r),o=[];for(let e of s.reconstruction){let t=e.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");o.push(u.RawImage.fromTensor(t))}return o.length>1?o:o[0]}}class B extends f{constructor(e){super(e)}async _call(e){let t=await m(e),r=await this.processor(t),{predicted_depth:s}=await this.model(r),o=[];for(let e=0;e<t.length;++e){let r=s[e],[a,n]=r.dims.slice(-2),[i,l]=t[e].size,c=(await (0,d.interpolate_4d)(r.view(1,1,a,n),{size:[l,i],mode:"bilinear"})).view(l,i),m=c.min().item(),p=c.max().item(),h=c.sub(m).div_(p-m).mul_(255).to("uint8").unsqueeze(0),f=u.RawImage.fromTensor(h);o.push({predicted_depth:c,depth:f})}return o.length>1?o:o[0]}}let R=Object.freeze({"text-classification":{tokenizer:s.AutoTokenizer,pipeline:_,model:o.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:s.AutoTokenizer,pipeline:g,model:o.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:s.AutoTokenizer,pipeline:M,model:o.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:s.AutoTokenizer,pipeline:y,model:o.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:s.AutoTokenizer,pipeline:b,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:s.AutoTokenizer,pipeline:v,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:s.AutoTokenizer,pipeline:w,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:s.AutoTokenizer,pipeline:P,model:o.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:s.AutoTokenizer,pipeline:T,model:o.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:S,model:o.AutoModelForAudioClassification,processor:a.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:s.AutoTokenizer,pipeline:C,model:o.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:s.AutoTokenizer,pipeline:E,model:[o.AutoModelForSpeechSeq2Seq,o.AutoModelForCTC],processor:a.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:s.AutoTokenizer,pipeline:z,model:[o.AutoModelForTextToWaveform,o.AutoModelForTextToSpectrogram],processor:[a.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:s.AutoTokenizer,pipeline:A,model:o.AutoModelForVision2Seq,processor:a.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:I,model:o.AutoModelForImageClassification,processor:a.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:$,model:[o.AutoModelForImageSegmentation,o.AutoModelForSemanticSegmentation,o.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:L,model:[o.AutoModelForImageSegmentation,o.AutoModelForSemanticSegmentation,o.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:s.AutoTokenizer,pipeline:j,model:o.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:O,model:o.AutoModelForObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:s.AutoTokenizer,pipeline:N,model:o.AutoModelForZeroShotObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:s.AutoTokenizer,pipeline:D,model:o.AutoModelForDocumentQuestionAnswering,processor:a.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:V,model:o.AutoModelForImageToImage,processor:a.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:B,model:o.AutoModelForDepthEstimation,processor:a.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:s.AutoTokenizer,pipeline:k,model:o.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:a.AutoProcessor,pipeline:F,model:[o.AutoModelForImageFeatureExtraction,o.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),G=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function q(e,t=null,{progress_callback:r=null,config:s=null,cache_dir:o=null,local_files_only:a=!1,revision:n="main",device:l=null,dtype:c=null,subfolder:d="onnx",use_external_data_format:u=null,model_file_name:m=null,session_options:p={}}={}){let h=R[(e=G[e]??e).split("_",1)[0]];if(!h)throw Error(`Unsupported pipeline: ${e}. Must be one of [${Object.keys(R)}]`);t||(t=h.default.model,console.log(`No model specified. Using default model: "${t}".`));let f=new Map([["tokenizer",h.tokenizer],["model",h.model],["processor",h.processor]]),_=await U(f,t,{progress_callback:r,config:s,cache_dir:o,local_files_only:a,revision:n,device:l,dtype:c,subfolder:d,use_external_data_format:u,model_file_name:m,session_options:p});return _.task=e,(0,i.dispatchCallback)(r,{status:"ready",task:e,model:t}),new h.pipeline(_)}async function U(e,t,r){let s=Object.create(null),o=[];for(let[a,n]of e.entries()){let e;n&&(e=Array.isArray(n)?new Promise(async(e,s)=>{let o;for(let a of n){if(null===a){e(null);return}try{e(await a.from_pretrained(t,r));return}catch(e){if(e.message?.includes("Unsupported model type"))o=e;else if(e.message?.includes("Could not locate file"))o=e;else{s(e);return}}}s(o)}):n.from_pretrained(t,r),s[a]=e,o.push(e))}for(let[e,t]of(await Promise.all(o),Object.entries(s)))s[e]=await t;return s}},"./src/tokenizers.js":(e,t,r)=>{r.r(t),r.d(t,{AlbertTokenizer:()=>ex,AutoTokenizer:()=>to,BartTokenizer:()=>eN,BertTokenizer:()=>ev,BlenderbotSmallTokenizer:()=>e7,BlenderbotTokenizer:()=>e6,BloomTokenizer:()=>eB,CLIPTokenizer:()=>e3,CamembertTokenizer:()=>eI,CodeGenTokenizer:()=>e2,CodeLlamaTokenizer:()=>eG,CohereTokenizer:()=>tr,ConvBertTokenizer:()=>eC,DebertaTokenizer:()=>ek,DebertaV2Tokenizer:()=>eF,DistilBertTokenizer:()=>eA,ElectraTokenizer:()=>eL,EsmTokenizer:()=>eQ,FalconTokenizer:()=>eW,GPT2Tokenizer:()=>eO,GPTNeoXTokenizer:()=>eH,GemmaTokenizer:()=>eJ,Grok1Tokenizer:()=>eK,HerbertTokenizer:()=>eS,LlamaTokenizer:()=>eR,M2M100Tokenizer:()=>e0,MBart50Tokenizer:()=>ez,MBartTokenizer:()=>eD,MPNetTokenizer:()=>eU,MarianTokenizer:()=>e5,MgpstrTokenizer:()=>ts,MobileBertTokenizer:()=>eP,NllbTokenizer:()=>eZ,NougatTokenizer:()=>te,PreTrainedTokenizer:()=>eb,Qwen2Tokenizer:()=>eX,RoFormerTokenizer:()=>eE,RobertaTokenizer:()=>eV,SiglipTokenizer:()=>e4,SpeechT5Tokenizer:()=>e9,SqueezeBertTokenizer:()=>eT,T5Tokenizer:()=>ej,TokenizerModel:()=>x,VitsTokenizer:()=>tt,Wav2Vec2CTCTokenizer:()=>e8,WhisperTokenizer:()=>e1,XLMRobertaTokenizer:()=>eq,XLMTokenizer:()=>e$,is_chinese_char:()=>g});var s=r("./src/utils/generic.js"),o=r("./src/utils/core.js"),a=r("./src/utils/hub.js"),n=r("./src/utils/maths.js"),i=r("./src/utils/tensor.js"),l=r("./src/utils/data-structures.js"),c=r("./node_modules/@huggingface/jinja/dist/index.js"),d=r("./src/models/whisper/common_whisper.js");async function u(e,t){let r=await Promise.all([(0,a.getModelJSON)(e,"tokenizer.json",!0,t),(0,a.getModelJSON)(e,"tokenizer_config.json",!0,t)]);return null!==t.legacy&&(r[1].legacy=t.legacy),r}function m(e,t=!0){if(void 0!==e.Regex){let t=e.Regex.replace(/\\([#&~])/g,"$1");for(let[e,r]of b)t=t.replaceAll(e,r);return RegExp(t,"gu")}if(void 0===e.String)return console.warn("Unknown pattern type:",e),null;{let r=(0,o.escapeRegExp)(e.String);return RegExp(t?r:`(${r})`,"gu")}}function p(e){return new Map(Object.entries(e))}function h(e){let t=e.dims;switch(t.length){case 1:return e.tolist();case 2:if(1!==t[0])throw Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return e.tolist()[0];default:throw Error(`Expected tensor to have 1-2 dimensions, got ${t.length}.`)}}function f(e){return e.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function _(e){return e.replace(/\p{M}/gu,"")}function g(e){return e>=19968&&e<=40959||e>=13312&&e<=19903||e>=131072&&e<=173791||e>=173824&&e<=177983||e>=177984&&e<=178207||e>=178208&&e<=183983||e>=63744&&e<=64255||e>=194560&&e<=195103}let M="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",y=RegExp(`^[${M}]+$`,"gu"),w=".,!?",b=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],["(?i:[sdmt]|ll|ve|re)","(?:[sS]|[dD]|[mM]|[tT]|[lL][lL]|[vV][eE]|[rR][eE])"],["[^\\r\\n\\p{L}\\p{N}]?+","[^\\r\\n\\p{L}\\p{N}]?"],["[^\\s\\p{L}\\p{N}]++","[^\\s\\p{L}\\p{N}]+"],[` ?[^(\\s|[${w}])]+`,` ?[^\\s${w}]+`]]);class v{constructor(e){this.content=e.content,this.id=e.id,this.single_word=e.single_word??!1,this.lstrip=e.lstrip??!1,this.rstrip=e.rstrip??!1,this.special=e.special??!1,this.normalized=e.normalized??null}}class x extends s.Callable{constructor(e){super(),this.config=e,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(e,...t){switch(e.type){case"WordPiece":return new P(e);case"Unigram":return new T(e,...t);case"BPE":return new S(e);default:if(e.vocab){if(Array.isArray(e.vocab))return new T(e,...t);if(!(Object.hasOwn(e,"continuing_subword_prefix")&&Object.hasOwn(e,"unk_token")))return new C(e,...t);if(Object.hasOwn(e,"merges"))return new S(e);return new P(e)}throw Error(`Unknown TokenizerModel type: ${e.type}`)}}_call(e){return e=this.encode(e),this.fuse_unk&&(e=function(e,t,r){let s=[],o=0;for(;o<e.length;){if(s.push(e[o]),(t.get(e[o])??r)!==r){++o;continue}for(;++o<e.length&&(t.get(e[o])??r)===r;)t.get(s.at(-1))!==r&&(s[s.length-1]+=e[o])}return s}(e,this.tokens_to_ids,this.unk_token_id)),e}encode(e){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(e){return e.map(e=>this.tokens_to_ids.get(e)??this.unk_token_id)}convert_ids_to_tokens(e){return e.map(e=>this.vocab[e]??this.unk_token)}}class P extends x{constructor(e){for(let[t,r]of(super(e),this.tokens_to_ids=p(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.max_input_chars_per_word=e.max_input_chars_per_word??100,this.vocab=Array(this.tokens_to_ids.size),this.tokens_to_ids))this.vocab[r]=t}encode(e){let t=[];for(let r of e){let e=[...r];if(e.length>this.max_input_chars_per_word){t.push(this.unk_token);continue}let s=!1,o=0,a=[];for(;o<e.length;){let t=e.length,r=null;for(;o<t;){let s=e.slice(o,t).join("");if(o>0&&(s=this.config.continuing_subword_prefix+s),this.tokens_to_ids.has(s)){r=s;break}--t}if(null===r){s=!0;break}a.push(r),o=t}s?t.push(this.unk_token):t.push(...a)}return t}}class T extends x{constructor(e,t){super(e);let r=e.vocab.length;this.vocab=Array(r),this.scores=Array(r);for(let t=0;t<r;++t)[this.vocab[t],this.scores[t]]=e.vocab[t];this.unk_token_id=e.unk_id,this.unk_token=this.vocab[e.unk_id],this.tokens_to_ids=new Map(this.vocab.map((e,t)=>[e,t])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=t.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,n.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new l.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(e){let t=e.chars,r=0;for(;r<t.length;){let s=!1,a=[],n=t.slice(r).join("");for(let t of this.trie.commonPrefixSearch(n)){a.push(t);let n=this.tokens_to_ids.get(t),i=this.scores[n],l=(0,o.len)(t);e.insert(r,l,i,n),s||1!==l||(s=!0)}s||e.insert(r,1,this.unk_score,this.unk_token_id),r+=1}}tokenize(e){let t=new l.TokenLattice(e,this.bos_token_id,this.eos_token_id);return this.populateNodes(t),t.tokens()}encode(e){let t=[];for(let r of e){let e=this.tokenize(r);t.push(...e)}return t}}let k=(()=>{let e=[...Array.from({length:94},(e,t)=>t+33),...Array.from({length:12},(e,t)=>t+161),...Array.from({length:82},(e,t)=>t+174)],t=e.slice(),r=0;for(let s=0;s<256;++s)e.includes(s)||(e.push(s),t.push(256+r),r+=1);let s=t.map(e=>String.fromCharCode(e));return Object.fromEntries(e.map((e,t)=>[e,s[t]]))})(),F=(0,o.reverseDictionary)(k);class S extends x{constructor(e){for(let[t,r]of(super(e),this.tokens_to_ids=p(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.vocab=Array(this.tokens_to_ids.size),this.tokens_to_ids))this.vocab[r]=t;let t=Array.isArray(e.merges[0]);this.merges=t?e.merges:e.merges.map(e=>e.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((e,t)=>[JSON.stringify(e),t])),this.end_of_word_suffix=e.end_of_word_suffix,this.continuing_subword_suffix=e.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new l.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(e){if(0===e.length)return[];let t=this.cache.get(e);if(void 0!==t)return t;let r=Array.from(e);this.end_of_word_suffix&&(r[r.length-1]+=this.end_of_word_suffix);let s=[];if(r.length>1){let e=new l.PriorityQueue((e,t)=>e.score<t.score),t={token:r[0],bias:0,prev:null,next:null},o=t;for(let t=1;t<r.length;++t){let s={bias:t/r.length,token:r[t],prev:o,next:null};o.next=s,this._add_node(e,o),o=s}for(;!e.isEmpty();){let r=e.pop();if(r.deleted||!r.next||r.next.deleted)continue;if(r.deleted=!0,r.next.deleted=!0,r.prev){let e={...r.prev};r.prev.deleted=!0,r.prev=e,e.prev?e.prev.next=e:t=e}let s={token:r.token+r.next.token,bias:r.bias,prev:r.prev,next:r.next.next};s.prev?(s.prev.next=s,this._add_node(e,s.prev)):t=s,s.next&&(s.next.prev=s,this._add_node(e,s))}for(let e=t;null!==e;e=e.next)s.push(e.token)}else s=r;if(this.continuing_subword_suffix)for(let e=0;e<s.length-1;++e)s[e]+=this.continuing_subword_suffix;return e.length<this.max_length_to_cache&&this.cache.put(e,s),s}_add_node(e,t){let r=this.bpe_ranks.get(JSON.stringify([t.token,t.next.token]));void 0!==r&&(t.score=r+t.bias,e.push(t))}encode(e){let t=[];for(let r of e){if(this.ignore_merges&&this.tokens_to_ids.has(r)){t.push(r);continue}for(let e of this.bpe(r))if(this.tokens_to_ids.has(e))t.push(e);else if(this.byte_fallback){let r=Array.from(this.text_encoder.encode(e)).map(e=>`<0x${e.toString(16).toUpperCase().padStart(2,"0")}>`);r.every(e=>this.tokens_to_ids.has(e))?t.push(...r):t.push(this.unk_token)}else t.push(this.unk_token)}return t}}class C extends x{constructor(e,t){for(let[r,s]of(super(e),this.tokens_to_ids=p(t.target_lang?e.vocab[t.target_lang]:e.vocab),this.bos_token=t.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=t.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=t.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=t.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=Array(this.tokens_to_ids.size),this.tokens_to_ids))this.vocab[s]=r}encode(e){return e}}class E extends s.Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(null===e)return null;switch(e.type){case"BertNormalizer":return new R(e);case"Precompiled":return new eh(e);case"Sequence":return new B(e);case"Replace":return new A(e);case"NFC":return new $(e);case"NFD":return new L(e);case"NFKC":return new j(e);case"NFKD":return new O(e);case"Strip":return new N(e);case"StripAccents":return new D(e);case"Lowercase":return new z(e);case"Prepend":return new V(e);default:throw Error(`Unknown Normalizer type: ${e.type}`)}}normalize(e){throw Error("normalize should be implemented in subclass.")}_call(e){return this.normalize(e)}}class A extends E{normalize(e){let t=m(this.config.pattern);return null===t?e:e.replaceAll(t,this.config.content)}}class I extends E{form=void 0;normalize(e){return e=e.normalize(this.form)}}class $ extends I{form="NFC"}class L extends I{form="NFD"}class j extends I{form="NFKC"}class O extends I{form="NFKD"}class N extends E{normalize(e){return this.config.strip_left&&this.config.strip_right?e=e.trim():(this.config.strip_left&&(e=e.trimStart()),this.config.strip_right&&(e=e.trimEnd())),e}}class D extends E{normalize(e){return e=_(e)}}class z extends E{normalize(e){return e=e.toLowerCase()}}class V extends E{normalize(e){return e=this.config.prepend+e}}class B extends E{constructor(e){super(e),this.normalizers=e.normalizers.map(e=>E.fromConfig(e))}normalize(e){return this.normalizers.reduce((e,t)=>t.normalize(e),e)}}class R extends E{_tokenize_chinese_chars(e){let t=[];for(let r=0;r<e.length;++r){let s=e[r];g(s.charCodeAt(0))?(t.push(" "),t.push(s),t.push(" ")):t.push(s)}return t.join("")}stripAccents(e){return e.normalize("NFD").replace(/\p{Mn}/gu,"")}_is_control(e){switch(e){case"	":case"\n":case"\r":return!1;default:return/^\p{Cc}|\p{Cf}|\p{Co}|\p{Cs}$/u.test(e)}}_clean_text(e){let t=[];for(let r of e){let e=r.charCodeAt(0);0===e||65533===e||this._is_control(r)||(/^\s$/.test(r)?t.push(" "):t.push(r))}return t.join("")}normalize(e){return this.config.clean_text&&(e=this._clean_text(e)),this.config.handle_chinese_chars&&(e=this._tokenize_chinese_chars(e)),this.config.lowercase?(e=e.toLowerCase(),!1!==this.config.strip_accents&&(e=this.stripAccents(e))):this.config.strip_accents&&(e=this.stripAccents(e)),e}}class G extends s.Callable{static fromConfig(e){if(null===e)return null;switch(e.type){case"BertPreTokenizer":return new q(e);case"Sequence":return new ef(e);case"Whitespace":return new e_(e);case"WhitespaceSplit":return new eg(e);case"Metaspace":return new em(e);case"ByteLevel":return new U(e);case"Split":return new W(e);case"Punctuation":return new H(e);case"Digits":return new Q(e);case"Replace":return new eM(e);case"FixedLength":return new ey(e);default:throw Error(`Unknown PreTokenizer type: ${e.type}`)}}pre_tokenize_text(e,t){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(e,t){return(Array.isArray(e)?e.map(e=>this.pre_tokenize_text(e,t)):this.pre_tokenize_text(e,t)).flat()}_call(e,t){return this.pre_tokenize(e,t)}}class q extends G{constructor(e){super(),this.pattern=RegExp(`[^\\s${M}]+|[${M}]`,"gu")}pre_tokenize_text(e,t){return e.trim().match(this.pattern)||[]}}class U extends G{constructor(e){super(),this.config=e,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=/'s|'t|'re|'ve|'m|'ll|'d| ?\p{L}+| ?\p{N}+| ?[^\s\p{L}\p{N}]+|\s+(?!\S)|\s+/gu,this.byte_encoder=k,this.text_encoder=new TextEncoder}pre_tokenize_text(e,t){return this.add_prefix_space&&!e.startsWith(" ")&&(e=" "+e),(this.use_regex?e.match(this.pattern)||[]:[e]).map(e=>Array.from(this.text_encoder.encode(e),e=>this.byte_encoder[e]).join(""))}}class W extends G{constructor(e){super(),this.config=e,this.pattern=m(this.config.pattern,this.config.invert)}pre_tokenize_text(e,t){return null===this.pattern?[]:this.config.invert?e.match(this.pattern)||[]:this.config.behavior?.toLowerCase()==="removed"?e.split(this.pattern).filter(e=>e):function(e,t){let r=[],s=0;for(let o of e.matchAll(t)){let t=o[0];s<o.index&&r.push(e.slice(s,o.index)),t.length>0&&r.push(t),s=o.index+t.length}return s<e.length&&r.push(e.slice(s)),r}(e,this.pattern)}}class H extends G{constructor(e){super(),this.config=e,this.pattern=RegExp(`[^${M}]+|[${M}]+`,"gu")}pre_tokenize_text(e,t){return e.match(this.pattern)||[]}}class Q extends G{constructor(e){super(),this.config=e;let t=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=RegExp(t,"gu")}pre_tokenize_text(e,t){return e.match(this.pattern)||[]}}class X extends s.Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(null===e)return null;switch(e.type){case"TemplateProcessing":return new Y(e);case"ByteLevel":return new Z(e);case"RobertaProcessing":return new K(e);case"BertProcessing":return new J(e);case"Sequence":return new ee(e);default:throw Error(`Unknown PostProcessor type: ${e.type}`)}}post_process(e,...t){throw Error("post_process should be implemented in subclass.")}_call(e,...t){return this.post_process(e,...t)}}class J extends X{constructor(e){super(e),this.cls=e.cls[0],this.sep=e.sep[0]}post_process(e,t=null,{add_special_tokens:r=!0}={}){r&&(e=(0,o.mergeArrays)([this.cls],e,[this.sep]));let s=Array(e.length).fill(0);if(null!==t){let a=r&&this instanceof K?[this.sep]:[],n=r?[this.sep]:[];e=(0,o.mergeArrays)(e,a,t,n),s=(0,o.mergeArrays)(s,Array(t.length+a.length+n.length).fill(1))}return{tokens:e,token_type_ids:s}}}class K extends J{}class Y extends X{constructor(e){super(e),this.single=e.single,this.pair=e.pair}post_process(e,t=null,{add_special_tokens:r=!0}={}){let s=null===t?this.single:this.pair,a=[],n=[];for(let i of s)"SpecialToken"in i?r&&(a.push(i.SpecialToken.id),n.push(i.SpecialToken.type_id)):"Sequence"in i&&("A"===i.Sequence.id?(a=(0,o.mergeArrays)(a,e),n=(0,o.mergeArrays)(n,Array(e.length).fill(i.Sequence.type_id))):"B"===i.Sequence.id&&(a=(0,o.mergeArrays)(a,t),n=(0,o.mergeArrays)(n,Array(t.length).fill(i.Sequence.type_id))));return{tokens:a,token_type_ids:n}}}class Z extends X{post_process(e,t=null){return t&&(e=(0,o.mergeArrays)(e,t)),{tokens:e}}}class ee extends X{constructor(e){super(e),this.processors=e.processors.map(e=>X.fromConfig(e))}post_process(e,t=null,r={}){let s;for(let o of this.processors)if(o instanceof Z)e=o.post_process(e).tokens,t&&(t=o.post_process(t).tokens);else{let a=o.post_process(e,t,r);e=a.tokens,s=a.token_type_ids}return{tokens:e,token_type_ids:s}}}class et extends s.Callable{constructor(e){super(),this.config=e,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=e.trim_offsets}static fromConfig(e){if(null===e)return null;switch(e.type){case"WordPiece":return new en(e);case"Metaspace":return new ep(e);case"ByteLevel":return new ei(e);case"Replace":return new er(e);case"ByteFallback":return new es(e);case"Fuse":return new eo(e);case"Strip":return new ea(e);case"Sequence":return new ec(e);case"CTC":return new el(e);case"BPEDecoder":return new ed(e);default:throw Error(`Unknown Decoder type: ${e.type}`)}}_call(e){return this.decode(e)}decode(e){return this.decode_chain(e).join("")}decode_chain(e){throw Error("`decode_chain` should be implemented in subclass.")}}class er extends et{decode_chain(e){let t=m(this.config.pattern);return null===t?e:e.map(e=>e.replaceAll(t,this.config.content))}}class es extends et{constructor(e){super(e),this.text_decoder=new TextDecoder}decode_chain(e){let t=[],r=[];for(let s of e){let e=null;if(6===s.length&&s.startsWith("<0x")&&s.endsWith(">")){let t=parseInt(s.slice(3,5),16);isNaN(t)||(e=t)}if(null!==e)r.push(e);else{if(r.length>0){let e=this.text_decoder.decode(Uint8Array.from(r));t.push(e),r=[]}t.push(s)}}if(r.length>0){let e=this.text_decoder.decode(Uint8Array.from(r));t.push(e),r=[]}return t}}class eo extends et{decode_chain(e){return[e.join("")]}}class ea extends et{constructor(e){super(e),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(e){return e.map(e=>{let t=0;for(let r=0;r<this.start;++r){if(e[r]===this.content){t=r+1;continue}break}let r=e.length;for(let t=0;t<this.stop;++t){let s=e.length-t-1;if(e[s]===this.content){r=s;continue}break}return e.slice(t,r)})}}class en extends et{constructor(e){super(e),this.cleanup=e.cleanup}decode_chain(e){return e.map((e,t)=>(0!==t&&(e=e.startsWith(this.config.prefix)?e.replace(this.config.prefix,""):" "+e),this.cleanup&&(e=f(e)),e))}}class ei extends et{constructor(e){super(e),this.byte_decoder=F,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(e){let t=new Uint8Array([...e.join("")].map(e=>this.byte_decoder[e]));return this.text_decoder.decode(t)}decode_chain(e){let t=[],r=[];for(let s of e)void 0!==this.added_tokens.find(e=>e.content===s)?(r.length>0&&(t.push(this.convert_tokens_to_string(r)),r=[]),t.push(s)):r.push(s);return r.length>0&&t.push(this.convert_tokens_to_string(r)),t}}class el extends et{constructor(e){super(e),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(e){if(0===e.length)return"";let t=[e[0]];for(let r=1;r<e.length;++r)e[r]!==t.at(-1)&&t.push(e[r]);let r=t.filter(e=>e!==this.pad_token).join("");return this.cleanup&&(r=f(r).replaceAll(this.word_delimiter_token," ").trim()),r}decode_chain(e){return[this.convert_tokens_to_string(e)]}}class ec extends et{constructor(e){super(e),this.decoders=e.decoders.map(e=>et.fromConfig(e))}decode_chain(e){return this.decoders.reduce((e,t)=>t.decode_chain(e),e)}}class ed extends et{constructor(e){super(e),this.suffix=this.config.suffix}decode_chain(e){return e.map((t,r)=>t.replaceAll(this.suffix,r===e.length-1?"":" "))}}class eu extends et{decode_chain(e){let t="";for(let r=1;r<e.length;r+=2)t+=e[r];return[t]}}class em extends G{constructor(e){super(),this.replacement=e.replacement,this.strRep=e.str_rep||this.replacement,this.prepend_scheme=e.prepend_scheme??"always"}pre_tokenize_text(e,{section_index:t}={}){let r=e.replaceAll(" ",this.strRep);return r.startsWith(this.replacement)||"always"!==this.prepend_scheme&&("first"!==this.prepend_scheme||0!==t)||(r=this.strRep+r),[r]}}class ep extends et{constructor(e){super(e),this.replacement=e.replacement}decode_chain(e){let t=[];for(let r=0;r<e.length;++r){let s=e[r].replaceAll(this.replacement," ");0==r&&s.startsWith(" ")&&(s=s.substring(1)),t.push(s)}return t}}class eh extends E{constructor(e){super(e),this.charsmap=e.precompiled_charsmap}normalize(e){return e=(e=(e=e.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,"")).replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," ")).includes("")?e.split("").map(e=>e.normalize("NFKC")).join(""):e.normalize("NFKC")}}class ef extends G{constructor(e){super(),this.tokenizers=e.pretokenizers.map(e=>G.fromConfig(e))}pre_tokenize_text(e,t){return this.tokenizers.reduce((e,r)=>r.pre_tokenize(e,t),[e])}}class e_ extends G{constructor(e){super()}pre_tokenize_text(e,t){return e.match(/\w+|[^\w\s]+/g)||[]}}class eg extends G{constructor(e){super()}pre_tokenize_text(e,t){return e.match(/\S+/g)||[]}}class eM extends G{constructor(e){super(),this.config=e,this.pattern=m(this.config.pattern),this.content=this.config.content}pre_tokenize_text(e,t){return null===this.pattern?[e]:[e.replaceAll(this.pattern,this.config.content)]}}class ey extends G{constructor(e){super(),this._length=e.length}pre_tokenize_text(e,t){let r=[];for(let t=0;t<e.length;t+=this._length)r.push(e.slice(t,t+this._length));return r}}let ew=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];class eb extends s.Callable{return_token_type_ids=!1;padding_side="right";constructor(e,t){for(let r of(super(),this.config=t,this.normalizer=E.fromConfig(e.normalizer),this.pre_tokenizer=G.fromConfig(e.pre_tokenizer),this.model=x.fromConfig(e.model,t),this.post_processor=X.fromConfig(e.post_processor),this.decoder=et.fromConfig(e.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[],e.added_tokens)){let e=new v(r);this.added_tokens.push(e),this.model.tokens_to_ids.set(e.content,e.id),this.model.vocab[e.id]=e.content,e.special&&(this.special_tokens.push(e.content),this.all_special_ids.push(e.id))}if(this.additional_special_tokens=t.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new l.DictionarySplitter(this.added_tokens.map(e=>e.content)),this.added_tokens_map=new Map(this.added_tokens.map(e=>[e.content,e])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=t.model_max_length,this.remove_space=t.remove_space,this.clean_up_tokenization_spaces=t.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=t.do_lowercase_and_remove_accent??!1,t.padding_side&&(this.padding_side=t.padding_side),this.add_bos_token=t.add_bos_token,this.add_eos_token=t.add_eos_token,this.legacy=!1,this.chat_template=t.chat_template??null,Array.isArray(this.chat_template)){let e=Object.create(null);for(let{name:t,template:r}of this.chat_template){if("string"!=typeof t||"string"!=typeof r)throw Error('Chat template must be a list of objects with "name" and "template" properties');e[t]=r}this.chat_template=e}this._compiled_template_cache=new Map}getToken(...e){for(let t of e){let e=this.config[t];if(e){if("object"!=typeof e)return e;if("AddedToken"===e.__type)return e.content;throw Error(`Unknown token: ${e}`)}}return null}static async from_pretrained(e,{progress_callback:t=null,config:r=null,cache_dir:s=null,local_files_only:o=!1,revision:a="main",legacy:n=null}={}){return new this(...await u(e,{progress_callback:t,config:r,cache_dir:s,local_files_only:o,revision:a,legacy:n}))}_call(e,{text_pair:t=null,add_special_tokens:r=!0,padding:s=!1,truncation:a=null,max_length:l=null,return_tensor:c=!0,return_token_type_ids:d=null}={}){let u;let m=Array.isArray(e);if(m){if(0===e.length)throw Error("text array must be non-empty");if(null!==t){if(Array.isArray(t)){if(e.length!==t.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");u=e.map((e,s)=>this._encode_plus(e,{text_pair:t[s],add_special_tokens:r,return_token_type_ids:d}))}else u=e.map(e=>this._encode_plus(e,{add_special_tokens:r,return_token_type_ids:d}))}else{if(null==e)throw Error("text may not be null or undefined");if(Array.isArray(t))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");u=[this._encode_plus(e,{text_pair:t,add_special_tokens:r,return_token_type_ids:d})]}if(null===l?l=this.model_max_length:null===a&&(!0===s?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),l=this.model_max_length):!1===s&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),a=!0)),!0===s&&(l=Math.min((0,n.max)(u.map(e=>e.input_ids.length))[0],l??1/0)),l=Math.min(l,this.model_max_length??1/0),s||a)for(let e=0;e<u.length;++e)u[e].input_ids.length!==l&&(u[e].input_ids.length>l?a&&function(e,t){for(let r of Object.keys(e))e[r].length=t}(u[e],l):s&&function(e,t,r,s){for(let a of Object.keys(e)){let n=t-e[a].length,i=r(a),l=Array(n).fill(i);e[a]="right"===s?(0,o.mergeArrays)(e[a],l):(0,o.mergeArrays)(l,e[a])}}(u[e],l,e=>"input_ids"===e?this.pad_token_id:0,this.padding_side));let p={};if(c){if(!(s&&a)&&u.some(e=>{for(let t of Object.keys(e))if(e[t].length!==u[0][t]?.length)return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");let e=[u.length,u[0].input_ids.length];for(let t of Object.keys(u[0]))p[t]=new i.Tensor("int64",BigInt64Array.from(u.flatMap(e=>e[t]).map(BigInt)),e)}else{for(let e of Object.keys(u[0]))p[e]=u.map(t=>t[e]);if(!m)for(let e of Object.keys(p))p[e]=p[e][0]}return p}_encode_text(e){if(null===e)return null;let t=this.added_tokens_splitter.split(e);for(let e=0;e<t.length;++e){let r=this.added_tokens_map.get(t[e]);r&&(r.lstrip&&e>0&&(t[e-1]=t[e-1].trimEnd()),r.rstrip&&e<t.length-1&&(t[e+1]=t[e+1].trimStart()))}return t.flatMap((e,t)=>{if(0===e.length)return[];if(this.added_tokens_map.has(e))return[e];if(!0===this.remove_space&&(e=e.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(e=_(e.toLowerCase())),null!==this.normalizer&&(e=this.normalizer(e)),0===e.length)return[];let r=null!==this.pre_tokenizer?this.pre_tokenizer(e,{section_index:t}):[e];return this.model(r)})}_encode_plus(e,{text_pair:t=null,add_special_tokens:r=!0,return_token_type_ids:s=null}={}){let{tokens:o,token_type_ids:a}=this._tokenize_helper(e,{pair:t,add_special_tokens:r}),n=this.model.convert_tokens_to_ids(o),i={input_ids:n,attention_mask:Array(n.length).fill(1)};return(s??this.return_token_type_ids)&&a&&(i.token_type_ids=a),i}_tokenize_helper(e,{pair:t=null,add_special_tokens:r=!1}={}){let s=this._encode_text(e),a=this._encode_text(t);return this.post_processor?this.post_processor(s,a,{add_special_tokens:r}):{tokens:(0,o.mergeArrays)(s??[],a??[])}}tokenize(e,{pair:t=null,add_special_tokens:r=!1}={}){return this._tokenize_helper(e,{pair:t,add_special_tokens:r}).tokens}encode(e,{text_pair:t=null,add_special_tokens:r=!0,return_token_type_ids:s=null}={}){return this._encode_plus(e,{text_pair:t,add_special_tokens:r,return_token_type_ids:s}).input_ids}batch_decode(e,t={}){return e instanceof i.Tensor&&(e=e.tolist()),e.map(e=>this.decode(e,t))}decode(e,t={}){if(e instanceof i.Tensor&&(e=h(e)),!Array.isArray(e)||0===e.length||!(0,o.isIntegralNumber)(e[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(e,t)}decode_single(e,{skip_special_tokens:t=!1,clean_up_tokenization_spaces:r=null}){let s=this.model.convert_ids_to_tokens(e);t&&(s=s.filter(e=>!this.special_tokens.includes(e)));let o=this.decoder?this.decoder(s):s.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(o=o.replaceAll(this.decoder.end_of_word_suffix," "),t&&(o=o.trim())),(r??this.clean_up_tokenization_spaces)&&(o=f(o)),o}get_chat_template({chat_template:e=null,tools:t=null}={}){if(this.chat_template&&"object"==typeof this.chat_template){let r=this.chat_template;if(null!==e&&Object.hasOwn(r,e))e=r[e];else if(null===e){if(null!==t&&"tool_use"in r)e=r.tool_use;else if("default"in r)e=r.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(r).sort()}.`)}}else if(null===e){if(this.chat_template)e=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating")}return e}apply_chat_template(e,{tools:t=null,documents:r=null,chat_template:s=null,add_generation_prompt:o=!1,tokenize:a=!0,padding:n=!1,truncation:i=!1,max_length:l=null,return_tensor:d=!0,return_dict:u=!1,tokenizer_kwargs:m={},...p}={}){if("string"!=typeof(s=this.get_chat_template({chat_template:s,tools:t})))throw Error(`chat_template must be a string, but got ${typeof s}`);let h=this._compiled_template_cache.get(s);void 0===h&&(h=new c.Template(s),this._compiled_template_cache.set(s,h));let f=Object.create(null);for(let e of ew){let t=this.getToken(e);t&&(f[e]=t)}let _=h.render({messages:e,add_generation_prompt:o,tools:t,documents:r,...f,...p});if(a){let e=this._call(_,{add_special_tokens:!1,padding:n,truncation:i,max_length:l,return_tensor:d,...m});return u?e:e.input_ids}return _}}class ev extends eb{return_token_type_ids=!0}class ex extends eb{return_token_type_ids=!0}class eP extends eb{return_token_type_ids=!0}class eT extends eb{return_token_type_ids=!0}class ek extends eb{return_token_type_ids=!0}class eF extends eb{return_token_type_ids=!0}class eS extends eb{return_token_type_ids=!0}class eC extends eb{return_token_type_ids=!0}class eE extends eb{return_token_type_ids=!0}class eA extends eb{}class eI extends eb{}class e$ extends eb{return_token_type_ids=!0;constructor(e,t){super(e,t),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class eL extends eb{return_token_type_ids=!0}class ej extends eb{}class eO extends eb{}class eN extends eb{}class eD extends eb{constructor(e,t){super(e,t),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(e=>this.languageRegex.test(e)),this.lang_to_token=e=>e}_build_translation_inputs(e,t,r){return eY(this,e,t,r)}}class ez extends eD{}class eV extends eb{}class eB extends eb{}class eR extends eb{padding_side="left";constructor(e,t){super(e,t),this.legacy=t.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new em({replacement:"",prepend_scheme:"first"}))}_encode_text(e){if(null===e)return null;if(this.legacy||0===e.length)return super._encode_text(e);let t=super._encode_text(""+e.replaceAll(""," "));return t.length>1&&""===t[0]&&this.special_tokens.includes(t[1])&&(t=t.slice(1)),t}}class eG extends eb{}class eq extends eb{}class eU extends eb{}class eW extends eb{}class eH extends eb{}class eQ extends eb{}class eX extends eb{}class eJ extends eb{}class eK extends eb{}function eY(e,t,r,s){if(!("language_codes"in e)||!Array.isArray(e.language_codes))throw Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in e)||!(e.languageRegex instanceof RegExp))throw Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in e)||"function"!=typeof e.lang_to_token)throw Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");let o=s.src_lang,a=s.tgt_lang;if(!e.language_codes.includes(a))throw Error(`Target language code "${a}" is not valid. Must be one of: {${e.language_codes.join(", ")}}`);if(void 0!==o){if(!e.language_codes.includes(o))throw Error(`Source language code "${o}" is not valid. Must be one of: {${e.language_codes.join(", ")}}`);for(let t of e.post_processor.config.single)if("SpecialToken"in t&&e.languageRegex.test(t.SpecialToken.id)){t.SpecialToken.id=e.lang_to_token(o);break}}return s.forced_bos_token_id=e.model.convert_tokens_to_ids([e.lang_to_token(a)])[0],e._call(t,r)}class eZ extends eb{constructor(e,t){super(e,t),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(e=>this.languageRegex.test(e)),this.lang_to_token=e=>e}_build_translation_inputs(e,t,r){return eY(this,e,t,r)}}class e0 extends eb{constructor(e,t){super(e,t),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(e=>this.languageRegex.test(e)).map(e=>e.slice(2,-2)),this.lang_to_token=e=>`__${e}__`}_build_translation_inputs(e,t,r){return eY(this,e,t,r)}}class e1 extends eb{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(e,{return_timestamps:t=!1,return_language:r=!1,time_precision:s=null,force_full_sequences:o=!0}={}){if(null===s)throw Error("Must specify time_precision");let a=null,i="word"===t;function l(){return{language:a,timestamp:[null,null],text:""}}let c=[],u=l(),m=0,p=this.timestamp_begin,h=p+1500,f=[],_=[],g=!1,M=null,w=new Set(this.all_special_ids);for(let r of e){let e=r.tokens,o=i?r.token_timestamps:null,b=null,v=p;if("stride"in r){let[t,o,a]=r.stride;if(m-=o,M=t-a,o&&(v=o/s+p),a)for(let t=e.length-1;t>=0;--t){let r=Number(e[t]);if(r>=p){if(null!==b&&(r-p)*s<M)break;b=r}}}let x=[],P=[];for(let r=0;r<e.length;++r){let M=Number(e[r]);if(w.has(M)){let e=this.decode([M]),r=d.WHISPER_LANGUAGE_MAPPING.get(e.slice(2,-2));if(void 0!==r){if(null!==a&&r!==a&&!t){f.push(x);let e=this.findLongestCommonSequence(f)[0],t=this.decode(e);u.text=t,c.push(u),f=[],x=[],u=l()}a=u.language=r}}else if(M>=p&&M<=h){let e=(M-p)*s+m,t=(0,n.round)(e,2);if(null!==b&&M>=b)g=!0;else if(g||f.length>0&&M<v)g=!1;else if(null===u.timestamp[0])u.timestamp[0]=t;else if(t===u.timestamp[0]);else{u.timestamp[1]=t,f.push(x),i&&_.push(P);let[e,r]=this.findLongestCommonSequence(f,_),s=this.decode(e);u.text=s,i&&(u.words=this.collateWordTimestamps(e,r,a)),c.push(u),f=[],x=[],_=[],P=[],u=l()}}else if(x.push(M),i){let e,t=(0,n.round)(o[r]+m,2);if(r+1<o.length){e=(0,n.round)(o[r+1]+m,2);let a=this.decode([M]);y.test(a)&&(e=(0,n.round)(Math.min(t+s,e),2))}else e=null;P.push([t,e])}}if("stride"in r){let[e,t,s]=r.stride;m+=e-s}x.length>0?(f.push(x),i&&_.push(P)):f.every(e=>0===e.length)&&(u=l(),f=[],x=[],_=[],P=[])}if(f.length>0){if(o&&t)throw Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");let[e,r]=this.findLongestCommonSequence(f,_),s=this.decode(e);u.text=s,i&&(u.words=this.collateWordTimestamps(e,r,a)),c.push(u)}let b=Object.create(null),v=c.map(e=>e.text).join("");if(t||r){for(let e=0;e<c.length;++e){let s=c[e];t||delete s.timestamp,r||delete s.language}if(i){let e=[];for(let t of c)for(let r of t.words)e.push(r);b={chunks:e}}else b={chunks:c}}return[v,b]}findLongestCommonSequence(e,t=null){let r=e[0],s=r.length,o=[],a=Array.isArray(t)&&t.length>0,n=a?[]:null,i=a?t[0]:null;for(let l=1;l<e.length;++l){let c=e[l],d=0,u=[s,s,0,0],m=c.length;for(let e=1;e<s+m;++e){let o;let n=Math.max(0,s-e),p=Math.min(s,s+m-e),h=r.slice(n,p),f=Math.max(0,e-s),_=Math.min(m,e),g=c.slice(f,_);if(h.length!==g.length)throw Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");o=a?h.filter((e,r)=>e===g[r]&&i[n+r]<=t[l][f+r]).length:h.filter((e,t)=>e===g[t]).length;let M=e/1e4,y=o/e+M;o>1&&y>d&&(d=y,u=[n,p,f,_])}let[p,h,f,_]=u,g=Math.floor((h+p)/2),M=Math.floor((_+f)/2);o.push(...r.slice(0,g)),s=(r=c.slice(M)).length,a&&(n.push(...i.slice(0,g)),i=t[l].slice(M))}return(o.push(...r),a)?(n.push(...i),[o,n]):[o,[]]}collateWordTimestamps(e,t,r){let[s,o,a]=this.combineTokensIntoWords(e,r),n=[];for(let e=0;e<s.length;++e){let r=a[e];n.push({text:s[e],timestamp:[t[r.at(0)][0],t[r.at(-1)][1]]})}return n}combineTokensIntoWords(e,t,r="\"'\xa1\xbf([{-",s="\"'.,!?:)]}"){let o,a,n;return["chinese","japanese","thai","lao","myanmar"].includes(t=t??"english")?[o,a,n]=this.splitTokensOnUnicode(e):[o,a,n]=this.splitTokensOnSpaces(e),this.mergePunctuations(o,a,n,r,s)}decode(e,t){let r;return t?.decode_with_timestamps?(e instanceof i.Tensor&&(e=h(e)),r=this.decodeWithTimestamps(e,t)):r=super.decode(e,t),r}decodeWithTimestamps(e,t){let r=t?.time_precision??.02,s=Array.from(this.all_special_ids).at(-1)+1,o=[[]];for(let t of e)if((t=Number(t))>=s){let e=((t-s)*r).toFixed(2);o.push(`<|${e}|>`),o.push([])}else o[o.length-1].push(t);return(o=o.map(e=>"string"==typeof e?e:super.decode(e,t))).join("")}splitTokensOnUnicode(e){let t=this.decode(e,{decode_with_timestamps:!0}),r=[],s=[],o=[],a=[],n=[],i=0;for(let l=0;l<e.length;++l){let c=e[l];a.push(c),n.push(l);let d=this.decode(a,{decode_with_timestamps:!0});d.includes("")&&""!==t[i+d.indexOf("")]||(r.push(d),s.push(a),o.push(n),a=[],n=[],i+=d.length)}return[r,s,o]}splitTokensOnSpaces(e){let[t,r,s]=this.splitTokensOnUnicode(e),o=[],a=[],n=[],i=RegExp(`^[${M}]$`,"gu");for(let e=0;e<t.length;++e){let l=t[e],c=r[e],d=s[e],u=c[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),m=l.startsWith(" "),p=l.trim(),h=i.test(p);if(u||m||h||0===o.length)o.push(l),a.push(c),n.push(d);else{let e=o.length-1;o[e]+=l,a[e].push(...c),n[e].push(...d)}}return[o,a,n]}mergePunctuations(e,t,r,s,a){let n=structuredClone(e),i=structuredClone(t),l=structuredClone(r),c=n.length-2,d=n.length-1;for(;c>=0;)n[c].startsWith(" ")&&s.includes(n[c].trim())?(n[d]=n[c]+n[d],i[d]=(0,o.mergeArrays)(i[c],i[d]),l[d]=(0,o.mergeArrays)(l[c],l[d]),n[c]="",i[c]=[],l[c]=[]):d=c,--c;for(c=0,d=1;d<n.length;)!n[c].endsWith(" ")&&a.includes(n[d])?(n[c]+=n[d],i[c]=(0,o.mergeArrays)(i[c],i[d]),l[c]=(0,o.mergeArrays)(l[c],l[d]),n[d]="",i[d]=[],l[d]=[]):c=d,++d;return[n.filter(e=>e),i.filter(e=>e.length>0),l.filter(e=>e.length>0)]}}class e2 extends eb{}class e3 extends eb{}class e4 extends eb{}class e5 extends eb{constructor(e,t){super(e,t),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(e=>this.languageRegex.test(e)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(e){if(null===e)return null;let[t,...r]=e.trim().split(this.languageRegex);if(0===r.length)return super._encode_text(t);if(2===r.length){let[e,t]=r;return this.supported_language_codes.includes(e)||console.warn(`Unsupported language code "${e}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,o.mergeArrays)([e],super._encode_text(t))}}}class e8 extends eb{}class e6 extends eb{}class e7 extends eb{}class e9 extends eb{}class te extends eb{}class tt extends eb{constructor(e,t){super(e,t),this.decoder=new eu({})}}class tr extends eb{}class ts extends eb{}class to{static TOKENIZER_CLASS_MAPPING={T5Tokenizer:ej,DistilBertTokenizer:eA,CamembertTokenizer:eI,DebertaTokenizer:ek,DebertaV2Tokenizer:eF,BertTokenizer:ev,HerbertTokenizer:eS,ConvBertTokenizer:eC,RoFormerTokenizer:eE,XLMTokenizer:e$,ElectraTokenizer:eL,MobileBertTokenizer:eP,SqueezeBertTokenizer:eT,AlbertTokenizer:ex,GPT2Tokenizer:eO,BartTokenizer:eN,MBartTokenizer:eD,MBart50Tokenizer:ez,RobertaTokenizer:eV,WhisperTokenizer:e1,CodeGenTokenizer:e2,CLIPTokenizer:e3,SiglipTokenizer:e4,MarianTokenizer:e5,BloomTokenizer:eB,NllbTokenizer:eZ,M2M100Tokenizer:e0,LlamaTokenizer:eR,CodeLlamaTokenizer:eG,XLMRobertaTokenizer:eq,MPNetTokenizer:eU,FalconTokenizer:eW,GPTNeoXTokenizer:eH,EsmTokenizer:eQ,Wav2Vec2CTCTokenizer:e8,BlenderbotTokenizer:e6,BlenderbotSmallTokenizer:e7,SpeechT5Tokenizer:e9,NougatTokenizer:te,VitsTokenizer:tt,Qwen2Tokenizer:eX,GemmaTokenizer:eJ,Grok1Tokenizer:eK,CohereTokenizer:tr,MgpstrTokenizer:ts,PreTrainedTokenizer:eb};static async from_pretrained(e,{progress_callback:t=null,config:r=null,cache_dir:s=null,local_files_only:o=!1,revision:a="main",legacy:n=null}={}){let[i,l]=await u(e,{progress_callback:t,config:r,cache_dir:s,local_files_only:o,revision:a,legacy:n}),c=l.tokenizer_class?.replace(/Fast$/,"")??"PreTrainedTokenizer",d=this.TOKENIZER_CLASS_MAPPING[c];return d||(console.warn(`Unknown tokenizer class "${c}", attempting to construct from base class.`),d=eb),new d(i,l)}}},"./src/utils/audio.js":(e,t,r)=>{r.r(t),r.d(t,{RawAudio:()=>v,hamming:()=>m,hanning:()=>u,mel_filter_bank:()=>g,read_audio:()=>c,spectrogram:()=>y,window_function:()=>w});var s=r("./src/utils/hub.js"),o=r("./src/utils/maths.js"),a=r("./src/utils/core.js"),n=r("./src/env.js"),i=r("./src/utils/tensor.js"),l=r("node:fs");async function c(e,t){let r;if("undefined"==typeof AudioContext)throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");let o=await (await (0,s.getFile)(e)).arrayBuffer(),a=new AudioContext({sampleRate:t});void 0===t&&console.warn(`No sampling rate provided, using default of ${a.sampleRate}Hz.`);let n=await a.decodeAudioData(o);if(2===n.numberOfChannels){let e=Math.sqrt(2),t=n.getChannelData(0),s=n.getChannelData(1);r=new Float32Array(t.length);for(let o=0;o<n.length;++o)r[o]=e*(t[o]+s[o])/2}else r=n.getChannelData(0);return r}function d(e,t){if(e<1)return new Float64Array;if(1===e)return new Float64Array([1]);let r=1-t,s=2*Math.PI/(e-1),o=new Float64Array(e);for(let a=0;a<e;++a)o[a]=t-r*Math.cos(a*s);return o}function u(e){return d(e,.5)}function m(e){return d(e,.54)}let p={htk:e=>2595*Math.log10(1+e/700),kaldi:e=>1127*Math.log(1+e/700),slaney:(e,t=1e3,r=15,s=27/Math.log(6.4))=>e>=t?r+Math.log(e/t)*s:3*e/200};function h(e,t="htk"){let r=p[t];if(!r)throw Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return"number"==typeof e?r(e):e.map(e=>r(e))}let f={htk:e=>700*(10**(e/2595)-1),kaldi:e=>700*(Math.exp(e/1127)-1),slaney:(e,t=1e3,r=15,s=Math.log(6.4)/27)=>e>=r?t*Math.exp(s*(e-r)):200*e/3};function _(e,t,r){let s=(t-e)/(r-1);return Float64Array.from({length:r},(t,r)=>e+s*r)}function g(e,t,r,s,o,a=null,n="htk",i=!1){let l;if(null!==a&&"slaney"!==a)throw Error('norm must be one of null or "slaney"');if(e<2)throw Error(`Require num_frequency_bins: ${e} >= 2`);if(r>s)throw Error(`Require min_frequency: ${r} <= max_frequency: ${s}`);let c=_(h(r,n),h(s,n),t+2),d=function(e,t="htk"){let r=f[t];if(!r)throw Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return"number"==typeof e?r(e):e.map(e=>r(e))}(c,n);if(i){let t=o/((e-1)*2);l=h(Float64Array.from({length:e},(e,r)=>r*t),n),d=c}else l=_(0,Math.floor(o/2),e);let u=function(e,t){let r=Float64Array.from({length:t.length-1},(e,r)=>t[r+1]-t[r]),s=Array.from({length:e.length},()=>Array(t.length));for(let r=0;r<e.length;++r){let o=s[r];for(let s=0;s<t.length;++s)o[s]=t[s]-e[r]}let o=t.length-2,a=Array.from({length:o},()=>Array(e.length));for(let t=0;t<e.length;++t){let e=s[t];for(let s=0;s<o;++s){let o=-e[s]/r[s],n=e[s+2]/r[s+1];a[s][t]=Math.max(0,Math.min(o,n))}}return a}(l,d);if(null!==a&&"slaney"===a)for(let r=0;r<t;++r){let t=u[r],s=2/(d[r+2]-d[r]);for(let r=0;r<e;++r)t[r]*=s}return u}function M(e,t,r,s,a){if(r<=0)throw Error("reference must be greater than zero");if(s<=0)throw Error("min_value must be greater than zero");let n=Math.log10(r=Math.max(s,r));for(let r=0;r<e.length;++r)e[r]=t*Math.log10(Math.max(s,e[r])-n);if(null!==a){if(a<=0)throw Error("db_range must be greater than zero");let t=(0,o.max)(e)[0]-a;for(let r=0;r<e.length;++r)e[r]=Math.max(e[r],t)}return e}async function y(e,t,r,s,{fft_length:n=null,power:l=1,center:c=!0,pad_mode:d="reflect",onesided:u=!0,preemphasis:m=null,preemphasis_htk_flavor:p=!0,mel_filters:h=null,mel_floor:f=1e-10,log_mel:_=null,reference:g=1,min_value:y=1e-10,db_range:w=null,remove_dc_offset:b=null,min_num_frames:v=null,max_num_frames:x=null,do_pad:P=!0,transpose:T=!1,mel_offset:k=0}={}){let F=t.length;if(null===n&&(n=r),r>n)throw Error(`frame_length (${r}) may not be larger than fft_length (${n})`);if(F!==r)throw Error(`Length of the window (${F}) must equal frame_length (${r})`);if(s<=0)throw Error("hop_length must be greater than zero");if(null===l&&null!==h)throw Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!p)throw Error("`preemphasis_htk_flavor=false` is not currently supported.");if(c)switch(d){case"reflect":{let t=Math.floor((n-1)/2)+1;e=function(e,t,r){let s=new e.constructor(e.length+t+r),o=e.length-1;for(let r=0;r<e.length;++r)s[t+r]=e[r];for(let r=1;r<=t;++r)s[t-r]=e[(0,a.calculateReflectOffset)(r,o)];for(let n=1;n<=r;++n)s[o+t+n]=e[(0,a.calculateReflectOffset)(o-n,o)];return s}(e,t,t);break}case"constant":{let t=Math.floor(n/2),r=new e.constructor(e.length+2*t);r.set(e,t),e=r;break}default:throw Error(`pad_mode="${d}" not implemented yet.`)}let S=Math.floor(1+Math.floor((e.length-r)/s));null!==v&&S<v&&(S=v);let C=u?Math.floor(n/2)+1:n,E=S,A=S;null!==x&&(x>S?P&&(A=x):A=E=x);let I=new o.FFT(n),$=new Float64Array(n),L=new Float64Array(I.outputBufferSize),j=new Float32Array(C*A);for(let o=0;o<E;++o){let a=o*s,n=Math.min(e.length-a,r);n!==r&&$.fill(0,0,r);for(let t=0;t<n;++t)$[t]=e[a+t];if(b){let e=0;for(let t=0;t<n;++t)e+=$[t];let t=e/n;for(let e=0;e<n;++e)$[e]-=t}if(null!==m){for(let e=n-1;e>=1;--e)$[e]-=m*$[e-1];$[0]*=1-m}for(let e=0;e<t.length;++e)$[e]*=t[e];I.realTransform(L,$);for(let e=0;e<C;++e){let t=e<<1;j[e*A+o]=L[t]**2+L[t+1]**2}}if(null!==l&&2!==l){let e=l/2;for(let t=0;t<j.length;++t)j[t]**=e}let O=h.length,N=await (0,i.matmul)(new i.Tensor("float32",h.flat(),[O,C]),new i.Tensor("float32",j,[C,A]));T&&(N=N.transpose(1,0));let D=N.data;for(let e=0;e<D.length;++e)D[e]=k+Math.max(f,D[e]);if(null!==l&&null!==_){let e=Math.min(D.length,E*O);switch(_){case"log":for(let t=0;t<e;++t)D[t]=Math.log(D[t]);break;case"log10":for(let t=0;t<e;++t)D[t]=Math.log10(D[t]);break;case"dB":if(1===l)!function(e,t=1,r=1e-5,s=null){M(e,20,t,r,s)}(D,g,y,w);else if(2===l)!function(e,t=1,r=1e-10,s=null){M(e,10,t,r,s)}(D,g,y,w);else throw Error(`Cannot use log_mel option '${_}' with power ${l}`);break;default:throw Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${_}'`)}}return N}function w(e,t,{periodic:r=!0,frame_length:s=null,center:o=!0}={}){let a;let n=r?e+1:e;switch(t){case"boxcar":a=new Float64Array(n).fill(1);break;case"hann":case"hann_window":a=u(n);break;case"hamming":a=m(n);break;case"povey":a=u(n).map(e=>Math.pow(e,.85));break;default:throw Error(`Unknown window type ${t}.`)}if(r&&(a=a.subarray(0,e)),null===s)return a;if(e>s)throw Error(`Length of the window (${e}) may not be larger than frame_length (${s})`);return a}function b(e,t,r){for(let s=0;s<r.length;++s)e.setUint8(t+s,r.charCodeAt(s))}class v{constructor(e,t){this.audio=e,this.sampling_rate=t}toWav(){return function(e,t){let r=44,s=new ArrayBuffer(44+4*e.length),o=new DataView(s);b(o,0,"RIFF"),o.setUint32(4,36+4*e.length,!0),b(o,8,"WAVE"),b(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,3,!0),o.setUint16(22,1,!0),o.setUint32(24,t,!0),o.setUint32(28,4*t,!0),o.setUint16(32,4,!0),o.setUint16(34,32,!0),b(o,36,"data"),o.setUint32(40,4*e.length,!0);for(let t=0;t<e.length;++t,r+=4)o.setFloat32(r,e[t],!0);return s}(this.audio,this.sampling_rate)}toBlob(){return new Blob([this.toWav()],{type:"audio/wav"})}async save(e){let t;if(n.apis.IS_BROWSER_ENV){if(n.apis.IS_WEBWORKER_ENV)throw Error("Unable to save a file from a Web Worker.");t=a.saveBlob}else if(n.apis.IS_FS_AVAILABLE)t=async(e,t)=>{let r=await t.arrayBuffer();l.default.writeFileSync(e,Buffer.from(r))};else throw Error("Unable to save because filesystem is disabled in this environment.");await t(e,this.toBlob())}}},"./src/utils/constants.js":(e,t,r)=>{r.r(t),r.d(t,{CHAT_TEMPLATE_NAME:()=>l,CONFIG_NAME:()=>o,FEATURE_EXTRACTOR_NAME:()=>a,GENERATION_CONFIG_NAME:()=>c,GITHUB_ISSUE_URL:()=>s,IMAGE_PROCESSOR_NAME:()=>n,PROCESSOR_NAME:()=>i});let s="https://github.com/huggingface/transformers.js/issues/new/choose",o="config.json",a="preprocessor_config.json",n=a,i="processor_config.json",l="chat_template.jinja",c="generation_config.json"},"./src/utils/core.js":(e,t,r)=>{function s(e,t){e&&e(t)}function o(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[t,e]))}function a(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return e?.prototype?.__proto__?.constructor?.name==="TypedArray"}function i(e){return Number.isInteger(e)||"bigint"==typeof e}function l(e){return null==e||-1===e}function c(e){let t=[],r=e;for(;Array.isArray(r);)t.push(r.length),r=r[0];return t}function d(e,t,r){let s=e[t];if(void 0!==s)return delete e[t],s;if(void 0===r)throw Error(`Key ${t} does not exist in object.`);return r}function u(...e){return Array.prototype.concat.apply([],e)}function m(...e){return e.reduce((e,t)=>e.flatMap(e=>t.map(t=>[e,t])))}function p(e,t){return Math.abs((e+t)%(2*t)-t)}function h(e,t){let r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=e,s.click(),s.remove(),URL.revokeObjectURL(r)}function f(e,t){return Object.assign({},...t.map(t=>{if(void 0!==e[t])return{[t]:e[t]}}))}function _(e){let t=0;for(let r of e)++t;return t}function g(e,t){let r=0;for(let s of e)s===t&&++r;return r}r.r(t),r.d(t,{calculateDimensions:()=>c,calculateReflectOffset:()=>p,count:()=>g,dispatchCallback:()=>s,escapeRegExp:()=>a,isIntegralNumber:()=>i,isNullishDimension:()=>l,isTypedArray:()=>n,len:()=>_,mergeArrays:()=>u,pick:()=>f,pop:()=>d,product:()=>m,reverseDictionary:()=>o,saveBlob:()=>h})},"./src/utils/data-structures.js":(e,t,r)=>{r.r(t),r.d(t,{CharTrie:()=>o,DictionarySplitter:()=>l,LRUCache:()=>c,PriorityQueue:()=>s,TokenLattice:()=>n});class s{constructor(e=(e,t)=>e>t,t=1/0){this._heap=[],this._comparator=e,this._maxSize=t}get size(){return this._heap.length}isEmpty(){return 0===this.size}peek(){return this._heap[0]}push(...e){return this.extend(e)}extend(e){for(let t of e)if(this.size<this._maxSize)this._heap.push(t),this._siftUp();else{let e=this._smallest();this._comparator(t,this._heap[e])&&(this._heap[e]=t,this._siftUpFrom(e))}return this.size}pop(){let e=this.peek(),t=this.size-1;return t>0&&this._swap(0,t),this._heap.pop(),this._siftDown(),e}replace(e){let t=this.peek();return this._heap[0]=e,this._siftDown(),t}_parent(e){return(e+1>>>1)-1}_left(e){return(e<<1)+1}_right(e){return e+1<<1}_greater(e,t){return this._comparator(this._heap[e],this._heap[t])}_swap(e,t){let r=this._heap[e];this._heap[e]=this._heap[t],this._heap[t]=r}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(e){for(;e>0&&this._greater(e,this._parent(e));)this._swap(e,this._parent(e)),e=this._parent(e)}_siftDown(){let e=0;for(;this._left(e)<this.size&&this._greater(this._left(e),e)||this._right(e)<this.size&&this._greater(this._right(e),e);){let t=this._right(e)<this.size&&this._greater(this._right(e),this._left(e))?this._right(e):this._left(e);this._swap(e,t),e=t}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class o{constructor(){this.root=a.default()}extend(e){for(let t of e)this.push(t)}push(e){let t=this.root;for(let r of e){let e=t.children.get(r);void 0===e&&(e=a.default(),t.children.set(r,e)),t=e}t.isLeaf=!0}*commonPrefixSearch(e){let t=this.root;if(void 0===t)return;let r="";for(let s of e){if(r+=s,void 0===(t=t.children.get(s)))return;t.isLeaf&&(yield r)}}}class a{constructor(e,t){this.isLeaf=e,this.children=t}static default(){return new a(!1,new Map)}}class n{constructor(e,t,r){this.chars=Array.from(e),this.len=this.chars.length,this.bosTokenId=t,this.eosTokenId=r,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);let s=new i(this.bosTokenId,0,0,0,0),o=new i(this.eosTokenId,1,this.len,0,0);this.nodes.push(s.clone()),this.nodes.push(o.clone()),this.beginNodes[this.len].push(o),this.endNodes[0].push(s)}insert(e,t,r,s){let o=new i(s,this.nodes.length,e,t,r);this.beginNodes[e].push(o),this.endNodes[e+t].push(o),this.nodes.push(o)}viterbi(){let e=this.len,t=0;for(;t<=e;){if(0==this.beginNodes[t].length)return[];for(let e of this.beginNodes[t]){e.prev=null;let r=0,s=null;for(let o of this.endNodes[t]){let t=o.backtraceScore+e.score;(null===s||t>r)&&(s=o.clone(),r=t)}if(null===s)return[];e.prev=s,e.backtraceScore=r}++t}let r=[],s=this.beginNodes[e][0].prev;if(null===s)return[];let o=s.clone();for(;null!==o.prev;)r.push(o.clone()),o=o.clone().prev.clone();return r.reverse(),r}piece(e){return this.chars.slice(e.pos,e.pos+e.length).join("")}tokens(){return this.viterbi().map(e=>this.piece(e))}tokenIds(){return this.viterbi().map(e=>e.tokenId)}}class i{constructor(e,t,r,s,o){this.tokenId=e,this.nodeId=t,this.pos=r,this.length=s,this.score=o,this.prev=null,this.backtraceScore=0}clone(){let e=new i(this.tokenId,this.nodeId,this.pos,this.length,this.score);return e.prev=this.prev,e.backtraceScore=this.backtraceScore,e}}class l{constructor(e){this.trie=this._buildTrie(e)}_buildTrie(e){let t=Object.create(null);for(let r of e){let e=t;for(let t=0;t<r.length;++t)e=e[r[t]]??=Object.create(null);e.end=r}return t}split(e){let t=[],r=e.length,s=0,o=0;for(;o<r;){let a=this.trie,n=null,i=o;for(;i<r&&(a=a[e[i]]);)a.end&&(n=a.end),++i;n?(o>s&&t.push(e.slice(s,o)),t.push(n),o+=n.length,s=o):++o}return s<r&&t.push(e.slice(s)),t}}class c{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;let t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}put(e,t){this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,t),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}},"./src/utils/devices.js":(e,t,r)=>{r.r(t),r.d(t,{DEVICE_TYPES:()=>s});let s=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,t,r)=>{r.r(t),r.d(t,{DATA_TYPES:()=>n,DEFAULT_DEVICE_DTYPE_MAPPING:()=>i,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>l,isWebGpuFp16Supported:()=>a});var s=r("./src/env.js"),o=r("./src/utils/devices.js");let a=function(){let e;return async function(){if(void 0===e){if(s.apis.IS_WEBGPU_AVAILABLE)try{e=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch(t){e=!1}else e=!1}return e}}(),n=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),i=Object.freeze({[o.DEVICE_TYPES.wasm]:n.q8}),l=Object.freeze({[n.fp32]:"",[n.fp16]:"_fp16",[n.int8]:"_int8",[n.uint8]:"_uint8",[n.q8]:"_quantized",[n.q4]:"_q4",[n.q4f16]:"_q4f16",[n.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,t,r)=>{r.r(t),r.d(t,{Callable:()=>s});let s=class{constructor(){let e=function(...t){return e._call(...t)};return Object.setPrototypeOf(e,new.target.prototype)}_call(...e){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,t,r)=>{r.r(t),r.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>i,getFile:()=>m,getModelFile:()=>_,getModelJSON:()=>M,getModelText:()=>g});var s=r("node:fs"),o=r("node:path"),a=r("./src/env.js"),n=r("./src/utils/core.js");let i=100,l={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class c{constructor(e){if(this.filePath=e,this.headers=new Headers,this.exists=s.default.existsSync(e),this.exists){this.status=200,this.statusText="OK";let t=s.default.statSync(e);this.headers.set("content-length",t.size.toString()),this.updateContentType();let r=s.default.createReadStream(e);this.body=new ReadableStream({start(e){r.on("data",t=>e.enqueue(t)),r.on("end",()=>e.close()),r.on("error",t=>e.error(t))},cancel(){r.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){let e=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",l[e]??"application/octet-stream")}clone(){let e=new c(this.filePath);return e.exists=this.exists,e.status=this.status,e.statusText=this.statusText,e.headers=new Headers(this.headers),e}async arrayBuffer(){return(await s.default.promises.readFile(this.filePath)).buffer}async blob(){return new Blob([await s.default.promises.readFile(this.filePath)],{type:this.headers.get("content-type")})}async text(){return await s.default.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function d(e,t=null,r=null){let s;try{s=new URL(e)}catch(e){return!1}return(!t||!!t.includes(s.protocol))&&(!r||!!r.includes(s.hostname))}let u=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;async function m(e){if(a.env.useFS&&!d(e,["http:","https:","blob:"]))return new c(e instanceof URL?"file:"===e.protocol?e.pathname:e.toString():e);if("undefined"==typeof process||process?.release?.name!=="node")return fetch(e);{let t=!!process.env?.TESTING_REMOTELY,r=a.env.version,s=new Headers;if(s.set("User-Agent",`transformers.js/${r}; is_ci/${t};`),d(e,["http:","https:"],["huggingface.co","hf.co"])){let e=process.env?.HF_TOKEN??process.env?.HF_ACCESS_TOKEN;e&&s.set("Authorization",`Bearer ${e}`)}return fetch(e,{headers:s})}}let p={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};class h{constructor(e){this.path=e}async match(e){let t=new c(o.default.join(this.path,e));return t.exists?t:void 0}async put(e,t,r){let a=o.default.join(this.path,e);try{let e=t.headers.get("Content-Length"),n=parseInt(e??"0"),i=0;await s.default.promises.mkdir(o.default.dirname(a),{recursive:!0});let l=s.default.createWriteStream(a),c=t.body.getReader();for(;;){let{done:e,value:t}=await c.read();if(e)break;await new Promise((e,r)=>{l.write(t,t=>{if(t){r(t);return}e()})}),i+=t.length;let s=n?i/n*100:0;r?.({progress:s,loaded:i,total:n})}l.close()}catch(e){try{await s.default.promises.unlink(a)}catch{}throw e}}}async function f(e,...t){for(let r of t)try{let t=await e.match(r);if(t)return t}catch(e){continue}}async function _(e,t,r=!0,s={},o=!1){let i,l,_,g;if(!a.env.allowLocalModels){if(s.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!a.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}if((0,n.dispatchCallback)(s.progress_callback,{status:"initiate",name:e,file:t}),!i&&a.env.useCustomCache){if(!a.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!a.env.customCache.match||!a.env.customCache.put)throw Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");i=a.env.customCache}if(!i&&a.env.useBrowserCache){if("undefined"==typeof caches)throw Error("Browser cache is not available in this environment.");try{i=await caches.open("transformers-cache")}catch(e){console.warn("An error occurred while opening the browser cache:",e)}}if(!i&&a.env.useFSCache){if(!a.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");i=new h(s.cache_dir??a.env.cacheDir)}let M=s.revision??"main",b=w(e,t),v=!(!u.test(e)||e.includes("..")||e.includes("--")||e.endsWith(".git")||e.endsWith(".ipynb")),x=v?w(a.env.localModelPath,b):b,P=w(a.env.remoteHost,a.env.remotePathTemplate.replaceAll("{model}",e).replaceAll("{revision}",encodeURIComponent(M)),t),T=i instanceof h?"main"===M?b:w(e,M,t):P,k=!1;i&&(_=await f(i,x,T));let F=void 0!==_;if(void 0===_){if(a.env.allowLocalModels){if(d(b,["http:","https:"])){if(s.local_files_only)throw Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${b}.`);if(!a.env.allowRemoteModels)throw Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${b}.`)}else try{_=await m(x),l=x}catch(e){console.warn(`Unable to load from local path "${x}": "${e}"`)}}if(void 0===_||404===_.status){if(s.local_files_only||!a.env.allowRemoteModels){if(!r)return null;throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${x}".`)}if(!v)throw Error(`Local file missing at "${x}" and download aborted due to invalid model ID "${e}".`);if(200!==(_=await m(P)).status)return function(e,t,r){if(!r)return null;let s=p[e]??`Error (${e}) occurred while trying to load file`;throw Error(`${s}: "${t}".`)}(_.status,P,r);l=T}k=i&&"undefined"!=typeof Response&&_ instanceof Response&&200===_.status}if((0,n.dispatchCallback)(s.progress_callback,{status:"download",name:e,file:t}),!(a.apis.IS_NODE_ENV&&o)){let r;s.progress_callback?F&&"undefined"!=typeof navigator&&/firefox/i.test(navigator.userAgent)?(r=new Uint8Array(await _.arrayBuffer()),(0,n.dispatchCallback)(s.progress_callback,{status:"progress",name:e,file:t,progress:100,loaded:r.length,total:r.length})):r=await y(_,r=>{(0,n.dispatchCallback)(s.progress_callback,{status:"progress",name:e,file:t,...r})}):r=new Uint8Array(await _.arrayBuffer()),g=r}if(k&&l&&await i.match(l)===void 0){if(g)await i.put(l,new Response(g,{headers:_.headers})).catch(e=>{console.warn(`Unable to add response to browser cache: ${e}.`)});else{let r=s.progress_callback?r=>(0,n.dispatchCallback)(s.progress_callback,{status:"progress",name:e,file:t,...r}):void 0;await i.put(l,_,r)}}if((0,n.dispatchCallback)(s.progress_callback,{status:"done",name:e,file:t}),g){if(!a.apis.IS_NODE_ENV&&o)throw Error("Cannot return path in a browser environment.");return g}if(_ instanceof c)return _.filePath;let S=await i?.match(l);if(S instanceof c)return S.filePath;if(S instanceof Response)return new Uint8Array(await S.arrayBuffer());if("string"==typeof S)return S;throw Error("Unable to get model file path or buffer.")}async function g(e,t,r=!0,s={}){let o=await _(e,t,r,s,!1);return null===o?null:new TextDecoder("utf-8").decode(o)}async function M(e,t,r=!0,s={}){let o=await g(e,t,r,s);return null===o?{}:JSON.parse(o)}async function y(e,t){let r=e.headers.get("Content-Length");null===r&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let s=parseInt(r??"0"),o=new Uint8Array(s),a=0,n=e.body.getReader();async function i(){let{done:e,value:r}=await n.read();if(e)return;let l=a+r.length;if(l>s){let e=new Uint8Array(s=l);e.set(o),o=e}return o.set(r,a),t({progress:(a=l)/s*100,loaded:a,total:s}),i()}return await i(),o}function w(...e){return(e=e.map((t,r)=>(r&&(t=t.replace(RegExp("^/"),"")),r!==e.length-1&&(t=t.replace(RegExp("/$"),"")),t))).join("/")}},"./src/utils/image.js":(e,t,r)=>{let s,o,a;r.r(t),r.d(t,{RawImage:()=>h,load_image:()=>f});var n=r("./src/utils/core.js"),i=r("./src/utils/hub.js"),l=r("./src/env.js"),c=r("./src/utils/tensor.js"),d=r("sharp");let u=l.apis.IS_BROWSER_ENV||l.apis.IS_WEBWORKER_ENV;if(u)s=(e,t)=>{if(!self.OffscreenCanvas)throw Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(e,t)},a=self.createImageBitmap,o=self.ImageData;else if(d.default)a=async e=>{let t=(await e.metadata()).channels,{data:r,info:s}=await e.rotate().raw().toBuffer({resolveWithObject:!0}),o=new h(new Uint8ClampedArray(r),s.width,s.height,s.channels);return void 0!==t&&t!==s.channels&&o.convert(t),o};else throw Error("Unable to load image processing library.");let m={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},p=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class h{constructor(e,t,r,s){this.data=e,this.width=t,this.height=r,this.channels=s}get size(){return[this.width,this.height]}static async read(e){if(e instanceof h)return e;if("string"==typeof e||e instanceof URL)return await this.fromURL(e);if(e instanceof Blob)return await this.fromBlob(e);if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return this.fromCanvas(e);throw Error(`Unsupported input type: ${typeof e}`)}static fromCanvas(e){if(!u)throw Error("fromCanvas() is only supported in browser environments.");return new h(e.getContext("2d").getImageData(0,0,e.width,e.height).data,e.width,e.height,4)}static async fromURL(e){let t=await (0,i.getFile)(e);if(200!==t.status)throw Error(`Unable to read image from "${e}" (${t.status} ${t.statusText})`);let r=await t.blob();return this.fromBlob(r)}static async fromBlob(e){if(u){let t=await a(e),r=s(t.width,t.height).getContext("2d");return r.drawImage(t,0,0),new this(r.getImageData(0,0,t.width,t.height).data,t.width,t.height,4)}{let t=(0,d.default)(await e.arrayBuffer());return await a(t)}}static fromTensor(e,t="CHW"){if(3!==e.dims.length)throw Error(`Tensor should have 3 dimensions, but has ${e.dims.length} dimensions.`);if("CHW"===t)e=e.transpose(1,2,0);else if("HWC"===t);else throw Error(`Unsupported channel format: ${t}`);if(!(e.data instanceof Uint8ClampedArray||e.data instanceof Uint8Array))throw Error(`Unsupported tensor type: ${e.type}`);switch(e.dims[2]){case 1:case 2:case 3:case 4:return new h(e.data,e.dims[1],e.dims[0],e.dims[2]);default:throw Error(`Unsupported number of channels: ${e.dims[2]}`)}}grayscale(){if(1===this.channels)return this;let e=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let t=0,r=0;t<this.data.length;t+=this.channels){let s=this.data[t],o=this.data[t+1],a=this.data[t+2];e[r++]=Math.round(.2989*s+.587*o+.114*a)}break;default:throw Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,1)}rgb(){if(3===this.channels)return this;let e=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let t=0,r=0;t<this.data.length;++t)e[r++]=this.data[t],e[r++]=this.data[t],e[r++]=this.data[t];break;case 4:for(let t=0,r=0;t<this.data.length;t+=4)e[r++]=this.data[t],e[r++]=this.data[t+1],e[r++]=this.data[t+2];break;default:throw Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,3)}rgba(){if(4===this.channels)return this;let e=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let t=0,r=0;t<this.data.length;++t)e[r++]=this.data[t],e[r++]=this.data[t],e[r++]=this.data[t],e[r++]=255;break;case 3:for(let t=0,r=0;t<this.data.length;t+=3)e[r++]=this.data[t],e[r++]=this.data[t+1],e[r++]=this.data[t+2],e[r++]=255;break;default:throw Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(e,this.width,this.height,4)}putAlpha(e){if(e.width!==this.width||e.height!==this.height)throw Error(`Expected mask size to be ${this.width}x${this.height}, but got ${e.width}x${e.height}`);if(1!==e.channels)throw Error(`Expected mask to have 1 channel, but got ${e.channels}`);let t=this.data,r=e.data,s=this.width*this.height;if(3===this.channels){let e=new Uint8ClampedArray(4*s);for(let o=0,a=0,n=0;o<s;++o)e[n++]=t[a++],e[n++]=t[a++],e[n++]=t[a++],e[n++]=r[o];return this._update(e,this.width,this.height,4)}if(4===this.channels){for(let e=0;e<s;++e)t[4*e+3]=r[e];return this}throw Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(e,t,{resample:r=2}={}){if(this.width===e&&this.height===t)return this;let o=m[r]??r,i=(0,n.isNullishDimension)(e),l=(0,n.isNullishDimension)(t);if(i&&l)return this;if(i?e=t/this.height*this.width:l&&(t=e/this.width*this.height),u){let r=this.channels,o=this.toCanvas(),a=s(e,t).getContext("2d");return a.drawImage(o,0,0,e,t),new h(a.getImageData(0,0,e,t).data,e,t,4).convert(r)}{let r=this.toSharp();switch(o){case"box":case"hamming":("box"===o||"hamming"===o)&&(console.warn(`Resampling method ${o} is not yet supported. Using bilinear instead.`),o="bilinear");case"nearest":case"bilinear":case"bicubic":r=r.affine([e/this.width,0,0,t/this.height],{interpolator:o});break;case"lanczos":r=r.resize({width:e,height:t,fit:"fill",kernel:"lanczos3"});break;default:throw Error(`Resampling method ${o} is not supported.`)}return await a(r)}}async pad([e,t,r,o]){if(e=Math.max(e,0),t=Math.max(t,0),r=Math.max(r,0),o=Math.max(o,0),0===e&&0===t&&0===r&&0===o)return this;if(u){let a=this.channels,n=this.toCanvas(),i=this.width+e+t,l=this.height+r+o,c=s(i,l).getContext("2d");return c.drawImage(n,0,0,this.width,this.height,e,r,this.width,this.height),new h(c.getImageData(0,0,i,l).data,i,l,4).convert(a)}{let s=this.toSharp().extend({left:e,right:t,top:r,bottom:o});return await a(s)}}async crop([e,t,r,o]){if(e=Math.max(e,0),t=Math.max(t,0),r=Math.min(r,this.width-1),o=Math.min(o,this.height-1),0===e&&0===t&&r===this.width-1&&o===this.height-1)return this;let n=r-e+1,i=o-t+1;if(u){let r=this.channels,o=this.toCanvas(),a=s(n,i).getContext("2d");return a.drawImage(o,e,t,n,i,0,0,n,i),new h(a.getImageData(0,0,n,i).data,n,i,4).convert(r)}{let r=this.toSharp().extract({left:e,top:t,width:n,height:i});return await a(r)}}async center_crop(e,t){if(this.width===e&&this.height===t)return this;let r=(this.width-e)/2,o=(this.height-t)/2;if(u){let a=this.channels,n=this.toCanvas(),i=s(e,t).getContext("2d"),l=0,c=0,d=0,u=0;return r>=0?l=r:d=-r,o>=0?c=o:u=-o,i.drawImage(n,l,c,e,t,d,u,e,t),new h(i.getImageData(0,0,e,t).data,e,t,4).convert(a)}{let s=this.toSharp();if(r>=0&&o>=0)s=s.extract({left:Math.floor(r),top:Math.floor(o),width:e,height:t});else if(r<=0&&o<=0){let a=Math.floor(-o),n=Math.floor(-r);s=s.extend({top:a,left:n,right:e-this.width-n,bottom:t-this.height-a})}else{let a=[0,0],n=0;o<0?(a[0]=Math.floor(-o),a[1]=t-this.height-a[0]):n=Math.floor(o);let i=[0,0],l=0;r<0?(i[0]=Math.floor(-r),i[1]=e-this.width-i[0]):l=Math.floor(r),s=s.extend({top:a[0],bottom:a[1],left:i[0],right:i[1]}).extract({left:l,top:n,width:e,height:t})}return await a(s)}}async toBlob(e="image/png",t=1){if(!u)throw Error("toBlob() is only supported in browser environments.");let r=this.toCanvas();return await r.convertToBlob({type:e,quality:t})}toTensor(e="CHW"){let t=new c.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if("HWC"===e);else if("CHW"===e)t=t.permute(2,0,1);else throw Error(`Unsupported channel format: ${e}`);return t}toCanvas(){if(!u)throw Error("toCanvas() is only supported in browser environments.");let e=this.clone().rgba(),t=s(e.width,e.height),r=new o(e.data,e.width,e.height);return t.getContext("2d").putImageData(r,0,0),t}split(){let{data:e,width:t,height:r,channels:s}=this,o=e.constructor,a=e.length/s,n=Array.from({length:s},()=>new o(a));for(let t=0;t<a;++t){let r=s*t;for(let o=0;o<s;++o)n[o][t]=e[r+o]}return n.map(e=>new h(e,t,r,1))}_update(e,t,r,s=null){return this.data=e,this.width=t,this.height=r,null!==s&&(this.channels=s),this}clone(){return new h(this.data.slice(),this.width,this.height,this.channels)}convert(e){if(this.channels===e)return this;switch(e){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(e){if(u){if(l.apis.IS_WEBWORKER_ENV)throw Error("Unable to save an image from a Web Worker.");let t=e.split(".").pop().toLowerCase(),r=p.get(t)??"image/png",s=await this.toBlob(r);(0,n.saveBlob)(e,s)}else if(l.apis.IS_FS_AVAILABLE){let t=this.toSharp();return await t.toFile(e)}else throw Error("Unable to save the image because filesystem is disabled in this environment.")}toSharp(){if(u)throw Error("toSharp() is only supported in server-side environments.");return(0,d.default)(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}let f=h.read.bind(h)},"./src/utils/maths.js":(e,t,r)=>{function s(e,[t,r,s],[o,a],n="bilinear",i=!1){let l=a/s,c=o/r,d=new e.constructor(o*a*t),u=r*s,m=o*a;for(let n=0;n<o;++n)for(let o=0;o<a;++o){let i=n*a+o,p=(o+.5)/l-.5,h=(n+.5)/c-.5,f=Math.floor(p),_=Math.floor(h),g=Math.min(f+1,s-1),M=Math.min(_+1,r-1),y=p-(f=Math.max(f,0)),w=h-(_=Math.max(_,0)),b=(1-y)*(1-w),v=y*(1-w),x=(1-y)*w,P=y*w,T=_*s,k=M*s,F=T+f,S=T+g,C=k+f,E=k+g;for(let r=0;r<t;++r){let t=r*u;d[r*m+i]=b*e[t+F]+v*e[t+S]+x*e[t+C]+P*e[t+E]}}return d}function o(e,t,r){let s=Array(r.length),o=Array(r.length);for(let e=r.length-1,a=1;e>=0;--e)o[e]=a,s[e]=t[r[e]],a*=s[e];let a=r.map((e,t)=>o[r.indexOf(t)]),n=new e.constructor(e.length);for(let r=0;r<e.length;++r){let s=0;for(let e=t.length-1,o=r;e>=0;--e)s+=o%t[e]*a[e],o=Math.floor(o/t[e]);n[s]=e[r]}return[n,s]}function a(e){let t=u(e)[0],r=e.map(e=>Math.exp(e-t)),s=r.reduce((e,t)=>e+t,0);return r.map(e=>e/s)}function n(e){let t=u(e)[0],r=0;for(let s=0;s<e.length;++s)r+=Math.exp(e[s]-t);let s=Math.log(r);return e.map(e=>e-t-s)}function i(e,t){let r=0;for(let s=0;s<e.length;++s)r+=e[s]*t[s];return r}function l(e,t){let r=i(e,t);return r/(c(e)*c(t))}function c(e){return Math.sqrt(e.reduce((e,t)=>e+t*t,0))}function d(e){if(0===e.length)throw Error("Array must not be empty");let t=e[0],r=0;for(let s=1;s<e.length;++s)e[s]<t&&(t=e[s],r=s);return[t,r]}function u(e){if(0===e.length)throw Error("Array must not be empty");let t=e[0],r=0;for(let s=1;s<e.length;++s)e[s]>t&&(t=e[s],r=s);return[t,r]}function m(e){return e>0&&(e&e-1)==0}r.r(t),r.d(t,{FFT:()=>f,bankers_round:()=>M,cos_sim:()=>l,dot:()=>i,dynamic_time_warping:()=>y,interpolate_data:()=>s,log_softmax:()=>n,magnitude:()=>c,max:()=>u,medianFilter:()=>_,min:()=>d,permute_data:()=>o,round:()=>g,softmax:()=>a});class p{constructor(e){if(this.size=0|e,this.size<=1||!m(this.size))throw Error("FFT size must be a power of two larger than 1");this._csize=e<<1,this.table=new Float64Array(2*this.size);for(let e=0;e<this.table.length;e+=2){let t=Math.PI*e/this.size;this.table[e]=Math.cos(t),this.table[e+1]=-Math.sin(t)}let t=0;for(let e=1;this.size>e;e<<=1)++t;this._width=t%2==0?t-1:t,this._bitrev=new Int32Array(1<<this._width);for(let e=0;e<this._bitrev.length;++e){this._bitrev[e]=0;for(let t=0;t<this._width;t+=2){let r=this._width-t-2;this._bitrev[e]|=(e>>>t&3)<<r}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(e,t){let r=t||Array(e.length>>>1);for(let t=0;t<e.length;t+=2)r[t>>>1]=e[t];return r}toComplexArray(e,t){let r=t||this.createComplexArray();for(let t=0;t<r.length;t+=2)r[t]=e[t>>>1],r[t+1]=0;return r}transform(e,t){if(e===t)throw Error("Input and output buffers must be different");this._transform4(e,t,1)}realTransform(e,t){if(e===t)throw Error("Input and output buffers must be different");this._realTransform4(e,t,1)}inverseTransform(e,t){if(e===t)throw Error("Input and output buffers must be different");this._transform4(e,t,-1);for(let t=0;t<e.length;++t)e[t]/=this.size}_transform4(e,t,r){let s,o;let a=this._csize,n=1<<this._width,i=a/n<<1,l=this._bitrev;if(4===i)for(s=0,o=0;s<a;s+=i,++o){let r=l[o];this._singleTransform2(t,e,s,r,n)}else for(s=0,o=0;s<a;s+=i,++o){let a=l[o];this._singleTransform4(t,e,s,a,n,r)}let c=this.table;for(n>>=2;n>=2;n>>=2){let t=(i=a/n<<1)>>>2;for(s=0;s<a;s+=i){let o=s+t-1;for(let a=s,i=0;a<o;a+=2,i+=n){let s=a,o=s+t,n=o+t,l=n+t,d=e[s],u=e[s+1],m=e[o],p=e[o+1],h=e[n],f=e[n+1],_=e[l],g=e[l+1],M=c[i],y=r*c[i+1],w=m*M-p*y,b=m*y+p*M,v=c[2*i],x=r*c[2*i+1],P=h*v-f*x,T=h*x+f*v,k=c[3*i],F=r*c[3*i+1],S=_*k-g*F,C=_*F+g*k,E=d+P,A=u+T,I=d-P,$=u-T,L=w+S,j=b+C,O=r*(w-S),N=r*(b-C);e[s]=E+L,e[s+1]=A+j,e[o]=I+N,e[o+1]=$-O,e[n]=E-L,e[n+1]=A-j,e[l]=I-N,e[l+1]=$+O}}}}_singleTransform2(e,t,r,s,o){let a=e[s],n=e[s+1],i=e[s+o],l=e[s+o+1];t[r]=a+i,t[r+1]=n+l,t[r+2]=a-i,t[r+3]=n-l}_singleTransform4(e,t,r,s,o,a){let n=2*o,i=3*o,l=e[s],c=e[s+1],d=e[s+o],u=e[s+o+1],m=e[s+n],p=e[s+n+1],h=e[s+i],f=e[s+i+1],_=l+m,g=c+p,M=l-m,y=c-p,w=d+h,b=u+f,v=a*(d-h),x=a*(u-f);t[r]=_+w,t[r+1]=g+b,t[r+2]=M+x,t[r+3]=y-v,t[r+4]=_-w,t[r+5]=g-b,t[r+6]=M-x,t[r+7]=y+v}_realTransform4(e,t,r){let s,o;let a=this._csize,n=1<<this._width,i=a/n<<1,l=this._bitrev;if(4===i)for(s=0,o=0;s<a;s+=i,++o){let r=l[o];this._singleRealTransform2(t,e,s,r>>>1,n>>>1)}else for(s=0,o=0;s<a;s+=i,++o){let a=l[o];this._singleRealTransform4(t,e,s,a>>>1,n>>>1,r)}let c=this.table;for(n>>=2;n>=2;n>>=2){let t=(i=a/n<<1)>>>1,o=t>>>1,l=o>>>1;for(s=0;s<a;s+=i)for(let a=0,i=0;a<=l;a+=2,i+=n){let n=s+a,d=n+o,u=d+o,m=u+o,p=e[n],h=e[n+1],f=e[d],_=e[d+1],g=e[u],M=e[u+1],y=e[m],w=e[m+1],b=c[i],v=r*c[i+1],x=f*b-_*v,P=f*v+_*b,T=c[2*i],k=r*c[2*i+1],F=g*T-M*k,S=g*k+M*T,C=c[3*i],E=r*c[3*i+1],A=y*C-w*E,I=y*E+w*C,$=p+F,L=h+S,j=p-F,O=h-S,N=x+A,D=P+I,z=r*(x-A),V=r*(P-I);if(e[n]=$+N,e[n+1]=L+D,e[d]=j+V,e[d+1]=O-z,0===a){e[u]=$-N,e[u+1]=L-D;continue}if(a===l)continue;let B=s+o-a,R=s+t-a;e[B]=j-r*V,e[B+1]=-O-r*z,e[R]=$-r*N,e[R+1]=-L+r*D}}let d=a>>>1;for(let t=2;t<d;t+=2)e[a-t]=e[t],e[a-t+1]=-e[t+1]}_singleRealTransform2(e,t,r,s,o){let a=e[s],n=e[s+o];t[r]=a+n,t[r+1]=0,t[r+2]=a-n,t[r+3]=0}_singleRealTransform4(e,t,r,s,o,a){let n=e[s],i=e[s+o],l=e[s+2*o],c=e[s+3*o],d=n+l,u=n-l,m=i+c,p=a*(i-c);t[r]=d+m,t[r+1]=0,t[r+2]=u,t[r+3]=-p,t[r+4]=d-m,t[r+5]=0,t[r+6]=u,t[r+7]=p}}class h{constructor(e){let t=2*(e-1),r=2*(2*e-1),s=2**Math.ceil(Math.log2(r));this.bufferSize=s,this._a=t;let o=new Float64Array(r),a=new Float64Array(s);this._chirpBuffer=new Float64Array(s),this._buffer1=new Float64Array(s),this._buffer2=new Float64Array(s),this._outBuffer1=new Float64Array(s),this._outBuffer2=new Float64Array(s);let n=-2*Math.PI/e,i=Math.cos(n),l=Math.sin(n);for(let t=0;t<r>>1;++t){let r=(t+1-e)**2/2,s=Math.sqrt(i**2+l**2)**r,n=r*Math.atan2(l,i),c=2*t;o[c]=s*Math.cos(n),o[c+1]=s*Math.sin(n),a[c]=o[c],a[c+1]=-o[c+1]}this._slicedChirpBuffer=o.subarray(t,r),this._f=new p(s>>1),this._f.transform(this._chirpBuffer,a)}_transform(e,t,r){let s=this._buffer1,o=this._buffer2,a=this._outBuffer1,n=this._outBuffer2,i=this._chirpBuffer,l=this._slicedChirpBuffer,c=this._a;if(r)for(let e=0;e<l.length;e+=2){let r=e+1,o=t[e>>1];s[e]=o*l[e],s[r]=o*l[r]}else for(let e=0;e<l.length;e+=2){let r=e+1;s[e]=t[e]*l[e]-t[r]*l[r],s[r]=t[e]*l[r]+t[r]*l[e]}this._f.transform(a,s);for(let e=0;e<i.length;e+=2){let t=e+1;o[e]=a[e]*i[e]-a[t]*i[t],o[t]=a[e]*i[t]+a[t]*i[e]}this._f.inverseTransform(n,o);for(let t=0;t<n.length;t+=2){let r=n[t+c],s=n[t+c+1],o=l[t],a=l[t+1];e[t]=r*o-s*a,e[t+1]=r*a+s*o}}transform(e,t){this._transform(e,t,!1)}realTransform(e,t){this._transform(e,t,!0)}}class f{constructor(e){this.fft_length=e,this.isPowerOfTwo=m(e),this.isPowerOfTwo?(this.fft=new p(e),this.outputBufferSize=2*e):(this.fft=new h(e),this.outputBufferSize=this.fft.bufferSize)}realTransform(e,t){this.fft.realTransform(e,t)}transform(e,t){this.fft.transform(e,t)}}function _(e,t){if(t%2==0||t<=0)throw Error("Window size must be a positive odd number");let r=new e.constructor(e.length),s=new e.constructor(t),o=Math.floor(t/2);for(let t=0;t<e.length;++t){let a=0;for(let r=-o;r<=o;++r){let o=t+r;o<0?o=Math.abs(o):o>=e.length&&(o=2*(e.length-1)-o),s[a++]=e[o]}s.sort(),r[t]=s[o]}return r}function g(e,t){let r=Math.pow(10,t);return Math.round(e*r)/r}function M(e){let t=Math.round(e);return Math.abs(e)%1==.5?t%2==0?t:t-1:t}function y(e){let t=e.length,r=e[0].length,s=[t+1,r+1],o=Array.from({length:s[0]},()=>Array(s[1]).fill(1/0));o[0][0]=0;let a=Array.from({length:s[0]},()=>Array(s[1]).fill(-1));for(let t=1;t<s[1];++t)for(let r=1;r<s[0];++r){let s,n;let i=o[r-1][t-1],l=o[r-1][t],c=o[r][t-1];i<l&&i<c?(s=i,n=0):l<i&&l<c?(s=l,n=1):(s=c,n=2),o[r][t]=e[r-1][t-1]+s,a[r][t]=n}for(let e=0;e<s[1];++e)a[0][e]=2;for(let e=0;e<s[0];++e)a[e][0]=1;let n=t,i=r,l=[],c=[];for(;n>0||i>0;)switch(l.push(n-1),c.push(i-1),a[n][i]){case 0:--n,--i;break;case 1:--n;break;case 2:--i;break;default:throw Error(`Internal error in dynamic time warping. Unexpected trace[${n}, ${i}]. Please file a bug report.`)}return l.reverse(),c.reverse(),[l,c]}},"./src/utils/tensor.js":(e,t,r)=>{r.r(t),r.d(t,{DataTypeMap:()=>n,Tensor:()=>i,cat:()=>b,full:()=>F,full_like:()=>S,interpolate:()=>c,interpolate_4d:()=>d,layer_norm:()=>g,matmul:()=>u,mean:()=>T,mean_pooling:()=>_,ones:()=>C,ones_like:()=>E,permute:()=>l,quantize_embeddings:()=>j,rand:()=>$,randn:()=>L,rfft:()=>m,slice:()=>f,stack:()=>v,std_mean:()=>P,topk:()=>p,zeros:()=>A,zeros_like:()=>I});var s=r("./src/utils/maths.js"),o=r("./src/backends/onnx.js"),a=r("./src/ops/registry.js");let n=Object.freeze({float32:Float32Array,float16:"undefined"!=typeof Float16Array?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class i{get dims(){return this.ort_tensor.dims}set dims(e){this.ort_tensor.dims=e}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}ort_tensor;constructor(...e){return(0,o.isONNXTensor)(e[0])?this.ort_tensor=e[0]:this.ort_tensor=new o.Tensor(e[0],e[1],e[2]),new Proxy(this,{get:(e,t)=>{if("string"==typeof t){let r=Number(t);if(Number.isInteger(r))return e._getitem(r)}return e[t]},set:(e,t,r)=>e[t]=r})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){let[e,...t]=this.dims;if(t.length>0){let r=t.reduce((e,t)=>e*t);for(let s=0;s<e;++s)yield this._subarray(s,r,t)}else yield*this.data}_getitem(e){let[t,...r]=this.dims;if(e=w(e,t),!(r.length>0))return new i(this.type,[this.data[e]],r);{let t=r.reduce((e,t)=>e*t);return this._subarray(e,t,r)}}indexOf(e){let t=this.data;for(let r=0;r<t.length;++r)if(t[r]==e)return r;return -1}_subarray(e,t,r){let s=e*t,o=(e+1)*t,a="subarray"in this.data?this.data.subarray(s,o):this.data.slice(s,o);return new i(this.type,a,r)}item(){let e=this.data;if(1!==e.length)throw Error(`a Tensor with ${e.length} elements cannot be converted to Scalar`);return e[0]}tolist(){return function(e,t){let r=e.length;if(r!==t.reduce((e,t)=>e*t))throw Error(`cannot reshape array of size ${r} into shape (${t})`);let s=e;for(let e=t.length-1;e>=0;e--)s=s.reduce((r,s)=>{let o=r[r.length-1];return o.length<t[e]?o.push(s):r.push([s]),r},[[]]);return s[0]}(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){let e=this.data;for(let t=0;t<e.length;++t)e[t]=1/(1+Math.exp(-e[t]));return this}map(e){return this.clone().map_(e)}map_(e){let t=this.data;for(let r=0;r<t.length;++r)t[r]=e(t[r],r,t);return this}mul(e){return this.clone().mul_(e)}mul_(e){let t=this.data;for(let r=0;r<t.length;++r)t[r]*=e;return this}div(e){return this.clone().div_(e)}div_(e){let t=this.data;for(let r=0;r<t.length;++r)t[r]/=e;return this}add(e){return this.clone().add_(e)}add_(e){let t=this.data;for(let r=0;r<t.length;++r)t[r]+=e;return this}sub(e){return this.clone().sub_(e)}sub_(e){let t=this.data;for(let r=0;r<t.length;++r)t[r]-=e;return this}clone(){return new i(this.type,this.data.slice(),this.dims.slice())}slice(...e){let t=[],r=[];for(let s=0;s<this.dims.length;++s){let o=e[s];if(null==o)r.push([0,this.dims[s]]),t.push(this.dims[s]);else if("number"==typeof o)o=w(o,this.dims[s],s),r.push([o,o+1]);else if(Array.isArray(o)&&2===o.length){let[e,a]=o;if((e=null===e?0:w(e,this.dims[s],s,!1))>(a=null===a?this.dims[s]:w(a,this.dims[s],s,!1)))throw Error(`Invalid slice: ${o}`);let n=[Math.max(e,0),Math.min(a,this.dims[s])];r.push(n),t.push(n[1]-n[0])}else throw Error(`Invalid slice: ${o}`)}let s=r.map(([e,t])=>t-e),o=s.reduce((e,t)=>e*t),a=this.data,n=new a.constructor(o),l=this.stride(),c=!0;for(let e=1;e<s.length;++e)if(0!==r[e][0]||r[e][1]!==this.dims[e]){c=!1;break}if(c){let e=r[0][0]*l[0],t=r[0][1]*l[0];if(ArrayBuffer.isView(a))n.set(a.subarray(e,t));else if(Array.isArray(a)){let r=a.slice(e,t);for(let e=0;e<r.length;++e)n[e]=r[e]}else throw Error("Unsupported data type for slicing")}else for(let e=0;e<o;++e){let t=0;for(let o=s.length-1,a=e;o>=0;--o){let e=s[o];t+=(a%e+r[o][0])*l[o],a=Math.floor(a/e)}n[e]=a[t]}return new i(this.type,n,t)}permute(...e){return l(this,e)}transpose(...e){return this.permute(...e)}sum(e=null,t=!1){return this.norm(1,e,t)}norm(e="fro",t=null,r=!1){if("fro"===e)e=2;else if("string"==typeof e)throw Error(`Unsupported norm: ${e}`);let s=this.data,o=(t,r)=>t+r**e;if(null===t){let t=s.reduce(o,0)**(1/e);return new i(this.type,[t],[])}let[a,n,l]=x(o,this,t,r);if(1!==e)for(let t=0;t<n.length;++t)n[t]=n[t]**(1/e);return new i(a,n,l)}normalize_(e=2,t=1){t=w(t,this.dims.length);let r=this.norm(e,t,!0),s=this.data,o=r.data;for(let e=0;e<s.length;++e){let r=0;for(let s=this.dims.length-1,o=e,a=1;s>=0;--s){let e=this.dims[s];s!==t&&(r+=o%e*a,a*=this.dims[s]),o=Math.floor(o/e)}s[e]/=o[r]}return this}normalize(e=2,t=1){return this.clone().normalize_(e,t)}stride(){return function(e){let t=Array(e.length);for(let r=e.length-1,s=1;r>=0;--r)t[r]=s,s*=e[r];return t}(this.dims)}squeeze(e=null){return new i(this.type,this.data,M(this.dims,e))}squeeze_(e=null){return this.dims=M(this.dims,e),this}unsqueeze(e=null){return new i(this.type,this.data,y(this.dims,e))}unsqueeze_(e=null){return this.dims=y(this.dims,e),this}flatten_(e=0,t=-1){t=(t+this.dims.length)%this.dims.length;let r=this.dims.slice(0,e),s=this.dims.slice(e,t+1),o=this.dims.slice(t+1);return this.dims=[...r,s.reduce((e,t)=>e*t,1),...o],this}flatten(e=0,t=-1){return this.clone().flatten_(e,t)}view(...e){let t=-1;for(let r=0;r<e.length;++r)if(-1===e[r]){if(-1!==t)throw Error("Only one dimension can be inferred");t=r}let r=this.data;if(-1!==t){let s=e.reduce((e,r,s)=>s!==t?e*r:e,1);e[t]=r.length/s}return new i(this.type,r,e)}neg_(){let e=this.data;for(let t=0;t<e.length;++t)e[t]=-e[t];return this}neg(){return this.clone().neg_()}gt(e){let t=new Uint8Array(this.data.length),r=this.data;for(let s=0;s<r.length;++s)t[s]=r[s]>e?1:0;return new i("bool",t,this.dims)}lt(e){let t=new Uint8Array(this.data.length),r=this.data;for(let s=0;s<r.length;++s)t[s]=r[s]<e?1:0;return new i("bool",t,this.dims)}clamp_(e,t){let r=this.data;for(let s=0;s<r.length;++s)r[s]=Math.min(Math.max(r[s],e),t);return this}clamp(e,t){return this.clone().clamp_(e,t)}round_(){let e=this.data;for(let t=0;t<e.length;++t)e[t]=Math.round(e[t]);return this}round(){return this.clone().round_()}mean(e=null,t=!1){return T(this,e,t)}min(e=null,t=!1){if(null===e){let e=(0,s.min)(this.data)[0];return new i(this.type,[e],[])}let[r,o,a]=x((e,t)=>Math.min(e,t),this,e,t,1/0);return new i(r,o,a)}max(e=null,t=!1){if(null===e){let e=(0,s.max)(this.data)[0];return new i(this.type,[e],[])}let[r,o,a]=x((e,t)=>Math.max(e,t),this,e,t,-1/0);return new i(r,o,a)}argmin(e=null,t=!1){if(null!==e)throw Error("`dim !== null` not yet implemented.");return new i("int64",[BigInt((0,s.min)(this.data)[1])],[])}argmax(e=null,t=!1){if(null!==e)throw Error("`dim !== null` not yet implemented.");return new i("int64",[BigInt((0,s.max)(this.data)[1])],[])}to(e){let t;if(this.type===e)return this;if(!n.hasOwnProperty(e))throw Error(`Unsupported type: ${e}`);let r=["int64","uint64"].includes(this.type),s=["int64","uint64"].includes(e);return r&&!s?t=Number:!r&&s&&(t=["float16","float32","float64"].includes(this.type)?e=>BigInt(Math.floor(e)):BigInt),new i(e,n[e].from(this.data,t),this.dims)}}function l(e,t){let[r,o]=(0,s.permute_data)(e.data,e.dims,t);return new i(e.type,r,o)}function c(e,[t,r],o="bilinear",a=!1){let n=e.dims.at(-3)??1,l=e.dims.at(-2),c=e.dims.at(-1),d=(0,s.interpolate_data)(e.data,[n,l,c],[t,r],o,a);return new i(e.type,d,[n,t,r])}async function d(e,{size:t=null,mode:r="bilinear"}={}){let s,o;if(4!==e.dims.length)throw Error("`interpolate_4d` currently only supports 4D input.");if(!t)throw Error("`interpolate_4d` requires a `size` argument.");if(2===t.length)s=[...e.dims.slice(0,2),...t];else if(3===t.length)s=[e.dims[0],...t];else if(4===t.length)s=t;else throw Error("`size` must be of length 2, 3, or 4.");if("nearest"===r)o=await a.TensorOpRegistry.nearest_interpolate_4d;else if("bilinear"===r)o=await a.TensorOpRegistry.bilinear_interpolate_4d;else if("bicubic"===r)o=await a.TensorOpRegistry.bicubic_interpolate_4d;else throw Error(`Unsupported mode: ${r}`);let n=new i("int64",new BigInt64Array(s.map(BigInt)),[s.length]);return await o({x:e,s:n})}async function u(e,t){let r=await a.TensorOpRegistry.matmul;return await r({a:e,b:t})}async function m(e,t){let r=await a.TensorOpRegistry.rfft;return await r({x:e,a:t})}async function p(e,t){let r=await a.TensorOpRegistry.top_k;return t=null==t?e.dims.at(-1):Math.min(t,e.dims.at(-1)),await r({x:e,k:new i("int64",[BigInt(t)],[1])})}let h=e=>new i("int64",e,[e.length]);async function f(e,t,r,s,o){let n=await a.TensorOpRegistry.slice;return await n({x:e,s:h(t),e:h(r),a:h(s),t:h(o??Array(s.length).fill(1))})}function _(e,t){let r=e.data,s=t.data,o=[e.dims[0],e.dims[2]],a=new r.constructor(o[0]*o[1]),[n,l,c]=e.dims,d=0;for(let e=0;e<n;++e){let t=e*c*l;for(let o=0;o<c;++o){let n=0,i=0,u=e*l,m=t+o;for(let e=0;e<l;++e){let t=Number(s[u+e]);i+=t,n+=r[m+e*c]*t}let p=n/i;a[d++]=p}}return new i(e.type,a,o)}function g(e,t,{eps:r=1e-5}={}){if(2!==e.dims.length)throw Error("`layer_norm` currently only supports 2D input.");let[s,o]=e.dims;if(1!==t.length&&t[0]!==o)throw Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");let[a,n]=P(e,1,0,!0),l=a.data,c=n.data,d=e.data,u=new d.constructor(d.length);for(let e=0;e<s;++e){let t=e*o;for(let s=0;s<o;++s){let o=t+s;u[o]=(d[o]-c[e])/(l[e]+r)}}return new i(e.type,u,e.dims)}function M(e,t){return e=e.slice(),null===t?e=e.filter(e=>1!==e):"number"==typeof t?1===e[t]&&e.splice(t,1):Array.isArray(t)&&(e=e.filter((e,r)=>1!==e||!t.includes(r))),e}function y(e,t){return t=w(t,e.length+1),(e=e.slice()).splice(t,0,1),e}function w(e,t,r=null,s=!0){if(e<-t||e>=t){if(!s)return e<-t?0:t;throw Error(`IndexError: index ${e} is out of bounds for dimension${null===r?"":" "+r} with size ${t}`)}return e<0&&(e=(e%t+t)%t),e}function b(e,t=0){t=w(t,e[0].dims.length);let r=e[0].dims.slice();r[t]=e.reduce((e,r)=>e+r.dims[t],0);let s=r.reduce((e,t)=>e*t,1),o=new e[0].data.constructor(s),a=e[0].type;if(0===t){let t=0;for(let r of e){let e=r.data;o.set(e,t),t+=e.length}}else{let s=0;for(let a=0;a<e.length;++a){let{data:n,dims:i}=e[a];for(let e=0;e<n.length;++e){let a=0;for(let o=i.length-1,n=e,l=1;o>=0;--o){let e=i[o],c=n%e;o===t&&(c+=s),a+=c*l,l*=r[o],n=Math.floor(n/e)}o[a]=n[e]}s+=i[t]}}return new i(a,o,r)}function v(e,t=0){return b(e.map(e=>e.unsqueeze(t)),t)}function x(e,t,r=null,s=!1,o=null){let a=t.data,n=t.dims;r=w(r,n.length);let i=n.slice();i[r]=1;let l=new a.constructor(a.length/n[r]);null!==o&&l.fill(o);for(let t=0;t<a.length;++t){let s=0;for(let e=n.length-1,o=t,a=1;e>=0;--e){let t=n[e];e!==r&&(s+=o%t*a,a*=i[e]),o=Math.floor(o/t)}l[s]=e(l[s],a[t],t,s)}return s||i.splice(r,1),[t.type,l,i]}function P(e,t=null,r=1,s=!1){let o=e.data,a=e.dims;if(null===t){let t=o.reduce((e,t)=>e+t,0)/o.length,s=Math.sqrt(o.reduce((e,r)=>e+(r-t)**2,0)/(o.length-r)),a=new i(e.type,[t],[]);return[new i(e.type,[s],[]),a]}let n=T(e,t=w(t,a.length),s),l=n.data,[c,d,u]=x((e,t,r,s)=>e+(t-l[s])**2,e,t,s);for(let e=0;e<d.length;++e)d[e]=Math.sqrt(d[e]/(a[t]-r));return[new i(c,d,u),n]}function T(e,t=null,r=!1){let s=e.dims,o=e.data;if(null===t){let t=o.reduce((e,t)=>e+t,0);return new i(e.type,[t/o.length],[])}let[a,n,l]=x((e,t)=>e+t,e,t=w(t,s.length),r);if(1!==s[t])for(let e=0;e<n.length;++e)n[e]/=s[t];return new i(a,n,l)}function k(e,t,r,s){return new i(r,new s(e.reduce((e,t)=>e*t,1)).fill(t),e)}function F(e,t){let r,s;if("number"==typeof t)r="float32",s=Float32Array;else if("bigint"==typeof t)r="int64",s=BigInt64Array;else if("boolean"==typeof t)r="bool",s=Uint8Array;else throw Error(`Unsupported data type: ${typeof t}`);return k(e,t,r,s)}function S(e,t){return F(e.dims,t)}function C(e){return k(e,1n,"int64",BigInt64Array)}function E(e){return C(e.dims)}function A(e){return k(e,0n,"int64",BigInt64Array)}function I(e){return A(e.dims)}function $(e){let t=e.reduce((e,t)=>e*t,1);return new i("float32",Float32Array.from({length:t},()=>Math.random()),e)}function L(e){let t=e.reduce((e,t)=>e*t,1);return new i("float32",Float32Array.from({length:t},()=>Math.sqrt(-2*Math.log(1-Math.random()))*Math.cos(2*Math.PI*(1-Math.random()))),e)}function j(e,t){if(2!==e.dims.length)throw Error("The tensor must have 2 dimensions");if(e.dims.at(-1)%8!=0)throw Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(t))throw Error("The precision must be either 'binary' or 'ubinary'");let r="binary"===t,s=r?Int8Array:Uint8Array,o=e.data,a=new s(o.length/8);for(let e=0;e<o.length;++e){let t=o[e]>0?1:0,s=Math.floor(e/8),n=e%8;a[s]|=t<<7-n,r&&0===n&&(a[s]-=128)}return new i(r?"int8":"uint8",a,[e.dims[0],e.dims[1]/8])}},"./src/utils/video.js":(e,t,r)=>{r.r(t),r.d(t,{RawVideo:()=>n,RawVideoFrame:()=>a,load_video:()=>i});var s=r("./src/utils/image.js"),o=r("./src/env.js");class a{constructor(e,t){this.image=e,this.timestamp=t}}class n{constructor(e,t){e.length>0&&e[0]instanceof s.RawImage&&(e=e.map((r,s)=>new a(r,(s+1)/(e.length+1)*t))),this.frames=e,this.duration=t}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function i(e,{num_frames:t=null,fps:r=null}={}){let i,l;if(!o.apis.IS_BROWSER_ENV)throw Error("`load_video` is currently only supported in browser environments.");if(null==t&&null==r)throw Error("Either num_frames or fps must be provided.");let c=[],d=document.createElement("video");if(d.crossOrigin="anonymous",d.muted=!0,"string"==typeof e)d.src=e;else if(e instanceof Blob)d.src=URL.createObjectURL(e);else if(e instanceof HTMLVideoElement)d.src=e.src;else throw Error("Invalid URL or video element provided.");if(await new Promise(e=>d.onloadedmetadata=e),d.seekable.start(0)===d.seekable.end(0)){let e=await fetch(d.src),t=await e.blob();d.src=URL.createObjectURL(t),await new Promise(e=>d.onloadedmetadata=e)}let u=d.duration;null!=t?(i=t,l=1===t?0:u/(t-1)):i=Math.floor(u/(l=1/r));let m=[];for(let e=0;e<i;++e)m.push(1===t?u/2:e*l);let p=document.createElement("canvas");p.width=d.videoWidth,p.height=d.videoHeight;let h=p.getContext("2d",{willReadFrequently:!0});for(let e of m){d.currentTime=e,await new Promise(e=>{d.onseeked=e}),h.drawImage(d,0,0,p.width,p.height);let t=h.getImageData(0,0,p.width,p.height),r=new a(new s.RawImage(t.data,p.width,p.height,4),e);c.push(r)}return d.remove(),new n(c,u)}}},X={};function J(e){var t=X[e];if(void 0!==t)return t.exports;var r=X[e]={exports:{}};return Q[e](r,r.exports,J),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;J.t=function(r,s){if(1&s&&(r=this(r)),8&s||"object"==typeof r&&r&&(4&s&&r.__esModule||16&s&&"function"==typeof r.then))return r;var o=Object.create(null);J.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var n=2&s&&r;"object"==typeof n&&!~e.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,J.d(o,a),o}})(),J.d=(e,t)=>{for(var r in t)J.o(t,r)&&!J.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},J.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),J.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var K={};(()=>{J.r(K),J.d(K,{ASTFeatureExtractor:()=>u.ASTFeatureExtractor,ASTForAudioClassification:()=>r.ASTForAudioClassification,ASTModel:()=>r.ASTModel,ASTPreTrainedModel:()=>r.ASTPreTrainedModel,AlbertForMaskedLM:()=>r.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>r.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>r.AlbertForSequenceClassification,AlbertModel:()=>r.AlbertModel,AlbertPreTrainedModel:()=>r.AlbertPreTrainedModel,AlbertTokenizer:()=>s.AlbertTokenizer,ArceeForCausalLM:()=>r.ArceeForCausalLM,ArceeModel:()=>r.ArceeModel,ArceePreTrainedModel:()=>r.ArceePreTrainedModel,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>o.AutoConfig,AutoFeatureExtractor:()=>m.AutoFeatureExtractor,AutoImageProcessor:()=>f.AutoImageProcessor,AutoModel:()=>r.AutoModel,AutoModelForAudioClassification:()=>r.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>r.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>r.AutoModelForAudioTextToText,AutoModelForCTC:()=>r.AutoModelForCTC,AutoModelForCausalLM:()=>r.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>r.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>r.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>r.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>r.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>r.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>r.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>r.AutoModelForImageTextToText,AutoModelForImageToImage:()=>r.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>r.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>r.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>r.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>r.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>r.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>r.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>r.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>r.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>r.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>r.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>r.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>r.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>r.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>r.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>r.AutoModelForVision2Seq,AutoModelForXVector:()=>r.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>r.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>M.AutoProcessor,AutoTokenizer:()=>s.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>r.BartForConditionalGeneration,BartForSequenceClassification:()=>r.BartForSequenceClassification,BartModel:()=>r.BartModel,BartPretrainedModel:()=>r.BartPretrainedModel,BartTokenizer:()=>s.BartTokenizer,BaseModelOutput:()=>r.BaseModelOutput,BaseStreamer:()=>y.BaseStreamer,BeitFeatureExtractor:()=>h.BeitFeatureExtractor,BeitForImageClassification:()=>r.BeitForImageClassification,BeitModel:()=>r.BeitModel,BeitPreTrainedModel:()=>r.BeitPreTrainedModel,BertForMaskedLM:()=>r.BertForMaskedLM,BertForQuestionAnswering:()=>r.BertForQuestionAnswering,BertForSequenceClassification:()=>r.BertForSequenceClassification,BertForTokenClassification:()=>r.BertForTokenClassification,BertModel:()=>r.BertModel,BertPreTrainedModel:()=>r.BertPreTrainedModel,BertTokenizer:()=>s.BertTokenizer,BitImageProcessor:()=>h.BitImageProcessor,BlenderbotForConditionalGeneration:()=>r.BlenderbotForConditionalGeneration,BlenderbotModel:()=>r.BlenderbotModel,BlenderbotPreTrainedModel:()=>r.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>r.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>r.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>r.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>s.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>s.BlenderbotTokenizer,BloomForCausalLM:()=>r.BloomForCausalLM,BloomModel:()=>r.BloomModel,BloomPreTrainedModel:()=>r.BloomPreTrainedModel,BloomTokenizer:()=>s.BloomTokenizer,CLIPFeatureExtractor:()=>h.CLIPFeatureExtractor,CLIPImageProcessor:()=>h.CLIPImageProcessor,CLIPModel:()=>r.CLIPModel,CLIPPreTrainedModel:()=>r.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>r.CLIPSegForImageSegmentation,CLIPSegModel:()=>r.CLIPSegModel,CLIPSegPreTrainedModel:()=>r.CLIPSegPreTrainedModel,CLIPTextModel:()=>r.CLIPTextModel,CLIPTextModelWithProjection:()=>r.CLIPTextModelWithProjection,CLIPTokenizer:()=>s.CLIPTokenizer,CLIPVisionModel:()=>r.CLIPVisionModel,CLIPVisionModelWithProjection:()=>r.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>r.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>r.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>r.CamembertForSequenceClassification,CamembertForTokenClassification:()=>r.CamembertForTokenClassification,CamembertModel:()=>r.CamembertModel,CamembertPreTrainedModel:()=>r.CamembertPreTrainedModel,CamembertTokenizer:()=>s.CamembertTokenizer,CausalLMOutput:()=>r.CausalLMOutput,CausalLMOutputWithPast:()=>r.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>h.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>r.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>r.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>r.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>u.ClapFeatureExtractor,ClapModel:()=>r.ClapModel,ClapPreTrainedModel:()=>r.ClapPreTrainedModel,ClapTextModelWithProjection:()=>r.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>b.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>r.CodeGenForCausalLM,CodeGenModel:()=>r.CodeGenModel,CodeGenPreTrainedModel:()=>r.CodeGenPreTrainedModel,CodeGenTokenizer:()=>s.CodeGenTokenizer,CodeLlamaTokenizer:()=>s.CodeLlamaTokenizer,CohereForCausalLM:()=>r.CohereForCausalLM,CohereModel:()=>r.CohereModel,CoherePreTrainedModel:()=>r.CoherePreTrainedModel,CohereTokenizer:()=>s.CohereTokenizer,ConvBertForMaskedLM:()=>r.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>r.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>r.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>r.ConvBertForTokenClassification,ConvBertModel:()=>r.ConvBertModel,ConvBertPreTrainedModel:()=>r.ConvBertPreTrainedModel,ConvBertTokenizer:()=>s.ConvBertTokenizer,ConvNextFeatureExtractor:()=>h.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>r.ConvNextForImageClassification,ConvNextImageProcessor:()=>h.ConvNextImageProcessor,ConvNextModel:()=>r.ConvNextModel,ConvNextPreTrainedModel:()=>r.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>r.ConvNextV2ForImageClassification,ConvNextV2Model:()=>r.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>r.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>r.DFineForObjectDetection,DFineModel:()=>r.DFineModel,DFinePreTrainedModel:()=>r.DFinePreTrainedModel,DINOv3ConvNextModel:()=>r.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>r.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>h.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>r.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>r.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>h.DPTFeatureExtractor,DPTForDepthEstimation:()=>r.DPTForDepthEstimation,DPTImageProcessor:()=>h.DPTImageProcessor,DPTModel:()=>r.DPTModel,DPTPreTrainedModel:()=>r.DPTPreTrainedModel,DacDecoderModel:()=>r.DacDecoderModel,DacDecoderOutput:()=>r.DacDecoderOutput,DacEncoderModel:()=>r.DacEncoderModel,DacEncoderOutput:()=>r.DacEncoderOutput,DacFeatureExtractor:()=>u.DacFeatureExtractor,DacModel:()=>r.DacModel,DacPreTrainedModel:()=>r.DacPreTrainedModel,DataTypeMap:()=>l.DataTypeMap,DebertaForMaskedLM:()=>r.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>r.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>r.DebertaForSequenceClassification,DebertaForTokenClassification:()=>r.DebertaForTokenClassification,DebertaModel:()=>r.DebertaModel,DebertaPreTrainedModel:()=>r.DebertaPreTrainedModel,DebertaTokenizer:()=>s.DebertaTokenizer,DebertaV2ForMaskedLM:()=>r.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>r.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>r.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>r.DebertaV2ForTokenClassification,DebertaV2Model:()=>r.DebertaV2Model,DebertaV2PreTrainedModel:()=>r.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>s.DebertaV2Tokenizer,DecisionTransformerModel:()=>r.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>r.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>h.DeiTFeatureExtractor,DeiTForImageClassification:()=>r.DeiTForImageClassification,DeiTImageProcessor:()=>h.DeiTImageProcessor,DeiTModel:()=>r.DeiTModel,DeiTPreTrainedModel:()=>r.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>r.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>r.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>r.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>r.DepthProPreTrainedModel,DetrFeatureExtractor:()=>h.DetrFeatureExtractor,DetrForObjectDetection:()=>r.DetrForObjectDetection,DetrForSegmentation:()=>r.DetrForSegmentation,DetrImageProcessor:()=>h.DetrImageProcessor,DetrModel:()=>r.DetrModel,DetrObjectDetectionOutput:()=>r.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>r.DetrPreTrainedModel,DetrSegmentationOutput:()=>r.DetrSegmentationOutput,Dinov2ForImageClassification:()=>r.Dinov2ForImageClassification,Dinov2Model:()=>r.Dinov2Model,Dinov2PreTrainedModel:()=>r.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>r.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>r.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>r.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>r.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>r.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>r.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>r.DistilBertForTokenClassification,DistilBertModel:()=>r.DistilBertModel,DistilBertPreTrainedModel:()=>r.DistilBertPreTrainedModel,DistilBertTokenizer:()=>s.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>h.DonutFeatureExtractor,DonutImageProcessor:()=>h.DonutImageProcessor,DonutSwinModel:()=>r.DonutSwinModel,DonutSwinPreTrainedModel:()=>r.DonutSwinPreTrainedModel,EdgeTamModel:()=>r.EdgeTamModel,EfficientNetForImageClassification:()=>r.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>h.EfficientNetImageProcessor,EfficientNetModel:()=>r.EfficientNetModel,EfficientNetPreTrainedModel:()=>r.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>r.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>r.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>r.ElectraForSequenceClassification,ElectraForTokenClassification:()=>r.ElectraForTokenClassification,ElectraModel:()=>r.ElectraModel,ElectraPreTrainedModel:()=>r.ElectraPreTrainedModel,ElectraTokenizer:()=>s.ElectraTokenizer,EncodecFeatureExtractor:()=>u.EncodecFeatureExtractor,EosTokenCriteria:()=>w.EosTokenCriteria,Ernie4_5ForCausalLM:()=>r.Ernie4_5ForCausalLM,Ernie4_5Model:()=>r.Ernie4_5Model,Ernie4_5PreTrainedModel:()=>r.Ernie4_5PreTrainedModel,EsmForMaskedLM:()=>r.EsmForMaskedLM,EsmForSequenceClassification:()=>r.EsmForSequenceClassification,EsmForTokenClassification:()=>r.EsmForTokenClassification,EsmModel:()=>r.EsmModel,EsmPreTrainedModel:()=>r.EsmPreTrainedModel,EsmTokenizer:()=>s.EsmTokenizer,ExaoneForCausalLM:()=>r.ExaoneForCausalLM,ExaoneModel:()=>r.ExaoneModel,ExaonePreTrainedModel:()=>r.ExaonePreTrainedModel,FFT:()=>c.FFT,FalconForCausalLM:()=>r.FalconForCausalLM,FalconModel:()=>r.FalconModel,FalconPreTrainedModel:()=>r.FalconPreTrainedModel,FalconTokenizer:()=>s.FalconTokenizer,FastViTForImageClassification:()=>r.FastViTForImageClassification,FastViTModel:()=>r.FastViTModel,FastViTPreTrainedModel:()=>r.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>d.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>r.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>r.Florence2PreTrainedModel,Florence2Processor:()=>g.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>b.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>b.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>h.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>r.GLPNForDepthEstimation,GLPNModel:()=>r.GLPNModel,GLPNPreTrainedModel:()=>r.GLPNPreTrainedModel,GPT2LMHeadModel:()=>r.GPT2LMHeadModel,GPT2Model:()=>r.GPT2Model,GPT2PreTrainedModel:()=>r.GPT2PreTrainedModel,GPT2Tokenizer:()=>s.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>r.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>r.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>r.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>r.GPTJForCausalLM,GPTJModel:()=>r.GPTJModel,GPTJPreTrainedModel:()=>r.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>r.GPTNeoForCausalLM,GPTNeoModel:()=>r.GPTNeoModel,GPTNeoPreTrainedModel:()=>r.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>r.GPTNeoXForCausalLM,GPTNeoXModel:()=>r.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>r.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>s.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>r.Gemma2ForCausalLM,Gemma2Model:()=>r.Gemma2Model,Gemma2PreTrainedModel:()=>r.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>r.Gemma3ForCausalLM,Gemma3Model:()=>r.Gemma3Model,Gemma3PreTrainedModel:()=>r.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>u.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>r.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>r.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>g.Gemma3nProcessor,GemmaForCausalLM:()=>r.GemmaForCausalLM,GemmaModel:()=>r.GemmaModel,GemmaPreTrainedModel:()=>r.GemmaPreTrainedModel,GemmaTokenizer:()=>s.GemmaTokenizer,GlmForCausalLM:()=>r.GlmForCausalLM,GlmModel:()=>r.GlmModel,GlmPreTrainedModel:()=>r.GlmPreTrainedModel,GraniteForCausalLM:()=>r.GraniteForCausalLM,GraniteModel:()=>r.GraniteModel,GraniteMoeHybridForCausalLM:()=>r.GraniteMoeHybridForCausalLM,GraniteMoeHybridModel:()=>r.GraniteMoeHybridModel,GraniteMoeHybridPreTrainedModel:()=>r.GraniteMoeHybridPreTrainedModel,GranitePreTrainedModel:()=>r.GranitePreTrainedModel,Grok1Tokenizer:()=>s.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>r.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>h.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>r.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>g.GroundingDinoProcessor,GroupViTModel:()=>r.GroupViTModel,GroupViTPreTrainedModel:()=>r.GroupViTPreTrainedModel,HeliumForCausalLM:()=>r.HeliumForCausalLM,HeliumModel:()=>r.HeliumModel,HeliumPreTrainedModel:()=>r.HeliumPreTrainedModel,HerbertTokenizer:()=>s.HerbertTokenizer,HieraForImageClassification:()=>r.HieraForImageClassification,HieraModel:()=>r.HieraModel,HieraPreTrainedModel:()=>r.HieraPreTrainedModel,HubertForCTC:()=>r.HubertForCTC,HubertForSequenceClassification:()=>r.HubertForSequenceClassification,HubertModel:()=>r.HubertModel,HubertPreTrainedModel:()=>r.HubertPreTrainedModel,IJepaForImageClassification:()=>r.IJepaForImageClassification,IJepaModel:()=>r.IJepaModel,IJepaPreTrainedModel:()=>r.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>r.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>h.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>r.Idefics3PreTrainedModel,Idefics3Processor:()=>g.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>u.ImageFeatureExtractor,ImageMattingOutput:()=>r.ImageMattingOutput,ImageProcessor:()=>p.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>w.InterruptableStoppingCriteria,JAISLMHeadModel:()=>r.JAISLMHeadModel,JAISModel:()=>r.JAISModel,JAISPreTrainedModel:()=>r.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>h.JinaCLIPImageProcessor,JinaCLIPModel:()=>r.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>r.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>g.JinaCLIPProcessor,JinaCLIPTextModel:()=>r.JinaCLIPTextModel,JinaCLIPVisionModel:()=>r.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>r.Lfm2ForCausalLM,Lfm2Model:()=>r.Lfm2Model,Lfm2PreTrainedModel:()=>r.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>r.LiteWhisperForConditionalGeneration,Llama4ForCausalLM:()=>r.Llama4ForCausalLM,Llama4PreTrainedModel:()=>r.Llama4PreTrainedModel,LlamaForCausalLM:()=>r.LlamaForCausalLM,LlamaModel:()=>r.LlamaModel,LlamaPreTrainedModel:()=>r.LlamaPreTrainedModel,LlamaTokenizer:()=>s.LlamaTokenizer,LlavaForConditionalGeneration:()=>r.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>r.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>h.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>r.LlavaPreTrainedModel,LlavaProcessor:()=>g.LlavaProcessor,LlavaQwen2ForCausalLM:()=>r.LlavaQwen2ForCausalLM,LogitsProcessor:()=>b.LogitsProcessor,LogitsProcessorList:()=>b.LogitsProcessorList,LogitsWarper:()=>b.LogitsWarper,LongT5ForConditionalGeneration:()=>r.LongT5ForConditionalGeneration,LongT5Model:()=>r.LongT5Model,LongT5PreTrainedModel:()=>r.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>r.M2M100ForConditionalGeneration,M2M100Model:()=>r.M2M100Model,M2M100PreTrainedModel:()=>r.M2M100PreTrainedModel,M2M100Tokenizer:()=>s.M2M100Tokenizer,MBart50Tokenizer:()=>s.MBart50Tokenizer,MBartForCausalLM:()=>r.MBartForCausalLM,MBartForConditionalGeneration:()=>r.MBartForConditionalGeneration,MBartForSequenceClassification:()=>r.MBartForSequenceClassification,MBartModel:()=>r.MBartModel,MBartPreTrainedModel:()=>r.MBartPreTrainedModel,MBartTokenizer:()=>s.MBartTokenizer,MPNetForMaskedLM:()=>r.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>r.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>r.MPNetForSequenceClassification,MPNetForTokenClassification:()=>r.MPNetForTokenClassification,MPNetModel:()=>r.MPNetModel,MPNetPreTrainedModel:()=>r.MPNetPreTrainedModel,MPNetTokenizer:()=>s.MPNetTokenizer,MT5ForConditionalGeneration:()=>r.MT5ForConditionalGeneration,MT5Model:()=>r.MT5Model,MT5PreTrainedModel:()=>r.MT5PreTrainedModel,MarianMTModel:()=>r.MarianMTModel,MarianModel:()=>r.MarianModel,MarianPreTrainedModel:()=>r.MarianPreTrainedModel,MarianTokenizer:()=>s.MarianTokenizer,Mask2FormerImageProcessor:()=>h.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>h.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>r.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>h.MaskFormerImageProcessor,MaskFormerModel:()=>r.MaskFormerModel,MaskFormerPreTrainedModel:()=>r.MaskFormerPreTrainedModel,MaskedLMOutput:()=>r.MaskedLMOutput,MaxLengthCriteria:()=>w.MaxLengthCriteria,Metric3DForDepthEstimation:()=>r.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>r.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>r.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>r.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>r.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>r.MgpstrModelOutput,MgpstrPreTrainedModel:()=>r.MgpstrPreTrainedModel,MgpstrProcessor:()=>g.MgpstrProcessor,MgpstrTokenizer:()=>s.MgpstrTokenizer,MimiDecoderModel:()=>r.MimiDecoderModel,MimiDecoderOutput:()=>r.MimiDecoderOutput,MimiEncoderModel:()=>r.MimiEncoderModel,MimiEncoderOutput:()=>r.MimiEncoderOutput,MimiModel:()=>r.MimiModel,MimiPreTrainedModel:()=>r.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>b.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>b.MinNewTokensLengthLogitsProcessor,Ministral3ForCausalLM:()=>r.Ministral3ForCausalLM,Ministral3Model:()=>r.Ministral3Model,Ministral3PreTrainedModel:()=>r.Ministral3PreTrainedModel,MinistralForCausalLM:()=>r.MinistralForCausalLM,MinistralModel:()=>r.MinistralModel,MinistralPreTrainedModel:()=>r.MinistralPreTrainedModel,Mistral3ForConditionalGeneration:()=>r.Mistral3ForConditionalGeneration,MistralForCausalLM:()=>r.MistralForCausalLM,MistralModel:()=>r.MistralModel,MistralPreTrainedModel:()=>r.MistralPreTrainedModel,MobileBertForMaskedLM:()=>r.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>r.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>r.MobileBertForSequenceClassification,MobileBertModel:()=>r.MobileBertModel,MobileBertPreTrainedModel:()=>r.MobileBertPreTrainedModel,MobileBertTokenizer:()=>s.MobileBertTokenizer,MobileLLMForCausalLM:()=>r.MobileLLMForCausalLM,MobileLLMModel:()=>r.MobileLLMModel,MobileLLMPreTrainedModel:()=>r.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>h.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>r.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>r.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>h.MobileNetV1ImageProcessor,MobileNetV1Model:()=>r.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>r.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>h.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>r.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>r.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>h.MobileNetV2ImageProcessor,MobileNetV2Model:()=>r.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>r.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>h.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>r.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>r.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>h.MobileNetV3ImageProcessor,MobileNetV3Model:()=>r.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>r.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>h.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>r.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>r.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>h.MobileNetV4ImageProcessor,MobileNetV4Model:()=>r.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>r.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>h.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>r.MobileViTForImageClassification,MobileViTImageProcessor:()=>h.MobileViTImageProcessor,MobileViTModel:()=>r.MobileViTModel,MobileViTPreTrainedModel:()=>r.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>r.MobileViTV2ForImageClassification,MobileViTV2Model:()=>r.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>r.MobileViTV2PreTrainedModel,ModelOutput:()=>r.ModelOutput,ModernBertDecoderForCausalLM:()=>r.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>r.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>r.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>r.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>r.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>r.ModernBertForTokenClassification,ModernBertModel:()=>r.ModernBertModel,ModernBertPreTrainedModel:()=>r.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>r.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>u.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>r.MoonshineForConditionalGeneration,MoonshineModel:()=>r.MoonshineModel,MoonshinePreTrainedModel:()=>r.MoonshinePreTrainedModel,MoonshineProcessor:()=>g.MoonshineProcessor,MptForCausalLM:()=>r.MptForCausalLM,MptModel:()=>r.MptModel,MptPreTrainedModel:()=>r.MptPreTrainedModel,MultiModalityCausalLM:()=>r.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>r.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>r.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>r.MusicgenForConditionalGeneration,MusicgenModel:()=>r.MusicgenModel,MusicgenPreTrainedModel:()=>r.MusicgenPreTrainedModel,NanoChatForCausalLM:()=>r.NanoChatForCausalLM,NanoChatModel:()=>r.NanoChatModel,NanoChatPreTrainedModel:()=>r.NanoChatPreTrainedModel,NeoBertForMaskedLM:()=>r.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>r.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>r.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>r.NeoBertForTokenClassification,NeoBertModel:()=>r.NeoBertModel,NeoBertPreTrainedModel:()=>r.NeoBertPreTrainedModel,NllbTokenizer:()=>s.NllbTokenizer,NoBadWordsLogitsProcessor:()=>b.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>b.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>r.NomicBertModel,NomicBertPreTrainedModel:()=>r.NomicBertPreTrainedModel,NougatImageProcessor:()=>h.NougatImageProcessor,NougatTokenizer:()=>s.NougatTokenizer,OPTForCausalLM:()=>r.OPTForCausalLM,OPTModel:()=>r.OPTModel,OPTPreTrainedModel:()=>r.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>r.Olmo2ForCausalLM,Olmo2Model:()=>r.Olmo2Model,Olmo2PreTrainedModel:()=>r.Olmo2PreTrainedModel,OlmoForCausalLM:()=>r.OlmoForCausalLM,OlmoModel:()=>r.OlmoModel,OlmoPreTrainedModel:()=>r.OlmoPreTrainedModel,OpenELMForCausalLM:()=>r.OpenELMForCausalLM,OpenELMModel:()=>r.OpenELMModel,OpenELMPreTrainedModel:()=>r.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>h.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>r.OwlViTForObjectDetection,OwlViTImageProcessor:()=>h.OwlViTImageProcessor,OwlViTModel:()=>r.OwlViTModel,OwlViTPreTrainedModel:()=>r.OwlViTPreTrainedModel,OwlViTProcessor:()=>g.OwlViTProcessor,Owlv2ForObjectDetection:()=>r.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>h.Owlv2ImageProcessor,Owlv2Model:()=>r.Owlv2Model,Owlv2PreTrainedModel:()=>r.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>r.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>r.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>g.PaliGemmaProcessor,ParakeetFeatureExtractor:()=>u.ParakeetFeatureExtractor,ParakeetForCTC:()=>r.ParakeetForCTC,ParakeetPreTrainedModel:()=>r.ParakeetPreTrainedModel,PatchTSMixerForPrediction:()=>r.PatchTSMixerForPrediction,PatchTSMixerModel:()=>r.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>r.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>r.PatchTSTForPrediction,PatchTSTModel:()=>r.PatchTSTModel,PatchTSTPreTrainedModel:()=>r.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>r.Phi3ForCausalLM,Phi3Model:()=>r.Phi3Model,Phi3PreTrainedModel:()=>r.Phi3PreTrainedModel,Phi3VForCausalLM:()=>r.Phi3VForCausalLM,Phi3VImageProcessor:()=>h.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>r.Phi3VPreTrainedModel,Phi3VProcessor:()=>g.Phi3VProcessor,PhiForCausalLM:()=>r.PhiForCausalLM,PhiModel:()=>r.PhiModel,PhiPreTrainedModel:()=>r.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PixtralImageProcessor:()=>h.PixtralImageProcessor,PixtralProcessor:()=>g.PixtralProcessor,PreTrainedModel:()=>r.PreTrainedModel,PreTrainedTokenizer:()=>s.PreTrainedTokenizer,PretrainedConfig:()=>o.PretrainedConfig,PretrainedMixin:()=>r.PretrainedMixin,Processor:()=>_.Processor,PvtForImageClassification:()=>r.PvtForImageClassification,PvtImageProcessor:()=>h.PvtImageProcessor,PvtModel:()=>r.PvtModel,PvtPreTrainedModel:()=>r.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>u.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>r.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>r.PyAnnoteModel,PyAnnotePreTrainedModel:()=>r.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>g.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>r.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>r.Qwen2ForCausalLM,Qwen2Model:()=>r.Qwen2Model,Qwen2PreTrainedModel:()=>r.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>s.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>r.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>h.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>r.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>g.Qwen2VLProcessor,Qwen3ForCausalLM:()=>r.Qwen3ForCausalLM,Qwen3Model:()=>r.Qwen3Model,Qwen3PreTrainedModel:()=>r.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>r.RFDetrForObjectDetection,RFDetrModel:()=>r.RFDetrModel,RFDetrObjectDetectionOutput:()=>r.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>r.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>r.RTDetrForObjectDetection,RTDetrImageProcessor:()=>h.RTDetrImageProcessor,RTDetrModel:()=>r.RTDetrModel,RTDetrObjectDetectionOutput:()=>r.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>r.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>r.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>r.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>r.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>r.RTDetrV2PreTrainedModel,RawAudio:()=>a.RawAudio,RawImage:()=>n.RawImage,RawVideo:()=>i.RawVideo,RawVideoFrame:()=>i.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>b.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>r.ResNetForImageClassification,ResNetModel:()=>r.ResNetModel,ResNetPreTrainedModel:()=>r.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>r.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>r.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>r.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>r.RoFormerForTokenClassification,RoFormerModel:()=>r.RoFormerModel,RoFormerPreTrainedModel:()=>r.RoFormerPreTrainedModel,RoFormerTokenizer:()=>s.RoFormerTokenizer,RobertaForMaskedLM:()=>r.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>r.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>r.RobertaForSequenceClassification,RobertaForTokenClassification:()=>r.RobertaForTokenClassification,RobertaModel:()=>r.RobertaModel,RobertaPreTrainedModel:()=>r.RobertaPreTrainedModel,RobertaTokenizer:()=>s.RobertaTokenizer,Sam2ImageProcessor:()=>h.Sam2ImageProcessor,Sam2ImageSegmentationOutput:()=>r.Sam2ImageSegmentationOutput,Sam2Model:()=>r.Sam2Model,Sam2PreTrainedModel:()=>r.Sam2PreTrainedModel,Sam2Processor:()=>g.Sam2Processor,Sam2VideoProcessor:()=>g.Sam2VideoProcessor,Sam3ImageProcessor:()=>h.Sam3ImageProcessor,Sam3TrackerModel:()=>r.Sam3TrackerModel,SamImageProcessor:()=>h.SamImageProcessor,SamImageSegmentationOutput:()=>r.SamImageSegmentationOutput,SamModel:()=>r.SamModel,SamPreTrainedModel:()=>r.SamPreTrainedModel,SamProcessor:()=>g.SamProcessor,SapiensForDepthEstimation:()=>r.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>r.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>r.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>r.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>u.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>h.SegformerFeatureExtractor,SegformerForImageClassification:()=>r.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>r.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>h.SegformerImageProcessor,SegformerModel:()=>r.SegformerModel,SegformerPreTrainedModel:()=>r.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>r.Seq2SeqLMOutput,SequenceClassifierOutput:()=>r.SequenceClassifierOutput,SiglipImageProcessor:()=>h.SiglipImageProcessor,SiglipModel:()=>r.SiglipModel,SiglipPreTrainedModel:()=>r.SiglipPreTrainedModel,SiglipTextModel:()=>r.SiglipTextModel,SiglipTokenizer:()=>s.SiglipTokenizer,SiglipVisionModel:()=>r.SiglipVisionModel,SmolLM3ForCausalLM:()=>r.SmolLM3ForCausalLM,SmolLM3Model:()=>r.SmolLM3Model,SmolLM3PreTrainedModel:()=>r.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>r.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>h.SmolVLMImageProcessor,SmolVLMProcessor:()=>g.SmolVLMProcessor,SnacDecoderModel:()=>r.SnacDecoderModel,SnacEncoderModel:()=>r.SnacEncoderModel,SnacFeatureExtractor:()=>u.SnacFeatureExtractor,SnacModel:()=>r.SnacModel,SnacPreTrainedModel:()=>r.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>u.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>r.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>r.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>r.SpeechT5HifiGan,SpeechT5Model:()=>r.SpeechT5Model,SpeechT5PreTrainedModel:()=>r.SpeechT5PreTrainedModel,SpeechT5Processor:()=>g.SpeechT5Processor,SpeechT5Tokenizer:()=>s.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>r.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>r.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>r.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>r.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>r.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>s.SqueezeBertTokenizer,StableLmForCausalLM:()=>r.StableLmForCausalLM,StableLmModel:()=>r.StableLmModel,StableLmPreTrainedModel:()=>r.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>r.Starcoder2ForCausalLM,Starcoder2Model:()=>r.Starcoder2Model,Starcoder2PreTrainedModel:()=>r.Starcoder2PreTrainedModel,StoppingCriteria:()=>w.StoppingCriteria,StoppingCriteriaList:()=>w.StoppingCriteriaList,StyleTextToSpeech2Model:()=>r.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>r.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SupertonicForConditionalGeneration:()=>r.SupertonicForConditionalGeneration,SupertonicPreTrainedModel:()=>r.SupertonicPreTrainedModel,SuppressTokensAtBeginLogitsProcessor:()=>b.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>r.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>h.Swin2SRImageProcessor,Swin2SRModel:()=>r.Swin2SRModel,Swin2SRPreTrainedModel:()=>r.Swin2SRPreTrainedModel,SwinForImageClassification:()=>r.SwinForImageClassification,SwinForSemanticSegmentation:()=>r.SwinForSemanticSegmentation,SwinModel:()=>r.SwinModel,SwinPreTrainedModel:()=>r.SwinPreTrainedModel,T5ForConditionalGeneration:()=>r.T5ForConditionalGeneration,T5Model:()=>r.T5Model,T5PreTrainedModel:()=>r.T5PreTrainedModel,T5Tokenizer:()=>s.T5Tokenizer,TableTransformerForObjectDetection:()=>r.TableTransformerForObjectDetection,TableTransformerModel:()=>r.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>r.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>r.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>b.TemperatureLogitsWarper,Tensor:()=>l.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>y.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>r.TokenClassifierOutput,TokenizerModel:()=>s.TokenizerModel,TopKLogitsWarper:()=>b.TopKLogitsWarper,TopPLogitsWarper:()=>b.TopPLogitsWarper,TrOCRForCausalLM:()=>r.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>r.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>r.UltravoxModel,UltravoxPreTrainedModel:()=>r.UltravoxPreTrainedModel,UltravoxProcessor:()=>g.UltravoxProcessor,UniSpeechForCTC:()=>r.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>r.UniSpeechForSequenceClassification,UniSpeechModel:()=>r.UniSpeechModel,UniSpeechPreTrainedModel:()=>r.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>r.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>r.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>r.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>r.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>r.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>g.VLChatProcessor,VLMImageProcessor:()=>h.VLMImageProcessor,VaultGemmaForCausalLM:()=>r.VaultGemmaForCausalLM,VaultGemmaModel:()=>r.VaultGemmaModel,VaultGemmaPreTrainedModel:()=>r.VaultGemmaPreTrainedModel,ViTFeatureExtractor:()=>h.ViTFeatureExtractor,ViTForImageClassification:()=>r.ViTForImageClassification,ViTImageProcessor:()=>h.ViTImageProcessor,ViTMAEModel:()=>r.ViTMAEModel,ViTMAEPreTrainedModel:()=>r.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>r.ViTMSNForImageClassification,ViTMSNModel:()=>r.ViTMSNModel,ViTMSNPreTrainedModel:()=>r.ViTMSNPreTrainedModel,ViTModel:()=>r.ViTModel,ViTPreTrainedModel:()=>r.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>r.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>r.VitMatteForImageMatting,VitMatteImageProcessor:()=>h.VitMatteImageProcessor,VitMattePreTrainedModel:()=>r.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>r.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>h.VitPoseImageProcessor,VitPosePreTrainedModel:()=>r.VitPosePreTrainedModel,VitsModel:()=>r.VitsModel,VitsModelOutput:()=>r.VitsModelOutput,VitsPreTrainedModel:()=>r.VitsPreTrainedModel,VitsTokenizer:()=>s.VitsTokenizer,VoxtralForConditionalGeneration:()=>r.VoxtralForConditionalGeneration,VoxtralProcessor:()=>g.VoxtralProcessor,Wav2Vec2BertForCTC:()=>r.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>r.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>r.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>r.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>s.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>u.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>r.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>r.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>r.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>r.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>r.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>g.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>g.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>r.WavLMForAudioFrameClassification,WavLMForCTC:()=>r.WavLMForCTC,WavLMForSequenceClassification:()=>r.WavLMForSequenceClassification,WavLMForXVector:()=>r.WavLMForXVector,WavLMModel:()=>r.WavLMModel,WavLMPreTrainedModel:()=>r.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>u.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>r.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>r.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>u.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>r.WhisperForConditionalGeneration,WhisperModel:()=>r.WhisperModel,WhisperPreTrainedModel:()=>r.WhisperPreTrainedModel,WhisperProcessor:()=>g.WhisperProcessor,WhisperTextStreamer:()=>y.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>b.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>s.WhisperTokenizer,XLMForQuestionAnswering:()=>r.XLMForQuestionAnswering,XLMForSequenceClassification:()=>r.XLMForSequenceClassification,XLMForTokenClassification:()=>r.XLMForTokenClassification,XLMModel:()=>r.XLMModel,XLMPreTrainedModel:()=>r.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>r.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>r.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>r.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>r.XLMRobertaForTokenClassification,XLMRobertaModel:()=>r.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>r.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>s.XLMRobertaTokenizer,XLMTokenizer:()=>s.XLMTokenizer,XLMWithLMHeadModel:()=>r.XLMWithLMHeadModel,XVectorOutput:()=>r.XVectorOutput,YolosFeatureExtractor:()=>h.YolosFeatureExtractor,YolosForObjectDetection:()=>r.YolosForObjectDetection,YolosImageProcessor:()=>h.YolosImageProcessor,YolosModel:()=>r.YolosModel,YolosObjectDetectionOutput:()=>r.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>r.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>c.bankers_round,cat:()=>l.cat,cos_sim:()=>c.cos_sim,dot:()=>c.dot,dynamic_time_warping:()=>c.dynamic_time_warping,env:()=>e.env,full:()=>l.full,full_like:()=>l.full_like,getCacheShapes:()=>o.getCacheShapes,hamming:()=>a.hamming,hanning:()=>a.hanning,interpolate:()=>l.interpolate,interpolate_4d:()=>l.interpolate_4d,interpolate_data:()=>c.interpolate_data,is_chinese_char:()=>s.is_chinese_char,layer_norm:()=>l.layer_norm,load_image:()=>n.load_image,load_video:()=>i.load_video,log_softmax:()=>c.log_softmax,magnitude:()=>c.magnitude,matmul:()=>l.matmul,max:()=>c.max,mean:()=>l.mean,mean_pooling:()=>l.mean_pooling,medianFilter:()=>c.medianFilter,mel_filter_bank:()=>a.mel_filter_bank,min:()=>c.min,ones:()=>l.ones,ones_like:()=>l.ones_like,permute:()=>l.permute,permute_data:()=>c.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>l.quantize_embeddings,rand:()=>l.rand,randn:()=>l.randn,read_audio:()=>a.read_audio,rfft:()=>l.rfft,round:()=>c.round,slice:()=>l.slice,softmax:()=>c.softmax,spectrogram:()=>a.spectrogram,stack:()=>l.stack,std_mean:()=>l.std_mean,topk:()=>l.topk,window_function:()=>a.window_function,zeros:()=>l.zeros,zeros_like:()=>l.zeros_like});var e=J("./src/env.js"),t=J("./src/pipelines.js"),r=J("./src/models.js"),s=J("./src/tokenizers.js"),o=J("./src/configs.js"),a=J("./src/utils/audio.js"),n=J("./src/utils/image.js"),i=J("./src/utils/video.js"),l=J("./src/utils/tensor.js"),c=J("./src/utils/maths.js"),d=J("./src/base/feature_extraction_utils.js"),u=J("./src/models/feature_extractors.js"),m=J("./src/models/auto/feature_extraction_auto.js"),p=J("./src/base/image_processors_utils.js"),h=J("./src/models/image_processors.js"),f=J("./src/models/auto/image_processing_auto.js"),_=J("./src/base/processing_utils.js"),g=J("./src/models/processors.js"),M=J("./src/models/auto/processing_auto.js"),y=J("./src/generation/streamers.js"),w=J("./src/generation/stopping_criteria.js"),b=J("./src/generation/logits_process.js")})(),K.ASTFeatureExtractor,K.ASTForAudioClassification,K.ASTModel,K.ASTPreTrainedModel,K.AlbertForMaskedLM,K.AlbertForQuestionAnswering,K.AlbertForSequenceClassification,K.AlbertModel,K.AlbertPreTrainedModel,K.AlbertTokenizer,K.ArceeForCausalLM,K.ArceeModel,K.ArceePreTrainedModel,K.AudioClassificationPipeline,K.AutoConfig,K.AutoFeatureExtractor,K.AutoImageProcessor,K.AutoModel,K.AutoModelForAudioClassification,K.AutoModelForAudioFrameClassification,K.AutoModelForAudioTextToText,K.AutoModelForCTC,K.AutoModelForCausalLM,K.AutoModelForDepthEstimation,K.AutoModelForDocumentQuestionAnswering,K.AutoModelForImageClassification,K.AutoModelForImageFeatureExtraction,K.AutoModelForImageMatting,K.AutoModelForImageSegmentation,K.AutoModelForImageTextToText,K.AutoModelForImageToImage,K.AutoModelForMaskGeneration,K.AutoModelForMaskedLM,K.AutoModelForNormalEstimation,K.AutoModelForObjectDetection,K.AutoModelForPoseEstimation,K.AutoModelForQuestionAnswering,K.AutoModelForSemanticSegmentation,K.AutoModelForSeq2SeqLM,K.AutoModelForSequenceClassification,K.AutoModelForSpeechSeq2Seq,K.AutoModelForTextToSpectrogram,K.AutoModelForTextToWaveform,K.AutoModelForTokenClassification,K.AutoModelForUniversalSegmentation,K.AutoModelForVision2Seq,K.AutoModelForXVector,K.AutoModelForZeroShotObjectDetection,K.AutoProcessor,K.AutoTokenizer,K.AutomaticSpeechRecognitionPipeline,K.BackgroundRemovalPipeline,K.BartForConditionalGeneration,K.BartForSequenceClassification,K.BartModel,K.BartPretrainedModel,K.BartTokenizer,K.BaseModelOutput,K.BaseStreamer,K.BeitFeatureExtractor,K.BeitForImageClassification,K.BeitModel,K.BeitPreTrainedModel,K.BertForMaskedLM,K.BertForQuestionAnswering,K.BertForSequenceClassification,K.BertForTokenClassification,K.BertModel,K.BertPreTrainedModel,K.BertTokenizer,K.BitImageProcessor,K.BlenderbotForConditionalGeneration,K.BlenderbotModel,K.BlenderbotPreTrainedModel,K.BlenderbotSmallForConditionalGeneration,K.BlenderbotSmallModel,K.BlenderbotSmallPreTrainedModel,K.BlenderbotSmallTokenizer,K.BlenderbotTokenizer,K.BloomForCausalLM,K.BloomModel,K.BloomPreTrainedModel,K.BloomTokenizer,K.CLIPFeatureExtractor,K.CLIPImageProcessor,K.CLIPModel,K.CLIPPreTrainedModel,K.CLIPSegForImageSegmentation,K.CLIPSegModel,K.CLIPSegPreTrainedModel,K.CLIPTextModel,K.CLIPTextModelWithProjection,K.CLIPTokenizer,K.CLIPVisionModel,K.CLIPVisionModelWithProjection,K.CamembertForMaskedLM,K.CamembertForQuestionAnswering,K.CamembertForSequenceClassification,K.CamembertForTokenClassification,K.CamembertModel,K.CamembertPreTrainedModel,K.CamembertTokenizer,K.CausalLMOutput,K.CausalLMOutputWithPast,K.ChineseCLIPFeatureExtractor,K.ChineseCLIPModel,K.ChineseCLIPPreTrainedModel,K.ClapAudioModelWithProjection,K.ClapFeatureExtractor,K.ClapModel,K.ClapPreTrainedModel,K.ClapTextModelWithProjection,K.ClassifierFreeGuidanceLogitsProcessor,K.CodeGenForCausalLM,K.CodeGenModel,K.CodeGenPreTrainedModel,K.CodeGenTokenizer,K.CodeLlamaTokenizer,K.CohereForCausalLM,K.CohereModel,K.CoherePreTrainedModel,K.CohereTokenizer,K.ConvBertForMaskedLM,K.ConvBertForQuestionAnswering,K.ConvBertForSequenceClassification,K.ConvBertForTokenClassification,K.ConvBertModel,K.ConvBertPreTrainedModel,K.ConvBertTokenizer,K.ConvNextFeatureExtractor,K.ConvNextForImageClassification,K.ConvNextImageProcessor,K.ConvNextModel,K.ConvNextPreTrainedModel,K.ConvNextV2ForImageClassification,K.ConvNextV2Model,K.ConvNextV2PreTrainedModel,K.DFineForObjectDetection,K.DFineModel,K.DFinePreTrainedModel,K.DINOv3ConvNextModel,K.DINOv3ConvNextPreTrainedModel,K.DINOv3ViTImageProcessor,K.DINOv3ViTModel,K.DINOv3ViTPreTrainedModel,K.DPTFeatureExtractor,K.DPTForDepthEstimation,K.DPTImageProcessor,K.DPTModel,K.DPTPreTrainedModel,K.DacDecoderModel,K.DacDecoderOutput,K.DacEncoderModel,K.DacEncoderOutput,K.DacFeatureExtractor,K.DacModel,K.DacPreTrainedModel,K.DataTypeMap,K.DebertaForMaskedLM,K.DebertaForQuestionAnswering,K.DebertaForSequenceClassification,K.DebertaForTokenClassification,K.DebertaModel,K.DebertaPreTrainedModel,K.DebertaTokenizer,K.DebertaV2ForMaskedLM,K.DebertaV2ForQuestionAnswering,K.DebertaV2ForSequenceClassification,K.DebertaV2ForTokenClassification,K.DebertaV2Model,K.DebertaV2PreTrainedModel,K.DebertaV2Tokenizer,K.DecisionTransformerModel,K.DecisionTransformerPreTrainedModel,K.DeiTFeatureExtractor,K.DeiTForImageClassification,K.DeiTImageProcessor,K.DeiTModel,K.DeiTPreTrainedModel,K.DepthAnythingForDepthEstimation,K.DepthAnythingPreTrainedModel,K.DepthEstimationPipeline,K.DepthProForDepthEstimation,K.DepthProPreTrainedModel,K.DetrFeatureExtractor,K.DetrForObjectDetection,K.DetrForSegmentation,K.DetrImageProcessor,K.DetrModel,K.DetrObjectDetectionOutput,K.DetrPreTrainedModel,K.DetrSegmentationOutput,K.Dinov2ForImageClassification,K.Dinov2Model,K.Dinov2PreTrainedModel,K.Dinov2WithRegistersForImageClassification,K.Dinov2WithRegistersModel,K.Dinov2WithRegistersPreTrainedModel,K.DistilBertForMaskedLM,K.DistilBertForQuestionAnswering,K.DistilBertForSequenceClassification,K.DistilBertForTokenClassification,K.DistilBertModel,K.DistilBertPreTrainedModel,K.DistilBertTokenizer,K.DocumentQuestionAnsweringPipeline,K.DonutFeatureExtractor,K.DonutImageProcessor,K.DonutSwinModel,K.DonutSwinPreTrainedModel,K.EdgeTamModel,K.EfficientNetForImageClassification,K.EfficientNetImageProcessor,K.EfficientNetModel,K.EfficientNetPreTrainedModel,K.ElectraForMaskedLM,K.ElectraForQuestionAnswering,K.ElectraForSequenceClassification,K.ElectraForTokenClassification,K.ElectraModel,K.ElectraPreTrainedModel,K.ElectraTokenizer,K.EncodecFeatureExtractor,K.EosTokenCriteria,K.Ernie4_5ForCausalLM,K.Ernie4_5Model,K.Ernie4_5PreTrainedModel,K.EsmForMaskedLM,K.EsmForSequenceClassification,K.EsmForTokenClassification,K.EsmModel,K.EsmPreTrainedModel,K.EsmTokenizer,K.ExaoneForCausalLM,K.ExaoneModel,K.ExaonePreTrainedModel,K.FFT,K.FalconForCausalLM,K.FalconModel,K.FalconPreTrainedModel,K.FalconTokenizer,K.FastViTForImageClassification,K.FastViTModel,K.FastViTPreTrainedModel,K.FeatureExtractionPipeline,K.FeatureExtractor,K.FillMaskPipeline,K.Florence2ForConditionalGeneration,K.Florence2PreTrainedModel,K.Florence2Processor,K.ForcedBOSTokenLogitsProcessor,K.ForcedEOSTokenLogitsProcessor,K.GLPNFeatureExtractor,K.GLPNForDepthEstimation,K.GLPNModel,K.GLPNPreTrainedModel,K.GPT2LMHeadModel,K.GPT2Model,K.GPT2PreTrainedModel,K.GPT2Tokenizer,K.GPTBigCodeForCausalLM,K.GPTBigCodeModel,K.GPTBigCodePreTrainedModel,K.GPTJForCausalLM,K.GPTJModel,K.GPTJPreTrainedModel,K.GPTNeoForCausalLM,K.GPTNeoModel,K.GPTNeoPreTrainedModel,K.GPTNeoXForCausalLM,K.GPTNeoXModel,K.GPTNeoXPreTrainedModel,K.GPTNeoXTokenizer,K.Gemma2ForCausalLM,K.Gemma2Model,K.Gemma2PreTrainedModel,K.Gemma3ForCausalLM,K.Gemma3Model,K.Gemma3PreTrainedModel,K.Gemma3nAudioFeatureExtractor,K.Gemma3nForConditionalGeneration,K.Gemma3nPreTrainedModel,K.Gemma3nProcessor,K.GemmaForCausalLM,K.GemmaModel,K.GemmaPreTrainedModel,K.GemmaTokenizer,K.GlmForCausalLM,K.GlmModel,K.GlmPreTrainedModel,K.GraniteForCausalLM,K.GraniteModel,K.GraniteMoeHybridForCausalLM,K.GraniteMoeHybridModel,K.GraniteMoeHybridPreTrainedModel,K.GranitePreTrainedModel,K.Grok1Tokenizer,K.GroundingDinoForObjectDetection,K.GroundingDinoImageProcessor,K.GroundingDinoPreTrainedModel,K.GroundingDinoProcessor,K.GroupViTModel,K.GroupViTPreTrainedModel,K.HeliumForCausalLM,K.HeliumModel,K.HeliumPreTrainedModel,K.HerbertTokenizer,K.HieraForImageClassification,K.HieraModel,K.HieraPreTrainedModel,K.HubertForCTC,K.HubertForSequenceClassification,K.HubertModel,K.HubertPreTrainedModel,K.IJepaForImageClassification,K.IJepaModel,K.IJepaPreTrainedModel,K.Idefics3ForConditionalGeneration,K.Idefics3ImageProcessor,K.Idefics3PreTrainedModel,K.Idefics3Processor,K.ImageClassificationPipeline,K.ImageFeatureExtractionPipeline,K.ImageFeatureExtractor,K.ImageMattingOutput,K.ImageProcessor,K.ImageSegmentationPipeline,K.ImageToImagePipeline,K.ImageToTextPipeline,K.InterruptableStoppingCriteria,K.JAISLMHeadModel,K.JAISModel,K.JAISPreTrainedModel,K.JinaCLIPImageProcessor,K.JinaCLIPModel,K.JinaCLIPPreTrainedModel,K.JinaCLIPProcessor,K.JinaCLIPTextModel,K.JinaCLIPVisionModel,K.Lfm2ForCausalLM,K.Lfm2Model,K.Lfm2PreTrainedModel,K.LiteWhisperForConditionalGeneration,K.Llama4ForCausalLM,K.Llama4PreTrainedModel,K.LlamaForCausalLM,K.LlamaModel,K.LlamaPreTrainedModel,K.LlamaTokenizer,K.LlavaForConditionalGeneration,K.LlavaOnevisionForConditionalGeneration,K.LlavaOnevisionImageProcessor,K.LlavaPreTrainedModel,K.LlavaProcessor,K.LlavaQwen2ForCausalLM,K.LogitsProcessor,K.LogitsProcessorList,K.LogitsWarper,K.LongT5ForConditionalGeneration,K.LongT5Model,K.LongT5PreTrainedModel,K.M2M100ForConditionalGeneration,K.M2M100Model,K.M2M100PreTrainedModel,K.M2M100Tokenizer,K.MBart50Tokenizer,K.MBartForCausalLM,K.MBartForConditionalGeneration,K.MBartForSequenceClassification,K.MBartModel,K.MBartPreTrainedModel,K.MBartTokenizer,K.MPNetForMaskedLM,K.MPNetForQuestionAnswering,K.MPNetForSequenceClassification,K.MPNetForTokenClassification,K.MPNetModel,K.MPNetPreTrainedModel,K.MPNetTokenizer,K.MT5ForConditionalGeneration,K.MT5Model,K.MT5PreTrainedModel,K.MarianMTModel,K.MarianModel,K.MarianPreTrainedModel,K.MarianTokenizer,K.Mask2FormerImageProcessor,K.MaskFormerFeatureExtractor,K.MaskFormerForInstanceSegmentation,K.MaskFormerImageProcessor,K.MaskFormerModel,K.MaskFormerPreTrainedModel,K.MaskedLMOutput,K.MaxLengthCriteria,K.Metric3DForDepthEstimation,K.Metric3DPreTrainedModel,K.Metric3Dv2ForDepthEstimation,K.Metric3Dv2PreTrainedModel,K.MgpstrForSceneTextRecognition,K.MgpstrModelOutput,K.MgpstrPreTrainedModel,K.MgpstrProcessor,K.MgpstrTokenizer,K.MimiDecoderModel,K.MimiDecoderOutput,K.MimiEncoderModel,K.MimiEncoderOutput,K.MimiModel,K.MimiPreTrainedModel,K.MinLengthLogitsProcessor,K.MinNewTokensLengthLogitsProcessor,K.Ministral3ForCausalLM,K.Ministral3Model,K.Ministral3PreTrainedModel,K.MinistralForCausalLM,K.MinistralModel,K.MinistralPreTrainedModel,K.Mistral3ForConditionalGeneration,K.MistralForCausalLM,K.MistralModel,K.MistralPreTrainedModel,K.MobileBertForMaskedLM,K.MobileBertForQuestionAnswering,K.MobileBertForSequenceClassification,K.MobileBertModel,K.MobileBertPreTrainedModel,K.MobileBertTokenizer,K.MobileLLMForCausalLM,K.MobileLLMModel,K.MobileLLMPreTrainedModel,K.MobileNetV1FeatureExtractor,K.MobileNetV1ForImageClassification,K.MobileNetV1ForSemanticSegmentation,K.MobileNetV1ImageProcessor,K.MobileNetV1Model,K.MobileNetV1PreTrainedModel,K.MobileNetV2FeatureExtractor,K.MobileNetV2ForImageClassification,K.MobileNetV2ForSemanticSegmentation,K.MobileNetV2ImageProcessor,K.MobileNetV2Model,K.MobileNetV2PreTrainedModel,K.MobileNetV3FeatureExtractor,K.MobileNetV3ForImageClassification,K.MobileNetV3ForSemanticSegmentation,K.MobileNetV3ImageProcessor,K.MobileNetV3Model,K.MobileNetV3PreTrainedModel,K.MobileNetV4FeatureExtractor,K.MobileNetV4ForImageClassification,K.MobileNetV4ForSemanticSegmentation,K.MobileNetV4ImageProcessor,K.MobileNetV4Model,K.MobileNetV4PreTrainedModel,K.MobileViTFeatureExtractor,K.MobileViTForImageClassification,K.MobileViTImageProcessor,K.MobileViTModel,K.MobileViTPreTrainedModel,K.MobileViTV2ForImageClassification,K.MobileViTV2Model,K.MobileViTV2PreTrainedModel,K.ModelOutput,K.ModernBertDecoderForCausalLM,K.ModernBertDecoderModel,K.ModernBertDecoderPreTrainedModel,K.ModernBertForMaskedLM,K.ModernBertForSequenceClassification,K.ModernBertForTokenClassification,K.ModernBertModel,K.ModernBertPreTrainedModel,K.Moondream1ForConditionalGeneration,K.MoonshineFeatureExtractor,K.MoonshineForConditionalGeneration,K.MoonshineModel,K.MoonshinePreTrainedModel,K.MoonshineProcessor,K.MptForCausalLM,K.MptModel,K.MptPreTrainedModel,K.MultiModalityCausalLM,K.MultiModalityPreTrainedModel,K.MusicgenForCausalLM,K.MusicgenForConditionalGeneration,K.MusicgenModel,K.MusicgenPreTrainedModel,K.NanoChatForCausalLM,K.NanoChatModel,K.NanoChatPreTrainedModel,K.NeoBertForMaskedLM,K.NeoBertForQuestionAnswering,K.NeoBertForSequenceClassification,K.NeoBertForTokenClassification,K.NeoBertModel,K.NeoBertPreTrainedModel,K.NllbTokenizer,K.NoBadWordsLogitsProcessor,K.NoRepeatNGramLogitsProcessor,K.NomicBertModel,K.NomicBertPreTrainedModel,K.NougatImageProcessor,K.NougatTokenizer,K.OPTForCausalLM,K.OPTModel,K.OPTPreTrainedModel,K.ObjectDetectionPipeline,K.Olmo2ForCausalLM,K.Olmo2Model,K.Olmo2PreTrainedModel,K.OlmoForCausalLM,K.OlmoModel,K.OlmoPreTrainedModel,K.OpenELMForCausalLM,K.OpenELMModel,K.OpenELMPreTrainedModel,K.OwlViTFeatureExtractor,K.OwlViTForObjectDetection,K.OwlViTImageProcessor,K.OwlViTModel,K.OwlViTPreTrainedModel,K.OwlViTProcessor,K.Owlv2ForObjectDetection,K.Owlv2ImageProcessor,K.Owlv2Model,K.Owlv2PreTrainedModel,K.PaliGemmaForConditionalGeneration,K.PaliGemmaPreTrainedModel,K.PaliGemmaProcessor,K.ParakeetFeatureExtractor,K.ParakeetForCTC,K.ParakeetPreTrainedModel,K.PatchTSMixerForPrediction,K.PatchTSMixerModel,K.PatchTSMixerPreTrainedModel,K.PatchTSTForPrediction,K.PatchTSTModel,K.PatchTSTPreTrainedModel,K.Phi3ForCausalLM,K.Phi3Model,K.Phi3PreTrainedModel,K.Phi3VForCausalLM,K.Phi3VImageProcessor,K.Phi3VPreTrainedModel,K.Phi3VProcessor,K.PhiForCausalLM,K.PhiModel,K.PhiPreTrainedModel,K.Pipeline,K.PixtralImageProcessor,K.PixtralProcessor,K.PreTrainedModel,K.PreTrainedTokenizer,K.PretrainedConfig,K.PretrainedMixin,K.Processor,K.PvtForImageClassification,K.PvtImageProcessor,K.PvtModel,K.PvtPreTrainedModel,K.PyAnnoteFeatureExtractor,K.PyAnnoteForAudioFrameClassification,K.PyAnnoteModel,K.PyAnnotePreTrainedModel,K.PyAnnoteProcessor,K.QuestionAnsweringModelOutput,K.QuestionAnsweringPipeline,K.Qwen2ForCausalLM,K.Qwen2Model,K.Qwen2PreTrainedModel,K.Qwen2Tokenizer,K.Qwen2VLForConditionalGeneration,K.Qwen2VLImageProcessor,K.Qwen2VLPreTrainedModel,K.Qwen2VLProcessor,K.Qwen3ForCausalLM,K.Qwen3Model,K.Qwen3PreTrainedModel,K.RFDetrForObjectDetection,K.RFDetrModel,K.RFDetrObjectDetectionOutput,K.RFDetrPreTrainedModel,K.RTDetrForObjectDetection,K.RTDetrImageProcessor,K.RTDetrModel,K.RTDetrObjectDetectionOutput,K.RTDetrPreTrainedModel,K.RTDetrV2ForObjectDetection,K.RTDetrV2Model,K.RTDetrV2ObjectDetectionOutput,K.RTDetrV2PreTrainedModel,K.RawAudio,K.RawImage,K.RawVideo,K.RawVideoFrame,K.RepetitionPenaltyLogitsProcessor,K.ResNetForImageClassification,K.ResNetModel,K.ResNetPreTrainedModel,K.RoFormerForMaskedLM,K.RoFormerForQuestionAnswering,K.RoFormerForSequenceClassification,K.RoFormerForTokenClassification,K.RoFormerModel,K.RoFormerPreTrainedModel,K.RoFormerTokenizer,K.RobertaForMaskedLM,K.RobertaForQuestionAnswering,K.RobertaForSequenceClassification,K.RobertaForTokenClassification,K.RobertaModel,K.RobertaPreTrainedModel,K.RobertaTokenizer,K.Sam2ImageProcessor,K.Sam2ImageSegmentationOutput,K.Sam2Model,K.Sam2PreTrainedModel,K.Sam2Processor,K.Sam2VideoProcessor,K.Sam3ImageProcessor,K.Sam3TrackerModel,K.SamImageProcessor,K.SamImageSegmentationOutput,K.SamModel,K.SamPreTrainedModel,K.SamProcessor,K.SapiensForDepthEstimation,K.SapiensForNormalEstimation,K.SapiensForSemanticSegmentation,K.SapiensPreTrainedModel,K.SeamlessM4TFeatureExtractor,K.SegformerFeatureExtractor,K.SegformerForImageClassification,K.SegformerForSemanticSegmentation,K.SegformerImageProcessor,K.SegformerModel,K.SegformerPreTrainedModel,K.Seq2SeqLMOutput,K.SequenceClassifierOutput,K.SiglipImageProcessor,K.SiglipModel,K.SiglipPreTrainedModel,K.SiglipTextModel,K.SiglipTokenizer,K.SiglipVisionModel,K.SmolLM3ForCausalLM,K.SmolLM3Model,K.SmolLM3PreTrainedModel,K.SmolVLMForConditionalGeneration,K.SmolVLMImageProcessor,K.SmolVLMProcessor,K.SnacDecoderModel,K.SnacEncoderModel,K.SnacFeatureExtractor,K.SnacModel,K.SnacPreTrainedModel,K.SpeechT5FeatureExtractor,K.SpeechT5ForSpeechToText,K.SpeechT5ForTextToSpeech,K.SpeechT5HifiGan,K.SpeechT5Model,K.SpeechT5PreTrainedModel,K.SpeechT5Processor,K.SpeechT5Tokenizer,K.SqueezeBertForMaskedLM,K.SqueezeBertForQuestionAnswering,K.SqueezeBertForSequenceClassification,K.SqueezeBertModel,K.SqueezeBertPreTrainedModel,K.SqueezeBertTokenizer,K.StableLmForCausalLM,K.StableLmModel,K.StableLmPreTrainedModel,K.Starcoder2ForCausalLM,K.Starcoder2Model,K.Starcoder2PreTrainedModel,K.StoppingCriteria,K.StoppingCriteriaList,K.StyleTextToSpeech2Model,K.StyleTextToSpeech2PreTrainedModel,K.SummarizationPipeline,K.SupertonicForConditionalGeneration,K.SupertonicPreTrainedModel,K.SuppressTokensAtBeginLogitsProcessor,K.Swin2SRForImageSuperResolution,K.Swin2SRImageProcessor,K.Swin2SRModel,K.Swin2SRPreTrainedModel,K.SwinForImageClassification,K.SwinForSemanticSegmentation,K.SwinModel,K.SwinPreTrainedModel,K.T5ForConditionalGeneration,K.T5Model,K.T5PreTrainedModel,K.T5Tokenizer,K.TableTransformerForObjectDetection,K.TableTransformerModel,K.TableTransformerObjectDetectionOutput,K.TableTransformerPreTrainedModel,K.TemperatureLogitsWarper,K.Tensor,K.Text2TextGenerationPipeline,K.TextClassificationPipeline,K.TextGenerationPipeline,K.TextStreamer,K.TextToAudioPipeline,K.TokenClassificationPipeline,K.TokenClassifierOutput,K.TokenizerModel,K.TopKLogitsWarper,K.TopPLogitsWarper,K.TrOCRForCausalLM,K.TrOCRPreTrainedModel,K.TranslationPipeline,K.UltravoxModel,K.UltravoxPreTrainedModel,K.UltravoxProcessor,K.UniSpeechForCTC,K.UniSpeechForSequenceClassification,K.UniSpeechModel,K.UniSpeechPreTrainedModel,K.UniSpeechSatForAudioFrameClassification,K.UniSpeechSatForCTC,K.UniSpeechSatForSequenceClassification,K.UniSpeechSatModel,K.UniSpeechSatPreTrainedModel,K.VLChatProcessor,K.VLMImageProcessor,K.VaultGemmaForCausalLM,K.VaultGemmaModel,K.VaultGemmaPreTrainedModel,K.ViTFeatureExtractor,K.ViTForImageClassification,K.ViTImageProcessor,K.ViTMAEModel,K.ViTMAEPreTrainedModel,K.ViTMSNForImageClassification,K.ViTMSNModel,K.ViTMSNPreTrainedModel,K.ViTModel,K.ViTPreTrainedModel,K.VisionEncoderDecoderModel,K.VitMatteForImageMatting,K.VitMatteImageProcessor,K.VitMattePreTrainedModel,K.VitPoseForPoseEstimation,K.VitPoseImageProcessor,K.VitPosePreTrainedModel,K.VitsModel,K.VitsModelOutput,K.VitsPreTrainedModel,K.VitsTokenizer,K.VoxtralForConditionalGeneration,K.VoxtralProcessor,K.Wav2Vec2BertForCTC,K.Wav2Vec2BertForSequenceClassification,K.Wav2Vec2BertModel,K.Wav2Vec2BertPreTrainedModel,K.Wav2Vec2CTCTokenizer,K.Wav2Vec2FeatureExtractor,K.Wav2Vec2ForAudioFrameClassification,K.Wav2Vec2ForCTC,K.Wav2Vec2ForSequenceClassification,K.Wav2Vec2Model,K.Wav2Vec2PreTrainedModel,K.Wav2Vec2Processor,K.Wav2Vec2ProcessorWithLM,K.WavLMForAudioFrameClassification,K.WavLMForCTC,K.WavLMForSequenceClassification,K.WavLMForXVector,K.WavLMModel,K.WavLMPreTrainedModel,K.WeSpeakerFeatureExtractor,K.WeSpeakerResNetModel,K.WeSpeakerResNetPreTrainedModel,K.WhisperFeatureExtractor,K.WhisperForConditionalGeneration,K.WhisperModel,K.WhisperPreTrainedModel,K.WhisperProcessor,K.WhisperTextStreamer,K.WhisperTimeStampLogitsProcessor,K.WhisperTokenizer,K.XLMForQuestionAnswering,K.XLMForSequenceClassification,K.XLMForTokenClassification,K.XLMModel,K.XLMPreTrainedModel,K.XLMRobertaForMaskedLM,K.XLMRobertaForQuestionAnswering,K.XLMRobertaForSequenceClassification,K.XLMRobertaForTokenClassification,K.XLMRobertaModel,K.XLMRobertaPreTrainedModel,K.XLMRobertaTokenizer,K.XLMTokenizer,K.XLMWithLMHeadModel,K.XVectorOutput,K.YolosFeatureExtractor,K.YolosForObjectDetection,K.YolosImageProcessor,K.YolosModel,K.YolosObjectDetectionOutput,K.YolosPreTrainedModel,K.ZeroShotAudioClassificationPipeline,K.ZeroShotClassificationPipeline,K.ZeroShotImageClassificationPipeline,K.ZeroShotObjectDetectionPipeline,K.bankers_round,K.cat,K.cos_sim,K.dot,K.dynamic_time_warping;var Y=K.env;K.full,K.full_like,K.getCacheShapes,K.hamming,K.hanning,K.interpolate,K.interpolate_4d,K.interpolate_data,K.is_chinese_char,K.layer_norm,K.load_image,K.load_video,K.log_softmax,K.magnitude,K.matmul,K.max,K.mean,K.mean_pooling,K.medianFilter,K.mel_filter_bank,K.min,K.ones,K.ones_like,K.permute,K.permute_data;var Z=K.pipeline;K.quantize_embeddings,K.rand,K.randn,K.read_audio,K.rfft,K.round,K.slice,K.softmax,K.spectrogram,K.stack,K.std_mean,K.topk,K.window_function,K.zeros,K.zeros_like;var ee=class e{constructor(e={}){this.name="default",this.progressCallback=void 0;let{modelName:t="Xenova/all-MiniLM-L6-v2",revision:r="main",dtype:s,progressCallback:o,quantized:a=!1,wasm:n=!1}=e;this.modelName=t,this.revision=r,this.dtype=s||(a?"uint8":"fp32"),this.quantized=a,this.progressCallback=o,this.wasm=n,this.wasm&&(Y.backends.onnx.backend="wasm")}static buildFromConfig(t){return new e({modelName:t.model_name,revision:t.revision,dtype:t.dtype,quantized:t.quantized,wasm:t.wasm})}async generate(e){let t=await Z("feature-extraction",this.modelName,{revision:this.revision,progress_callback:this.progressCallback,dtype:this.dtype});return(await t(e,{pooling:"mean",normalize:!0})).tolist()}defaultSpace(){return"cosine"}supportedSpaces(){return["cosine","l2","ip"]}getConfig(){return{model_name:this.modelName,revision:this.revision,dtype:this.dtype,quantized:this.quantized}}validateConfigUpdate(e){if(this.getConfig().model_name!==e.model_name)throw Error("The DefaultEmbeddingFunction's 'model' cannot be changed after initialization.")}static validateConfig(e){!function(e,t){let r=function(e){if(!a[e])throw Error(`Schema '${e}' not found`);return a[e]}(t),s=o.compile(r);if(!s(e)){let e=(s.errors||[]).map(e=>`${e.instancePath||"/"}: ${e.message}`).join(", ");throw Error(`Config validation failed for schema '${t}': ${e}`)}}(e,"transformers")}}},1235:e=>{"use strict";e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},69771:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')}};