(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{7081:function(e,t,r){Promise.resolve().then(r.bind(r,6412))},6412:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var i=r(7437),s=r(7770),n=r(2265);function o(e){switch(e){case"Critical":return"bg-red-100 text-red-700";case"High":return"bg-orange-100 text-orange-700";case"Medium":return"bg-amber-100 text-amber-700";default:return"bg-gray-100 text-gray-700"}}function d(e){let{className:t}=e;return(0,i.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}function l(e){let{className:t}=e;return(0,i.jsxs)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}function a(e){if(!e)return"—";try{let t=new Date(e),r=new Date().getTime()-t.getTime(),i=Math.floor(r/6e4);if(i<1)return"Just now";if(i<60)return"".concat(i,"m ago");let s=Math.floor(i/60);if(s<24)return"".concat(s,"h ago");return"".concat(Math.floor(s/24),"d ago")}catch(e){return"—"}}function c(e){if(!e)return"—";try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(e){return"—"}}function u(){var e,t,r,u,g,p,m,x,h,v,y,f,b,j,N,k;let{user:_}=(0,s.aF)(),[w,I]=(0,n.useState)(!0),[C,S]=(0,n.useState)("recordings"),[T,R]=(0,n.useState)(null),[F,A]=(0,n.useState)([]),[O,L]=(0,n.useState)(null),[H,U]=(0,n.useState)(null),[P,M]=(0,n.useState)(!1),[J,D]=(0,n.useState)(null),[E,z]=(0,n.useState)(null),[W,B]=(0,n.useState)({}),[q,G]=(0,n.useState)(null),[K,Q]=(0,n.useState)(""),[V,X]=(0,n.useState)(!1),Y=(0,n.useRef)(!1),[Z,$]=(0,n.useState)("unresolved"),ee="unresolved"===Z?F.filter(e=>"Resolved"!==e.status):"resolved"===Z?F.filter(e=>"Resolved"===e.status):F,et=null!==(g=null!==(u=null!==(r=null!==(t=ee.find(e=>e.recordingId===O))&&void 0!==t?t:ee[0])&&void 0!==r?r:F.find(e=>e.recordingId===O))&&void 0!==u?u:F[0])&&void 0!==g?g:null,er=(0,n.useCallback)(async(e,t)=>{if(!(t<1)&&!(t>5))try{var r;let[i,s]=await Promise.all([fetch("/api/db/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordingId:e.recordingId,title:e.title,description:e.description,severity:e.severity,suggestedFix:null!==(r=e.suggestedFix)&&void 0!==r?r:"",developerRating:t})}),fetch("/api/db/issues/".concat(encodeURIComponent(e.recordingId)),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({approved:!0,approvedRating:t,approvedAt:new Date().toISOString()})})]);!i.ok&&s.ok&&await fetch("/api/issues/log-approval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordingId:e.recordingId,title:e.title,suggestedFix:e.suggestedFix,rating:t})}),A(r=>r.map(r=>r.recordingId===e.recordingId?{...r,approved:!0,approvedRating:t}:r)),z(null),B(r=>({...r,[e.recordingId]:t}))}catch(e){}},[]),ei=(0,n.useCallback)(async e=>{if(K.trim()&&!V){X(!0);try{var t,r,i,s;let n={recordingId:e.recordingId,posthogCategoryId:null!==(r=e.posthogCategoryId)&&void 0!==r?r:"ux",posthogIssueTypeId:null!==(i=e.posthogIssueTypeId)&&void 0!==i?i:"rage-frustration",title:e.title,description:e.description,severity:e.severity,codeLocation:null!==(s=e.codeLocation)&&void 0!==s?s:"",codeSnippetHint:e.codeSnippetHint,startUrl:null===(t=e.recording)||void 0===t?void 0:t.start_url},o=await fetch("/api/issues/suggest-fix",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issues:[n],revisionInstructions:K.trim(),previousSuggestedFix:e.suggestedFix})}),d=await o.json(),l=(Array.isArray(null==d?void 0:d.suggestedFixes)?d.suggestedFixes:[]).find(t=>t.recordingId===e.recordingId);if(null==l?void 0:l.suggestedFix){try{await fetch("/api/db/issues/".concat(encodeURIComponent(e.recordingId),"/revisions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instruction:K.trim(),suggestedFixAfter:l.suggestedFix})}),await fetch("/api/db/issues/".concat(encodeURIComponent(e.recordingId)),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({suggestedFix:l.suggestedFix})})}catch(e){}A(t=>t.map(t=>t.recordingId===e.recordingId?{...t,suggestedFix:l.suggestedFix}:t)),G(null),Q("")}}catch(e){}finally{X(!1)}}},[K,V]),es=(0,n.useCallback)(async e=>{D(null),U(null),M(!0);try{let t=await fetch("/api/posthog/session-recordings/".concat(e,"/embed")),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to load replay");U(r.embedUrl)}catch(e){D(e instanceof Error?e.message:"Could not load replay")}finally{M(!1)}},[]);(0,n.useEffect)(()=>{let e=!1;return async function(){R(null);let t="_t=".concat(Date.now());try{var r,i,s,n;let o=await fetch("/api/posthog/session-recordings?limit=50&date_from=-7d&".concat(t));if(!o.ok){R("Failed to load session recordings"),Y.current=!1;return}let d=await o.json(),l=Array.isArray(null==d?void 0:d.results)?d.results:[];try{let e=l.map(e=>{var t,r,i;let s=e.start_time?new Date(e.start_time).getTime():0,n=(null!==(r=e.recording_duration)&&void 0!==r?r:0)*1e3;return{id:e.id,distinct_id:null!==(i=e.distinct_id)&&void 0!==i?i:null===(t=e.person)||void 0===t?void 0:t.distinct_id,start_time:e.start_time,end_time:n?new Date(s+n).toISOString():void 0,recording_duration:e.recording_duration}}),r=await fetch("/api/posthog/rage-dead-clicks?".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordings:e})});if(r.ok){let e=await r.json();l=l.map(t=>{var r,i,s,n,o,d;return{...t,rage_click_count:null!==(n=null!==(s=t.rage_click_count)&&void 0!==s?s:null===(r=e[t.id])||void 0===r?void 0:r.rageClickCount)&&void 0!==n?n:0,dead_click_count:null!==(d=null!==(o=t.dead_click_count)&&void 0!==o?o:null===(i=e[t.id])||void 0===i?void 0:i.deadClickCount)&&void 0!==d?d:0}})}}catch(e){try{let e=await fetch("/api/posthog/rage-dead-clicks?".concat(t));if(e.ok){let t=await e.json();l=l.map(e=>{var r,i,s,n,o,d;return{...e,rage_click_count:null!==(n=null!==(s=e.rage_click_count)&&void 0!==s?s:null===(r=t[e.id])||void 0===r?void 0:r.rageClickCount)&&void 0!==n?n:0,dead_click_count:null!==(d=null!==(o=e.dead_click_count)&&void 0!==o?o:null===(i=t[e.id])||void 0===i?void 0:i.deadClickCount)&&void 0!==d?d:0}})}}catch(e){}}try{await fetch("/api/db/monitoring",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordings:l})})}catch(e){}let u=l.filter(e=>null!=e.console_error_count&&e.console_error_count>0||null!=e.rage_click_count&&e.rage_click_count>0||null!=e.dead_click_count&&e.dead_click_count>0);if(e){S(null),I(!1),Y.current=!1;return}if(0===u.length){L(null),S(null),I(!1),l.length>0&&A([]),Y.current=!1;return}let g=(e,t)=>{var r,i;return{recordingId:t.recordingId,recording:e,title:t.title,description:t.description,suggestedFix:null!==(r=t.suggestedFix)&&void 0!==r?r:void 0,codeLocation:t.codeLocation,codeSnippetHint:t.codeSnippetHint,posthogCategoryId:t.posthogCategoryId,posthogIssueTypeId:t.posthogIssueTypeId,severity:["Critical","High","Medium","Low"].includes(t.severity)?t.severity:"Medium",instances:1,timeAgo:a(e.start_time),firstDetected:c(e.start_time),status:"Resolved"===t.status?"Resolved":"Unresolved",approved:t.approved,approvedRating:null!==(i=t.approvedRating)&&void 0!==i?i:void 0}},p=[];try{let e=await fetch("/api/db/issues"),t=await e.json();p=Array.isArray(null==t?void 0:t.issues)?t.issues:[]}catch(e){}let m=new Map(p.filter(e=>u.some(t=>t.id===e.recordingId)).map(e=>[e.recordingId,e])),x=u.filter(e=>!m.has(e.id));if(0===x.length&&m.size>0){let t=Array.from(m.entries()).map(e=>{let[t,r]=e,i=u.find(e=>e.id===t);return g(i,r)});e||(A(t),L(null!==(i=null===(r=t[0])||void 0===r?void 0:r.recordingId)&&void 0!==i?i:null)),S(null),I(!1),Y.current=!1;return}let h=[];if(x.length>0){S("analyzing");let t=x.map(e=>{var t,r;return{recordingId:e.id,consoleErrorCount:null!==(t=e.console_error_count)&&void 0!==t?t:0,clickCount:null!==(r=e.click_count)&&void 0!==r?r:0,rageClickCount:e.rage_click_count,deadClickCount:e.dead_click_count,durationSeconds:e.recording_duration,startUrl:e.start_url,startTime:e.start_time}}),r=await fetch("/api/issues/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordings:t})}),i=await r.json(),s=Array.isArray(null==i?void 0:i.issues)?i.issues:[],n=[];if(s.length>0&&!e){S("suggesting");try{let e=await fetch("/api/issues/suggest-fix",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issues:s})}),t=await e.json();n=Array.isArray(null==t?void 0:t.suggestedFixes)?t.suggestedFixes:[]}catch(e){}}h=x.map(e=>{var t,r,i,o,d,l,u;let g=s.find(t=>t.recordingId===e.id),p=n.find(t=>t.recordingId===e.id),m=null!==(t=e.console_error_count)&&void 0!==t?t:0,x=null!==(r=e.rage_click_count)&&void 0!==r?r:0,h=null!==(i=e.dead_click_count)&&void 0!==i?i:0,v=[];m>0&&v.push("".concat(m," console error(s)")),x>0&&v.push("".concat(x," rage click(s)")),h>0&&v.push("".concat(h," dead click(s)"));let y=v.length>0?"Session with ".concat(v.join(", ")):"Session with issues",f=v.length>0?"This session had ".concat(v.join(", ")," and ").concat(null!==(o=e.click_count)&&void 0!==o?o:0," total clicks. Watch the replay to investigate."):"Watch the replay to investigate.";return{recordingId:e.id,recording:e,title:null!==(d=null==g?void 0:g.title)&&void 0!==d?d:y,description:null!==(l=null==g?void 0:g.description)&&void 0!==l?l:f,suggestedFix:null==p?void 0:p.suggestedFix,codeLocation:null!==(u=null==g?void 0:g.codeLocation)&&void 0!==u?u:null==p?void 0:p.codeLocation,codeSnippetHint:null==g?void 0:g.codeSnippetHint,posthogCategoryId:null==g?void 0:g.posthogCategoryId,posthogIssueTypeId:null==g?void 0:g.posthogIssueTypeId,severity:(null==g?void 0:g.severity)&&["Critical","High","Medium","Low"].includes(g.severity)?g.severity:"Medium",instances:1,timeAgo:a(e.start_time),firstDetected:c(e.start_time),status:"Unresolved"}});try{await fetch("/api/db/issues",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({issues:h.map(e=>{var t,r,i,s;return{recordingId:e.recordingId,posthogCategoryId:null!==(r=e.posthogCategoryId)&&void 0!==r?r:"ux",posthogIssueTypeId:null!==(i=e.posthogIssueTypeId)&&void 0!==i?i:"rage-frustration",title:e.title,description:e.description,severity:e.severity,codeLocation:null!==(s=e.codeLocation)&&void 0!==s?s:"",codeSnippetHint:e.codeSnippetHint,startUrl:null===(t=e.recording)||void 0===t?void 0:t.start_url,suggestedFix:e.suggestedFix}})})})}catch(e){}}let v=[...Array.from(m.entries()).map(e=>{let[t,r]=e,i=u.find(e=>e.id===t);return g(i,r)}),...h];try{let e=await fetch("/api/db/issues"),t=await e.json(),r=Array.isArray(null==t?void 0:t.issues)?t.issues:[],i=Object.fromEntries(r.map(e=>[e.recordingId,e]));v=v.map(e=>{var t,r;let s=i[e.recordingId];return s?{...e,status:"Resolved"===s.status?"Resolved":e.status,approved:null!==(t=s.approved)&&void 0!==t?t:e.approved,approvedRating:null!==(r=s.approvedRating)&&void 0!==r?r:e.approvedRating}:e})}catch(e){}e||(A(v),L(null!==(n=null===(s=v[0])||void 0===s?void 0:s.recordingId)&&void 0!==n?n:null))}catch(t){e||R(t instanceof Error?t.message:"Failed to load issues")}finally{e||(S(null),I(!1)),Y.current=!1}}(),()=>{e=!0,Y.current=!1}},[]),(0,n.useEffect)(()=>{(null==et?void 0:et.recordingId)&&es(et.recordingId)},[null==et?void 0:et.recordingId,es]);let en=(0,n.useCallback)(async e=>{try{await fetch("/api/db/issues/".concat(encodeURIComponent(e.recordingId)),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"Resolved"})})}catch(e){}A(t=>t.map(t=>t.recordingId===e.recordingId?{...t,status:"Resolved"}:t))},[]),eo=F.filter(e=>"Resolved"!==e.status).length,ed=F.filter(e=>"Resolved"===e.status).length,el=[{key:"unresolved",label:"Unresolved",count:eo},{key:"all",label:"All",count:F.length},{key:"resolved",label:"Resolved",count:ed}];return w?(0,i.jsxs)("div",{className:"flex h-full flex-col",children:[(0,i.jsxs)("header",{className:"flex shrink-0 items-center justify-between border-b border-gray-200 bg-white px-6 py-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d,{className:"h-6 w-6 text-primary"}),(0,i.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Issues"})]}),(0,i.jsx)("div",{className:"flex items-center gap-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-3 border-l border-gray-200 pl-4",children:[(0,i.jsxs)("div",{className:"text-right text-sm",children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:null!==(x=null!==(m=null==_?void 0:_.firstName)&&void 0!==m?m:null==_?void 0:_.username)&&void 0!==x?x:"User"}),(0,i.jsx)("p",{className:"text-gray-500",children:null!==(h=null==_?void 0:null===(p=_.primaryEmailAddress)||void 0===p?void 0:p.emailAddress)&&void 0!==h?h:""})]}),(0,i.jsx)(s.l8,{afterSignOutUrl:"/"})]})})]}),(0,i.jsx)("div",{className:"flex flex-1 flex-col items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,i.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-2 border-primary border-t-transparent"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["recordings"===C&&"Loading session recordings…","analyzing"===C&&"Issue monitoring agent analyzing…","suggesting"===C&&"Solution agent suggesting fixes…"]}),(0,i.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"This may take a minute. Please wait until both agents finish."})]})]})})]}):(0,i.jsxs)("div",{className:"flex h-full flex-col",children:[(0,i.jsxs)("header",{className:"flex shrink-0 items-center justify-between border-b border-gray-200 bg-white px-6 py-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d,{className:"h-6 w-6 text-primary"}),(0,i.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Issues"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3 border-l border-gray-200 pl-4",children:[(0,i.jsxs)("div",{className:"text-right text-sm",children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:null!==(y=null!==(v=null==_?void 0:_.firstName)&&void 0!==v?v:null==_?void 0:_.username)&&void 0!==y?y:"User"}),(0,i.jsx)("p",{className:"text-gray-500",children:null!==(f=null==_?void 0:null===(e=_.primaryEmailAddress)||void 0===e?void 0:e.emailAddress)&&void 0!==f?f:""})]}),(0,i.jsx)(s.l8,{afterSignOutUrl:"/"})]})]}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden p-6",children:[T&&(0,i.jsx)("div",{className:"mb-4 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:T}),0===F.length&&!T&&(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center rounded-xl border border-gray-200 bg-white p-8",children:(0,i.jsx)("p",{className:"text-gray-500",children:"No issues from session recordings. Recordings with console errors will appear here."})}),F.length>0&&0===ee.length&&(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center rounded-xl border border-gray-200 bg-white p-8",children:(0,i.jsx)("p",{className:"text-gray-500",children:"unresolved"===Z?"No unresolved issues.":"resolved"===Z?"No resolved issues.":"No issues match the current filter."})}),F.length>0&&ee.length>0&&et&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:et.title}),(0,i.jsxs)("div",{className:"mt-1 flex items-center gap-3 text-sm text-gray-500",children:[(0,i.jsx)("span",{className:"rounded px-2 py-0.5 font-medium ".concat(o(et.severity)),children:et.severity}),(0,i.jsxs)("span",{children:["First detected ",et.firstDetected]}),(0,i.jsx)("span",{children:[(null!==(b=et.recording.console_error_count)&&void 0!==b?b:0)>0&&"".concat(et.recording.console_error_count," errors"),(null!==(j=et.recording.rage_click_count)&&void 0!==j?j:0)>0&&"".concat(et.recording.rage_click_count," rage"),(null!==(N=et.recording.dead_click_count)&&void 0!==N?N:0)>0&&"".concat(et.recording.dead_click_count," dead"),"".concat(null!==(k=et.recording.click_count)&&void 0!==k?k:0," clicks")].filter(Boolean).join(" \xb7 ")})]}),(0,i.jsx)("div",{className:"mt-3 flex gap-2",children:el.map(e=>(0,i.jsxs)("button",{type:"button",onClick:()=>{$(e.key);let t="unresolved"===e.key?F.filter(e=>"Resolved"!==e.status):"resolved"===e.key?F.filter(e=>"Resolved"===e.status):F;!t.some(e=>e.recordingId===O)&&t.length>0&&L(t[0].recordingId)},className:"rounded-full border px-3 py-1.5 text-sm font-medium ".concat(Z===e.key?"border-red-500 text-red-600":"border-gray-300 text-gray-600 hover:bg-gray-50"),children:[e.label," (",e.count,")"]},e.key))})]}),(0,i.jsxs)("div",{className:"flex flex-1 gap-6 overflow-hidden min-h-0",children:[(0,i.jsxs)("div",{className:"flex w-[380px] shrink-0 flex-col overflow-hidden",children:[(0,i.jsxs)("h3",{className:"mb-3 text-xs font-semibold uppercase tracking-wider text-gray-500",children:["Issues (",ee.length,")"]}),(0,i.jsx)("div",{className:"flex flex-col gap-2 overflow-y-auto",children:ee.map(e=>{var t,r,s;return(0,i.jsxs)("button",{type:"button",onClick:()=>L(e.recordingId),className:"rounded-xl border p-4 text-left transition-colors ".concat(O===e.recordingId?"border-primary bg-primary/5":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:e.title}),(0,i.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-xs text-gray-500",children:[(0,i.jsx)("span",{className:"rounded px-1.5 py-0.5 font-medium ".concat(o(e.severity)),children:e.severity}),(0,i.jsx)("span",{children:[(null!==(t=e.recording.console_error_count)&&void 0!==t?t:0)>0&&"".concat(e.recording.console_error_count," err"),(null!==(r=e.recording.rage_click_count)&&void 0!==r?r:0)>0&&"".concat(e.recording.rage_click_count," rage"),(null!==(s=e.recording.dead_click_count)&&void 0!==s?s:0)>0&&"".concat(e.recording.dead_click_count," dead")].filter(Boolean).join(", ")}),(0,i.jsx)("span",{children:e.timeAgo})]}),(0,i.jsx)("p",{className:"mt-2 line-clamp-2 text-sm text-gray-600",children:e.description})]},e.recordingId)})})]}),(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-6 overflow-y-auto",children:[(0,i.jsxs)("section",{className:"rounded-xl border border-gray-200 bg-white p-5",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d,{className:"h-5 w-5 text-gray-500"}),(0,i.jsx)("h3",{className:"font-semibold text-gray-900",children:"Issue Description"})]}),(0,i.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,i.jsx)("span",{className:"inline-block rounded px-2 py-0.5 text-sm font-medium ".concat("Resolved"===et.status?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"),children:et.status}),"Resolved"!==et.status&&(0,i.jsx)("button",{type:"button",onClick:()=>en(et),className:"rounded-lg bg-primary px-3 py-1.5 text-sm font-medium text-white hover:bg-primary-dark",children:"Mark Resolved"})]}),(0,i.jsx)("p",{className:"mt-3 text-sm text-gray-600",children:et.description}),(et.codeLocation||et.codeSnippetHint)&&(0,i.jsxs)("div",{className:"mt-4 space-y-2",children:[et.codeLocation&&(0,i.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-3 py-2",children:[(0,i.jsx)("p",{className:"text-xs font-medium uppercase tracking-wider text-gray-500",children:"Where in the code"}),(0,i.jsx)("p",{className:"mt-1 font-mono text-sm text-gray-800",children:et.codeLocation})]}),et.codeSnippetHint&&(0,i.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-amber-50/80 px-3 py-2",children:[(0,i.jsx)("p",{className:"text-xs font-medium uppercase tracking-wider text-amber-700",children:"Code hint"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-gray-700",children:et.codeSnippetHint})]})]}),et.suggestedFix&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt-4 rounded-lg border border-green-200 bg-green-50 px-3 py-2",children:[(0,i.jsx)("p",{className:"text-xs font-medium uppercase tracking-wider text-green-700",children:"Suggested fix"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-gray-700",children:et.suggestedFix})]}),et.approved?(0,i.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:["Approved",null!=et.approvedRating&&(0,i.jsxs)("span",{className:"ml-2 text-amber-600",children:["\xb7 ",et.approvedRating,"/5"]})]}):(0,i.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,i.jsx)("button",{type:"button",onClick:()=>{z(et.recordingId),G(null)},className:"rounded-lg border border-green-600 bg-green-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-green-700",children:"Approve"}),(0,i.jsx)("button",{type:"button",onClick:()=>{G(et.recordingId),z(null)},className:"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Revise"})]}),E===et.recordingId&&(0,i.jsxs)("div",{className:"mt-3 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Rating (1–5)"}),(0,i.jsx)("div",{className:"mt-2 flex gap-2",children:[1,2,3,4,5].map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>B(t=>({...t,[et.recordingId]:e})),className:"h-8 w-8 rounded border text-sm font-medium ".concat(W[et.recordingId]===e?"border-primary bg-primary text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-100"),children:e},e))}),(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return er(et,null!==(e=W[et.recordingId])&&void 0!==e?e:0)},disabled:!(W[et.recordingId]>=1&&W[et.recordingId]<=5),className:"mt-2 rounded-lg bg-primary px-3 py-1.5 text-sm font-medium text-white hover:bg-primary-dark disabled:opacity-50",children:"Submit"})]}),q===et.recordingId&&(0,i.jsxs)("div",{className:"mt-3 rounded-lg border border-gray-200 bg-gray-50 p-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Instructions to revise the suggested fix"}),(0,i.jsx)("textarea",{value:K,onChange:e=>Q(e.target.value),placeholder:"e.g. Make the fix shorter, focus on error handling only...",rows:3,className:"mt-2 w-full rounded border border-gray-300 px-3 py-2 text-sm"}),(0,i.jsx)("button",{type:"button",onClick:()=>ei(et),disabled:!K.trim()||V,className:"mt-2 rounded-lg bg-primary px-3 py-1.5 text-sm font-medium text-white hover:bg-primary-dark disabled:opacity-50",children:V?"Regenerating…":"Submit"})]})]})]}),(0,i.jsxs)("section",{className:"rounded-xl border border-gray-200 bg-white p-5",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(l,{className:"h-5 w-5 text-gray-500"}),(0,i.jsx)("h3",{className:"font-semibold text-gray-900",children:"Related Session"})]}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-gray-100",children:[(0,i.jsxs)("div",{className:"aspect-video w-full min-h-[240px] bg-gray-200",children:[P&&(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),J&&!P&&(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center p-4 text-sm text-red-600",children:J}),H&&!P&&(0,i.jsx)("iframe",{src:H,title:"Session replay",className:"h-full w-full border-0",allow:"fullscreen"})]}),(0,i.jsxs)("div",{className:"border-t border-gray-200 px-3 py-2 text-xs text-gray-500",children:[et.recordingId.slice(0,8),"… \xb7 ",et.timeAgo]})]})})]})]})]})]})]})]})}}},function(e){e.O(0,[770,971,117,744],function(){return e(e.s=7081)}),_N_E=e.O()}]);